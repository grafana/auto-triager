[{"id":68168,"title":"Inappropriate HTTP response code-Star Dashboard","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n  - Inappropriate 500 status code for failed to star dashboard\r\n\r\n| path         | msg    | error |  current status |\r\n|--------------|-----------|-----------|-----------|\r\n| /api/user/stars/dashboard/  | Failed to star dashboard      |  (pq: duplicate key value violates unique constraint \"UQE_star_user_id_dashboard_id\")       | 500|\r\n\r\n**What did you expect to happen**:\r\n  - Based on the error messages, it appears that all the failed requests were caused by uer errors. Therefore, we should anticipate the appropriate status code to be returned, rather than a generic 500 Internal Server. \r\n\n\n### \n# How do we reproduce it?\n\n\nsee above description.\n\n### \n# What Grafana version are you using?\n\n\nv9.4.8\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nNone\n\n### User's OS?\n\n_No response_\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["type/duplicate","area/backend/api","area/backend/db/postgres","triage/needs-confirmation"]},{"id":72426,"title":"Grafana: From Grafana container image \"9.4.13\" detected fields are not enabled in explore option","body":"### What happened?\n\nWe recently upgraded to Grafana's recent helm version \"6.58.5\" with appversion \"10.0.2\" from our existing appversion \"9.3.6\".\r\nAfter moving, we discovered that grafana was unable to display \"Detected fileds\" when we tried to search for loki logs under the explore option.\r\n\r\n\r\nWe tested a couple of additional versions, \"9.4.13\" and \"9.5.5\", and they all have the same problems.\r\n\r\nSo, within helm version \"6.58.5,\" we utilised grafana appversion \"9.3.6,\" and we can see the \"Detected fileds.\"\r\n\r\nIs there anything we need to enable or adjust with versions beginning with \"9.4.13,\" or is this feature gone?\n\n### What did you expect to happen?\n\nWe need grafana to have this \"Detected fileds\" feature with latest appversions.\n\n### Did this work before?\n\nyes, in app version 9.3.6.\n\n### How do we reproduce it?\n\n1. Install latest grafana helm.\r\n2. Install Grafana loki\r\n3. Add loki datasoure in grafana and try using the explore options for logs\r\n\n\n### Is the bug inside a dashboard panel?\n\nNot sure\n\n### Environment (with versions)?\n\nGrafana: 10.0.2\r\nOS:\r\nBrowser:\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\n_No response_","labels":["area/explore","datasource/Loki","triage/needs-confirmation"]},{"id":62645,"title":"Button that has a drop down list is hidden on iPhone 14 pro max","body":"\u003c!--Please use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWhen I go to the main dashboard, the host drop down is hidden. You have to click around to find it.\r\n\r\n**On iPhone:**\r\n\r\n![867A0F2A-742C-45B7-9145-32B427FB6610](https://user-images.githubusercontent.com/5727000/215912490-f053d933-816e-4c7d-99fc-9c96a82db7dc.png)\r\n![580333E6-0B31-471A-BA83-D24A1FFB4165](https://user-images.githubusercontent.com/5727000/215912497-7aa35d65-0962-4469-a822-32cc279d9d44.png)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n**On Desktop:**\r\n\u003cimg width=\"1725\" alt=\"Screenshot 2023-02-01 at 00 08 08\" src=\"https://user-images.githubusercontent.com/5727000/215912750-800ed940-287e-483c-84e8-6c77e30335e6.png\"\u003e\r\n\r\n**What you expected to happen**:\r\nI expect to show the drop down boxes.\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nExplained in the “what happened”.\r\n\r\n**Environment**: iPhone 14 pro max\r\n- Grafana version: 9.3.6\r\n- Data source type \u0026 version: Prometheus 2.24.1\r\n- OS Grafana is installed on: debian 11\r\n- User OS \u0026 Browser: Safari\r\n- Grafana plugins: redis\r\n- Others:\r\n```[tasklist]\r\n### Tasks\r\n\r\n\r\n```\r\n","labels":["area/mobile-support","triage/needs-confirmation","team/grafana-dashboards"]},{"id":69833,"title":"Dashboards: location of repeated panels are wrong (misalignment)","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\nlocation of repeated pannels are wrong ( from \"last row\" to \"the nth from the last row\". \"n\" will increase with variable value count)\r\n\r\n**What did you expect to happen**:\r\n\r\n  - \r\n\r\n![image](https://github.com/grafana/grafana/assets/8463208/28709c36-a651-4f47-a329-e30c773da993)\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\nit seems that this issue appeared after upgrading to version 8.x\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\nGrafana v9.5.1 (bc353e4b2d)\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n[get-help-data.txt](https://github.com/grafana/grafana/files/11703712/get-help-data.txt)\r\n\r\n\r\n### Grafana Platform?\r\n\r\nDocker\r\n\r\n### User's OS?\r\n\r\nCentOS 7\r\n\r\n### User's Browser?\r\n\r\nGoogle Chrome 114.0.5735.106\r\n\r\n### Is this a Regression?\r\n\r\nYes\r\n\r\n### Are Datasources involved?\r\n\r\n_No response_\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["type/bug","area/dashboard","area/frontend","area/templating/repeating","team/grafana-dashboards","prio/planned"]},{"id":61107,"title":"Annotations Break After Viewing Then Saving","body":"**What happened**:\r\nA dashboard has a working Elasticsearch Annotation.  Go to Settings \u003e Annotations and view the Annotation.   Save the dashboard.\r\n\r\nThe annotation no longer functions.   The JSON changed so that the query is no longer used.\r\n\r\n**What you expected to happen**:\r\nNothing.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nThere are other reports that look similar going back some time, so I expect this will be tough to reproduce.  See:\r\nhttps://github.com/grafana/grafana/issues/39186\r\nhttps://github.com/grafana/grafana/issues/57122\r\n\r\nReproduced in Chrome, Firefox, and Safari\r\n\r\n* existing dashboard with an elasticsearch annotation\r\n* upgraded to v9.1.6 \r\n* annotation works fine, confirm that 'Save' finds no changes to save\r\n* Settings \u003e Annotations, select the Annotation (just viewing it, not touching any fields)\r\n* 'Save Dashboard', it shows a diff even tho we didn't edit anything, go ahead and Save\r\n* annotation no longer works:  elasticsearch is getting an empty query that fetches all records for the time range\r\n\r\nAnnotation JSON Before, Working:\r\n```\r\n      {\r\n        \"datasource\": {\r\n          \"type\": \"elasticsearch\",\r\n          \"uid\": \"000000129\"\r\n        },\r\n        \"enable\": true,\r\n        \"hide\": false,\r\n        \"iconColor\": \"rgba(255, 96, 96, 1)\",\r\n        \"name\": \"docc updates\",\r\n        \"query\": \"(syslog_program.raw:doccserver_$cluster OR syslog_program.raw:doccserver) AND msg.raw:\\\"docc event\\\" AND app_namespace.raw:\\\"$namespace\\\" AND app_name.raw:\\\"$application\\\" AND docc_cluster.raw:\\\"$cluster\\\" AND (docc_event.raw:\\\"update\\\" OR docc_event.raw:\\\"deploy\\\" OR docc_event.raw:\\\"restart\\\")\",\r\n        \"showIn\": 0,\r\n        \"tags\": [],\r\n        \"tagsField\": \"app_name\",\r\n        \"textField\": \"docc_event\",\r\n        \"type\": \"tags\"\r\n      }\r\n ```\r\n \r\n Annotation JSON after daring to look at it in the UI, Busted:\r\n ```\r\n       {\r\n        \"datasource\": {\r\n          \"type\": \"elasticsearch\",\r\n          \"uid\": \"000000129\"\r\n        },\r\n        \"enable\": true,\r\n        \"hide\": false,\r\n        \"iconColor\": \"rgba(255, 96, 96, 1)\",\r\n        \"mappings\": {},\r\n        \"name\": \"docc updates\",\r\n        \"showIn\": 0,\r\n        \"tags\": [],\r\n        \"tagsField\": \"app_name\",\r\n        \"target\": {\r\n          \"query\": \"(syslog_program.raw:doccserver_$cluster OR syslog_program.raw:doccserver) AND msg.raw:\\\"docc event\\\" AND app_namespace.raw:\\\"$namespace\\\" AND app_name.raw:\\\"$application\\\" AND docc_cluster.raw:\\\"$cluster\\\" AND (docc_event.raw:\\\"update\\\" OR docc_event.raw:\\\"deploy\\\" OR docc_event.raw:\\\"restart\\\")\",\r\n          \"refId\": \"annotation_query\"\r\n        },\r\n        \"textField\": \"docc_event\",\r\n        \"type\": \"tags\"\r\n      }\r\n ```\r\n\r\nNote the added `mappings` field, and the new `target` field that now contains our `query`, except the query isn't used anymore.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: v9.1.6\r\n- Data source type \u0026 version: Elasticsearch\r\n- OS Grafana is installed on: Using the Docker image\r\n- User OS \u0026 Browser: MacOS, reproduced in Chrome, Firefox, and Safari\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/bug","area/annotations","datasource/Elasticsearch"]},{"id":58876,"title":"Run queries in Grafana Alerting not working","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWhen creating a Grafana managed alert rule then it returns 401 on testing the query.\r\n\r\nThe error is: `Failed to evaluate queries and expressions: failed to execute conditions: failed to execute query A: client_error: client error: 401`\r\n\r\nUsing the developer tool in the browser I'm able to see the request to `/api/v1/eval` and that it returns HTTP 400 with the error message above. \r\n\r\nBy sniffing the traffic between the Grafana instance and the Mimir datasource I can see that the call to `/prometheus/api/v1/query_range` returns 401 as it does not forward the access token and ID token. \r\n\r\n\u003cimg width=\"1713\" alt=\"image\" src=\"https://user-images.githubusercontent.com/52233080/202393050-d603a49f-2908-42c2-a903-7639a9a0ac5c.png\"\u003e\r\n\r\n\r\nIt seems the issue stems from this function: https://github.com/grafana/grafana/blob/main/pkg/services/ngalert/eval/eval.go#L213\r\n\r\nA new header is created, but the `Authorization` and `X-ID-Token` values are not copied. I'm not sure if this is intentional or not.\r\n\r\n**What you expected to happen**:\r\n\r\nIt should forward the OAuth tokens when doing the query.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n1. Create a new rule\r\n2. Create a Mimir/Prometheus query\r\n3. Error message is displayed\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: Grafana v9.2.4\r\n- Data source type \u0026 version: Prometheus type Mimir\r\n- OS Grafana is installed on: Kubernetes with Helm\r\n- User OS \u0026 Browser: Safari 16.1 \r\n- Grafana plugins: \r\n- Others:\r\n","labels":["area/alerting","datasource/Prometheus","area/auth/oauth","needs investigation"]},{"id":81991,"title":"grafana-server does not start after update ","body":"### What happened?\r\n\r\n```\r\nFeb 06 18:03:14 phoebe systemd[1]: grafana-server.service: Scheduled restart job, restart counter is at 3.\r\nFeb 06 18:03:14 phoebe systemd[1]: Started grafana-server.service - Grafana instance.\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=settings t=2024-02-06T18:03:14.212953702+01:00 level=info msg=\"Starting Grafana\" version=10.3.1 commit=00a22ff8b28550d593ec369ba3da1b25780f0a4a branch=HEAD compiled=2024-01-22T19:40:42+01:00\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=settings t=2024-02-06T18:03:14.213193198+01:00 level=info msg=\"Config loaded from\" file=/usr/share/grafana/conf/defaults.ini\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=settings t=2024-02-06T18:03:14.213206083+01:00 level=info msg=\"Config loaded from\" file=/etc/grafana/grafana.ini\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=settings t=2024-02-06T18:03:14.213213126+01:00 level=info msg=\"Config overridden from command line\" arg=\"default.paths.data=/var/lib/grafana\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=settings t=2024-02-06T18:03:14.213219899+01:00 level=info msg=\"Config overridden from command line\" arg=\"default.paths.logs=/var/log/grafana\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=settings t=2024-02-06T18:03:14.21322547+01:00 level=info msg=\"Config overridden from command line\" arg=\"default.paths.plugins=/var/lib/grafana/plugins\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=settings t=2024-02-06T18:03:14.213231271+01:00 level=info msg=\"Config overridden from command line\" arg=\"default.paths.provisioning=/etc/grafana/provisioning\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=settings t=2024-02-06T18:03:14.213237613+01:00 level=info msg=Target target=[all]\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=settings t=2024-02-06T18:03:14.213251388+01:00 level=info msg=\"Path Home\" path=/usr/share/grafana\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=settings t=2024-02-06T18:03:14.21325691+01:00 level=info msg=\"Path Data\" path=/var/lib/grafana\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=settings t=2024-02-06T18:03:14.21326219+01:00 level=info msg=\"Path Logs\" path=/var/log/grafana\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=settings t=2024-02-06T18:03:14.21326755+01:00 level=info msg=\"Path Plugins\" path=/var/lib/grafana/plugins\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=settings t=2024-02-06T18:03:14.213273431+01:00 level=info msg=\"Path Provisioning\" path=/etc/grafana/provisioning\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=settings t=2024-02-06T18:03:14.213278811+01:00 level=info msg=\"App mode production\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=sqlstore t=2024-02-06T18:03:14.213625862+01:00 level=info msg=\"Connecting to DB\" dbtype=sqlite3\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=migrator t=2024-02-06T18:03:14.214160149+01:00 level=info msg=\"Starting DB migrations\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=migrator t=2024-02-06T18:03:14.231753167+01:00 level=info msg=\"migrations completed\" performed=0 skipped=526 duration=621.563µs\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=secrets t=2024-02-06T18:03:14.232985895+01:00 level=info msg=\"Envelope encryption state\" enabled=true currentprovider=secretKey.v1\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=plugin.store t=2024-02-06T18:03:14.24605606+01:00 level=info msg=\"Loading plugins...\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=plugins.registration t=2024-02-06T18:03:14.27873813+01:00 level=info msg=\"Plugin registered\" pluginId=input\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=plugin.store t=2024-02-06T18:03:14.27881746+01:00 level=info msg=\"Plugins loaded\" count=56 duration=32.762291ms\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=query_data t=2024-02-06T18:03:14.280938128+01:00 level=info msg=\"Query Service initialization\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=live.push_http t=2024-02-06T18:03:14.285622207+01:00 level=info msg=\"Live Push Gateway initialization\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=ngalert.migration t=2024-02-06T18:03:14.295155349+01:00 level=info msg=Starting\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=ngalert.migration CurrentType=UnifiedAlerting DesiredType=UnifiedAlerting CleanOnDowngrade=false CleanOnUpgrade=false t=2024-02-06T18:03:14.295566492+01:00 level=info msg=\"Migration already complete\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=ngalert t=2024-02-06T18:03:14.302310643+01:00 level=warn msg=\"Unexpected number of rows updating alert configuration history\" rows=0 org=1 hash=e0528a75784033ae7b15c40851d89484\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=infra.usagestats.collector t=2024-02-06T18:03:14.305119351+01:00 level=info msg=\"registering usage stat providers\" usageStatsProvidersLen=2\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=server t=2024-02-06T18:03:14.305205605+01:00 level=info msg=\"Writing PID file\" path=/run/grafana/grafana-server.pid pid=2886243\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=provisioning.alerting t=2024-02-06T18:03:14.305931738+01:00 level=info msg=\"starting to provision alerting\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=provisioning.alerting t=2024-02-06T18:03:14.305957897+01:00 level=info msg=\"finished to provision alerting\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=grafanaStorageLogger t=2024-02-06T18:03:14.306527121+01:00 level=info msg=\"Storage starting\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=ngalert.state.manager t=2024-02-06T18:03:14.306606041+01:00 level=info msg=\"Warming state cache for startup\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=http.server t=2024-02-06T18:03:14.308303875+01:00 level=info msg=\"HTTP Server Listen\" address=[::1]:3000 protocol=http subUrl=/monitor socket=\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=grafana-apiserver t=2024-02-06T18:03:14.311159442+01:00 level=info msg=\"cannot derive external address port without listening on a secure port.\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886243]: logger=ngalert.multiorg.alertmanager t=2024-02-06T18:03:14.306695652+01:00 level=info msg=\"Starting MultiOrg Alertmanager\"\r\nFeb 06 18:03:14 phoebe systemd[1]: grafana-server.service: Main process exited, code=exited, status=255/EXCEPTION\r\nFeb 06 18:03:14 phoebe systemd[1]: grafana-server.service: Failed with result 'exit-code'.\r\nFeb 06 18:03:14 phoebe systemd[1]: grafana-server.service: Scheduled restart job, restart counter is at 4.\r\nFeb 06 18:03:14 phoebe systemd[1]: Started grafana-server.service - Grafana instance.\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=settings t=2024-02-06T18:03:14.710664984+01:00 level=info msg=\"Starting Grafana\" version=10.3.1 commit=00a22ff8b28550d593ec369ba3da1b25780f0a4a branch=HEAD compiled=2024-01-22T19:40:42+01:00\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=settings t=2024-02-06T18:03:14.710901925+01:00 level=info msg=\"Config loaded from\" file=/usr/share/grafana/conf/defaults.ini\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=settings t=2024-02-06T18:03:14.710920349+01:00 level=info msg=\"Config loaded from\" file=/etc/grafana/grafana.ini\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=settings t=2024-02-06T18:03:14.710932473+01:00 level=info msg=\"Config overridden from command line\" arg=\"default.paths.data=/var/lib/grafana\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=settings t=2024-02-06T18:03:14.710948353+01:00 level=info msg=\"Config overridden from command line\" arg=\"default.paths.logs=/var/log/grafana\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=settings t=2024-02-06T18:03:14.710956448+01:00 level=info msg=\"Config overridden from command line\" arg=\"default.paths.plugins=/var/lib/grafana/plugins\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=settings t=2024-02-06T18:03:14.710964474+01:00 level=info msg=\"Config overridden from command line\" arg=\"default.paths.provisioning=/etc/grafana/provisioning\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=settings t=2024-02-06T18:03:14.710975314+01:00 level=info msg=Target target=[all]\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=settings t=2024-02-06T18:03:14.711000282+01:00 level=info msg=\"Path Home\" path=/usr/share/grafana\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=settings t=2024-02-06T18:03:14.711023386+01:00 level=info msg=\"Path Data\" path=/var/lib/grafana\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=settings t=2024-02-06T18:03:14.711050467+01:00 level=info msg=\"Path Logs\" path=/var/log/grafana\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=settings t=2024-02-06T18:03:14.711106154+01:00 level=info msg=\"Path Plugins\" path=/var/lib/grafana/plugins\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=settings t=2024-02-06T18:03:14.71111502+01:00 level=info msg=\"Path Provisioning\" path=/etc/grafana/provisioning\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=settings t=2024-02-06T18:03:14.711121082+01:00 level=info msg=\"App mode production\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=sqlstore t=2024-02-06T18:03:14.711423618+01:00 level=info msg=\"Connecting to DB\" dbtype=sqlite3\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=migrator t=2024-02-06T18:03:14.711925092+01:00 level=info msg=\"Starting DB migrations\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=migrator t=2024-02-06T18:03:14.730739566+01:00 level=info msg=\"migrations completed\" performed=0 skipped=526 duration=607.527µs\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=secrets t=2024-02-06T18:03:14.732116298+01:00 level=info msg=\"Envelope encryption state\" enabled=true currentprovider=secretKey.v1\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=plugin.store t=2024-02-06T18:03:14.744849052+01:00 level=info msg=\"Loading plugins...\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=plugins.registration t=2024-02-06T18:03:14.780137322+01:00 level=info msg=\"Plugin registered\" pluginId=input\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=plugin.store t=2024-02-06T18:03:14.780212707+01:00 level=info msg=\"Plugins loaded\" count=56 duration=35.36614ms\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=query_data t=2024-02-06T18:03:14.783191338+01:00 level=info msg=\"Query Service initialization\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=live.push_http t=2024-02-06T18:03:14.787234186+01:00 level=info msg=\"Live Push Gateway initialization\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=ngalert.migration t=2024-02-06T18:03:14.791640375+01:00 level=info msg=Starting\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=ngalert.migration CurrentType=UnifiedAlerting DesiredType=UnifiedAlerting CleanOnDowngrade=false CleanOnUpgrade=false t=2024-02-06T18:03:14.792103998+01:00 level=info msg=\"Migration already complete\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=ngalert t=2024-02-06T18:03:14.798576342+01:00 level=warn msg=\"Unexpected number of rows updating alert configuration history\" rows=0 org=1 hash=e0528a75784033ae7b15c40851d89484\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=infra.usagestats.collector t=2024-02-06T18:03:14.801328772+01:00 level=info msg=\"registering usage stat providers\" usageStatsProvidersLen=2\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=server t=2024-02-06T18:03:14.801420377+01:00 level=info msg=\"Writing PID file\" path=/run/grafana/grafana-server.pid pid=2886261\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=provisioning.alerting t=2024-02-06T18:03:14.802291896+01:00 level=info msg=\"starting to provision alerting\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=provisioning.alerting t=2024-02-06T18:03:14.802319168+01:00 level=info msg=\"finished to provision alerting\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=grafanaStorageLogger t=2024-02-06T18:03:14.802490745+01:00 level=info msg=\"Storage starting\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=ngalert.state.manager t=2024-02-06T18:03:14.803220083+01:00 level=info msg=\"Warming state cache for startup\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=ngalert.state.manager t=2024-02-06T18:03:14.803484808+01:00 level=info msg=\"State cache has been initialized\" states=0 duration=263.993µs\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=ngalert.scheduler t=2024-02-06T18:03:14.803530445+01:00 level=info msg=\"Starting scheduler\" tickInterval=10s\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=ticker t=2024-02-06T18:03:14.803570862+01:00 level=info msg=starting first_tick=2024-02-06T18:03:20+01:00\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=ngalert.multiorg.alertmanager t=2024-02-06T18:03:14.803498695+01:00 level=info msg=\"Starting MultiOrg Alertmanager\"\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=http.server t=2024-02-06T18:03:14.805452235+01:00 level=info msg=\"HTTP Server Listen\" address=[::1]:3000 protocol=http subUrl=/monitor socket=\r\nFeb 06 18:03:14 phoebe /usr/share/grafana/bin/grafana[2886261]: logger=grafana-apiserver t=2024-02-06T18:03:14.806383067+01:00 level=info msg=\"cannot derive external address port without listening on a secure port.\"\r\nFeb 06 18:03:14 phoebe systemd[1]: grafana-server.service: Main process exited, code=exited, status=255/EXCEPTION\r\nFeb 06 18:03:14 phoebe systemd[1]: grafana-server.service: Failed with result 'exit-code'.\r\nFeb 06 18:03:15 phoebe systemd[1]: grafana-server.service: Scheduled restart job, restart counter is at 5.\r\nFeb 06 18:03:15 phoebe systemd[1]: grafana-server.service: Start request repeated too quickly.\r\nFeb 06 18:03:15 phoebe systemd[1]: grafana-server.service: Failed with result 'exit-code'.\r\nFeb 06 18:03:15 phoebe systemd[1]: Failed to start grafana-server.service - Grafana instance.\r\n```\r\n\r\n\r\n### What did you expect to happen?\r\n\r\ngrafana-server to start\r\n\r\n### Did this work before?\r\n\r\nworked in 10.2.3, no changes except the update\r\n\r\n### How do we reproduce it?\r\n\r\n1. Update to 10.3.1\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.3.1\r\nOS: Exherbo\r\nBrowser:\r\n\r\n\r\n### Grafana platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### Datasource(s)?\r\n\r\nprometheus","labels":["needs more info","area/backend","triage/needs-confirmation"]},{"id":82410,"title":"Dashboards: CSV download does not show same values as legent","body":"### What happened?\n\nwith a timeseries graph against prometheus: ie avg by (pod)(kube_pod_container_resource_requests{resource=\"memory\"})\r\n\r\nit shows a line graph for each pod over last 24 hours\r\nand it shows a legend with 2 columns (pod and memory in bytes)\r\n\r\nwhen clicking download CSV on the results it seems to only download historical per 5 min entries for just 1 pod\n\n### What did you expect to happen?\n\nwould like to download exactly what the 2 column legent under the panel shows. ie all distinct pod names and last byte value for each one\n\n### Did this work before?\n\nno\n\n### How do we reproduce it?\n\n1. create timeseries panel that runs an expr against prometheus\r\n2. click download csv\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.2.1\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nprometheus","labels":["bot/no new info","area/panel/timeseries"]},{"id":63165,"title":"Alerting provisioning failing on restart in Kubernetes","body":"What happened:\r\nI want to provision alert rules (coming from K8s ConfigMaps) into Grafana running on K8s.\r\nFor first time alert rules are working and health is appearing as `OK` but as take restart to add/update rules, Grafana give constantly error: `invalid format of evaluation results for the alert definition: frame cannot uniquely be identified by its labels`\r\nAlso state of alert stay in `Pending` state.\r\n\r\n```\r\n          model:\r\n            expr: up{job=\"otel-mtrics\"} != 1\r\n            intervalMs: 1000\r\n            legendFormat: \"{{ method }} :: {{ handler }} - {{ pod }}\"\r\n            maxDataPoints: 43200\r\n            refId: A\r\n```\r\n\r\n\u003cimg width=\"1451\" alt=\"image\" src=\"https://user-images.githubusercontent.com/16935593/217723572-1de862ac-07ac-418d-98a6-d3ae30e713a1.png\"\u003e\r\n\r\n\u003cimg width=\"1448\" alt=\"image\" src=\"https://user-images.githubusercontent.com/16935593/217723388-936db62c-7f32-4b5f-aa89-9717f36f9d19.png\"\u003e\r\n\r\n```\r\n---\r\napiVersion: v1\r\nkind: ConfigMap\r\nmetadata:\r\n  name: grafana-datasources\r\n  namespace: grafanapoc\r\ndata:\r\n  prometheus.yaml: |-\r\n    apiVersion: 1\r\n\r\n    deleteDatasources:\r\n      - name: Graphite\r\n        orgId: 1\r\n\r\n    datasources:\r\n      - name: Promscale-PromQL\r\n        type: prometheus\r\n        url: http://xxxxx:9201\r\n        isDefault: true\r\n        editable: true\r\n        access: proxy\r\n---\r\napiVersion: v1\r\nkind: ConfigMap\r\nmetadata:\r\n  name: grafana-alerting\r\n  namespace: grafanapoc\r\ndata:\r\n  alerting.yaml: |\r\n    apiVersion: 1\r\n    groups:\r\n    - name: Engine - Error Rate\r\n      folder: sample\r\n      interval: 1m\r\n      rules:\r\n      - for: 5m\r\n        labels:\r\n          alertname: Engine - Error Rate\r\n          severity: high\r\n        annotations:\r\n          __alertId__: '4'\r\n          description: Elevated Error Rates Observed in \"engine\"\r\n          message: Elevated Error Rates Observed in \"engine\"\r\n          summary: Elevated Error Rates Observed in \"engine\"\r\n        title: Engine - Error Rate\r\n        condition: A\r\n        data:\r\n        - refId: A\r\n          queryType: 'Prometheus'\r\n          relativeTimeRange:\r\n            from: 300\r\n            to: 0\r\n          datasourceUid: 'xxxxxxx'\r\n          model:\r\n            expr: up{job=\"otel-mtrics\"} != 1\r\n            intervalMs: 1000\r\n            legendFormat: \"{{ method }} :: {{ handler }} - {{ pod }}\"\r\n            maxDataPoints: 43200\r\n            refId: A\r\n        - refId: B\r\n          queryType: 'Prometheus'\r\n          relativeTimeRange:\r\n            from: 300\r\n            to: 0\r\n          datasourceUid: \"xxxxxxx\"\r\n          model:\r\n            expr: up{job=\"kubernetes-pods\"} != 0\r\n            intervalMs: 1000\r\n            legendFormat: \"{{ method }} :: {{ handler }} - {{ pod }}\"\r\n            maxDataPoints: 43200\r\n            refId: B\r\n        intervalSeconds: 60\r\n        uid: zPPjDmiVk\r\n        version: 2\r\n        namespace_uid: OceOdmi4k\r\n        namespace_id: 135\r\n        rule_group: Engine - Error Rate\r\n        no_data_state: NoData\r\n        exec_err_state: Alerting\r\n---\r\napiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: grafana\r\n  namespace: grafanapoc\r\nspec:\r\n  replicas: 1\r\n  selector:\r\n    matchLabels:\r\n      app: grafana\r\n  template:\r\n    metadata:\r\n      name: grafana\r\n      labels:\r\n        app: grafana\r\n    spec:\r\n      containers:\r\n        - name: grafana\r\n          image: grafana/grafana:9.3.6-ubuntu\r\n          ports:\r\n            - name: grafana\r\n              containerPort: 3000\r\n          env:\r\n            - name: GF_AUTH_BASIC_ENABLED\r\n              value: \"true\"\r\n            - name: GF_AUTH_ANONYMOUS_ENABLED\r\n              value: \"true\"\r\n            - name: GF_AUTH_ANONYMOUS_ORG_ROLE\r\n              value: Viewer\r\n            - name: GF_LOG_LEVEL\r\n              value: er\r\n            - name: GF_LOG_MODE\r\n              value: console\r\n            - name: GF_METRICS_ENABLED\r\n              value: \"true\"\r\n            - name: GF_PLUGIN_GRAFANA_IMAGE_RENDERER_RENDERING_IGNORE_HTTPS_ERRORS\r\n              value: \"true\"\r\n          volumeMounts:\r\n            - mountPath: /etc/grafana/provisioning/alerting/alerting.yaml\r\n              subPath: \"alerting.yaml\"\r\n              name: grafana-alerting\r\n              readOnly: false\r\n            - mountPath: /tmp\r\n              name: tmp-dir\r\n            - mountPath: /etc/grafana/provisioning/datasources\r\n              name: grafana-datasources\r\n              readOnly: false\r\n      volumes:\r\n        - name: grafana-alerting\r\n          configMap:\r\n            defaultMode: 420\r\n            name: grafana-alerting\r\n        - name : tmp-dir\r\n          emptyDir:\r\n            {}\r\n        - name: grafana-datasources\r\n          configMap:\r\n              defaultMode: 420\r\n              name: grafana-datasources\r\n```\r\n","labels":["needs more info","area/alerting","area/provisioning"]},{"id":49331,"title":"In Grafana 8.5.2, Datasources listing is empty in Prometheus datasource settings","body":"**What happened:** Installed grafana 8.5.2, added prometheus datasource. New feature has been added to manage alerts under that toggle button there is an option to list datasource, eventhough alertmanager datasource are added it is not listing. same under Exemplers.\r\n\r\n**What you expected to happen:** Need to list the datasources\r\n\r\n**How to reproduce it (as minimally and precisely as possible):**\r\n\r\nIn any standalone VM install grafana 8.5.2 rpm\r\nAdd alertmanager datasource\r\nAdd prometheus datasource\r\nonce prometheus datasource added , its settings tab will be opened by default. \r\nUnder Alerting section --\u003e alertmanager datasource list is empty.\r\nUnder Exemplers section --\u003e datasource list is empty.\r\n\r\nIs there any way to fix the issue or any workaround??\r\n\r\n**Environment:**\r\nGrafana version: 8.5.2\r\nData source type \u0026 version: Prometheus datasource\r\nOS Grafana is installed on: CentOS Linux 7\r\nUser OS \u0026 Browser: n/a\r\nGrafana plugins: n/a\r\nOthers: n/a","labels":["needs more info","area/alerting","datasource/Prometheus","bot/no new info","area/configuration"]},{"id":51798,"title":"Grafana 9 permissions changes","body":"**What happened**:\r\nI can't access Teams as Grafana Admin\r\n\r\n**What you expected to happen**:\r\nI can access teams as Grafana Admin\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Login as \"Grafana Admin\"\r\n2. Access \"Teams\" `/org/teams `\r\n3. Get redirected away\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.2\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["needs more info","area/auth/rbac"]},{"id":78648,"title":"Force transition to \"Main Org\" when requesting /api/datasources in any other organization.","body":"### What happened?\n\nUnexpected behavior with API request \"/api/datasources\".\n\n### What did you expect to happen?\n\nRetrieving JSON with the parameters of the current organization's datasources, not the datasources in \"Main\".\n\n### Did this work before?\n\nYes, it appeared after migrating from 10.0.3 to 10.2.1.\r\nBefore migrating to 10.2.1, the combination of the post method with switching organizations \"/api/user/using/$some_orgid\" and get with a request for all local data sources \"/api/datasources\" worked.\n\n### How do we reproduce it?\n\n1. Make post request for switch to some different from \"Main\" organization \"/api/user/using/$some_orgid\".\r\n2. Make get request and get all datasources in organization \"/api/datasources\".\r\n3. Get unexpected datasources from the \"Main\" organization and switch to it.\n\n### Is the bug inside a dashboard panel?\n\nNope\n\n### Environment (with versions)?\n\nGrafana: 10.2.1\r\nOS: Ubuntu 18.04\r\nBrowser: python3 (requests lib)\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\n\"Zabbix plugin for Grafana\" - https://grafana.com/grafana/plugins/alexanderzobnin-zabbix-app/","labels":["area/admin/user","type/regression"]},{"id":65004,"title":"Unable to hide Redis query data","body":"\r\n**What happened**: Unable to hide Redis query result from panel.\r\n\r\n**What you expected to happen**: Toggling hide/unhide should affect visibility of query in panel\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nAdd any Redis query that produces data, toggle hide/unhide. See that values are always shown regardless of setting.\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.3\r\n- Data source type \u0026 version: Redis 2.1.1\r\n- OS Grafana is installed on: Ubuntu 20.04\r\n- User OS \u0026 Browser: MacOS 11.7.3, Chrome 110\r\n\r\n\u003cimg width=\"1590\" alt=\"Screen Shot 2023-03-19 at 12 08 05 PM\" src=\"https://user-images.githubusercontent.com/3473637/226190196-3e7d0cc1-1174-4bdf-8bc9-f248ab7d0b03.png\"\u003e\r\n\u003cimg width=\"330\" alt=\"Screen Shot 2023-03-19 at 12 18 36 PM\" src=\"https://user-images.githubusercontent.com/3473637/226190207-cede35ad-2edf-403f-8596-41f2283ca401.png\"\u003e\r\n","labels":["area/query-editor","triage/needs-confirmation"]},{"id":82975,"title":"UI: Text Panel disappears on Safari","body":"### What happened?\n\nHello,\r\nNot sure how to describe this issue but i have a text panel on the same line with other panels (Table for example)\r\nWhen i hover on table rows Text panel dissapear\n\n### What did you expect to happen?\n\nText panel remains visible\n\n### Did this work before?\n\nIt worked on 10.1\n\n### How do we reproduce it?\n\n1.Create a table panel\r\n2.Create a text panel\r\n3.Hover on Table rows\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana:10.3.1\r\nOS:  Sonoma \r\n\u003cimg width=\"1718\" alt=\"Screenshot 2024-02-17 at 01 19 53\" src=\"https://github.com/grafana/grafana/assets/13196005/5b3607ea-c4ea-4539-8999-e73d8bcf3c03\"\u003e\r\n\u003cimg width=\"1706\" alt=\"Screenshot 2024-02-17 at 01 20 21\" src=\"https://github.com/grafana/grafana/assets/13196005/1117c01e-0538-430e-a2a3-b727337f9ead\"\u003e\r\n14.2.1 (23C71)\r\nBrowser: Safari\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\n_No response_","labels":["area/dashboard","team/grafana-dashboards"]},{"id":54641,"title":"Grafana \"Origin Not Allowed\" 403 Error","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: Receiving an \"Origin Not Allowed\" 403 error when POST or PUT requests are made from the browser after upgrading from 7.5.7\r\n\r\n**What you expected to happen**: Requests (such as query to CloudWatch datasource) to go through. Calls are working when made to the Grafana API manually from command line and do not contain the \"Origin\" header\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**: Greafana is hosted in a docker container on ECS. Traffic to it passes through an ALB and Zuul Gateway. ALB integration support appears to require Grafana to seek another means to the CSRF, most likely via x-forwarded-for header. \r\n\r\n**Environment**:\r\n- Grafana version: 9.1.1\r\n- Data source type \u0026 version: Cloud Watch 5.0.0 and InfluxDB\r\n- OS Grafana is installed on: Ubuntu 20.0.4\r\n- User OS \u0026 Browser: Windows Chrome/Firefox\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/backend"]},{"id":58149,"title":"The # is not being replaced by %23 when using data field with # symbol in Data links","body":"**What happened**:\r\n\r\nWhen using Data links, when `var` in ${__data.fields.\u003cvar\u003e} contains a `#` symbol it will not be encoded to %23 when for example space is being encoded to %20. This leads to incorrect url and incorrect Variables filing\r\n\r\n**What you expected to happen**:\r\nExpected `#` to be encoded to %23\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n- Add Postgres or other SQL data source\r\n- Create a Variable `test` of Custom type\r\n- Add values `sprint 1`, `sprint #2` to it\r\n- Create a Bar chart with data `select name,value from (values('sprint 1',25), ('sprint #2', 15)) s(name,value);` \r\n- Add a Data link to it using Variable `test`: `scheme://your_domain/d/${__dashboard.uid}﻿/﻿${__dashboard}﻿?﻿﻿﻿var-test=${__data.fields.name}`\r\n- Save/Apply changes in Editing mode\r\n- Go to View mode \r\n- Reload the page\r\n- Click on the first bar and then click the data link you created. It should be ok - the `test` dropdown is selected\r\n- Click second bar and then click the data link\r\n- You will see that `test` dropdown is showing not what you expect and in the browser address field `#` is not encoded: `?var-test=sprint%20#2`\r\n\r\n**Environment**:\r\n- Grafana version: setup 1:  v 9.2.3 | setup 2: v. 8.4.4\r\n- Data source type \u0026 version: SQL\r\n- OS Grafana is installed on:  setup 1: docker image under macos 12.2.1 (21D62) | setup  2: Openshift 4.10.0\r\n- User OS \u0026 Browser: chrome\r\n- Grafana plugins: no\r\n- Others: no\r\n","labels":["needs more info","area/dashboard/data-links","area/panel/barchart","triage/needs-confirmation"]},{"id":44484,"title":"Bar Chart not displaying bar when there is only column","body":"**What happened**:\nAfter upgrading to the latest version (v8.3.4) when using the Bar Chart visualisation when a query using the MSSQL datasource only returns a single series it does not draw a single bar, if there are two or more series returned then two or more bars are drawn. If you switch to Table view you can see there is data being returned. \n\n**What you expected to happen**:\nA single bar should be drawn as per older versions. \n\n**How to reproduce it (as minimally and precisely as possible)**:\nAs per the description have a query that returns a single series using the MSSQL datasource, a single bar is not drawn. \n\n**Anything else we need to know?**:\n\n**Environment**:\n- Grafana version:\n8.3.4\n- Data source type \u0026 version:\nMSSQL\n- OS Grafana is installed on:\nWindows\n- User OS \u0026 Browser:\nWindows 10 with Edge","labels":["type/bug","area/panel/barchart","type/regression"]},{"id":48979,"title":"Data source of the query doesn't update when changing corresponding Data source variable","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nChanging Data Source variable doesn't update Data Source of the query. It does, however, update another variable which is based on the Data Source variable. \r\n\r\nI have set up Data Source variable called env to dynamically switch databases:\r\n![image](https://user-images.githubusercontent.com/48870382/168389537-919f8fcf-6dc4-4301-82e4-ed0a45085618.png)\r\n\r\nIn the Data Source for the query I selected `${env}` and it correctly sets the environment that is initially selected (Production). However, when changing the variable to another data source (Staging), the query seems to be targeting the old (Production) data source. To prove that it still incorrectly points to Production, after switching to the Staging data source I used the device value D1839-00662 (which I made sure only exists on Production!) and indeed data appeared, proving my hypothesis.\r\n\r\n![Screen-Recording-2022-05-13-at-1](https://user-images.githubusercontent.com/48870382/168390116-660a4a2b-6d80-4159-9373-f17b8a2e9d45.gif)\r\n\r\n\r\n**What you expected to happen**:\r\nWhen changing Data Source variable, if a query depends on that variable to determine its data source, it must start targeting new data source automatically.\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Set up variable using Data Source option and have at least 2 options available.\r\n2. In the query settings select that variable as the data source.\r\n3. When changing values of the variable, data source of the query stays the same.\r\n\r\n**Anything else we need to know?**:\r\nInterestingly, I used `${env}` variable in the query of another variable and it does respond to changing the value of `${env}`, so it only affects the queries.\r\n\r\n**Environment**:\r\n- Grafana version: v8.5.2\r\n- Data source type \u0026 version: PostgreSQL\r\n- OS Grafana is installed on: Mac, Windows\r\n- User OS \u0026 Browser: Firefox, Chrome, Safari\r\n- Grafana plugins: N/A\r\n- Others: N/A\r\n","labels":["area/dashboard/templating","datasource/Postgres"]},{"id":43887,"title":"Grafana bar guages sometimes meet the criteria but don't show up as full","body":"**What happened**:\r\n\r\nWe've got a dashboard to monitor backups with some bar graphs we use as indicators below text (due to accessibility reasons), and despite the text being green and the bar being full on most of them, some of them end up in a state where the text is green but the bar is empty?\r\n\r\n**What you expected to happen**:\r\n\r\nWe expected all the bars to have green text and be full where the threshold we set was met.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nCreate more than ~30 bar graphs on each page, with a threshold on them, (we use loops to create multiple rows with like 40 bar graphs on each part to monitor different phases of backups with the same types of backup in them) and check the display of any that have a passing threshold\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.3\r\n- Data source type \u0026 version: Prometheus 2.26.0\r\n- OS Grafana is installed on: Rocky Linux 8\r\n- User OS \u0026 Browser: Microsoft Edge (Linux)\r\n- Grafana plugins: N/a\r\n- Others: Nothing I know of\r\n","labels":["needs investigation","area/panel/bargauge"]},{"id":47171,"title":"First day of week doesn't work correctly with Time shift for last week's results","body":"**What happened**: First day of week set to Monday, results with Time shift 1w/w not correct. On March 28th (Monday), the data fetched by the query was from 2022-03-14..2022-03-27.\r\n![image](https://user-images.githubusercontent.com/11799308/161194747-09f12f41-1f87-4a4f-90c2-6fe45b2ccfed.png)\r\n\r\n**What you expected to happen**: Should have shown data from the previous week.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: First day of week to Monday and these settings for the graph.\r\n![image](https://user-images.githubusercontent.com/11799308/161194723-2241f12a-f278-44ce-abb5-6bce63031e54.png)\r\n\r\n**Anything else we need to know?**: The issue was resolved by using 1w+1d/w in Time shift.\r\n![image](https://user-images.githubusercontent.com/11799308/161194886-2f2b9a2b-3b6f-42e3-b023-34393ea2b7e7.png)\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.4\r\n- Data source type \u0026 version: MySQL (MariaDB 10.6.4)\r\n- OS Grafana is installed on: Windows 10\r\n- User OS \u0026 Browser: Windows 10, Firefox/Chrome\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/panel/data"]},{"id":84797,"title":"fail to get render panel image with valid admin role service account token","body":"### What happened?\r\n\r\nI have admin role service account token,I have a script run as webhook service to receive alert from grafana.\r\nas webhook way could send alert with image, with help of image render. it was working before 9.4.7, using apikey.\r\nafter grafana 10.x, it forces to migrate to service account and token to integrate with grafana. \r\nmy cmd run  like below, \r\ncurl -H 'Authorization: Bearer glsa_abcd_15de8a1b' 'https://abc.com/render/d-solo/NtNdgVOSk?panelId=4' \u003e test34.png\r\nresult:\r\n![image](https://github.com/grafana/grafana/assets/8426828/d032839d-e774-4188-af61-58a3c2ed8854)\r\n\r\nwhile using same token, I could create dashboard via below post. \r\ntips:  the image render works when I click the rendered image link\r\n![image](https://github.com/grafana/grafana/assets/8426828/fc09ff3e-92b5-4ac9-96e8-3fcd2cb8789d)\r\n\r\n\r\ncurl -X POST --insecure -H \"Authorization: Bearer glsa_aaaaa_37aa44a6\" -H \"Content-Type: application/json\" -d '{\r\n  \"dashboard\": {\r\n    \"id\": null,\r\n    \"title\": \"Production Overview\",\r\n    \"tags\": [ \"templated\" ],\r\n    \"timezone\": \"browser\",\r\n    \"rows\": [\r\n      {\r\n      }\r\n    ],\r\n    \"schemaVersion\": 6,\r\n    \"version\": 0\r\n  },\r\n  \"overwrite\": false\r\n}' https://abc.com/api/dashboards/db\r\n\r\n\r\n### What did you expect to happen?\r\n\r\ndownload the rendered image with panel content, not the error.\r\n\r\n### Did this work before?\r\n\r\nyes, on 9.4.7, now we are on 10.3 \u0026 10.4\r\n\r\n### How do we reproduce it?\r\n\r\n1. install image render(https://github.com/grafana/grafana-image-renderer)\r\ndraw a panel with a time series chart  and click share to check rendered image on browser like above pic 2 ==\u003e to validate the image render works.\r\n2. run below cmd with an admin service account token(create by admin, goto service account tab), replace below token and grafana url, \r\nNtNdgVOSk and panelId could be found on step1\r\ncurl -H 'Authorization: Bearer glsa_abcd_15de8a1b' 'https://abc.com/render/d-solo/NtNdgVOSk?panelId=4' \u003e test34.png\r\n\r\n3. check the png file, whether it's an error or normal panel content\r\n\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nno, looks like grafana block an entry\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.4\r\nOS: ubuntu\r\nBrowser: Chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nKubernetes\r\n\r\n### Datasource(s)?\r\n\r\nany","labels":["needs more info","area/image-rendering","team/grafana-sharing","can't reproduce"]},{"id":64961,"title":"Alerts states annotations not shown on Annotation list panel","body":"**What happened**: Annotations generated from alerting do not show up in the Annotation list panel. \n\n**What you expected to happen**: For the annotations history to be displayed. \n\n**How to reproduce it (as minimally and precisely as possible)**: Create an alarm make it fire and try to see it in the annotation list panel\n\n\n**Environment**:\n- Grafana version: 9.4.3 ( also tested in nightly) \n\nOther references from the community forum that shows the issue\nhttps://community.grafana.com/t/alerts-states-automatic-annotations-not-shown-on-annotation-list-panel/63498\n\n","labels":["area/annotations","area/alerting","bot/no new info","area/panel/annotation-list"]},{"id":44506,"title":"Dashboard Import is broken in v8.3.x","body":"Hello team, I tried to import dashboards from one version to another and it's being broken because of the datasource object in dashboard.json.\r\n\r\nWe are on version v8.3.3\r\n\r\nIn older versions, datasource key is a string like `datasource: \"my-datasource\"`\r\n\r\nIn newer versions, datasource key is an object like `datasource: {\"name: \"my-datasource\", \"uid\": \"12345\"}`\r\n\r\nSo, when I import from one version to the another, datasource is not being recognized and it's defaulting to the default datasource.","labels":["area/dashboard","needs more info"]},{"id":61893,"title":"invalid value / unknown config name: custom","body":"**What happened**:\r\nWhen I specify both `type = mysql` and `ssl_mode = true` in the `[database]` section of the config file, I get this error message:\r\n```\r\nbash-5.1$ /local/grafana/bin/grafana-server --config=/grafana.ini --homepath=/local/grafana\r\nINFO [01-20|23:36:34] Starting Grafana                         logger=settings version=9.3.1 commit=89b365f8b1 branch=HEAD compiled=2022-12-01T12:45:45Z\r\nINFO [01-20|23:36:34] Config loaded from                       logger=settings file=/local/grafana/conf/defaults.ini\r\nINFO [01-20|23:36:34] Config loaded from                       logger=settings file=/grafana.ini\r\nINFO [01-20|23:36:34] Path Home                                logger=settings path=/local/grafana\r\nINFO [01-20|23:36:34] Path Data                                logger=settings path=/local/data\r\nINFO [01-20|23:36:34] Path Logs                                logger=settings path=/local/grafana/data/log\r\nINFO [01-20|23:36:34] Path Plugins                             logger=settings path=/local/grafana/data/plugins\r\nINFO [01-20|23:36:34] Path Provisioning                        logger=settings path=/local/grafana/conf/provisioning\r\nINFO [01-20|23:36:34] App mode production                      logger=settings\r\nINFO [01-20|23:36:34] Connecting to DB                         logger=sqlstore dbtype=mysql\r\nFailed to start grafana. error: failed to connect to database: invalid value / unknown config name: custom\r\nfailed to connect to database: invalid value / unknown config name: custom\r\nbash-5.1$\r\n```\r\nIf I remove `type = mysql` and run the server, it proceeds. If I leave the `type`, remove `ssl_mode = true`, and run the server, it proceeds.\r\n\r\n**What you expected to happen**:\r\nNo errors, or at least a more helpful error.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nSpecify both `type = mysql` and `ssl_mode = true`:\r\n```\r\n[database]\r\ntype             = mysql\r\nhost             = \u003chostname\u003e:\u003cport\u003e\r\nname             = grafana\r\nserver_cert_name = \u003chostname\u003e\r\nuser             = \u003cusername\u003e\r\npassword         = \u003cpassword\u003e\r\nssl_mode         = true\r\nca_cert_path     = /etc/ssl/certs/ca-certificates.crt\r\n```\r\n\r\n**Anything else we need to know?**:\r\nI run this on a new server with an empty database.\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.1\r\n- Data source type \u0026 version: n/a\r\n- OS Grafana is installed on: Linux Ubuntu 22.04.1 LTS\r\n- User OS \u0026 Browser: n/a\r\n- Grafana plugins: n/a\r\n- Database: DigitalOcean MySQL 8 cluster\r\n","labels":["needs more info","area/backend/db","area/configuration"]},{"id":83263,"title":"Alerting: reordering \"grouped\" alert rules removes alerts filtered via search","body":"### What happened?\r\n\r\nWhen reordering rules inside a \"filtered\" evaluation group, all alerts that were not present in filtered list get removed.\r\n\r\n### What did you expect to happen?\r\n\r\nAlert rules not to be deleted when sorting a filtered evaluation group.\r\nI would even expect that the sort list content would NOT be affected by rule filters via search dialog.\r\n\r\n### Did this work before?\r\n\r\nn/a\r\n\r\n### How do we reproduce it?\r\n\r\n1. create 3 alert rules using the same evaluation group, e.g. create alert rules \"a1\", \"b1\" and \"b2\" under evaluation group \"mygroup\"\r\n2. filter alerts, e.g. search for \"b\"\r\n3. reorder rules for the \"mygroup\" evaluation group, e.g., move \"b2\" to top position\r\n4. clear all filters\r\n5. the alert rule \"a1\" is gone\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nno\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.3.3\r\nOS: linux\r\nBrowser: chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nDocker\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["type/bug","area/alerting","area/frontend"]},{"id":43978,"title":"Elastic: Table fails to load due to \"type\": \"script_exception\", \"reason\": \"compile error\" - Resolves by clicking in and out of the Options script field","body":"Hi, I have a strange behaviour with panels using the metric `docker.cpu.user.pct`.\r\n\r\n## **What happened?**\r\nI've recently upgraded from Grafana 5.4.3 to 8.3.0. When reviewing the dashboards I found 2 panels were empty with error:\r\n\r\n```\r\nObject\r\ndata:\"{\r\n    \"root_cause\": [\r\n        {\r\n            \"type\": \"script_exception\",\r\n            \"reason\": \"compile error\",\r\n            \"script_stack\": [\r\n                \"\",\r\n                \"^---- HERE\"\r\n            ],\r\n            \"script\": \"\",\r\n            \"lang\": \"painless\"\r\n        }\r\n    ],\r\n    \"type\": \"search_phase_execution_exception\",\r\n    \"reason\": \"all shards failed\",\r\n    \"phase\": \"query\",\r\n    \"grouped\": true,\r\n    \"failed_shards\": [\r\n        {\r\n            \"shard\": 0,\r\n            \"index\": \"metricbeat-6.8.21-2022.01.12\",\r\n            \"node\": \"MIMI2kXYS4KA81wsM3WKqg\",\r\n            \"reason\": {\r\n                \"type\": \"script_exception\",\r\n                \"reason\": \"compile error\",\r\n                \"script_stack\": [\r\n                    \"\",\r\n                    \"^---- HERE\"\r\n                ],\r\n                \"script\": \"\",\r\n                \"lang\": \"painless\",\r\n                \"caused_by\": {\r\n                    \"type\": \"illegal_argument_exception\",\r\n                    \"reason\": \"Cannot generate an empty script.\"\r\n                }\r\n            }\r\n        }\r\n    ]\r\n}\"\r\nmessage:\"compile error\"\r\nconfig:Object\r\nurl:\"api/datasources/proxy/3/_msearch\"\r\nmethod:\"POST\"\r\ndata:\"{\"search_type\":\"query_then_fetch\",\"ignore_unavailable\":true,\"index\":[\"metricbeat-*-2022.01.12\"]}\r\n{\"size\":0,\"query\":{\"bool\":{\"filter\":[{\"range\":{\"@timestamp\":{\"gte\":1642008640752,\"lte\":1642009240752,\"format\":\"epoch_millis\"}}},{\"query_string\":{\"analyze_wildcard\":true,\"query\":\"beat.hostname:* AND docker.container.labels.com_docker_stack_namespace:* AND docker.container.labels.com_docker_swarm_service_name:* AND docker.container.labels.com_docker_swarm_task_id:*\"}}]}},\"aggs\":{\"5\":{\"terms\":{\"field\":\"docker.container.name\",\"size\":500,\"order\":{\"_key\":\"desc\"},\"min_doc_count\":1},\"aggs\":{\"9\":{\"terms\":{\"field\":\"docker.container.labels.org_label-schema_version\",\"size\":500,\"order\":{\"_key\":\"desc\"},\"min_doc_count\":1,\"missing\":\"N/A\"},\"aggs\":{\"7\":{\"terms\":{\"field\":\"beat.hostname\",\"size\":500,\"order\":{\"_key\":\"desc\"},\"min_doc_count\":1},\"aggs\":{\"1\":{\"max\":{\"field\":\"docker.cpu.user.pct\",\"script\":\"\"}},\"3\":{\"max\":{\"field\":\"docker.memory.rss.pct\"}},\"4\":{\"sum\":{\"field\":\"docker.network.out.bytes\"}},\"8\":{\"max\":{\"field\":\"docker.healthcheck.event.exit_code\"}}}}}}}}}}\r\n\"\r\nheaders:Object\r\nretry:0\r\nhideFromInspector:false\r\n```\r\nI found out that it would populate the table if I clicked in and out of the Options \u003e Script field of the `docker.cpu.user.pct` metric.\r\n\r\nSee video below:\r\nhttps://user-images.githubusercontent.com/31474068/149197679-6854fefa-45a8-4716-ad6b-d4e9b6140380.mov\r\n\r\n## **What you expected to happen**:\r\nPanel to be populated normally as before the upgrade\r\n\r\n## **How to reproduce it (as minimally and precisely as possible)**:\r\nEdit the table, click in the Script field of the options of docker.cpu.user.pct metric and click out of it(see Video above)\r\n\r\nThis is the dashboard was created with v5.4.3 (i had to change the format to txt so I could upload):\r\n\r\n[docker.txt](https://github.com/grafana/grafana/files/7856843/docker.txt)\r\n\r\n## **Environment**:\r\n- Grafana version: grafana-oss-8.3.0-ubuntu\r\n- Data source type \u0026 version: Metricbeat 6.8.21 (Elasticsearch 6.8.21)\r\n- OS Grafana is installed on: Docker container running in Linux Server\r\n- User OS \u0026 Browser: Ubuntu 18.04.1 LTS + Brave Browser Version 1.34.80 Chromium: 97.0.4692.71 (Official Build) (x86_64)\r\n- Grafana plugins: None\r\n- Others:\r\n\r\nI didn't find anything related already open or closed. Apologies in advance if this is a duplicate.","labels":["area/dashboard","needs more info","datasource/Elasticsearch","bot/no new info"]},{"id":82368,"title":"Log panel colorisation","body":"**Why is this needed**:\r\n\r\nThe log panel only highlights a specific logging level using a small bar on the left hand side of the panel.\r\n\r\n\r\n**What would you like to be added**:\r\n\r\nThere should be an option to highlight the entire line.\r\n","labels":["type/feature-request","area/panel/logs","area/logs"]},{"id":73921,"title":"Docker: Can't change admin password in CLI using Swarm Secrets with MySQL as Database","body":"### What happened?\n\nHere is my Grafana Stack, using Swarm secrets to pass my Database user password with variable \"GF_DATABASE_PASSWORD__FILE\":\r\n\r\n```\r\nversion: \"3.9\"\r\n\r\nservices:\r\n  grafana-db:\r\n    image: grafana-db\r\n    environment:\r\n      MARIADB_DATABASE: grafana\r\n      MARIADB_ROOT_PASSWORD_FILE: /run/secrets/grafanadb_root_pw\r\n    networks:\r\n      - backend\r\n    secrets:\r\n      - grafanadb_root_pw\r\n      - grafanadb_gwadmingrafana_pw\r\n\r\n  grafana:\r\n    image: grafana\r\n    depends_on:\r\n      - grafana-db\r\n    ports:\r\n      - 8080:8080\r\n    environment:\r\n      GF_DATABASE_TYPE: \"mysql\"\r\n      GF_DATABASE_HOST: \"grafana-db:3306\"\r\n      GF_DATABASE_NAME: \"grafana\"\r\n      GF_DATABASE_USER: \"gwadmingrafana\"\r\n      GF_DATABASE_PASSWORD__FILE: /run/secrets/grafanadb_gwadmingrafana_pw\r\n      GF_SERVER_HTTP_PORT: \"8080\"\r\n    networks:\r\n      - frontend\r\n      - backend\r\n    secrets:\r\n      - grafanadb_gwadmingrafana_pw\r\n\r\nnetworks:\r\n  frontend:\r\n  backend:\r\nsecrets:\r\n  grafanadb_root_pw:\r\n    external: true\r\n  grafanadb_gwadmingrafana_pw:\r\n    external: true\r\n```\r\n\r\nWhen I try to change my Admin password in CLI:\r\n\r\n`grafana-cli admin reset-admin-password password`\r\n\r\nThis is the output that I get:\r\n\r\n```\r\nERROR[08-28|11:47:18] alert migration failure: could not get migration log logger=migrator error=\"failed to check table existence: Error 1045: Access denied for user 'gwadmingrafana'@'10.0.4.4' (using password: NO)\"\r\n```\r\n\r\n![print_error](https://github.com/grafana/grafana/assets/16540578/24c2a8f9-038a-4e8e-99c4-2721428352c4)\r\n\r\nHere is the same Stack, without using Swarm secrets and passing my Database user password with variable \"GF_DATABASE_PASSWORD\":\r\n\r\n```\r\nversion: \"3.9\"\r\n\r\nservices:\r\n  grafana-db:\r\n    image: grafana-db\r\n    environment:\r\n      MARIADB_DATABASE: grafana\r\n      MARIADB_ROOT_PASSWORD_FILE: /run/secrets/grafanadb_root_pw\r\n    networks:\r\n      - backend\r\n    secrets:\r\n      - grafanadb_root_pw\r\n      - grafanadb_gwadmingrafana_pw\r\n\r\n  grafana:\r\n    image: grafana\r\n    depends_on:\r\n      - grafana-db\r\n    ports:\r\n      - 8080:8080\r\n    environment:\r\n      GF_DATABASE_TYPE: \"mysql\"\r\n      GF_DATABASE_HOST: \"grafana-db:3306\"\r\n      GF_DATABASE_NAME: \"grafana\"\r\n      GF_DATABASE_USER: \"gwadmingrafana\"\r\n      GF_DATABASE_PASSWORD: mypassword\r\n      GF_SERVER_HTTP_PORT: \"8080\"\r\n    networks:\r\n      - frontend\r\n      - backend\r\n    secrets:\r\n      - grafanadb_gwadmingrafana_pw\r\n\r\nnetworks:\r\n  frontend:\r\n  backend:\r\nsecrets:\r\n  grafanadb_root_pw:\r\n    external: true\r\n  grafanadb_gwadmingrafana_pw:\r\n    external: true\r\n```\r\n\r\nWith this Stack, I can change the Admin password in CLI as expected:\r\n\r\n![print_ok](https://github.com/grafana/grafana/assets/16540578/da32abc3-46d4-4118-9d10-cec126c139fb)\n\n### What did you expect to happen?\n\nIn both Stacks, I expected to change admin password in CLI\n\n### Did this work before?\n\nNo\n\n### How do we reproduce it?\n\nDeploy a Swarm Stack using Secrets and try to change ADMIN password.\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 9.2.6\r\nOS: Oracle Linux Server release 8.7\r\nBrowser: Versão 1.57.53 Chromium: 116.0.5845.114 (Versão oficial) 64 bits\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\n_No response_","labels":["area/backend","area/docker","area/backend/db/sqlite","triage/needs-confirmation"]},{"id":60652,"title":"Bar chart decimal number fields don't have a step value","body":"**What happened**: I tried to type decimal values into the bar chart decimal fields (bar radius, bar width, line width). They were set to 1 and so the graph was not updated as I expected.\r\n\r\n**What you expected to happen**: I expected those values to be reflected in the fields.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: Mouse into a bar chart decimal fields. Type a decimal number, e.g. `0.2`.\r\n\r\n**Anything else we need to know?**:\r\n\r\nThis screenshot shows the fields I'm talking about, after I used the attached sliders to select the values I wanted. I am unable to type them in directly as I should be.\r\n\r\n![Screen Shot 2022-12-21 at 2 28 10 PM](https://user-images.githubusercontent.com/3988134/208988194-2e8ed800-1e24-4dec-b13a-d4f6c5f402bd.png)\r\n\r\nAs I suggested in the title, this is because the input fields are lacking a `step` value corresponding with the sliders (`0.1`, `0.05`, etc.), so Chrome (and other HTML5-compliant browsers) don't allow entering decimal values.\r\n\r\n**Environment**:\r\n- Grafana version: v9.3 (latest)\r\n- Data source type \u0026 version: Prometheus\r\n- OS Grafana is installed on: Web UI\r\n- User OS \u0026 Browser: OSX, Chrome\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["bot/no new info","area/panel/barchart"]},{"id":58313,"title":"Cannot assign folder to new alert rule (not always, at least)","body":"This is on Grafana 9.1.8, please see the attached video.\r\n\r\n- When I type in \"General\" folder name, then it is not found in the list, but it says \"Hit enter to create\"\r\n- I hit enter, and it says that folder already exists\r\n- However, it is never shown in the list, even if I refresh the whole page\r\n- Interestingly, if I choose a different name, yes \"not so general\" and hit enter, then the folder is created\r\n\r\nWhat is happening here?","labels":["type/bug","area/alerting","area/dashboard/folders","needs investigation","prio/unscheduled"]},{"id":46607,"title":"Stat will have decimal points","body":"The actual data is no decimal point, all integers.\r\nBut there is a decimal point when it is displayed through \"Stat\".\r\n![image](https://user-images.githubusercontent.com/58923704/158497222-6beda785-ca26-435b-ae3f-116be73610df.png)\r\n\r\n\r\n\u003cdetails\u003e\r\n\u003csummary\u003eDashboard JSON\u003c/summary\u003e\r\n\u003cpre\u003e\r\n{\r\n  \"annotations\": {\r\n    \"list\": [\r\n      {\r\n        \"builtIn\": 1,\r\n        \"datasource\": \"-- Grafana --\",\r\n        \"enable\": true,\r\n        \"hide\": true,\r\n        \"iconColor\": \"rgba(0, 211, 255, 1)\",\r\n        \"name\": \"Annotations \u0026 Alerts\",\r\n        \"target\": {\r\n          \"limit\": 100,\r\n          \"matchAny\": false,\r\n          \"tags\": [],\r\n          \"type\": \"dashboard\"\r\n        },\r\n        \"type\": \"dashboard\"\r\n      }\r\n    ]\r\n  },\r\n  \"editable\": true,\r\n  \"fiscalYearStartMonth\": 0,\r\n  \"graphTooltip\": 0,\r\n  \"id\": 9,\r\n  \"links\": [],\r\n  \"liveNow\": false,\r\n  \"panels\": [\r\n    {\r\n      \"description\": \"\",\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"thresholds\"\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              }\r\n            ]\r\n          },\r\n          \"unit\": \"none\"\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 9,\r\n        \"w\": 12,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"colorMode\": \"value\",\r\n        \"graphMode\": \"none\",\r\n        \"justifyMode\": \"auto\",\r\n        \"orientation\": \"auto\",\r\n        \"reduceOptions\": {\r\n          \"calcs\": [\r\n            \"lastNotNull\"\r\n          ],\r\n          \"fields\": \"\",\r\n          \"values\": false\r\n        },\r\n        \"textMode\": \"auto\"\r\n      },\r\n      \"pluginVersion\": \"8.4.3\",\r\n      \"targets\": [\r\n        {\r\n          \"application\": {\r\n            \"filter\": \"hwSecSessStatTable\"\r\n          },\r\n          \"datasource\": {\r\n            \"type\": \"alexanderzobnin-zabbix-datasource\",\r\n            \"uid\": \"DIiKu7Vnk\"\r\n          },\r\n          \"functions\": [],\r\n          \"group\": {\r\n            \"filter\": \"HostGroups/Net/Huawei\"\r\n          },\r\n          \"host\": {\r\n            \"filter\": \"Net_192.168.255.254\"\r\n          },\r\n          \"item\": {\r\n            \"filter\": \"hwSecCurrSessNum\"\r\n          },\r\n          \"itemTag\": {\r\n            \"filter\": \"\"\r\n          },\r\n          \"options\": {\r\n            \"disableDataAlignment\": false,\r\n            \"showDisabledItems\": false,\r\n            \"skipEmptyValues\": false,\r\n            \"useZabbixValueMapping\": false\r\n          },\r\n          \"proxy\": {\r\n            \"filter\": \"\"\r\n          },\r\n          \"queryType\": \"0\",\r\n          \"refId\": \"A\",\r\n          \"resultFormat\": \"time_series\",\r\n          \"table\": {\r\n            \"skipEmptyValues\": false\r\n          },\r\n          \"tags\": {\r\n            \"filter\": \"\"\r\n          },\r\n          \"trigger\": {\r\n            \"filter\": \"\"\r\n          },\r\n          \"triggers\": {\r\n            \"acknowledged\": 2,\r\n            \"count\": true,\r\n            \"minSeverity\": 3\r\n          }\r\n        }\r\n      ],\r\n      \"title\": \"hwSecCurrSessNum\",\r\n      \"type\": \"stat\"\r\n    }\r\n  ],\r\n  \"schemaVersion\": 35,\r\n  \"style\": \"dark\",\r\n  \"tags\": [],\r\n  \"templating\": {\r\n    \"list\": []\r\n  },\r\n  \"time\": {\r\n    \"from\": \"now-6h\",\r\n    \"to\": \"now\"\r\n  },\r\n  \"timepicker\": {},\r\n  \"timezone\": \"\",\r\n  \"title\": \"hwSecCurrSessNum\",\r\n  \"uid\": \"0fi39OEnz\",\r\n  \"version\": 1,\r\n  \"weekStart\": \"\"\r\n}\r\n\u003c/pre\u003e\r\n\u003c/details\u003e","labels":["needs investigation","area/panel/stat"]},{"id":63231,"title":"When both Row and Panel use the same variable for the repeat option, the query doesn't honor the value set by the row option","body":"**What happened**:\r\nWhen both Row and Panel use the same variable for the repeat option, the query doesn't honor the value set by the row option\r\n\r\nWe have a cluster label baked with the region name. For example:\r\n- my-**use1**-dev-cluster\r\n- my-**use1**-prod-cluster\r\n- my-**use2**-dev-cluster\r\n- my-**use2**-prod-cluster\r\n\r\n#### Variable\r\nregion: use1 and use2\r\n\r\n### Repeat option \r\nRow: $region\r\nPanel: $cluster\r\n\r\n#### query label filter\r\n```\r\n{cluster=~\".*-$region-.*\", cluster=~\"$cluster\"}\r\n```\r\n\r\nTwo rows in the DB\r\n- use1\r\n- use2\r\nEach row will have all four clusters.\r\n- In use1 row, both use2 graphs have no data.\r\n- In use2 row, both use1 graphs have no data.\r\n\r\n**What you expected to happen**:\r\nTwo rows in the DB\r\n- use1\r\n- use2\r\nEach row will have two clusters\r\n\r\nFirst row **use1**\r\n- my-**use1**-dev-cluster\r\n- my-**use1**-prod-cluster\r\n\r\nSecond row **use2**\r\n- my-**use2**-dev-cluster\r\n- my-**use2**-prod-cluster\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: AMG from AWS\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on: AWS\r\n- User OS \u0026 Browser: Any browser\r\n- Grafana plugins: Time series\r\n- Others:\r\n","labels":["area/dashboard/templating","needs more info","stale","area/dashboard/rows"]},{"id":62569,"title":"No Docker tag latest if beta version","body":"Why do they keep tagging latest docker if it's still in beta?\r\nThanks\r\n","labels":["needs more info","area/docker"]},{"id":72461,"title":"Live Measurements: Measurement tag information seems to get lost","body":"### What happened?\r\n\r\nA dashboard with a number of \"Stat\" panels using query type \"Live Measurements\" is running in a browser for a while (say an hour or even more). Without any interaction, the panels switch to \"No data\", while they were showing measurements all fine before.\r\n\r\nThe measurements are coming from Telegraf via Grafana Websocket.\r\n\r\nThe measurements are filtered within the \"Transform\" area of the panel by tag as I want just specific measurements to show in the \"Stat\" panel.\r\n\r\nAs soon as the the panel switches to \"No data\" you can see from the \"Transform\" area in the panel, that the tags seem to be lost and measurements get \"numbered\":\r\n\r\n![image](https://github.com/grafana/grafana/assets/102018536/4e3e6e19-bdec-4965-9a87-c5edb8f6db69)\r\n\r\nThis seems to be the reason, why the panel is showing \"No data\" as the filtering is not working any more.\r\n\r\nSimply reloading the web-page, will make all work again. Tags are visible again an filtering is working again:\r\n\r\n![image](https://github.com/grafana/grafana/assets/102018536/2de8f22e-786e-4bca-9fe0-94bee59f63e1)\r\n\r\nWithin Telegraf the same data is in parallel also written into an InfluxDB (so 2 output plugins in Telegraf). Data in InfluxDB is fine all the time.\r\n\r\n### What did you expect to happen?\r\n\r\nMeasurement tags should not get lost over time for live measurements.\r\n\r\n### Did this work before?\r\n\r\nNo. I've had this issue ever since using Live Measurements (I started with 9.x).\r\n\r\n### How do we reproduce it?\r\n\r\n1.) Setup a mesaurement in telegraf with multiple tags and use output plugin configured to feed grafana web socket\r\n2.) Create a dashboard with at least one \"Stat\" panel\r\n3.) Configure \"Stat\" panel to use \"Live Measurement\" as query type and filter in transform area for one specific tag\r\n4.) Run dashboard in browser for some time\r\n5.) Once the panel shows \"No data\" check names in transform area (as shown in screenshots)\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nIf I copy to clipboard and paste here I get: \"There was an error posting your comment: Body is too long\"\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.0.3\r\nOS: Raspbian GNU/Linux 10 (buster)\r\nBrowser: MS Edge / Chrome / Firefox\r\n\r\n\r\n### Grafana platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### Datasource(s)?\r\n\r\nMeasurements from Telegraf via Grafana WebSocket","labels":["area/panel/stat","area/transformations","triage/needs-confirmation"]},{"id":63308,"title":"INDEX command denied to user grafana for table 'preferences' on upgrade Grafana 8.5.13 -\u003e 9.3.6","body":"**What happened**:\r\n\r\nTrying to upgrade from Grafana 8.5.13  to 9.3.6 while pointing to the same database\r\nNew Grafana pods fail to start due to the following error:\r\n\r\n\u003e logger=migrator t=2023-02-13T09:27:18.421737646Z level=info msg=\"Starting DB migrations\"\r\nlogger=migrator t=2023-02-13T09:27:18.428533792Z level=info msg=\"Executing migration\" id=\"Add preferences index org_id\"\r\nlogger=migrator t=2023-02-13T09:27:18.432795571Z level=error msg=\"Executing migration failed\" id=\"Add preferences index org_id\" error=\"Error 1142: INDEX command denied to user 'grafana'@'IP' for table 'preferences'\"\r\nlogger=migrator t=2023-02-13T09:27:18.432817092Z level=error msg=\"Exec failed\" error=\"Error 1142: INDEX command denied to user 'grafana'@'IP' for table 'preferences'\" sql=\"CREATE INDEX `IDX_preferences_org_id` ON `preferences` (`org_id`);\"\r\nError: ✗ migration failed (id = Add preferences index org_id): Error 1142: INDEX command denied to user 'grafana'@'IP' for table 'preferences'\r\n\r\nCurrent grafana user has the following permissions which are missing INDEX:\r\n```mysql\u003e show grants;\r\n+-------------------------------------------------------------------------------------------------------------------------+\r\n| Grants for grafana@%                                                                                                    |\r\n+-------------------------------------------------------------------------------------------------------------------------+\r\n| GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, RELOAD, REFERENCES, ALTER ON *.* TO 'grafana'@'%' WITH GRANT OPTION |\r\n+-------------------------------------------------------------------------------------------------------------------------+\r\n1 row in set (0.01 sec)\r\n```\r\n\r\n\r\n**What you expected to happen**:\r\n\r\nWould expect it to be backwards compatible or to have relevant permissions added to the database when installing grafana 9 from helm, or to have relevant documentation on any manual changes required for the upgrade\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nAssuming same upgrade can be reproduced manually by lunching the relevant version and upgrading to 9.3.*\r\n\r\n","labels":["needs more info","type/build-packaging","stale","area/backend/db/migration"]},{"id":45261,"title":"origin not allowed popup and dashboard can not be saved when using IIS as reverse proxy","body":"**What happened**:\r\nWhen trying to save dashboard, yellow exclamation mark popup: \"origin not allowed\" and  dashboard is not saving. (  via domain name using IIS reverse proxy  )\r\nWhen accessing grafana directly by internal IP:3000 everything works.  \r\n\r\nReverting grafana to version 8.3.4 solve problem. Problem exist on version 8.3.5 and 8.3.6\r\n\r\nI'm not using sub path in IIS reverse proxy\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.6\r\n- Data source type \u0026 version: influxdb 1.8.10\r\n- OS Grafana is installed on: Debian 11\r\n- User OS \u0026 Browser: Win11/Chrome\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/docs","needs more info","area/configuration"]},{"id":89292,"title":"time series panel mouse hover over data point display does not show nearest data point","body":"### What happened?\n\nWhen hovering the mouse near a data point in a time series panel, the point is high lighted (see green shadow around green data point in the image). But instead of showing the data that belongs to the highlighted point, it seems the data belonging to the data point that is nearest in the up/down dimension is shown in the overlay (dark red instead of green). It is really hard to get the data for the nearest point in this case.\r\n![image](https://github.com/grafana/grafana/assets/172830202/20d2fc3a-e865-47e1-97de-c44bb0f3130e)\r\n\n\n### What did you expect to happen?\n\nShow data belonging to highlightest nearest (in x and y dimension) data point in overlay. \r\nAlso I would expect only one data point to be highlighted at a time..it seems many data points are selected\n\n### Did this work before?\n\nno idea\n\n### How do we reproduce it?\n\n1. create data set as shown in the image (many close by points in up down dimension but with good difference in left/right dimension)\r\n2. hover mouse near data point \r\n3. observe data overlay\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: Grafana v11.0.0 (83b9528bce)\r\nOS: win10\r\nBrowser: chrome 125.0.6422.142\r\n\n\n### Grafana platform?\n\nI don't know\n\n### Datasource(s)?\n\ninfluxdb via flux","labels":["area/panel/timeseries","triage/needs-confirmation"]},{"id":69636,"title":"grafana-server: crash on fatal error: concurrent map write","body":"### \n# What went wrong?\n\n\nGrafana restart frequently on kubernetes. full log:\r\n\r\n2023-06-06T09:34:00.418073359Z fatal error: concurrent map writes\r\n2023-06-06T09:34:00.418299352Z fatal error: concurrent map writes\r\n2023-06-06T09:34:00.426018958Z \r\n2023-06-06T09:34:00.432490636Z goroutine 165825 [running]:\r\n2023-06-06T09:34:00.432530947Z net/textproto.MIMEHeader.Del(...)\r\n2023-06-06T09:34:00.432659652Z \t/usr/local/go/src/net/textproto/header.go:55\r\n2023-06-06T09:34:00.432670227Z net/http.Header.Del(...)\r\n2023-06-06T09:34:00.432678468Z \t/usr/local/go/src/net/http/header.go:81\r\n2023-06-06T09:34:00.432843205Z github.com/grafana/grafana/pkg/util/proxyutil.ClearCookieHeader(0xc0064f5a00, {0x0, 0x0, 0xc003e20068?}, {0xc002f9ee80, 0x1, 0xa?})\r\n2023-06-06T09:34:00.432861737Z \t/drone/src/pkg/util/proxyutil/proxyutil.go:45 +0x16a\r\n2023-06-06T09:34:00.432872489Z github.com/grafana/grafana/pkg/services/query.(*Service).handleQuerySingleDatasource(0xc0010027e0, {0x3f3ed68, 0xc001efa0c0}, 0xc009a97b20, 0xc001d57220)\r\n2023-06-06T09:34:00.432880557Z \t/drone/src/pkg/services/query/query.go:228 +0x9b3\r\n2023-06-06T09:34:00.432890065Z github.com/grafana/grafana/pkg/services/query.(*Service).QueryData(0xc0010027e0, {0x3f3ed68, 0xc001efa0c0}, 0xc009a97b20, 0x0, {{0xc0036e93a0, 0xd}, {0xc0036e93b0, 0xd}, {0xc002868330, ...}, ...})\r\n2023-06-06T09:34:00.432909129Z \t/drone/src/pkg/services/query/query.go:91 +0x35b\r\n2023-06-06T09:34:00.432918425Z github.com/grafana/grafana/pkg/services/query.(*Service).QueryData.func1()\r\n2023-06-06T09:34:00.432926505Z \t/drone/src/pkg/services/query/query.go:108 +0x125\r\n2023-06-06T09:34:00.432934125Z golang.org/x/sync/errgroup.(*Group).Go.func1()\r\n2023-06-06T09:34:00.432942275Z \t/opt/drone/gomodcache/golang.org/x/sync@v0.1.0/errgroup/errgroup.go:75 +0x64\r\n2023-06-06T09:34:00.432950229Z created by golang.org/x/sync/errgroup.(*Group).Go\r\n2023-06-06T09:34:00.432957989Z \t/opt/drone/gomodcache/golang.org/x/sync@v0.1.0/errgroup/errgroup.go:72 +0xa5\r\n2023-06-06T09:34:00.432965888Z \r\n2023-06-06T09:34:00.432971601Z goroutine 1 [semacquire, 3 minutes]:\r\n2023-06-06T09:34:00.432978954Z sync.runtime_Semacquire(0x4?)\r\n2023-06-06T09:34:00.432987318Z \t/usr/local/go/src/runtime/sema.go:62 +0x25\r\n2023-06-06T09:34:00.432995401Z sync.(*WaitGroup).Wait(0xc001a77170?)\r\n2023-06-06T09:34:00.433002884Z \t/usr/local/go/src/sync/waitgroup.go:139 +0x52\r\n2023-06-06T09:34:00.433009447Z golang.org/x/sync/errgroup.(*Group).Wait(0xc001a73e80)\r\n2023-06-06T09:34:00.433017661Z \t/opt/drone/gomodcache/golang.org/x/sync@v0.1.0/errgroup/errgroup.go:53 +0x27\r\n2023-06-06T09:34:00.433074615Z github.com/grafana/grafana/pkg/server.(*Server).Run(0xc001c6ac00)\r\n2023-06-06T09:34:00.433083964Z \t/drone/src/pkg/server/server.go:181 +0x138\r\n2023-06-06T09:34:00.433092389Z github.com/grafana/grafana/pkg/cmd/grafana-server/commands.executeServer({0x7ffdaeb90134, 0x18}, {0x7ffdaeb90118, 0x12}, {0x0, 0x0}, {0x7ffdaeb90159, 0x6}, 0xc00007c580?, {{0x3f05944, ...}, ...})\r\n\n\n### \n# How do we reproduce it?\n\n\nI don't know the specific steps to reproduce, but it happens frequently\n\n### \n# What Grafana version are you using?\n\n\nv9.3.6\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nKubernetes\n\n### User's OS?\n\nAlpine Linux v3.15\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["needs more info","area/backend"]},{"id":50649,"title":"chaning dashboard require save changes even no changes has been made","body":"**What happened**:\r\n Recently Updated Grafana to 8.5.5. I used to create a dashboard links so when I need to switch between dashboards I select them from the link I created. In the new version of Grafana, every time I want to switch between the dashboards, panel require me to save changes even I did not have any changes. So I would discard changes or resave and overwrite dashboard. \r\n\r\n**What you expected to happen**:\r\n  changing dashboard without requiring save when no changes has been made recently. \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nUpdate to Grafana v8.5.5 and switch between dashboards from `dashboard-links`\r\n\r\n- Grafana version: v8.5.5\r\n- Data source type \u0026 version: every data source I have\r\n- OS Grafana is installed on: Centos\r\n- User OS \u0026 Browser: chrome Version 101.0.4951.64 and firefox 101.0.1 (64-bit)\r\n","labels":["area/dashboard/links"]},{"id":52046,"title":"Grafana explorer doesn't load log volume past 116 days","body":"Hello;\r\n\r\nWhen I set the time range more than 116 days in the Grafana explorer ( either past 116 days or any range more than 116 days ), it fails to load the log volume and throws the following error:\r\n\r\n![image](https://user-images.githubusercontent.com/71173136/178272324-243f237f-814a-484c-a157-daf942d0260c.png)\r\n\r\nPlease note that the log entries themselves get loaded just fine meaning I can see the logs and their detail but the log volume won't load.\r\n\r\nWhen I check the grafana-server logs the following errors can be seen:\r\n\r\n```\r\nlogger=context traceID=00000000000000000000000000000000 userId=1 orgId=1 uname=admin t=2022-07-11T08:17:25.613322771Z level=error msg=\"Request error\" error=\"runtime error: invalid memory address or nil pointer dereference\" stack=\"/usr/local/go/src/runtime/panic.go:221 (0x44e026)\r\n/usr/local/go/src/runtime/signal_unix.go:735 (0x44dff6)\r\n/drone/src/pkg/tsdb/loki/api.go:166 (0x26ed67d)\r\n/drone/src/pkg/tsdb/loki/loki.go:212 (0x26f3332)\r\n/drone/src/pkg/tsdb/loki/loki.go:195 (0x26f307b)\r\n/drone/src/pkg/tsdb/loki/loki.go:174 (0x26f26ea)\r\n/drone/src/pkg/plugins/backendplugin/coreplugin/core_plugin.go:81 (0x275cf90)\r\n/drone/src/pkg/plugins/plugins.go:247 (0x10ed88d)\r\n/drone/src/pkg/plugins/manager/client.go:22 (0x2765b11)\r\n/drone/src/pkg/plugins/backendplugin/instrumentation/instrumentation.go:38 (0x2765577)\r\n/drone/src/pkg/plugins/backendplugin/instrumentation/instrumentation.go:67 (0x2765878)\r\n/drone/src/pkg/plugins/manager/client.go:21 (0x27657a9)\r\n/drone/src/pkg/services/query/query.go:165 (0x1d96efb)\r\n/drone/src/pkg/services/query/query.go:81 (0x1d96296)\r\n/drone/src/pkg/api/metrics.go:48 (0x20c19bb)\r\n/drone/src/pkg/api/routing/routing.go:17 (0x181c8e1)\r\n/drone/src/pkg/api/response/web_hack.go:39 (0x10ea272)\r\n/usr/local/go/src/reflect/value.go:556 (0x4e1964)\r\n/usr/local/go/src/reflect/value.go:339 (0x4e0ee4)\r\n/drone/src/pkg/web/inject.go:159 (0xf578a6)\r\n/drone/src/pkg/web/inject.go:119 (0xf574f4)\r\n/drone/src/pkg/web/context.go:71 (0xf5678b)\r\n/drone/src/pkg/web/context.go:66 (0xf5e5da)\r\n/drone/src/pkg/web/macaron.go:141 (0xf5e5cc)\r\n/usr/local/go/src/net/http/server.go:2047 (0x6d5bee)\r\n/drone/src/pkg/middleware/csp.go:22 (0x1813972)\r\n/usr/local/go/src/reflect/value.go:556 (0x4e1964)\r\n/usr/local/go/src/reflect/value.go:339 (0x4e0ee4)\r\n/drone/src/pkg/web/inject.go:159 (0xf578a6)\r\n/drone/src/pkg/web/inject.go:119 (0xf574f4)\r\n/drone/src/pkg/web/context.go:71 (0xf5678b)\r\n/drone/src/pkg/web/context.go:66 (0xf5e5da)\r\n/drone/src/pkg/web/macaron.go:141 (0xf5e5cc)\r\n/usr/local/go/src/net/http/server.go:2047 (0x6d5bee)\r\n/drone/src/pkg/web/render.go:44 (0xf59386)\r\n/usr/local/go/src/reflect/value.go:556 (0x4e1964)\r\n/usr/local/go/src/reflect/value.go:339 (0x4e0ee4)\r\n/drone/src/pkg/web/inject.go:159 (0xf578a6)\r\n/drone/src/pkg/web/inject.go:119 (0xf574f4)\r\n/drone/src/pkg/web/context.go:71 (0xf5678b)\r\n/drone/src/pkg/web/context.go:66 (0xf5e5da)\r\n/drone/src/pkg/web/macaron.go:141 (0xf5e5cc)\r\n/usr/local/go/src/net/http/server.go:2047 (0x6d5bee)\r\n/drone/src/pkg/middleware/csrf.go:47 (0x1813f6a)\r\n/usr/local/go/src/reflect/value.go:556 (0x4e1964)\r\n/usr/local/go/src/reflect/value.go:339 (0x4e0ee4)\r\n/drone/src/pkg/web/inject.go:159 (0xf578a6)\r\n/drone/src/pkg/web/inject.go:119 (0xf574f4)\r\n/drone/src/pkg/web/context.go:71 (0xf5678b)\r\n/drone/src/pkg/web/context.go:66 (0x1816eca)\r\n/drone/src/pkg/middleware/recovery.go:168 (0x1816ec1)\r\n/drone/src/pkg/api/response/web_hack.go:51 (0x10ea0d3)\r\n/usr/local/go/src/reflect/value.go:556 (0x4e1964)\r\n/usr/local/go/src/reflect/value.go:339 (0x4e0ee4)\r\n/drone/src/pkg/web/inject.go:159 (0xf578a6)\r\n/drone/src/pkg/web/inject.go:119 (0xf574f4)\r\n/drone/src/pkg/web/context.go:71 (0xf5678b)\r\n/drone/src/pkg/web/context.go:66 (0x1814a44)\r\n/drone/src/pkg/middleware/logger.go:35 (0x1814a30)\r\n/drone/src/pkg/api/response/web_hack.go:31 (0x10ea434)\r\n/usr/local/go/src/reflect/value.go:556 (0x4e1964)\r\n/usr/local/go/src/reflect/value.go:339 (0x4e0ee4)\r\n/drone/src/pkg/web/inject.go:159 (0xf578a6)\r\n/drone/src/pkg/web/inject.go:119 (0xf574f4)\r\n/drone/src/pkg/web/context.go:71 (0xf5678b)\r\n/drone/src/pkg/web/context.go:66 (0x1817b59)\r\n/drone/src/pkg/middleware/request_metrics.go:58 (0x1817b48)\r\n/drone/src/pkg/api/response/web_hack.go:31 (0x10ea434)\r\n/usr/local/go/src/reflect/value.go:556 (0x4e1964)\r\n/usr/local/go/src/reflect/value.go:339 (0x4e0ee4)\r\n/drone/src/pkg/web/inject.go:159 (0xf578a6)\r\n/drone/src/pkg/web/inject.go:119 (0xf574f4)\r\n/drone/src/pkg/web/context.go:71 (0xf5678b)\r\n/drone/src/pkg/web/context.go:66 (0x1819359)\r\n/drone/src/pkg/middleware/request_tracing.go:81 (0x1819348)\r\n/drone/src/pkg/api/response/web_hack.go:31 (0x10ea434)\r\n/usr/local/go/src/reflect/value.go:556 (0x4e1964)\r\n\r\n/usr/local/go/src/reflect/value.go:339 (0x4e0ee4)\r\n/drone/src/pkg/web/inject.go:159 (0xf578a6)\r\n/drone/src/pkg/web/inject.go:119 (0xf574f4)\r\n/drone/src/pkg/web/context.go:71 (0xf5678b)\r\n/drone/src/pkg/web/router.go:156 (0xf5abfd)\r\n/drone/src/pkg/web/router.go:213 (0xf5b8b5)\r\n/drone/src/pkg/web/macaron.go:176 (0xf58cd0)\r\n/usr/local/go/src/net/http/server.go:2879 (0x6d915a)\r\n/usr/local/go/src/net/http/server.go:1930 (0x6d4cc7)\r\n/usr/local/go/src/runtime/asm_amd64.s:1581 (0x46c080)\r\n\r\nlogger=context traceID=00000000000000000000000000000000 userId=1 orgId=1 uname=admin t=2022-07-11T08:17:25.613411017Z level=error msg=\"Request Completed\" method=POST path=/api/ds/query status=500 remote_addr=\u003cSOME_IP\u003e time_ms=136 duration=136.692871ms size=123 referer=\"http://\u003cSOME_IP\u003e:\u003cSOME_PORT\u003e/explore?orgId=1\u0026left=%7B%22datasource%22:%22Loki%22,%22queries%22:%5B%7B%22refId%22:%22A%22,%22expr%22:%22%7Bappname%3D%5C%22LOG%5C%22%7D%22%7D%5D,%22range%22:%7B%22from%22:%22now%2Fy%22,%22to%22:%22now%2Fy%22%7D%7D\" traceID=00000000000000000000000000000000⏎\r\n```\r\n\r\nAny ideas about this?\r\n\r\nGrafana v9.0\r\n\r\nThanks in advance.","labels":["type/bug","needs more info","prio/low","datasource/Loki","area/logs"]},{"id":69218,"title":"Generic OAuth: Redirect URL does not respect server.root_url setting","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\nWhen attempting to set up OAuth via [Authelia](authelia.com/) as generic OAuth in Grafana, the `redirect_uri` parameter passed to the authorization flow always uses HTTP, while Authelia wants HTTPS:\r\n\r\n```\r\nThe request is missing a required parameter, includes an invalid parameter value, includes a parameter more than once, or is otherwise malformed. Redirect URL is using an insecure protocol, http is only allowed for hosts with suffix 'localhost', for example: http://myapp.localhost/.\r\n```\r\n\r\nBoth Authelia and Grafana run behind NginxProxyManager as reverse proxy and TLS termination. Grafana itself runs HTTP.\r\n\r\nThe description for the `server.root_url` setting, and multiple issues here where that setting was mentioned, suggests that it should be capable of forcing the prefix/base that the redirect URL is built from. But regardless of what values I set, the resulting URL never reflected any of it.\r\n\r\nEven when I removed any mention of the outside domain from the config file (e.g. `server.domain`), the generated URL still didn't change, suggesting that something like the `X-Forwarded` headers take precedence in build that value.\r\n\r\n**What did you expect to happen**:\r\n\r\nI'd expect that `server.root_url` is used to build the `redirect_uri` query parameter and takes precedence over any automatic URL guessing when set.\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\nSet up Grafana, Authelia and NginxProxyManager using https://www.authelia.com/integration/proxies/nginx-proxy-manager/ and https://www.authelia.com/integration/openid-connect/grafana/.\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\nv9.5.2 (cfcea75916)\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n### Grafana Platform?\r\n\r\nDocker\r\n\r\n### User's OS?\r\n\r\n_No response_\r\n\r\n### User's Browser?\r\n\r\n_No response_\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\n_No response_\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["area/auth/oauth","area/configuration","triage/needs-confirmation"]},{"id":51142,"title":"Error handling units","body":"**What happened**:\r\nGrafana 9 is now handling the units wrong. For instance, I selected kilograms for a value, but since the value was large, it was displayed as _Mg._ The correct unit should have been _tons_ since there is a predefined unit for this size. It is like measuring a roads in mm.\r\n\r\nIt also handles zero funny. It displays it as **0 fU** (U being your base unit), rather than **0 U.** As if femto zero is more of a zero\r\n\r\nGrafana now uses metric prefixes, however, it keeps the same precision. Thus displaying values that make no sense. For instance, used to have a value that displayed as _0.005 Ω,_ now it displays as _5.001 mΩ._ In this application having micro-ohms makes no sense. Any way to specify the minimum precision (for instance, milli-ohms) to display even when you selected a precision of 3 digits? This way it wouldn't display a value or fractions smaller than 1 mΩ. In the example, it should be displayed as 5mΩ However, if the value was _5.0023 Ω,_ it should display _5.002Ω,_ with the same number of digits selected before. \r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9 open source\r\n- OS Grafana is installed on: rpi\r\n","labels":["type/feature-request","area/units","needs investigation","team/grafana-dashboards"]},{"id":66907,"title":"change contact points often get exception","body":"## What happened:\r\nEdit a contact point,  toggle the \"Disable  resolved message\" on.  click button of \"Save contact point\" \r\ngets error like below pic\r\n\r\n## What you expected to happen:\r\nsave successfully\r\n\r\n## How to reproduce it (as minimally and precisely as possible):\r\nAssume you have a list of contact points( 10 buckets)\r\nEdit a contact point,  toggle the \"Disable  resolved message\" on.  click button of \"Save contact point\" \r\nit throws error at right top.  reclick that button. it succeeds.    I met several times, almost each time.\r\n\r\n## Anything else we need to know?:\r\n\r\n## Environment:\r\n- Grafana version: 9.4.7\r\n- Data source type \u0026 version: NA\r\n- OS Grafana is installed on: centos 8\r\n- User OS \u0026 Browser: chrome\r\n- Grafana plugins: NA\r\n- Others: NA\r\n\r\n![image](https://user-images.githubusercontent.com/8426828/233275048-82200473-7fdd-4333-b4cc-2c53d796f470.png)\r\n","labels":["needs more info","area/alerting","stale"]},{"id":54690,"title":"Live Query Panel in Dashboard Crashing Browser ","body":"Hello Everyone, \r\n\r\nWe have been facing issues with loki \"live log\" panel. \r\nOnce we disable the live log query panel in dashboard the data comes up fine. \r\nAnyone knows how to correctly add live log panel in dashboard without crashing the dashboard. \r\n\r\nThanks \r\nShubham ","labels":["area/dashboard","datasource/Loki","bot/no new info","area/live","triage/needs-confirmation"]},{"id":83448,"title":"Upgrading to 10.3.3 causes \"frame cannot uniquely be identified by it's labels\" errors for alerts that were previously working fine","body":"### What happened?\n\nWe recently attempted to upgrade from 10.2.3 to 10.3.3 for the recent security fix.  Unfortunately we quickly saw that this caused errors with multiple alerts and from multiple datasource types.  The error is:\r\n\r\n```\r\nInvalid format of evaluation results for the alert definition : frame cannot uniquely be identified by its labels: has duplicate results with labels {}\r\n```\r\n\r\nRevert back to 10.2.3 fixes the issue.\r\n\r\nI found another person having the same issue:\r\nhttps://www.reddit.com/r/grafana/comments/1ay5egy/getting_this_alert_error_in_grafana_1033_what_am/\n\n### What did you expect to happen?\n\nalerts to continue to function\n\n### Did this work before?\n\nyes\n\n### How do we reproduce it?\n\n1. upgrade to 10.3.3\r\n2. check alerts for above error\r\n3.\r\n\n\n### Is the bug inside a dashboard panel?\n\nno\n\n### Environment (with versions)?\n\nGrafana: 10.3.3\r\nOS: mac\r\nBrowser: chrome\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\n_No response_","labels":["area/expressions","triage/needs-confirmation"]},{"id":44033,"title":"Dashboard UID generation issue","body":"**What happened**: \r\nI use a script to generate dashboards with rest api (using a grafana python lib), and the script gives a fix UID to each dashboard (so if I have to generate them again fro some reason, the link to the dashboard is the same). But I got the error `Server Error 500: Error while checking if dashboard is provisioned` \r\n\r\n**What you expected to happen**:\r\nBefore, for older versions, the script was working fine and generating dashboards with the given UID.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nSend a dashboard through api with any already written UID\r\n\r\n**Anything else we need to know?**:\r\nWhen I dont send the UID, the script just works fine but all the links I have are deprecated every time the grafana instance is reset\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.0\r\n","labels":["needs more info","area/backend/api","area/backend"]},{"id":47393,"title":"Unicode newline \\u2028 isn't rendered as a new line visually","body":"**What happened**:\r\n\r\nWhen displaying logs from Loki in Grafana, a log line containing the Unicode character `\\u2028` (https://codepoints.net/U+2028?lang=en) should render as a new line visually, but it doesn't.\r\n\r\n**What you expected to happen**:\r\n\r\nShould render visually as a line break, i.e. text after it should be on a separate line (could be solved e.g. using \u003cbr\u003e tag).\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n```\r\nMy log line here, with a message \\u2028 followed by more text on a separate line.\r\n```\r\n\r\n**Anything else we need to know?**:\r\n\r\nLog systems often treat `\\n` as the delimiter between log lines. But for certain scenarios, for example stack traces, you want the whole trace on one log line, but you still want to show line breaks visually, to make it easier to read. Shipping those newlines through the log processor, log forwarding, log display tool etc. there are many places where you need to escape or do special handling.\r\n\r\nBy using the unicode `\\u2028` character, since it's not ASCII, there is little to worry about.\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.1\r\n- Data source type \u0026 version: Loki 2.4.1\r\n- OS Grafana is installed on: Ubuntu 20.04\r\n- User OS \u0026 Browser: Firefox 98 \r\n- Grafana plugins: n/a\r\n- Others: n/a\r\n","labels":["area/logs"]},{"id":52000,"title":"Maintaining Variables Hyper-link Issue","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:  When clicking on a link taking you to another page it shows the default page.\r\n\r\n**What you expected to happen**: When clicking on a link to take you to another page, keep the page variables from the current page.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: Create a link from one dashboard to another that has {__all_variables} in the dashboard, in the goal of keeping the selected variables. Through the text dashboard panel, using markdown.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**: Grafana OSS\r\n- Grafana version: 9.0.0\r\n- Data source type \u0026 version: InfluxDB Version 2.0.9, this specific issue doesn't necessarily deal with the data. \r\n- OS Grafana is installed on: Linux Ubuntu 20.04\r\n- User OS \u0026 Browser: Linux Ubuntu 20.04\r\n- Grafana plugins: None\r\n- Others:\r\n","labels":["area/dashboard/templating","area/dashboard","needs investigation","bot/no new info"]},{"id":83810,"title":"Grafana: Unable to set httponly for grafana cookie","body":"[###]\r\n![grafana cookieext](https://github.com/grafana/grafana/assets/94673081/893f4c15-99f8-48e4-8228-8bbe40752018)\r\nWhat happened?\r\n\r\nUnable to set httponly flag on grafana cookie, please see attachment\r\ncookie:\r\ngrafana_session_expiry\r\n\r\n### What did you expect to happen?\r\n\r\nall cookies are set httponly\r\n\r\n### Did this work before?\r\n\r\nno it never worked\r\n\r\n### How do we reproduce it?\r\n\r\n1. open dev tools in browser\r\n2. load a web page\r\n3. verify cookie's security flags\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana:10.3.1\r\nOS: RHEL9.3 UBI\r\nBrowser: EDGE, FIREFOX\r\n\r\n\r\n### Grafana platform?\r\n\r\nNone\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/security","bot/no new info","triage/needs-confirmation"]},{"id":61509,"title":"Dashboard Variables with Azure Data Explorer Datasource Don't Honor Time Parameters ","body":"**What happened**:\r\n\r\n\u003e My dashboard has an Azure Data Explorer (ADX) data-source with a query that returns a list of values used to filter various panels. When I use the built in parameters for the time-selector in a WHERE clause of the ADX query they aren't honored.  It appears the parameter values set by the time range selector can't accessed in an ADX data-source for dashboard parameter. \r\n\u003e \r\n\u003e This is a usability issue since users expect their changes to time filter to affect this list of values in the variable.  Since I can't access the parameters for their time selection, I have to either bring back all values in the ADX database (which is way too many) or introduce an arbitrary look back (e.g. - 7 days) which is only accurate if the user selects the same lookback time.  Therefore, my reports are inaccurate from a user perspective, and it reduces the trust in the Grafana reports we are trying to get our organization to adopt. \r\n\r\n**What you expected to happen**:\r\n\r\n\u003e I expect any variable query to have access to the dashboard time selection parameters enabling report designers to filter the results in based on the user's time selection. \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n\u003e 1. Create and dashboard and set the time using the time drop-down selector: \r\n\u003e    * Start Time: '2023-01-13 00:00' \r\n\u003e    * End Time: '2023-01-13 06:00'\r\n\u003e 2. Create a dashboard variable called mySeries that has an Azure Data Explorer data-source and uses this query:  \r\n\u003e ```\r\n\u003e    let seriesFilter = datatable(Timestamp:datetime, seriesName:string )[\r\n\u003e     '2023-01-13 00:00', \"A\", \r\n\u003e     '2023-01-13 01:00', \"B\", \r\n\u003e     '2023-01-13 02:00', \"C\", \r\n\u003e     '2023-01-13 03:00', \"D\", \r\n\u003e     '2023-01-13 04:00', \"E\", \r\n\u003e     '2023-01-13 05:00', \"F\", \r\n\u003e     '2023-01-13 06:00', \"G\" \r\n\u003e     ];\r\n\u003e    seriesFilter\r\n\u003e    | where Timestamp \u003e $__timeFrom() and Timestamp \u003c= $__timeTo()\r\n\u003e ```\r\n\u003e 3. Press the\"Run Query\" button and under \"Preview of Values\" you should see a single result of \"None\" which is improper\r\n\u003e 4. Next, comment out the where clause in the query to exclude the time filter: \r\n\u003e ```\r\n\u003e    let seriesFilter = datatable(Timestamp:datetime, seriesName:string )[\r\n\u003e     '2023-01-13 00:00', \"A\", \r\n\u003e     '2023-01-13 01:00', \"B\", \r\n\u003e     '2023-01-13 02:00', \"C\", \r\n\u003e     '2023-01-13 03:00', \"D\", \r\n\u003e     '2023-01-13 04:00', \"E\", \r\n\u003e     '2023-01-13 05:00', \"F\", \r\n\u003e     '2023-01-13 06:00', \"G\" \r\n\u003e     ];\r\n\u003e    seriesFilter\r\n\u003e    //| where Timestamp \u003e $__timeFrom() and Timestamp \u003c= $__timeTo()\r\n\u003e ```\r\n\u003e 5. Press the \"Run Query\" again and you'll see the expected results of: A, B, C, D, E, F, G\r\n\u003e 6. You can also create a table panel in the report using the same query and you'll see that it properly processes the time parameters. \r\n\r\n**Repro Demo**\r\n\r\n\u003e [Here ](https://1drv.ms/u/s!Ahi4riCD6b4OiIMyeAkdIL_3xR2uVA?e=VhX41e) is an animated gif that shows a repro of the issue.  The animation first shows the a table panel, with the query in step-2 above, works as expected and filters the rows based on the time selection.  The second part of the demo shows how the same query doesn't work as expected in the variable. \r\n\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version:  9.2.7.1\r\n- Data source type \u0026 version:  Azure Data Explorer 4.1.6\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/dashboard/templating","needs more info","effort/none","datasource/Azure"]},{"id":59767,"title":"Login: 'Sign In' button in lower left no longer working with proxy config setting root_url grafana \u003e= 9.3.0 ","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nClick on \"Sign In\" in lower left (box with inward arrow) -- get 404 Not Found in response. the  URL is missing subpath\r\n**What you expected to happen**:\r\nbe taken to the login screen\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nset root_url in /etc/grafana/grafana.ini  with a subpath\r\nall other links appear to work, but \"Sign In\" button is missing the subpath\r\n**Anything else we need to know?**:\r\nthe current config worked fine with all grafana 9.2.x and older. this broke in grafana 9.3.0 release\r\n**Environment**:\r\n- Grafana version: \u003e= 9.3\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on: redhat linux\r\n- User OS \u0026 Browser: firefox and chrome on redhat linux and fedora\r\n- Grafana plugins: -\r\n- Others: login via the grafana icon in top left still works properly with subpath\r\n\r\n","labels":["type/bug","area/navigation","area/frontend/login"]},{"id":61900,"title":"Alerting: Database migration failed due to slack alarm","body":"\r\n**What happened**:\r\n\r\nDatabase migration failed upgrading from Grafana 8.3 to 9.3.2\r\n\r\n**What you expected to happen**:\r\n\r\nMigration to work.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nThe Error log has this message:\r\n\r\n using the Slack chat API\"\r\nlogger=migrator t=2023-01-22T23:17:01.264431306Z level=error msg=\"Exec failed\" error=\"failed to validate AlertmanagerConfig in orgId 1: failed to validate receiver \\\"Alert Slack\\\" of type \\\"slack\\\": recipient must be specified when using the Slack chat API\" sql=\"code migration\"\r\n\r\n\r\nDatabase has \r\n```sql\r\nSELECT * FROM alert_notification;\r\n1|1|Alert Slack|slack|{\"addresses\":\"\",\"autoResolve\":true,\"httpMethod\":\"POST\",\"severity\":\"critical\",\"uploadImage\":false}|2021-06-30 19:06:56|2021-06-30 19:06:56|0|0|0|0|JxfOj1k7z|{}\r\n```\r\n\r\n\r\n**Anything else we need to know?**:\r\nI updated the slack notification to an email one, then the migration worked. (ID 2 has email type alarm)\r\n\r\n\r\n```sql\r\nUPDATE alert_notification\r\nSET\r\n    type = (SELECT type FROM alert_notification WHERE id = 2),\r\n    settings = (SELECT settings FROM alert_notification WHERE id = 2)\r\nWHERE id = 1;\r\n```\r\n\r\n\r\n\r\n\r\n\r\n","labels":["needs more info","area/alerting","area/backend/db/migration"]},{"id":55547,"title":"Pending invites is missing","body":"**What happened**:\r\n\r\nI created users with or without sending invitation email.\r\n\r\n**What you expected to happen**:\r\n\r\nI expected the \"Pending Invites\" to appear in users section next to \"Users\".\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nCreate a user.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.9 \u0026 9.1.5\r\n- Data source type \u0026 version: Prometheus\r\n- OS Grafana is installed on: Official Docker Image\r\n- User OS \u0026 Browser: Arch - Firefox\r\n- Grafana plugins: grafana-piechart-panel grafana-sentry-datasource\r\n\r\nI downgraded to 8.5.13 and I could see the \"Pending Invites\" again.\r\n\r\n\nhttps://github.com/grafana/grafana/issues/55547#tasklist-block-5e630750-2235-47bf-8df9-be1a0a326b36\n","labels":["type/bug","area/admin/user"]},{"id":74558,"title":"AlertProvisioning API: Updates to individual alert's provenance fails","body":"### What happened?\r\n\r\nI attempted to update the provenance of an existing alert via the `/api/v1/provisioning/alert-rules/{UID}` endpoint and got the following error:\r\n`Server Error 500: cannot change provenance from 'api' to ''`\r\n\r\nFrom the looks of it, this should be supported as of this PR: https://github.com/grafana/grafana/pull/63650\r\n\r\nI've attempted this both on a local instance running Grafana 10.0.5, as well as a grafana cloud instance running 10.2.0-60139\r\n\r\nIt seems like there are several routes to disabling provenance, but for some reason, it's not being supported by the `/api/v1/provisioning/alert-rules/{UID}` endpoint.\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nThe alert provenance should be updated \u0026 editing should not be allowed via the UI.\r\n\r\n### Did this work before?\r\n\r\nProbably not.\r\n\r\n### How do we reproduce it?\r\n\r\n1. Provisiong a new alert using the AlertProvisioning API and do not disable provenance.\r\n2. Update alert using the `/api/v1/provisioning/alert-rules/{UID}` API with the `X-Disable-Provenance`  header set.\r\n3. receive \"cannot change provenance from 'api' to ''\" error.\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\n_No response_\r\n\r\n### Grafana platform?\r\n\r\nNone\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["needs more info","area/alerting"]},{"id":68390,"title":"Grafana returning wrong query result after upgrading to 9.5","body":"### \n# What went wrong?\n\n\nI have a panel with the following Influx 1.8 query:\r\n````\r\nSELECT * from (\r\nSELECT last(\"percent_packet_loss\") as packetloss FROM \"ping\" WHERE (\"bucket\" = 'switches' ) AND $timeFilter\r\n) where \"packetloss\" \u003e 0\r\nGROUP BY \"name\"\r\n````\r\n\r\nWhen using grafana 9.3, with STAT PANEL, it works fine. Currently returning \"13\".\r\n\r\nI upgraded to grafana 9.5 and this query is now broken., It keeps oscilating the returned value. from 1, 3, 6, 8, every time the dashboard refreshes.\r\n\r\nDowngreading to grafana 9.3 fixes the issue.\r\n\r\n\r\n\r\n![image](https://github.com/grafana/grafana/assets/8555749/6b8757bc-a033-4d07-b5f2-93ec72cca940)\r\n\n\n### \n# How do we reproduce it?\n\n\nSee explanation above\n\n### \n# What Grafana version are you using?\n\n\nv9.5.2\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\npanel json:\r\n\r\n````\r\n{\r\n  \"id\": 32,\r\n  \"gridPos\": {\r\n    \"h\": 4,\r\n    \"w\": 3,\r\n    \"x\": 21,\r\n    \"y\": 5\r\n  },\r\n  \"type\": \"stat\",\r\n  \"title\": \"Total Switches DOWN\",\r\n  \"transformations\": [\r\n    {\r\n      \"id\": \"calculateField\",\r\n      \"options\": {\r\n        \"mode\": \"reduceRow\",\r\n        \"reduce\": {\r\n          \"reducer\": \"count\"\r\n        },\r\n        \"replaceFields\": true\r\n      }\r\n    }\r\n  ],\r\n  \"datasource\": {\r\n    \"uid\": \"_rojVbO4k\",\r\n    \"type\": \"influxdb\"\r\n  },\r\n  \"pluginVersion\": \"9.3.14\",\r\n  \"timeFrom\": \"1m\",\r\n  \"hideTimeOverride\": true,\r\n  \"fieldConfig\": {\r\n    \"defaults\": {\r\n      \"mappings\": [\r\n        {\r\n          \"options\": {\r\n            \"0\": {\r\n              \"index\": 0,\r\n              \"text\": \"0\"\r\n            }\r\n          },\r\n          \"type\": \"value\"\r\n        },\r\n        {\r\n          \"options\": {\r\n            \"match\": \"null+nan\",\r\n            \"result\": {\r\n              \"index\": 1,\r\n              \"text\": \"0\"\r\n            }\r\n          },\r\n          \"type\": \"special\"\r\n        }\r\n      ],\r\n      \"thresholds\": {\r\n        \"mode\": \"absolute\",\r\n        \"steps\": [\r\n          {\r\n            \"color\": \"#0086aa\",\r\n            \"value\": null\r\n          },\r\n          {\r\n            \"color\": \"#EAB839\",\r\n            \"value\": 1\r\n          }\r\n        ]\r\n      },\r\n      \"color\": {\r\n        \"mode\": \"thresholds\"\r\n      },\r\n      \"unit\": \"none\"\r\n    },\r\n    \"overrides\": []\r\n  },\r\n  \"options\": {\r\n    \"reduceOptions\": {\r\n      \"values\": false,\r\n      \"calcs\": [\r\n        \"lastNotNull\"\r\n      ],\r\n      \"fields\": \"\"\r\n    },\r\n    \"orientation\": \"auto\",\r\n    \"textMode\": \"value\",\r\n    \"colorMode\": \"background\",\r\n    \"graphMode\": \"none\",\r\n    \"justifyMode\": \"center\",\r\n    \"text\": {}\r\n  },\r\n  \"targets\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"influxdb\",\r\n        \"uid\": \"_rojVbO4k\"\r\n      },\r\n      \"query\": \"SELECT * from (\\nSELECT last(\\\"percent_packet_loss\\\") as packetloss FROM \\\"ping\\\" WHERE (\\\"bucket\\\" = 'switches' ) AND $timeFilter\\n) where \\\"packetloss\\\" \u003e 0\\nGROUP BY \\\"name\\\"\",\r\n      \"rawQuery\": true,\r\n      \"refId\": \"A\",\r\n      \"resultFormat\": \"time_series\"\r\n    }\r\n  ],\r\n  \"transparent\": true\r\n}\r\n````\n\n### Grafana Platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### User's OS?\n\nUbuntu 22.04\n\n### User's Browser?\n\nFirefox\n\n### Is this a Regression?\n\nYes\n\n### Are Datasources involved?\n\nInfluxDB 1.8\n\n### Anything else to add?\n\n\n_No response_","labels":["datasource/InfluxDB","prio/low","needs investigation","stale","triage/needs-confirmation"]},{"id":73676,"title":"Transformations: \"All values\" calculation returns the last entry for all rows of the table","body":"### What happened?\r\n\r\nAfter upgrade 9.3.6 =\u003e 10.0.3\r\n\r\n\"All values\" calculation within \"Add field from calculation\" transformation in reduce row mode returns the last entry for all rows of the table (the column value is the same for all rows).\r\n\r\nWorkaround is to use \"All unique values\" calculation.\r\n\r\n![Capture](https://github.com/grafana/grafana/assets/56519965/44be97f3-8e84-4ab7-8464-a6d7a8f8d74c)\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nThe field value must be calculated for each row separately.\r\n\r\n### Did this work before?\r\n\r\nYes, 9.3.6\r\n\r\n### How do we reproduce it?\r\n\r\n1. Create \"Add field from calculation\" transformation, use \"Reduce row\" mode\r\n2. Select \"All values\" calculation for one or seral fields\r\n3. Check calculated values\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nTable panel (other?)\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.0.3, 10.2.0\r\nOS: Linux\r\nBrowser: Firefox 113.0.2\r\n\r\n\r\n### Grafana platform?\r\n\r\nDocker\r\n\r\n### Datasource(s)?\r\n\r\nAny? (Elasticsearch, Graphite, ...)","labels":["area/transformations","triage/needs-confirmation"]},{"id":86744,"title":"Tooltips: overlap","body":"### What happened?\n\n![image](https://github.com/grafana/grafana/assets/43705385/5921ce39-ada8-4eef-b32c-52d4f6391265)\r\n\n\n### What did you expect to happen?\n\nTooltips should not overlap each other if there is a lot of data on them\n\n### Did this work before?\n\nidk\n\n### How do we reproduce it?\n\ndashboards attached\r\n[dashboard.json](https://github.com/grafana/grafana/files/15072430/dashboard.json)\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 11.1.0\r\nOS: windows 10\r\nBrowser: chrome \u0026 firefox\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["type/bug","area/dashboard","area/tooltip"]},{"id":88974,"title":"Alert urls: Grafana alert urls not working under subpath and reverse proxy","body":"### What happened?\n\nSpecific Grafana urls not working when serving Grafana under subpath.\r\nSeems that the subpath is not populated in the links. This results to the links not working when using Reverse proxy.\n\n### What did you expect to happen?\n\nExpected for the subpath to be populated in the links.\r\n\r\n**example:**\r\nthe alert rule annotation links ( dashboard , panel ) links are as follows:\r\n\r\n- https://{{domain}}/d/a18ef1af1afad0e84dae9155710ec07c_acc\r\n\r\nBut they should also have the subpath populated\r\n\r\n- https://{{domain}}/grafana/d/a18ef1af1afad0e84dae9155710ec07c_acc\r\n\r\n\r\n![Screenshot from 2024-06-10 12-14-08](https://github.com/grafana/grafana/assets/170091073/f286edb9-d39c-447f-80d6-50896a4e6bb1)\r\n\n\n### Did this work before?\n\nDidn't work before.\r\nOnly works when using no reverse proxy.\n\n### How do we reproduce it?\n\n1. Setup grafana with subpath / reverse proxy\r\n2. Create an alert , and link with panel ( Dashboard/panel annotation links )\r\n3. Open the alerts ( https://intragate.ec.europa.eu/cc-grafana-prod/alerting/list)\r\n4. Navigate to the created alert and expand\r\n5. Try to click in one of the links ( Dashboard UID , Panel ID )\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: oss - 10.3.3\r\nOS: Podman  - Rhel 8\r\nBrowser: Chrome\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\nPrometheus","labels":["needs more info","area/alerting","area/backend","triage/needs-confirmation"]},{"id":80224,"title":"Alerting: Templating plus Slack breaks when name for the notification template contain square brackets","body":"### What happened?\n\nI use Grafana Alerting with Slack as notification platform.\r\n\r\nTo increase readability, I create several notification templates. I would like to use the following naming pattern when I add a new template:\r\n\r\n- [Slack] Message Title\r\n- [Slack] Message Text\r\n- [EMail] Subject\r\n- [EMail] Body\r\n\r\nWhen I try to test a Slack contact point with the existing templates, I get an error message:\r\n\r\n```text\r\nlogger=ngalert.notifier.slack notifierUID=*** t=*** level=error msg=\"The request was unsuccessful\" body=\"{\\\"ok\\\":false,\\\"error\\\":\\\"invalid_arguments\\\",\\\"warning\\\":\\\"missing_charset\\\",\\\"response_metadata\\\":{\\\"messages\\\":[\\\"[ERROR] missing required field: channel\\\"],\\\"warnings\\\":[\\\"missing_charset\\\"]}}\" err=invalid_arguments\r\n```\r\n\r\nIf I remove the square brackets from the template names and then test the Slack contact point again, the test message is sent without an error.\r\n\r\nIn the documentation I cannot find any hint that there are character restrictions for template names.\n\n### What did you expect to happen?\n\nI expect that all characters are allowed in the template names. If there are any character restrictions, I expect the documentation to contain appropriate information.\n\n### Did this work before?\n\nI don't know\n\n### How do we reproduce it?\n\nSee \"What happened\"\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.1.1\r\nOS: MacOS Sonoma\r\nBrowser: Chrome\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\n_No response_","labels":["needs more info","area/alerting"]},{"id":77175,"title":"After updating to 10.2.0 suddenly all email alerts are light themes","body":"### What happened?\r\n\r\nI've just updated to Grafana v10.2.0 (895fbafb7a) and all the email alerts I'm getting suddenly are light themed.\r\n\r\nIt was dark themed before, and I cannot see a single setting to set it back to dark.\r\n\r\n### What did you expect to happen?\r\n\r\nTo stay dark themed.\r\n\r\n### Did this work before?\r\n\r\nYes, it was dark.\r\n\r\n### How do we reproduce it?\r\n\r\n1. Upgrade to Grafana v10.2.0 (895fbafb7a), and see that alert mails are light themed.\r\n2.\r\n3.\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nNo\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana:Grafana v10.2.0 (895fbafb7a)\r\nOS: Linux\r\n\r\n\r\n### Grafana platform?\r\n\r\nDocker\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/alerting","triage/needs-confirmation"]},{"id":67819,"title":"Logs: row message copy button does not work","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\n  - clicking the copy button does not copy the text and throws console error \"Uncaught TypeError: Cannot read properties of undefined (reading 'writeText')\"\r\n\r\n**What did you expect to happen**:\r\n\r\n  - clicking the copy button in logs row should copy the text\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n\r\n\u003cimg width=\"488\" alt=\"image\" src=\"https://user-images.githubusercontent.com/21957456/236178086-7772983d-f361-483d-a6e4-ece35d84265b.png\"\u003e\r\n\r\n\r\n**Step 1**:\r\n\r\n- Click copy button button on logs row tooltip button\r\n\r\n**Step 2**:\r\n\r\n- Try to paste the text - it seems like it's not copied to clipboard properly.\r\n\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\n9.5.1\r\n\r\n\r\n### Grafana Platform?\r\n\r\nDocker\r\n\r\n### User's OS?\r\n\r\nOSX\r\n\r\n### User's Browser?\r\n\r\nChromium\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\nLoki\r\n\r\n### Anything else to add?\r\n\r\n\r\nIt seems like there is already a proper copy button component which has fallback for http and older browsers that don't support `window.navigator.clipboard` - `ClipboardButton` in `@grafana/ui`.\r\nI would suggest using it in `LogRowMessage` component, like so:\r\n\r\n`LogRowMessage.tsx:7`\r\n```\r\nimport { IconButton, Tooltip, ClipboardButton } from '@grafana/ui';\r\n```\r\n\r\n`LogRowMessage.tsx:105`\r\n```\r\n              \u003cClipboardButton \r\n                title=\"Copy value to clipboard\"\r\n                fill=\"text\"\r\n                icon=\"copy\"\r\n                variant=\"secondary\"\r\n                size=\"md\"\r\n                getText={() =\u003e restructuredEntry}\r\n              /\u003e\r\n```","labels":["type/bug","datasource/Loki","area/logs"]},{"id":58796,"title":"Timeseries: Boolean units not shown on axis","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nBoolean units (On/Off, Yes/No) show \"NaN\" on Axis.\r\nTrue/False works as expected\r\n\r\nTooltip works fine with all three units.\r\n\r\n![image](https://user-images.githubusercontent.com/8208011/202060383-237d4dfe-5238-4642-a9e8-f88537715548.png)\r\n\r\n**What you expected to happen**:\r\nThe chosen unit should be shown on the axis.\r\n\r\n**Environment**:\r\n- Grafana version: v9.30-beta1\r\n- Data source type \u0026 version: Prometheus\r\n- OS Grafana is installed on: AlmaLinux 8\r\n- User OS \u0026 Browser: Chrome\r\n","labels":["type/bug","type/feature-request","area/panel/timeseries"]},{"id":53372,"title":"Grafana UI: Lazy loading libs in CodeEditor doesn't work in custom panel plugin","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nWhen lazy loading libs in the CodeEditor, the libs don't load/show.\r\n![image](https://user-images.githubusercontent.com/39485579/183366723-f91b486a-2228-4e02-97ec-42f59a4504a2.png)\r\n\r\n**What you expected to happen**:\r\n\r\nLazy loading libs should load the libs.\r\n![image](https://user-images.githubusercontent.com/39485579/183366862-480e7f6b-bf41-4e1e-a177-6fd26e34ac97.png)\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n\r\nRepo: https://github.com/ZuperZee/zuperzee-bug1-panel/tree/51a6eed6cf49b616c1a43fb610b6f578cc68b7df\r\n\r\nAdd the panel plugin\r\nCreate a panel with the added panel plugin in Grafana\r\nType `nice` (niceCar should be suggested) in the CodeEditor option in edit mode\r\n\r\ngo to `src/EditorOption.tsx` and edit the setTimeout timeout to 0\r\nTyping `nice` should show niceCar and niceTruck\r\n\r\n**Anything else we need to know?**:\r\n\r\nSeems like there was a bug (https://github.com/microsoft/monaco-editor/issues/2866) from https://github.com/microsoft/monaco-editor which was fixed in v0.32.0.\r\n\r\n**Environment**:\r\n- Grafana version: v9.0.6\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on: Docker\r\n- User OS \u0026 Browser: Ubuntu 22.04.1\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/plugins","triage/needs-confirmation"]},{"id":57033,"title":"Grafana unable to send alerts on email channels when alert rule passes and firing is true","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nGrafana is  unable to send alerts to email channel. \r\nWhen i use TEST button on Notification Channel, alert is received on said email address.\r\nBut when i reproduce a scenario where alert rule is passed and an alert should fire. It shows that its in Alerting state . But alert Never goes to defined email addresses.\r\n\r\nI checked logs and found following:\r\n\r\n**Logs for case when alert rule is in firing state:**\r\n\r\n`t=2022-10-15T15:16:30+0500 lvl=dbug msg=\"Scheduler: Putting job on to exec queue\" logger=alerting.scheduler name=Alert_Local_Prometheus id=11\r\nt=2022-10-15T15:16:30+0500 lvl=dbug msg=\"Sending query\" logger=tsdb.prometheus start=2022-10-15T10:11:30+0000 end=2022-10-15T10:16:30+0000 step=15s query=avg(prometheus_http_request_duration_seconds_sum/prometheus_http_request_duration_seconds_count)*1000\r\nt=2022-10-15T15:16:30+0500 lvl=dbug msg=\"Job Execution completed\" logger=alerting.engine timeMs=5.985 alertId=11 name=Alert_Local_Prometheus firing=true attemptID=1`\r\n\r\n**Logs for case when i test notification channel:**\r\n\r\n```\r\nt=2022-10-15T15:38:21+0500 lvl=dbug msg=\"Sending notification\" logger=alerting.notifier type=email uid= isDefault=false\r\nt=2022-10-15T15:38:21+0500 lvl=info msg=\"Sending alert notification to\" logger=alerting.notifier.email addresses=[sana_sz91@hotmail.com] singleEmail=true\r\n\r\n```\r\n\r\n\r\n\u003cimg width=\"892\" alt=\"alert1\" src=\"https://user-images.githubusercontent.com/39674269/195982876-c7cbda45-ebc8-431c-bdc4-e886002e3fd8.png\"\u003e\r\n\r\n\r\n\r\n**Testing alert rule thats in firing state gives following details:**\r\n\r\n\r\n\u003cimg width=\"960\" alt=\"alert2_testruleJSON\" src=\"https://user-images.githubusercontent.com/39674269/195982738-7e4089b0-e1ea-4591-b545-27b64d23b296.png\"\u003e\r\n\r\n**Alert is in Alerting State:**\r\n\r\n\u003cimg width=\"939\" alt=\"alert2_testrule\" src=\"https://user-images.githubusercontent.com/39674269/195982772-e7f7c66d-36eb-4022-8439-fc969ea869b2.png\"\u003e\r\n\r\n\r\n**What you expected to happen**:\r\n\r\nSince Email test channel notification is passed, i expect that when alert rule fires, notification should send but thats not case.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nConfigure any valid smtp settings that successfully fires test notification. and then configure the alert on metric\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.1\r\n- Data source type \u0026 version: Prometheus\r\n- OS Grafana is installed on: Windows\r\n- User OS \u0026 Browser: Chrome\r\n- Grafana plugins: Prometheus\r\n- Others:\r\n","labels":["needs more info","area/alerting/notifications","bot/no new info"]},{"id":45253,"title":"\"origin not allowed\" with InfluxDB \"Mixed\" datasources, v3.8.6","body":"**What happened**: \"origin not allowed\" all over the places also with v3.8.6, **when using a `Mixed` InfluxDB datasource**.\r\nPossibly duplicate of some other #45117, #45115\r\n\r\n**Environment**:\r\n- Grafana version: v8.3.6\r\n- Data source type \u0026 version: InfluxDB\r\n- OS Grafana is installed on: Linux\r\n- User OS \u0026 Browser: Ubuntu\r\n","labels":["needs more info","area/configuration"]},{"id":53525,"title":"Transformation wont calculate binary operation with influx source - returning NaN","body":"**What happened**:\r\nWhen trying to use transformation \"Add field from calculation\" with \"Binary operation\" the result for subtraction was \"NaN\" even though values are correct and are not null/empty/undefined etc. \r\n\r\n![image](https://user-images.githubusercontent.com/13632953/183904273-cab659dc-3af5-4dbe-afd6-f38fca6692d5.png)\r\n\r\n**What you expected to happen**:\r\nValue should be calculated correctly \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nI was using influx source which returned:\r\n![image](https://user-images.githubusercontent.com/13632953/183906639-9b688df0-0ef1-499c-9219-4234a54b2a04.png)\r\n\r\n**Anything else we need to know?**:\r\nIt was calculated propertly after doing a hack like so: \r\n1. Create `Outer join` on Time field\r\n2. Create `Organize field` and set names as are (without change) \r\n3. Create `Add Field from calculation` and set binary operator.\r\n4. Rename fields names from step 2. to any other name.\r\n![image](https://user-images.githubusercontent.com/13632953/183907560-1564606a-7545-4d1d-9b21-7ce05f722e85.png)\r\n\r\n\r\n**Environment**:\r\n- Grafana version: v8.5.6 (623255cf2d)\r\n- Data source type \u0026 version: influxdb\r\n- User OS \u0026 Browser: Google Chrome 104.0.5112.79\r\n","labels":["area/transformations","bot/no new info"]},{"id":54409,"title":"Trace to logs, span start and end shift","body":"**What happened**:\r\nUsing Trace from logs feature with a span start and end shift doesn't work.\r\nI use Tempo 1.5 and Grafana 9.1.\r\n\r\n**What you expected to happen**:\r\nUse span start and end shift allows me to jump from trace to logs with a timestamp having the value of start and end shift.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n- Go to Tempo datasource\r\n- Go in Trace to logs section\r\n- Add 5 minutes as span start and end shift\r\n- Go to any trace in Explore menu\r\n- Click on Logs for this span\r\n- The timestamp is really accurate (second) with the same start and end while I expect to be timestamp - 5 minutes as start date and timestamp + 5 minutes as start date.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**: Kubernetes, Helm chart\r\n- Grafana version: 9.1 enterprise\r\n- Data source type \u0026 version: Tempo 1.5\r\n- OS Grafana is installed on: Kubernetes linux (AKS)\r\n- User OS \u0026 Browser: Chrome\r\n- Grafana plugins: N.A","labels":["prio/medium","stale","area/tracing"]},{"id":57202,"title":"Grafana admins cannot add Oauth synced users to Org anymore, the Add button is missing","body":"**What happened**:\r\nGrafana administrators can no longer add new users  synced using Oauth to some Organization since 9.0.x. The button in the UI is missing\r\n\r\n**What you expected to happen**:\r\n1. Sign in to Grafana as a server administrator.\r\n2. Hover your cursor over the Server Admin (shield) icon until a menu appears, and click Users.\r\n3. Click a user.\r\n4. In the Organizations section, click Add user to organization.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Sign in to Grafana as a server administrator.\r\n2. Hover your cursor over the Server Admin (shield) icon until a menu appears, and click Users.\r\n3. Click a user.\r\n4. In the Organizations section, the button Add user to organization is missing.\r\n\r\n**Anything else we need to know?**:\r\nThis [documentation](https://grafana.com/docs/grafana/latest/administration/user-management/server-user-management/add-remove-user-to-org/) now is broken.\r\n\r\n**Environment**:\r\n- Grafana version: 9.1.5\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on: EKS\r\n- User OS \u0026 Browser: Chrome or Firefox, any version.\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/auth/oauth"]},{"id":77790,"title":"Grafana Dashboard : data is not populating in grafana dasboard","body":"### What happened?\n\n| Key | Value |\r\n|--|--|\r\n| Panel | logs @ 10.0.3 (eb8dd72637) |\r\n| Grafana | 10.0.3 (eb8dd72637) // Open Source |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"showTime\": false,\r\n        \"showLabels\": false,\r\n        \"showCommonLabels\": false,\r\n        \"wrapLogMessage\": false,\r\n        \"prettifyLogMessage\": false,\r\n        \"enableLogDetails\": true,\r\n        \"dedupStrategy\": \"none\",\r\n        \"sortOrder\": \"Descending\"\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"grafana\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"snapshot\",\r\n          \"snapshot\": [\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"meta\": {\r\n                  \"typeVersion\": [\r\n                    0,\r\n                    0\r\n                  ],\r\n                  \"custom\": {\r\n                    \"frameType\": \"LabeledTimeValues\",\r\n                    \"lokiQueryStatKey\": \"Summary: total bytes processed\"\r\n                  },\r\n                  \"stats\": [\r\n                    {\r\n                      \"displayName\": \"Summary: bytes processed per second\",\r\n                      \"unit\": \"Bps\",\r\n                      \"value\": 0\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Summary: lines processed per second\",\r\n                      \"value\": 0\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Summary: total bytes processed\",\r\n                      \"unit\": \"decbytes\",\r\n                      \"value\": 0\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Summary: total lines processed\",\r\n                      \"value\": 0\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Summary: exec time\",\r\n                      \"unit\": \"s\",\r\n                      \"value\": 0.038149\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Ingester: total reached\",\r\n                      \"value\": 48\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Ingester: total chunks matched\",\r\n                      \"value\": 0\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Ingester: total batches\",\r\n                      \"value\": 48\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Ingester: total lines sent\",\r\n                      \"value\": 0\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Ingester: head chunk bytes\",\r\n                      \"unit\": \"decbytes\",\r\n                      \"value\": 0\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Ingester: head chunk lines\",\r\n                      \"value\": 0\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Ingester: decompressed bytes\",\r\n                      \"unit\": \"decbytes\",\r\n                      \"value\": 0\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Ingester: decompressed lines\",\r\n                      \"value\": 0\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Ingester: compressed bytes\",\r\n                      \"unit\": \"decbytes\",\r\n                      \"value\": 0\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Ingester: total duplicates\",\r\n                      \"value\": 0\r\n                    }\r\n                  ],\r\n                  \"executedQueryString\": \"Expr: {app=\\\"abc-uat-credit-vas\\\"} |~ `(?i)`\",\r\n                  \"preferredVisualisationType\": \"logs\",\r\n                  \"limit\": 1000,\r\n                  \"searchWords\": [\r\n                    \"(?i)$filter\"\r\n                  ]\r\n                },\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"labels\",\r\n                    \"type\": \"other\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"json.RawMessage\"\r\n                    },\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"Time\",\r\n                    \"type\": \"time\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"time.Time\"\r\n                    },\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"Line\",\r\n                    \"type\": \"string\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"string\"\r\n                    },\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"tsNs\",\r\n                    \"type\": \"string\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"string\"\r\n                    },\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"id\",\r\n                    \"type\": \"string\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"string\"\r\n                    },\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [],\r\n                  [],\r\n                  [],\r\n                  [],\r\n                  []\r\n                ]\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      \"title\": \"Reproduced with embedded data\",\r\n      \"type\": \"logs\"\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003elogs @ 10.0.3 (eb8dd72637)\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003eA[loki]\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003e 1 frames, 5 fields, 0 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e10.0.3 (eb8dd72637) // Open Source\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"title\": \"Original Panel JSON\",\r\n      \"type\": \"text\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 7\r\n      },\r\n      \"options\": {\r\n        \"content\": \"{\\n  \\\"datasource\\\": {\\n    \\\"type\\\": \\\"loki\\\",\\n    \\\"uid\\\": \\\"PCCBBFD0DEF07AB4D\\\"\\n  },\\n  \\\"gridPos\\\": {\\n    \\\"h\\\": 8,\\n    \\\"w\\\": 12,\\n    \\\"x\\\": 0,\\n    \\\"y\\\": 0\\n  },\\n  \\\"id\\\": 1,\\n  \\\"options\\\": {\\n    \\\"showTime\\\": false,\\n    \\\"showLabels\\\": false,\\n    \\\"showCommonLabels\\\": false,\\n    \\\"wrapLogMessage\\\": false,\\n    \\\"prettifyLogMessage\\\": false,\\n    \\\"enableLogDetails\\\": true,\\n    \\\"dedupStrategy\\\": \\\"none\\\",\\n    \\\"sortOrder\\\": \\\"Descending\\\"\\n  },\\n  \\\"targets\\\": [\\n    {\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"loki\\\",\\n        \\\"uid\\\": \\\"PCCBBFD0DEF07AB4D\\\"\\n      },\\n      \\\"editorMode\\\": \\\"builder\\\",\\n      \\\"expr\\\": \\\"{app=\\\\\\\"abc-uat-credit-vas\\\\\\\"} |~ `(?i)$filter`\\\",\\n      \\\"queryType\\\": \\\"range\\\",\\n      \\\"refId\\\": \\\"A\\\"\\n    }\\n  ],\\n  \\\"title\\\": \\\"abc-uat-credit-vas\\\",\\n  \\\"type\\\": \\\"logs\\\"\\n}\",\r\n        \"mode\": \"code\",\r\n        \"code\": {\r\n          \"language\": \"json\",\r\n          \"showLineNumbers\": true,\r\n          \"showMiniMap\": true\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: abc-uat-credit-vas // 2023-11-07 17:33:40\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-logs\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"2023-11-07T11:33:40.011Z\",\r\n    \"to\": \"2023-11-07T12:03:40.011Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\n\n### What did you expect to happen?\n\ngrafana dashboard sho wlatest logs from kubernetes pods\n\n### Did this work before?\n\nYes it worked earlier.\r\nversion : 10.0.3 (eb8dd72637) // Open Source\n\n### How do we reproduce it?\n\n1.\r\n2.\r\n3.\r\n\n\n### Is the bug inside a dashboard panel?\n\nyes\n\n### Environment (with versions)?\n\nGrafana: 10.0.3 (eb8dd72637) // Open Source\r\nOS: Ubuntu . we are using official elm chart for grafan\r\nBrowser: Google chrome\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nLOKI","labels":["datasource/Loki","area/panel/logs","bot/no new info"]},{"id":78878,"title":"Inappropriate status code for calling the dashboard import API with an invalid payload","body":"### What happened?\n\n Calling the import API with an invalid payload – it seems a user error, but gets 500 response code on error. \r\n\r\n| msg      | error | method | path | status code|\r\n| ----------- | ----------- |--------| ----------- | ----------- |\r\n| Failed to save dashboard     | Dashboard input variable: DS_PROMETHEUS missing from import command | POST| /api/dashboards/import| 500|\r\n\r\n\r\n\n\n### What did you expect to happen?\n\nReturn correct status code, not 500.\n\n### Did this work before?\n\nno\n\n### How do we reproduce it?\n\nsee above\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 9.5.13\r\nOS:\r\nBrowser:\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["prio/high","beginner friendly","area/backend"]},{"id":43722,"title":"Dashboard variables' datasource not updated when renaming data source","body":"**What happened**:\r\nWe upgraded from 7.2.1 -\u003e 8.3.3, as part of the cleanup we renamed a couple datasources.  The graph panels were updated to use the renamed datasource however dashboard variables were not updated and require manual intervention to fix.  When loading the dashboard a \"templating\" error is shown indicating that \"Datasource \u003cname\u003e is not found\"\r\n\r\nPossibly related to #1664\r\n\r\n**What you expected to happen**:\r\n\r\nIdeally, when renaming a datasource, the variables associated with the dashboard would also be updated.\r\n\r\nI did not dig far enough into #33817 , #41232 , or #43263 but believe this may have been partially addressed by those.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nUnclear.  I did try renaming the datasource again after manually updating some of the dashboards and those variable names **did** update this time.\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.3 (when rename occurred)\r\n- Data source type \u0026 version: Influx v1.8.3\r\n- OS Grafana is installed on: CentOS 7\r\n- User OS \u0026 Browser: MacOS 11.5.1 w/ Chrome 96.0.4664.55\r\n- Grafana plugins: N/A\r\n","labels":["area/dashboard/templating","area/dashboard","needs investigation","bot/no new info"]},{"id":77285,"title":"Alerting: Alertmanager sends resolved notifications while Grafana alert is still firing","body":"### What happened?\n\nhaving :\r\n- a Grafana alert that is always firing :\r\n`vector(1)` Prometheus query.\r\nwith evaluation group interval at 1m\r\nand `for` at 5m\r\n- a notification policy that forwards all Grafana alerts to an Alertmanager(Mimir)\r\n\r\nI receive an alert notification after ~5 minutes, which is fine, but also a resolved notification 5 minutes after the alert notification, while the alert is still firing.\n\n### What did you expect to happen?\n\nResolved message should only happen if the alert is not firing.\n\n### Did this work before?\n\nNo\n\n### How do we reproduce it?\n\n1. have a notification policy that forwards  Grafana alerts to an Alertmanager\r\n\r\n2. setup a Grafana alert that is always firing :\r\n`vector(1)` Prometheus query.\r\nwith evaluation group interval at 1m\r\nand `for` at 5m\r\n\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: v9.5.7\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["area/alerting","triage/needs-confirmation"]},{"id":78649,"title":"Grafana-backend: Make Run failing on Windows due to BRA","body":"### What happened?\r\n\r\nUnable to build Grafana-backend on windows. See following steps and corresponding terminal outputs:\r\n\r\n```\r\n$ go install github.com/google/wire/cmd/wire@latest\r\ngo: downloading github.com/google/wire v0.5.0\r\ngo: downloading github.com/pmezard/go-difflib v1.0.0\r\ngo: downloading github.com/google/subcommands v1.0.1\r\ngo: downloading golang.org/x/tools v0.0.0-20190422233926-fe54fb35175b\r\n```\r\n\r\n```\r\n$ $GOPATH/bin/wire.exe gen -tags oss ./pkg/server ./pkg/cmd/grafana-cli/runner\r\nwire: github.com/grafana/grafana/pkg/server: wrote C:\\SB\\mm-grafana-ui\\pkg\\server\\wire_gen.go\r\n```\r\n\r\n```\r\n$ go run build.go build\r\nVersion: 10.1.5, Linux Version: 10.1.5, Package Iteration: 1700841246\r\nbuilding binaries build\r\nbuilding grafana ./pkg/cmd/grafana\r\nrm -r ./bin/windows-amd64/grafana.exe\r\nrm -r ./bin/windows-amd64/grafana.exe.md5\r\ngo build -ldflags -w -X main.version=10.1.5 -X main.commit=e9497b96 -X main.buildstamp=1700726600 -X main.buildBranch=ingr_em21_10_dev_temp_grafana_lcm -buildmode=exe -o ./bin/windows-amd64/grafana.exe ./pkg/cmd/grafana\r\ngo: downloading github.com/urfave/cli/v2 v2.25.0\r\ngo: downloading github.com/xrash/smetrics v0.0.0-20201216005158-039620a65673\r\ngo version\r\ngo version go1.20.3 windows/amd64\r\nTargeting windows/amd64\r\nbuilding binaries build\r\nbuilding grafana-server ./pkg/cmd/grafana-server\r\nrm -r ./bin/windows-amd64/grafana-server.exe\r\nrm -r ./bin/windows-amd64/grafana-server.exe.md5\r\ngo build -ldflags -w -X main.version=10.1.5 -X main.commit=e9497b96 -X main.buildstamp=1700726600 -X main.buildBranch=ingr_em21_10_dev_temp_grafana_lcm -buildmode=exe -o ./bin/windows-amd64/grafana-server.exe ./pkg/cmd/grafana-server\r\ngo version\r\ngo version go1.20.3 windows/amd64\r\nTargeting windows/amd64\r\nbuilding binaries build\r\nbuilding grafana-cli ./pkg/cmd/grafana-cli\r\nrm -r ./bin/windows-amd64/grafana-cli.exe\r\nrm -r ./bin/windows-amd64/grafana-cli.exe.md5\r\ngo build -ldflags -w -X main.version=10.1.5 -X main.commit=e9497b96 -X main.buildstamp=1700726600 -X main.buildBranch=ingr_em21_10_dev_temp_grafana_lcm -buildmode=exe -o ./bin/windows-amd64/grafana-cli.exe ./pkg/cmd/grafana-cli\r\ngo version\r\ngo version go1.20.3 windows/amd64\r\nTargeting windows/amd64\r\n```\r\n\r\n```\r\n$ make run\r\nFIND: Parameter format not correct\r\n(re)installing C/bin/bra-v0.0.0-20200517080246-1e3013ecaff8\r\ngo: downloading github.com/BurntSushi/toml v0.3.1\r\ngo: downloading github.com/urfave/cli v1.22.1\r\ngo: downloading github.com/cpuguy83/go-md2man/v2 v2.0.0-20190314233015-f79a8a8ca69d\r\ngo: downloading github.com/russross/blackfriday/v2 v2.0.1\r\ngo: downloading github.com/shurcooL/sanitized_anchor_name v1.0.0\r\nC/bin/bra-v0.0.0-20200517080246-1e3013ecaff8 run\r\nprocess_begin: CreateProcess(NULL, C/bin/bra-v0.0.0-20200517080246-1e3013ecaff8 run, ...) failed.\r\nmake (e=2): The system cannot find the file specified.\r\nmake: *** [run] Error 2\r\n```\r\n\r\n```\r\n$ env GO111MODULE=on go get github.com/unknwon/bra\r\n```\r\n\r\n```\r\n$ make run\r\nFIND: Parameter format not correct\r\n(re)installing C/bin/bra-v0.0.0-20200517080246-1e3013ecaff8\r\nC/bin/bra-v0.0.0-20200517080246-1e3013ecaff8 run\r\nprocess_begin: CreateProcess(NULL, C/bin/bra-v0.0.0-20200517080246-1e3013ecaff8 run, ...) failed.\r\nmake (e=2): The system cannot find the file specified.\r\nmake: *** [run] Error 2\r\n```\r\n\r\nAlso tried the following:\r\n\r\n```\r\n$ env GO111MODULE=on go get -u -v github.com/unknwon/bra\r\ngo: upgraded github.com/BurntSushi/toml v1.2.1 =\u003e v1.3.2\r\ngo: upgraded github.com/cpuguy83/go-md2man/v2 v2.0.2 =\u003e v2.0.3\r\ngo: upgraded github.com/unknwon/log v0.0.0-20150304194804-e617c87089d3 =\u003e v0.0.0-20200308114134-929b1006e34a\r\ngo: upgraded github.com/urfave/cli v1.22.12 =\u003e v1.22.14\r\ngo: upgraded golang.org/x/sys v0.10.0 =\u003e v0.14.0\r\n```\r\n\r\nBut `make run` fails with same error:\r\n```\r\n$ make run\r\nFIND: Parameter format not correct\r\n(re)installing C/bin/bra-v0.0.0-20200517080246-1e3013ecaff8\r\nC/bin/bra-v0.0.0-20200517080246-1e3013ecaff8 run\r\nprocess_begin: CreateProcess(NULL, C/bin/bra-v0.0.0-20200517080246-1e3013ecaff8 run, ...) failed.\r\nmake (e=2): The system cannot find the file specified.\r\nmake: *** [run] Error 2\r\n```\r\n\r\n### Environment\r\n\r\nOS: Windows 10\r\nTerminal: Bash","labels":["needs more info","area/backend","triage/needs-confirmation"]},{"id":61347,"title":"During the building of a linux Docker image using the Dockerfile in the root the file 'ARG GRAFANA_TGZ=\"grafana-latest.linux-x64-musl.tar.gz\" cannot be found","body":"I have an Azure pipeline which uses an Azure agent (specification: ubuntu-latest) to build and push a linux grafana docker image to an Azure container registry. This pipeline worked for an older version of grafana that I cloned around the 15th of November and I had not made any changes to the grafana code that was built.\r\n\r\nAfter I updated to the latest code in the grafana repo (commit f85a948) during the building of the image I now get the following issue\r\n__________________________________________________________________________________________________\r\nStep 38/68 : ARG GRAFANA_TGZ=\"grafana-latest.linux-x64-musl.tar.gz\"\r\n ---\u003e Running in 5d341c1fe41a\r\nRemoving intermediate container 5d341c1fe41a\r\n ---\u003e 60ef4ae29475\r\nStep 39/68 : COPY ${GRAFANA_TGZ} /tmp/grafana.tar.gz\r\nCOPY failed: file not found in build context or excluded by .dockerignore: stat grafana-latest.linux-x64-musl.tar.gz: file does not exist\r\n##[error]COPY failed: file not found in build context or excluded by .dockerignore: stat grafana-latest.linux-x64-musl.tar.gz: file does not exist\r\n##[error]The process '/usr/bin/docker' failed with exit code 1\r\nFinishing: Build and push an image to container registry\r\n__________________________________________________________________________________________________\r\nThe file \"grafana-latest.linux-x64-musl.tar.gz\" doesn't exist in the root of the repository.\r\n\r\nI have posted in the forums (https://community.grafana.com/t/cannot-build-docker-image-using-commit-id-4de0149/79504) but thought I'd also create it as an issue.","labels":["type/build-packaging","area/docker","triage/needs-confirmation"]},{"id":79176,"title":"Panel issues starting with iOS 17.2 (mobile devices)","body":"### What happened?\r\n\r\nStarting with iOS 17.2, dashboards are running into issues. Some panels are not displayed until the user start scrolling. \r\n\r\n### What did you expect to happen?\r\n\r\nAll panels are visible immediately after loading a dashboard on mobiles.\r\n\r\n### Did this work before?\r\n\r\nYES, issue is starting with iOS 17.2. Reproduced on Safari. Issue also reproducible on browsers which are using Apples WebKit.\r\n\r\n### How do we reproduce it?\r\n\r\n1. update iOS to 17.2 RC (public release next week)\r\n2. open a dashboard\r\n3. first panels are missing the most of the time\r\n\r\n\r\nhttps://github.com/grafana/grafana/assets/14274103/388e8198-f050-45ae-a7d5-ef07cdbac306\r\n\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.2.2\r\nOS: Ubuntu Focal\r\nBrowser: Safari\r\n\r\n\r\n### Grafana platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### Datasource(s)?\r\n\r\nInfluxDB","labels":["area/dashboard","area/panel/stat","triage/needs-confirmation"]},{"id":70397,"title":"Grafana 10.x: Alert list panel only showing alerts after clicking on \"Alert Rules\" view","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\nAlert list panel on dashboards is not showing configured alerts (even if I enable all alert state filters).\r\nAfter clicking to \"Home - Alerting - Alert Rules\" and reopening the dashboard all alerts will be shown.\r\nAlternatively I can click to another dashboard where alerts are visible in an Alert list pannel.\r\n\r\n**What did you expect to happen**:\r\n\r\nAlerts should always be shown in the panel (as configured)\r\n\r\n1) Opening the dashboard the first time:\r\n![SCR-20230620-qyrz](https://github.com/grafana/grafana/assets/14274103/e1af2909-0ca6-4b87-9a44-3ae9c937fc1b)\r\n\r\n2) clicking to Alert rules\r\n![SCR-20230620-qyyl](https://github.com/grafana/grafana/assets/14274103/f301ec85-229f-4da4-a954-29f14d67281f)\r\n\r\n3) reopen the dashboard after clicking Alert rules:\r\n![image](https://github.com/grafana/grafana/assets/14274103/06ce2f46-5fda-4adb-a33d-08413f756fd7)\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\n- Open Grafana and open a dashboard with configured \"Alert list panel\"\r\n\r\n**Step 2**:\r\n\r\n- No alerts are visible\r\n\r\n**Step 3**:\r\n\r\n- Click to \"Home - Alerting - Alert Rules\" and back to the dashboard\r\n- Alternatively I can click to another dashboard where the alerts are visible.\r\n\r\n**Step 4**:\r\n\r\n- All alerts are visible afterwards.\r\n\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\nv10.0.0 (81d85ce802)\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\nPanel config:\r\n\r\n{\r\n  \"datasource\": {\r\n    \"type\": \"datasource\",\r\n    \"uid\": \"grafana\"\r\n  },\r\n  \"gridPos\": {\r\n    \"h\": 10,\r\n    \"w\": 12,\r\n    \"x\": 0,\r\n    \"y\": 56\r\n  },\r\n  \"id\": 18,\r\n  \"options\": {\r\n    \"viewMode\": \"list\",\r\n    \"groupMode\": \"default\",\r\n    \"groupBy\": [],\r\n    \"maxItems\": 10,\r\n    \"sortOrder\": 3,\r\n    \"dashboardAlerts\": true,\r\n    \"alertName\": \"\",\r\n    \"alertInstanceLabelFilter\": \"\",\r\n    \"stateFilter\": {\r\n      \"firing\": true,\r\n      \"pending\": true,\r\n      \"noData\": false,\r\n      \"normal\": true,\r\n      \"error\": true,\r\n      \"alerting\": true,\r\n      \"execution_error\": true,\r\n      \"no_data\": true,\r\n      \"ok\": false,\r\n      \"paused\": true\r\n    },\r\n    \"dashboardTitle\": \"\",\r\n    \"folder\": \"\",\r\n    \"showOptions\": \"current\",\r\n    \"tags\": []\r\n  },\r\n  \"pluginVersion\": \"8.5.3\",\r\n  \"title\": \"POOL ÜBERWACHUNG / ALARME\",\r\n  \"type\": \"alertlist\"\r\n}\r\n\r\n### Grafana Platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### User's OS?\r\n\r\nUbuntu 20.04 LTS\r\n\r\n### User's Browser?\r\n\r\nSafari, Chrome\r\n\r\n### Is this a Regression?\r\n\r\nYes\r\n\r\n### Are Datasources involved?\r\n\r\nInfluxDB\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["area/panel/alertlist","triage/needs-confirmation"]},{"id":60956,"title":"Missing begin/end on 'step after' graphs","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nAssume a graph with Graph Style \u003e Line Interpolation 'Step After'.\r\n\r\nThe graph only shows from the first point _in range_ to the last point _in range_. Nothing is shown between the start of the range and the first point. Likewise, nothing is shown between the last point and the end of the range.\r\n\r\n**What you expected to happen**:\r\n\r\nA 'Step After' style graph is typically used to show the current value of an entity. As long as the value does not change it stays the same. At the start of the time range of the graph there may not be a data point for this entity but nevertheless if there were data points before the time range, it does have a valid value.\r\n\r\nLikewise, after the last data point the value should persist until the end of the range, or the current time, whichever comes first.\r\n\r\n![scrot20230104133802](https://user-images.githubusercontent.com/1118804/210556739-cc1c50f5-f2b1-46b5-b91e-b651954d7558.png)\r\n\r\nOn the left side, the first data point shown is 08:00,10. The value before 08:00 is not shown.\r\n\r\nOn the right side, the last data point shown is 12:00,50.  The value at 13:00 (=current time) is still 50 but not shown.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nI used a Step After graph with this simple CSV:\r\n````\r\ntime,value\r\n2023-01-04 00:00:00,5\r\n2023-01-04 08:00:00,10\r\n2023-01-04 09:00:00,20\r\n2023-01-04 10:00:00,30\r\n2023-01-04 11:00:00,40\r\n2023-01-04 12:00:00,50\r\n````\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.9\r\n- Data source type \u0026 version: N/A (in the example, CSV, manually input)\r\n- OS Grafana is installed on: Fedora 37\r\n- User OS \u0026 Browser: Fedora 37, Firefox 108\r\n- Grafana plugins: N/A\r\n- Others: N/A\r\n","labels":["area/panel/timeseries","kind/enhancement"]},{"id":64321,"title":"Unable to re-add alerts generated from export option using configmap ","body":"Unable to create alerts as configmap when we use exported /provisioned yaml configuration from export option (in grafana UI) 9.4.2 grafana version","labels":["type/question","area/alerting","area/provisioning"]},{"id":54048,"title":"Grafana 9.1.0 shows dashboard folders as \"open\" instead of \"closed\"","body":"In Grafana 9.0.7 and earlier, when I browse dashboards, the folder list is shown closed, that is, without showing the individual dashboards in the folder.  Like this:\r\n\r\n![grafana-closed-folders](https://user-images.githubusercontent.com/14140294/185955222-9db0dd17-0671-4111-b115-7584697dfc2b.png)\r\n\r\nbut in Grafana 9.10, the dashboard list is always open, showing not just the folder names, but also all the individual dashboards in the folders.  Like this:\r\n\r\n![grafana-open-folders](https://user-images.githubusercontent.com/14140294/185955614-72f0eb2c-9543-4b60-88e9-5d8434348dc9.png)\r\n\r\nSince we have _many_ folders and dashboards, this makes the list a lot more difficult to navigate.  Is it possible to restore the previous behavior of showing the folder list as closed?\r\n\r\nOne fact that may be relevant:  We use the Grafana Operator to manage our Grafana instance, and the Operator uses the Grafana dashboard API to load the dashboards into Grafana.  Could the use of the API be triggering the different UI state?","labels":["needs more info","area/dashboard/folders","area/frontend"]},{"id":48942,"title":"Annotation disappears on Zoom In","body":"Hi, \r\n\r\n**The issue**:\r\nI added some annotations that I store in a Postgresql database to my time series graph.\r\n\r\nWhenever I zoom into it the annotation disappears. I think the annotation disappears once the time resolution on the time-axis falls below one hour.\r\n![annotation_disappears](https://user-images.githubusercontent.com/9096348/168105841-200cfbe7-21a4-45aa-9281-ae336ffe12d3.gif)\r\n\r\n**I expect**:\r\nthe annotation to stay.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nSet up a postgresql db pull your annotation from it.\r\n\r\n**Anything else we need to know?**:\r\nI do use all 4 possible return values for the annotation (time start, time end, comment, flags)\r\n\r\n**Environment**:\r\n- Grafana version: Grafana CLI version 8.2.5\r\n- Data source type \u0026 version:  (PostgreSQL) 12.7\r\n- OS Grafana is installed on: Linux eaw-snw1 4.15.0-176-generic  Tue Mar 29 17:40:04 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux (Ubuntu 18.04.6 LTS)\r\n- User OS \u0026 Browser: Manjaro, Firefox\r\n- Grafana plugins: \r\n  - frser-sqlite-datasource @ 2.1.1\r\n  - grafana-worldmap-panel @ 0.3.2\r\n  - mtanda-histogram-panel @ 0.1.7\r\n  - ryantxu-ajax-panel @ 0.0.7-dev\r\n\r\n","labels":["needs more info","area/annotations","bot/no new info"]},{"id":69431,"title":"After restarting my grafana pod, my user's permissions in dashboards disappear.","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\n  - After restarting my grafana pod, my user's permissions in dashboards disappear. In my circumstance, I can only find this kind of situation in k8s dashboards like the following ones.Besides, permissions won't go away in my loki dashboard or node-exporter dashboard.\r\n![image](https://github.com/grafana/grafana/assets/120615592/6ddf219b-1127-4843-ae54-15bfb92b61ab)\r\n\r\n\r\n**What did you expect to happen**:\r\n\r\n  - I hope the permissions won't disappear after restarting grafana pod.\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\nThis is one of my k8s dashboard json file: Kubernetes / Compute Resources / Namespace (Pods)\r\n[k8s dashboard.txt](https://github.com/grafana/grafana/files/11633334/k8s.dashboard.txt)\r\n\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\nGrafana v9.3.6(978237e7cb)","labels":["area/dashboard","area/permissions","triage/needs-confirmation"]},{"id":86088,"title":"incorrect redirect when after creating if a new org in grafana","body":"### What happened?\n\nafter creating a new org and switch to a new org and from new back to the previous org i get this error in browser\r\n\r\n\u003cimg width=\"1727\" alt=\"Screenshot at Apr 13 15-24-29\" src=\"https://github.com/grafana/grafana/assets/82488489/98ad3d6e-35ef-4ed4-ac17-e9f27d2f3aa5\"\u003e\r\n\r\ni don`t understand why i get incorrect redirect to 3000 port but other features works correct\r\n\n\n### What did you expect to happen?\n\ncorrect switch between orgs\n\n### Did this work before?\n\nno\n\n### How do we reproduce it?\n\n1. create a new org \r\n2. switch to a new org\r\n3. switch back to previous org \r\n\n\n### Is the bug inside a dashboard panel?\n\nno\n\n### Environment (with versions)?\n\nGrafana: docker.io/grafana/grafana:10.4.0\r\nOS: Ubuntu 22.04.3 LTS (kubernetes workers)\r\nBrowser: google\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\n_No response_","labels":["area/auth","area/auth/authproxy","triage/needs-confirmation"]},{"id":72642,"title":"Geomap: Tooltip not working for \"route\"","body":"### What happened?\r\n\r\nTooltip not working for \"route\", \"markers\" work fine.\r\n\r\n### What did you expect to happen?\r\n\r\ntooltip to pop up like it does for \"markers\"\r\n\r\n### Did this work before?\r\n\r\nno\r\n\r\n### How do we reproduce it?\r\n\r\ncheck \"Display tooltip\"\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: Grafana v9.5.7 (d2bfe3cc0b)\r\nOS: RHEL 8\r\nBrowser: Chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### Datasource(s)?\r\n\r\nGeomap","labels":["area/panel/geomap"]},{"id":79773,"title":"grafana-server segfaults because the stack used by Cgo is too small","body":"### What happened?\n\ngrafana-server frequently segfaults and gets restarted by systemd, but without anything useful in the grafana logs (even with the log level raised to debug). After some (insane) investigation by a co-worker they determined that the segfault always occurrs while calling into sqlite code. The segfault occurs because the C call stack is too deep and goes past the memory allocated for the stack.\r\n\r\nDespite the system rlimit for stacks being 8MB, grafana-server thinks that the C stack size is 128K because it's built against musl. musl doesn't query the system for the stack size as per https://wiki.musl-libc.org/functional-differences-from-glibc.html#Thread-stack-size. 128K is too small for what grafana is doing.\r\n\r\nMy co-worker tried to use https://github.com/yaegashi/muslstack to patch the stack size, but the musl that grafana-server is built against appears to be too old and doesn't use the value from the PT_GNU_STACK header. Instead they used the following to patch the binary:\r\n\r\n```\r\ngdb --write /usr/share/grafana/bin/grafana -batch -ex \"set __default_stacksize = 8388608\"\r\n```\r\n\r\ngrafana-server now runs reliably. We haven't experienced a segfault in the last 12 hours, where previously it would often crash after a couple of http requests from certain users in our org.\r\n\n\n### What did you expect to happen?\n\ngrafana-server shouldn't segfault.\n\n### Did this work before?\n\nProbably not, but this is our first time with this combination of packages and operating system so we don't know.\r\n\r\nPreviously we were using our own builds of Grafana on Illumos and OpenBSD, which don't use musl.\n\n### How do we reproduce it?\n\nHard to say.\r\n\r\nOur grafana is set up behind nginx with `auth.proxy` for authentication. Everything else is largely defaults otherwise. The problem mostly occurs with Viewers looking at a dashboard backed by a Clickhouse datasource.\n\n### Is the bug inside a dashboard panel?\n\nNo\n\n### Environment (with versions)?\n\nGrafana: 10.2.2 and 10.2.3\r\nOS: Ubuntu 22.04.1 LTS on an LX branded zone on Triton Datacenter (https://www.tritondatacenter.com/)\r\nBrowser: Firefox and Chrome, but I don't think it matters\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\n_No response_","labels":["area/backend","triage/needs-confirmation"]},{"id":53198,"title":"Dashboards: \"Refresh live dashboards\" conflicts with panel-level time offsets","body":"**What happened**:\r\nTime period for this query is set to 7 days. Panel shows correct time period when Grafana first starts then alternates between the time period selected in the query controls, and the time period selected in the panel time range controls.\r\n\r\n**What you expected to happen**:\r\nTime period displayed should be as configured for the query and not the panel\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate panel with query over time period of 7 days.\r\n\r\n**Anything else we need to know?**:\r\nSystem comprises 1x dashboard of ten panels, panel time series are mix of past year, past month, instantaneous. Sample time is 30 seconds.\r\n\r\n**Environment**:\r\n- Grafana version: 8.5.4\r\n- Data source type \u0026 version: Influxdb 2.1.1\r\n- OS Grafana is installed on: Windows 10\r\n- User OS \u0026 Browser: Windows 10\r\n- Grafana plugins: None\r\n- Others:\r\n\r\ngif of observed behaviour. Note that it starts with the incorrect time period, then changes to the correct one.\r\n\r\n![GIF-2022-07-26-16-56-56](https://user-images.githubusercontent.com/82242000/181054831-3a179797-9318-469e-b8e0-382326c8d736.gif)\r\n[query - env.txt](https://github.com/grafana/grafana/files/9250059/query.-.env.txt)\r\n\r\n","labels":["type/docs","area/dashboard","needs investigation","stale","timepicker","triage/needs-confirmation","migrate/status-new-issues"]},{"id":72431,"title":"Explore: Long span/resource name labels in TraceQL search are not handled properly in UI","body":"### What happened?\n\nAfter adding custom OTEL resources to new Search form\r\n\r\n![image](https://github.com/grafana/grafana/assets/661992/0bef6489-428b-4f94-9a6d-4027283b8a28)\r\n\r\nLong names break UI flow and make the form hard to read\r\n\r\n![image](https://github.com/grafana/grafana/assets/661992/39f61859-04fe-4a8c-a544-92ba6a6b1910)\r\n\n\n### What did you expect to happen?\n\nEverything to be clear and readable\n\n### Did this work before?\n\nN/A\n\n### How do we reproduce it?\n\nSee 'What happened'\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: Grafana v10.2.0-128316pre (b019ef9a89)\r\nOS: Linux\r\nBrowser: Google Chrome\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["type/bug","type/ux","prio/low","area/explore","stale","triage/needs-confirmation"]},{"id":63420,"title":"Changing default CloudWatch endpoint raises exception","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI tried changing the CloudWatch endpoint in order to use a region specific one.\r\n\r\n**What you expected to happen**:\r\nIt'll work and the query will work.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nInstead of using the default, just type in a custom endpoint, either the global or region specific one.\r\n\r\n**Anything else we need to know?**:\r\nThe error message for both `https://monitoring.amazonaws.com` and `https://monitoring.eu-west-1.amazonaws.com` endpoints is:\r\n`1. Successfully queried the CloudWatch metrics API. 2. CloudWatch logs query failed: SerializationError: failed to unmarshal response error status code: 404, request id: c1fd0x11-a1e3-4129-b4de-20b52a7081da caused by: UnmarshalError: failed decoding error message 00000000 3c 55 6e 6b 6e 6f 77 6e 4f 70 65 72 61 74 69 6f |\u003cUnknownOperatio| 00000010 6e 45 78 63 65 70 74 69 6f 6e 2f 3e 0a |nException/\u003e.| caused by: invalid character '\u003c' looking for beginning of value`\r\n\r\nThe error message for `https://monitoring.amazonaws.com` is:\r\n`1. Successfully queried the CloudWatch metrics API. 2. CloudWatch logs query failed: SerializationError: failed to unmarshal response error status code: 404, request id: 99bb5x11-2fa7-4d74-b31b-3bf9c6aea37c caused by: UnmarshalError: failed decoding error message 00000000 3c 55 6e 6b 6e 6f 77 6e 4f 70 65 72 61 74 69 6f |\u003cUnknownOperatio| 00000010 6e 45 78 63 65 70 74 69 6f 6e 2f 3e 0a |nException/\u003e.| caused by: invalid character '\u003c' looking for beginning of value`\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.6\r\n- Data source type \u0026 version: 5.0.0\r\n- OS Grafana is installed on: Docker on Amazon Linux 2\r\n- User OS \u0026 Browser: Brave/Firefox\r\n- Grafana plugins: Irrelevant\r\n- Others: WebM Attached\r\n[input_v0.webm](https://user-images.githubusercontent.com/406826/219948430-f2587ee1-1888-49b6-a8be-dfd7da6ece62.webm)\r\n\r\n\r\n@LetsCreatProjects\r\n@guy-kimchi","labels":["area/backend/api","datasource/CloudWatch"]},{"id":54300,"title":"Cannot load multiline value as environment variable in datasources","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI can't add mulitiline values as environment variable. I want to add private key as variable and when I'm checking datasource status I got error. I want to do it with Google Cloud Monitoring. I have environment variables as secret, one line values works correctly. Working config:\r\n```\r\ndatasources:\r\n  datasources.yaml:\r\n    apiVersion: 1\r\n    datasources:\r\n      - name: prometheus\r\n        type: prometheus\r\n        url: http://prometheus-operated:9090/\r\n        access: proxy\r\n        isDefault: true\r\n      - name: \"Google Cloud Monitoring\"\r\n        type: stackdriver\r\n        access: proxy\r\n        jsonData:\r\n          tokenUri: \"https://oauth2.googleapis.com/token\"\r\n          clientEmail: ${grafana_cloud_monitoring_email}\r\n          authenticationType: \"jwt\"\r\n          defaultProject: ${grafana_cloud_monitoring_project}\r\n        secureJsonData:\r\n          privateKey: |\r\n            -----BEGIN PRIVATE KEY-----\r\n            key\r\n            key\r\n            -----END PRIVATE KEY-----\r\n```\r\nNot working config\r\n```\r\ndatasources:\r\n  datasources.yaml:\r\n    apiVersion: 1\r\n    datasources:\r\n      - name: prometheus\r\n        type: prometheus\r\n        url: http://prometheus-operated:9090/\r\n        access: proxy\r\n        isDefault: true\r\n      - name: \"Google Cloud Monitoring\"\r\n        type: stackdriver\r\n        access: proxy\r\n        jsonData:\r\n          tokenUri: \"https://oauth2.googleapis.com/token\"\r\n          clientEmail: ${grafana_cloud_monitoring_email}\r\n          authenticationType: \"jwt\"\r\n          defaultProject: ${grafana_cloud_monitoring_project}\r\n        secureJsonData:\r\n          privateKey: ${grafana_cloud_monitoring_private_key}\r\n```\r\nI tried also \r\n```\r\n        secureJsonData:\r\n          privateKey: | \r\n             ${grafana_cloud_monitoring_private_key}\r\n```\r\nWhen i decode secret it is as\r\n ```        \r\n            -----BEGIN PRIVATE KEY-----\r\n            key\r\n            key\r\n            -----END PRIVATE KEY-----\r\n```\r\n**What you expected to happen**:\r\n\r\nEnv variable should be use same as one line variables.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nTry to add multiline value as variable.\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.5.0\r\n- Data source type \u0026 version: Google Cloud Monitoring\r\n- OS Grafana is installed on: k8s v1.23\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["needs more info","area/backend","area/provisioning"]},{"id":61317,"title":"\"Create and manage alerting resources using file provisioning\" doesn't check out","body":"**I'm trying to follow the documentation on \"Provision alert rules\" from here without success:**\r\nhttps://grafana.com/docs/grafana/v9.3/alerting/set-up/provision-alerting-resources/file-provisioning/\r\n\r\n**Following step 1, I manually created an alert rule (and contact points,...):**\r\n![image](https://user-images.githubusercontent.com/6381927/211873216-3781ea6c-85eb-499c-b7b0-bce3d1f2e207.png)\r\n![image](https://user-images.githubusercontent.com/6381927/211871036-123029ac-3f13-4b00-8ed9-8cfed578ff6a.png)\r\n\r\n**Step 2 says \"Use the [Alerting provisioning API](https://grafana.com/docs/grafana/latest/developers/http_api/alerting/#get-alerts) to extract the alert rule.\":**\r\n![image](https://user-images.githubusercontent.com/6381927/211873382-8f47ac64-5e74-4bba-b31b-f698807a6f11.png)\r\n\r\n**Which leads to the page \"Alerting API\":**\r\nhttps://grafana.com/docs/grafana/latest/developers/http_api/alerting/#get-alerts\r\n\r\n**For some reason this page states that \"This topic is relevant for the legacy dashboard alerts only.\".. ok, weird... step 2 above sent me here to \"extract the alert rule\" that I created in step 1:**\r\n![image](https://user-images.githubusercontent.com/6381927/211870410-5b4f8b00-9a4e-4a88-9471-609d0f9fa4d0.png)\r\n\r\n**What happened**:\r\n\r\nProceeding to call GET /api/alerts anyway, all I get is an empty list and my created alert rule doesn't show up:\r\n![image](https://user-images.githubusercontent.com/6381927/211871217-145cb098-31d4-4b21-be10-14540ff57627.png)\r\n\r\n**What you expected to happen**:\r\n\r\nAccording to step 3 from the documentation I should be able to \"Copy the contents into a YAML or JSON configuration file in the default provisioning directory\"... but that's not going to work with an empty list.\r\n\r\n**What more I tried**:\r\n\r\nI also tried to retrieve data from the following APIs (which seem to be newer / non-legacy):\r\n\r\n* /api/v1/provisioning/contact-points\r\n* /api/v1/provisioning/alert-rules\r\n* /api/v1/provisioning/policies\r\n\r\n... then I continued at step 3 and copied the contents into the provisioning directory. But this results in errors when starting grafana:\r\n\r\n```\r\nFailed to start grafana. error: failure to parse file my-contact-points.json: yaml: unmarshal errors:\r\n  line 1: cannot unmarshal !!seq into alerting.AlertingFileV1\r\nfailure to parse file my-contact-points.json: yaml: unmarshal errors:\r\n  line 1: cannot unmarshal !!seq into alerting.AlertingFileV1\r\n```\r\n","labels":["type/docs","area/alerting","area/provisioning"]},{"id":84422,"title":"Variable in \"field from calculation\"","body":"### What happened?\r\n\r\n\r\nHey, I have a problem with performing binary operations with two variables. The operation executes successfully, but after refreshing the dashboard, it disappears because a new variable is created. Is there any way to bypass this?\r\n![image](https://github.com/grafana/grafana/assets/154582387/01dc2b54-c5aa-45ac-8ab1-f520eeea62b4)\r\n![Screenshot from 2024-03-14 08-05-06](https://github.com/grafana/grafana/assets/154582387/69bf0ff4-a2b3-4136-bc36-1fb250be9aa3)\r\n\r\nmy query A:\r\n\r\nfrom(bucket: \"search_jmeter_new_api\")\r\n  |\u003e range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n  |\u003e filter(fn: (r) =\u003e r[\"_field\"] == \"avg\" or r[\"_field\"] == \"count\" or r[\"_field\"] == \"error\" or r[\"_field\"] == \"max\" or r[\"_field\"] == \"min\")\r\n  |\u003e filter(fn: (r) =\u003e r[\"symbol\"] == \"TOTAL\")\r\n\r\n        |\u003e filter(fn: (r) =\u003e  r[\"number\"] == \"2.171.0_B_466_2024-03-06\")\r\n  |\u003e group()\r\n  |\u003e sort(columns: [\"_time\"], desc: true)\r\n  |\u003e pivot(rowKey:[\"number\",\"_measurement\"], columnKey: [\"_field\"], valueColumn: \"_value\")\r\n\r\nmy query B:\r\n\r\nfrom(bucket: \"search_jmeter_new_api\")\r\n  |\u003e range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n  |\u003e filter(fn: (r) =\u003e r[\"_field\"] == \"avg\" or r[\"_field\"] == \"count\" or r[\"_field\"] == \"error\" or r[\"_field\"] == \"max\" or r[\"_field\"] == \"min\")\r\n  |\u003e filter(fn: (r) =\u003e r[\"symbol\"] == \"TOTAL\")\r\n\r\n        |\u003e filter(fn: (r) =\u003e  r[\"number\"] == \"2.171.0_B_466_2024-03-06\")\r\n  |\u003e group()\r\n  |\u003e sort(columns: [\"_time\"], desc: true)\r\n  |\u003e pivot(rowKey:[\"number\",\"_measurement\"], columnKey: [\"_field\"], valueColumn: \"_value\")\r\n  |\u003e rename(columns:  {count: \"count_2\", min: \"min_2\", max: \"max_2\", avg: \"avg_2\", error: \"error_2\"})\r\n\r\n![image](https://github.com/grafana/grafana/assets/154582387/93f68f6f-b484-4ca9-8f0d-d28b1ea02397)\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nMake it not disappear because I can't display variables.\r\n\r\n### Did this work before?\r\n\r\nIt was working on grafana 7.4 \r\n\r\n### How do we reproduce it?\r\n\r\n1.\r\n2.\r\n3.\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 9.4.7\r\nOS: Ubuntu 22\r\nBrowser: Chorme\r\n\r\n\r\n### Grafana platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["needs more info","area/transformations"]},{"id":54753,"title":"Dashboard is frozen - no recent changes","body":"When I try to load my Grafana dashboard , it sometimes freezes and the page becomes unresponsive. I can’t click anything. Only a couple panels show data before it freezes, and the rest of the panels are stuck with the rotating arrows.\r\nI have not changed anything on the dashboard recently. My browser is version 86.0.4240.197 built on raspbian , running on Raspbian 10 (32 bit).\r\nI have using server as raspberry pi 3 model | B+.\r\nHow do I fix this? How do I determine what is causing the problem? I opened Chrome dev tools and don’t see any errors in the console. Is there a log somewhere?\r\nI only have the Stat Panel and DataTables plugins installed. I am using version 7.0.1 of Grafana.\r\nAny ideas?\r\nThanks.","labels":["area/dashboard","bot/no new info"]},{"id":49763,"title":"XY chart crashes when there is one data point","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWhen there is only one data point pair, the XY chart crashes.\r\nIn the gif below, I choose two random walk queries and filter out other data points except one pair. Then choose XY chart and the page crashed.\r\n![XY chart crash - random walk](https://user-images.githubusercontent.com/63325084/170801100-90cfb48a-e4ca-4dc3-bbd9-e397246cb954.gif)\r\n\r\nQuery results from the inspect drawer (data tab \u0026 query inspector)\r\nSince I used `Random Walk` as the datasource, I cannot recreate the exact same data but the query results in the .gif should be:\r\ntime                                   B-series         A-seris\r\n2022-05-27 10:10:36         49.5               4.59\r\n\r\nPanel settings can be extracted in the panel inspect drawer JSON tab\r\n`\"fieldConfig\": {\r\n    \"defaults\": {\r\n      \"custom\": {\r\n        \"point\": \"auto\",\r\n        \"pointSize\": {\r\n          \"fixed\": 5\r\n        },\r\n        \"line\": \"none\",\r\n        \"lineWidth\": 1,\r\n        \"axisPlacement\": \"auto\",\r\n        \"axisLabel\": \"\",\r\n        \"scaleDistribution\": {\r\n          \"type\": \"linear\"\r\n        },\r\n        \"hideFrom\": {\r\n          \"tooltip\": false,\r\n          \"viz\": false,\r\n          \"legend\": false\r\n        }\r\n      },\r\n      \"color\": {\r\n        \"mode\": \"palette-classic\"\r\n      },\r\n      \"mappings\": [],\r\n      \"thresholds\": {\r\n        \"mode\": \"absolute\",\r\n        \"steps\": [\r\n          {\r\n            \"color\": \"green\",\r\n            \"value\": null\r\n          },\r\n          {\r\n            \"color\": \"red\",\r\n            \"value\": 80\r\n          }\r\n        ]\r\n      }\r\n    },`\r\n\r\n**What you expected to happen**:\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version:\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/bug","stale","area/panel/xychart"]},{"id":60638,"title":"Minified React error #31 when trying to open Grafana","body":"**What happened**:\r\nMinified React error #31\r\nafter tryed to import an dashboard, when iam trying to enter my grafana with chrome\r\n\r\n![image](https://user-images.githubusercontent.com/54017453/208936504-b7110b28-5ba3-4cce-9b14-67e7db3c6d2e.png)\r\n\r\n\r\n**What you expected to happen**:\r\nThat i´t work\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nopen my grafana with chrome\r\n\r\n**Anything else we need to know?**:\r\nWith egde it works fine\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.1\r\n- Data source type \u0026 version: InfluxDB (1.8)  and Prometheus (2.41.4)\r\n- OS Grafana is installed on: Docker (Raspberry Pi 3)\r\n- User OS \u0026 Browser: Chrome -\u003e Fail; Edge -\u003e Work's\r\n- Grafana plugins: None\r\n- Others: --\r\n","labels":["needs more info","area/dashboard/import","area/docker"]},{"id":45813,"title":"Geomap Legend Doesnt Work","body":"**What happened**: I couldn't manage to get a lenged for geomap panel.\r\n\r\n**What you expected to happen**: I expect too see a legend.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: \r\n- Create a geomap with latitudes and longitudes / markers.\r\n- enable \"Show Legend\" under Data Layer section.\r\n- you'll get no legend.\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.1\r\n- Data source type \u0026 version: Postgres\r\n- OS Grafana is installed on: official docker image, grafana/grafana:latest\r\n- Grafana plugins: GEOMAP\r\n\r\n","labels":["area/panel/geomap"]},{"id":48922,"title":"grafana8.0.0+druid plugin: The same numeric value in the pie chart shows the same color","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: When I use SQL to get a list of values from Druid that contain the same values, I get two partitions with the same name and display color. \r\n![_20220512112549](https://user-images.githubusercontent.com/41045949/167987169-1c238550-8cc7-423f-a08f-9de63d6af57a.jpg)\r\n\r\nLooking at the data I got, they actually had different names\r\n![20220512112956](https://user-images.githubusercontent.com/41045949/167987234-bcbaa49c-e6a3-4c75-b208-b1d88a567b65.jpg)\r\n\r\n**What you expected to happen**: Grafana creates mappings between different values and versions, and a numeric value corresponds to only one mapping.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: Create a form similar to mine, and some of the values in the table are the same\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: grafana 8.0.0\r\n- Data source type \u0026 version: Druid \r\n- OS Grafana is installed on: CentOS7\r\n- User OS \u0026 Browser: Windows10 \u0026 chrome\r\n- Grafana plugins: grafadruid v1.2.0\r\n- Others:\r\n","labels":["needs more info","bot/no new info","area/panel/piechart"]},{"id":77859,"title":"UI: Make possible to disable animations and css filters","body":"### What happened?\r\n\r\nWhen using Grafana 10.0.1 and 10.2.0, together with VNC to VM, some operations are super slow and hog a lot of vnc server to vnc client bandwidth, especially at higher resolutions.\r\n\r\nThis problem was not present before in Grafana 9.x, but Grafana 10.x add some extra animations and animated css filter behind few menus, which cause massive amount of screen redraw every frame.\r\n\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nSmooth operations.\r\n\r\n\r\n### Did this work before?\r\n\r\nYes.\r\n\r\n### How do we reproduce it?\r\n\r\n1. Run Grafana 10.x\r\n2. Run VM, i.e. Fedora, and run desktop under Xvncserver\r\n3. Connect, with high resolution screen\r\n4. Maximise browser (Firefox, Chrome)\r\n5. After login, Click either hamburger menu on the left, or the main search bar at the top.\r\n6. Observe animation and css blue/frost filter applied to the rest of the page behind.\r\n\r\n\r\nExample:\r\n\r\n[grafana10-over-vnc.webm](https://github.com/grafana/grafana/assets/110322/4191054c-14f9-41ee-b684-52105debdc89)\r\n\r\nPlease note that above video capture, was captured at 30 fps, and AT VM side. On VNC client side it is even worse. The full viewport of the webpage had size 2275 px height x 2685 px tall.\r\n\r\n![grafana10-example-viewport](https://github.com/grafana/grafana/assets/110322/c2bed0e3-f7ec-4610-8eda-0238ac757b40)\r\n\r\n\r\nRunning very same web browser version, at same viewport size, and same grafana server, but on client side (without VNC), is smooth. So this is not a browser, grafana or machine issue, but rather inherent to VNC transfering A LOT of data during these animations.\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.x\r\nOS: Doesn't matter\r\nBrowser: Doesn't matter\r\n\r\n\r\n### Grafana platform?\r\n\r\nNone\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["effort/small","area/frontend"]},{"id":57526,"title":"GUI allows two dashboards with the same name, API does not","body":"I am currently writing a Ansible Playbook that replaces the datasources in all of our dashboards using the API. In this process I stumpled upon this issue.\r\n\r\nWe have two dashboards with the same name, but in two different folders. This is allowed and doesn't seem to be a problem in the GUI.\r\n```\r\n/folder1/mydashboard\r\n/folder2/mydashboard\r\n```\r\n\r\nIn my Ansible Playbook I do the following:\r\n\r\n1. Get all dashboards\r\n\r\n`GET http://mygrafanainstance:3000/api/search?type=dash-db`\r\n\r\n1. Loop all dashboards\r\n\r\n```\r\nGET http://mygrafanainstance:3000/api/dashboards/uid/uid-of-dashboard\r\nModify the datasource\r\nPOST http://mygrafanainstance:3000/api/dashboards/db\r\n```\r\n\r\nWhen I get to the second dashboard with a similar name I get the following error:\r\n`fatal: [b0633s01.bdunet.dk]: FAILED! =\u003e {\"cache_control\": \"no-cache\", \"changed\": false, \"connection\": \"close\", \"content_length\": \"96\", \"content_type\": \"application/json\", \"date\": \"Mon, 24 Oct 2022 12:12:30 GMT\", \"elapsed\": 0, \"expires\": \"-1\", \"json\": {\"message\": \"A dashboard with the same name in the folder already exists\", \"status\": \"name-exists\"}, \"msg\": \"Status code was 412 and not [200]: HTTP Error 412: Precondition Failed\", \"pragma\": \"no-cache\", \"redirected\": false, \"status\": 412, \"url\": \"http://mygrafanainstance:3000/api/dashboards/db\"}`\r\n\r\n\r\n**What happened**:\r\n\"A dashboard with the same name in the folder already exists\"\r\n\r\n**What you expected to happen**:\r\nThat dashboards is identified by meta.folderId and dashboard.id instead of dashboard.title.\r\nThe title should not be required to be unique.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate two dashboards with the same title in two different folders (same organization)\r\nGet the dashboards with API, and post the dashboards again - perhaps with a minor change like datasource uid.\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.1 (and 9.1.3)\r\n- OS Grafana is installed on: Docker running on RHEL\r\n\r\n","labels":["type/bug","area/dashboard","area/backend/api","area/backend"]},{"id":51011,"title":"TimeSeries: support for mixed pos/neg stacking","body":"\r\n\r\n**What happened**:\r\nstack negative value not show, according to https://github.com/grafana/grafana/issues/1360 fix and some fieled override method, this only work if the series data is all negative, but not the one has both negative and postive value.\r\n\r\nI believe this is very basic function, I just cann't believe this still not working \r\n\r\n**What you expected to happen**:\r\nstack according to the value\r\npostion value stack above the zero line\r\nnegative value stack below the zero line \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version:\r\n- I have tried 8.2.0,8,5.1,9.00 all has the same issue\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n![image](https://user-images.githubusercontent.com/17425165/174245348-68a7571d-57f2-4eee-9569-05d4ec2e1d39.png)\r\n","labels":["type/feature-request","area/panel/timeseries"]},{"id":53464,"title":"Cannot update alert rule in GUI when alert is created through the API","body":"**What happened**:\r\nI try updating an alert mySQL query in the UI. If the alert was created via the API - /grafana/api/v1/provisioning/alert-rules , then the changes I make to the alert query in the GUI do not save. Although I get a \"save successful\" prompt, the change does not actually take place.\r\n\r\n**What you expected to happen**:\r\nI expect to be able to modify an alert via the API and the GUI interchangeably.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate an alert via /grafana/api/v1/provisioning/alert-rules , then edit that alert mySQL query in the GUI, save the changes, and see that the changes were not made.\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.3\r\n- Data source type \u0026 version: MySQL\r\n- User OS \u0026 Browser: Mac OS Monterey v12.4\r\n","labels":["needs more info","area/alerting"]},{"id":69293,"title":"Alerting: Webhook/Slack generatorURL/SilenceURL missing orgId when alert-rule has no dashboard/panel link set","body":"### \n# What went wrong?\n\n\n**What happened**:\r\nI noticed sometimes the generatorURL will be missing the orgId from our Slack and Webhook messages, I managed to track it down to alerts without a dashboard/panel link. This is also affecting the silenceURL.\r\n\r\n**What did you expect to happen**:\r\nRegardless whether a dashboard/panel link is present, I would always expect an orgId to be present.\r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n- Open Grafana (with multi-orgs) and create an alert rule with a dashboard/panel link and route it slack and/or webhook\r\n\r\n**Step 2**:\r\n- Trigger the alert to fire, observe `generatorURL` and `silenceURL` has an orgId specified.\r\n\r\n**Step 3**:\r\n- Remove the dashboard/panel link and retrigger the alert-rule\r\n\r\n**Step 4**:\r\n- `generatorURL` and `silenceURL` won't have an orgId present\r\n\n\n### \n# What Grafana version are you using?\n\n\nv9.4, v9.5\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### User's OS?\n\nMacOS Ventura\n\n### User's Browser?\n\nFirefox\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["needs more info","area/alerting"]},{"id":62397,"title":"Alerting: InfluxDB + Flux: No float64 Data on Alert Query","body":"**What happened**:\r\nI am creating an alert in Grafana based off a Flux query. I have to do some footwork to get the incoming data in the format I need, and as a result this is what my query looks like:\r\n\r\n```\r\nimport \"join\"\r\nimport \"bitwise\"\r\n\r\nclosed = from(bucket: \"high-availability\")\r\n  |\u003e range(start: -30s)\r\n  |\u003e filter(fn: (r) =\u003e r[\"_measurement\"] == \"core\")\r\n  |\u003e filter(fn: (r) =\u003e r[\"_field\"] == \"gens-closed\")\r\nfreq = from(bucket: \"high-availability\")\r\n  |\u003e range(start: -30s)\r\n  |\u003e filter(fn: (r) =\u003e r[\"_measurement\"] == \"generator\")\r\n  |\u003e filter(fn: (r) =\u003e r[\"_field\"] == \"freq\")\r\n  |\u003e aggregateWindow( every: 1s, fn: last, createEmpty: true)\r\n  |\u003e drop(columns: [\"_measurement\", \"_field\"])\r\n\r\n\r\nclosed0 = closed |\u003e map( fn: (r) =\u003e ({ r with source: \"1\" , closed : bitwise.uand( a: uint(v: r[\"_value\"]) , b: uint(v:1) )}))\r\n                    |\u003e aggregateWindow( every: 1s, fn: last, createEmpty: false)\r\n                    |\u003e drop(columns: [\"_measurement\", \"_field\"])\r\nclosed1 = closed |\u003e map( fn: (r) =\u003e ({ r with source: \"2\" , closed : bitwise.uand( a: uint(v: r[\"_value\"]) , b: uint(v:2) )}))\r\n                    |\u003e aggregateWindow( every: 1s, fn: last, createEmpty: false)\r\n                    |\u003e drop(columns: [\"_measurement\", \"_field\"])\r\n\r\nunion_closed = union( tables: [closed0, closed1])\r\n\r\n\r\njoin.full( left: union_closed, right: freq,\r\n            on : (l,r) =\u003e l.id == r.id and l._time == r._time and l.source == r.source,\r\n            as: (l,r) =\u003e ({r with closed: l.closed}) )\r\n            |\u003e filter(fn : (r) =\u003e r[\"closed\"] != 0)\r\n            |\u003e drop(columns: [\"closed\", \"tag\", \"client\"])\r\n            |\u003e group(columns: [\"skid\", \"source\"])\r\n```\r\nIn the Grafana explorer, this request happily returns data which I can view. However, when in place for an alert query, I get the following error with no returned data: \r\n\r\n```\r\nError\r\nFailed to evaluate queries and expressions: no float64 value column found in frame\r\n```\r\n\r\n**What you expected to happen**:\r\nI was expecting some data to be returned from the query, as it is returned in the explorer view.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nI am not sure as the exact steps to replicate, but I seem to be seeing it based off the tables that a join produces.\r\n\r\n**Anything else we need to know?**:\r\nI have seen similarities here: https://github.com/grafana/grafana/issues/48072\r\nbut nothing in the thread was useful to me.\r\n\r\n**Environment**:\r\n- Grafana version: v9.4.0\r\n- Data source type \u0026 version: InfluxDB v2.5.1 (Flux Query)\r\n- OS Grafana is installed on: Debian 11 running Docker\r\n- User OS \u0026 Browser: Mac, Chrome","labels":["datasource/InfluxDB","needs more info","needs investigation"]},{"id":45429,"title":"CloudWatch Logs: Region dropdown doesn't allow template variables","body":"I want to use a template variable to set the region for the CloudWatch Logs datasource. However, the UI doesn't allow selecting/entering template variables.\r\n\r\nThis does seem to be supported when using CloudWatch Metrics, and it even seems to be supported by the CloudWatch Logs JSON model (i.e. the following snippet of panel JSON works):\r\n\r\n```json\r\n  // ...\r\n  \"type\": \"logs\",\r\n  \"datasource\": {\r\n    \"type\": \"cloudwatch\"\r\n  },\r\n  \"targets\": [\r\n    {\r\n      \"queryMode\": \"Logs\",\r\n      \"region\": \"$Region\",\r\n      \"datasource\": {\r\n        \"type\": \"cloudwatch\",\r\n      },\r\n      // ...\r\n    }\r\n```\r\n\r\n_Originally posted by @Eraac in https://github.com/grafana/grafana/issues/24333#issuecomment-684599523_","labels":["area/dashboard/templating","datasource/CloudWatch Logs"]},{"id":71563,"title":"not exporting to excel correctly","body":"### What happened?\r\n\r\nWhen we are going to export in excel, if we apply the filter inside the panel it exports all the data, or when we are going to apply a filter in the column inside the export tab it just closes, this is a bug\r\n\r\n### What did you expect to happen?\r\n\r\nWhen we are going to export in excel, if we apply the filter inside the panel to export data the filter it exports all the data, or when we are going to apply a filter on the column inside the export tab it just closes, this is a bug\r\n\r\n### Did this work before?\r\n\r\nthat it exports to excel according to the filter inside the panel\r\n\r\n### How do we reproduce it?\r\n\r\n1. select the filter in the panel\r\n2. click export\r\n3. export is closed or when it doesn't happen, it exports all data\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nnão\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.0.1\r\nOS: ENTERPRISE\r\nBrowser: chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### Datasource(s)?\r\n\r\nall data source","labels":["area/dashboard","triage/needs-confirmation","team/grafana-dashboards"]},{"id":75924,"title":"Product Area: Short description of bug","body":"### What happened?\n\nNavigating to `Alerting\u003eGroups` causes Grafana pod to restart. The UI displays the `Loading notifications` message for a while; then the Pod is OOMKilled. \r\nI tried increasing the memory limit to 20Gi (from 2Gi) with the same result.\n\n### What did you expect to happen?\n\nThe page loads or errors our without causing the pod to run out of memory.\n\n### Did this work before?\n\nNever tried before\n\n### How do we reproduce it?\n\n1. Unable `Unified Alerting`\r\n2. Add an Alertmanager datasource with large groups\r\n3. Navigate to `Alerting\u003eGroups`\r\n\n\n### Is the bug inside a dashboard panel?\n\nNo\n\n### Environment (with versions)?\n\nGrafana: 9.5.9\r\nOS: macOS 12.6.8\r\nBrowser: Chrome\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nAlertmanager","labels":["needs more info","area/alerting"]},{"id":66423,"title":"Grafana does not save data when docker host volumes are used","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nWhen using docker compose with host volumes, the data are not created in the host folders\r\n\r\n```yaml\r\nservices:\r\n      \r\n  grafana:\r\n    image: grafana/grafana:latest\r\n    container_name: grafana\r\n    hostname:  grafana\r\n    restart: always\r\n\r\n    user: '1001'\r\n\r\n    environment:\r\n      TZ: Europe/Amsterdam\r\n      UID: 1001\r\n      GID: 1001\r\n    volumes:\r\n      - /data/grafana/data:/var/lib/grafana\r\n      - /data/grafana/conf:/etc/grafana\r\n      - /data/grafana/logs:/var/log/grafana\r\n      - /data/grafana/share:/usr/share/grafana\r\n\r\n    ports:\r\n      - \"3000:3000\"\r\n```\r\n\r\nBut, when running `docker compose up -d` I get the following error:\r\n\r\n```bash\r\ngrafana  | GF_PATHS_CONFIG='/etc/grafana/grafana.ini' is not readable.\r\ngrafana  | GF_PATHS_DATA='/var/lib/grafana' is not writable.\r\ngrafana  | You may have issues with file permissions, more information here: http://docs.grafana.org/installation/docker/#migrate-to-v51-or-later\r\ngrafana  | mkdir: can't create directory '/var/lib/grafana/plugins': Permission denied\r\ngrafana  | GF_PATHS_CONFIG='/etc/grafana/grafana.ini' is not readable.\r\ngrafana  | GF_PATHS_DATA='/var/lib/grafana' is not writable.\r\ngrafana  | You may have issues with file permissions, more information here: http://docs.grafana.org/installation/docker/#migrate-to-v51-or-later\r\ngrafana  | mkdir: can't create directory '/var/lib/grafana/plugins': Permission denied\r\n```\r\n\r\nI changed the directories with `chown -R 472:0` and `user: '1001'`  was added to the compose file, but no luck.\r\n\r\n\r\n**What you expected to happen**:\r\n\r\nFor the files in `/etc/grafana` to be accessible on my host server, in the directory: `/data/grafana/conf`\r\n\r\nI want all those files accessible so that I can back them up.\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nRun on Ubuntu 22.04 with the above compose file.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version:  docker image: grafana/grafana:latest\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on: Ubuntu 22.04\r\n- User OS \u0026 Browser: Linux Ubuntu 22.04 (Desktop) Firefox 112\r\n- Grafana plugins: None\r\n- Others: docker version 23.0.3\r\n\r\n```[tasklist]\r\n```","labels":["needs more info","area/docker"]},{"id":68113,"title":"BarChart: bar highlight doesn't respect rounded corners","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\nThe bar chart highlight on mouse hover doesn't respect rounded corners. The highlight is displayed as a rectangle without rounded corners.\r\n![image](https://github.com/grafana/grafana/assets/56939935/478318b0-c488-4a44-bdaa-a831f9d49cd3)\r\n\r\n \r\n\r\n**What did you expect to happen**:\r\n\r\nI expected that the highlight will also have rounded corners and will match the bar in the chart.\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\n- Create a bar chart\r\n\r\n**Step 2**:\r\n\r\n- Set bar radius to a non-zero value and make sure that \"Highlight full area on hover\" is disabled\r\n\r\n**Step 3**:\r\n\r\n- Hover over the chart and observe the grey highlight\r\n\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\nv9.5.1 (bc353e4b2d)\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\n| Key | Value |\r\n|--|--|\r\n| Panel | barchart @ 9.5.1 (bc353e4b2d) |\r\n| Grafana | 9.5.1 (bc353e4b2d) // Open Source |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"custom\": {\r\n            \"lineWidth\": 1,\r\n            \"fillOpacity\": 80,\r\n            \"gradientMode\": \"none\",\r\n            \"axisPlacement\": \"auto\",\r\n            \"axisLabel\": \"\",\r\n            \"axisColorMode\": \"text\",\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"axisCenteredZero\": false,\r\n            \"hideFrom\": {\r\n              \"tooltip\": false,\r\n              \"viz\": false,\r\n              \"legend\": false\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"yellow\",\r\n                \"value\": null\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"orientation\": \"auto\",\r\n        \"xTickLabelRotation\": 0,\r\n        \"xTickLabelSpacing\": 0,\r\n        \"showValue\": \"auto\",\r\n        \"stacking\": \"none\",\r\n        \"groupWidth\": 0.7,\r\n        \"barWidth\": 0.71,\r\n        \"barRadius\": 0.45,\r\n        \"fullHighlight\": false,\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        },\r\n        \"legend\": {\r\n          \"showLegend\": true,\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"calcs\": []\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"grafana\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"snapshot\",\r\n          \"snapshot\": [\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"meta\": {\r\n                  \"typeVersion\": [\r\n                    0,\r\n                    0\r\n                  ],\r\n                  \"custom\": {\r\n                    \"executionFinishTime\": 1683643608914,\r\n                    \"executionStartTime\": 1683643608738,\r\n                    \"hasSeries\": true,\r\n                    \"queryId\": \"AEFACANMFQ3OJ2XOO6KODLITREROJKZJ6EWGPDUOUKXVW4ZHOLN7AAYUCRQGPEY\",\r\n                    \"status\": {\r\n                      \"CumulativeBytesMetered\": 10000000,\r\n                      \"CumulativeBytesScanned\": 774,\r\n                      \"ProgressPercentage\": 100\r\n                    },\r\n                    \"fetchStartTime\": 1683643608639,\r\n                    \"fetchEndTime\": 1683643608992,\r\n                    \"fetchTime\": 353\r\n                  },\r\n                  \"executedQueryString\": \"SELECT device, CREATE_TIME_SERIES(time, measure_value::double) FROM \\\"smartbee_draft\\\".\\\"smartbee_devices\\\" WHERE time BETWEEN from_milliseconds(1683557205048) AND from_milliseconds(1683643605048) AND measure_name = 'lte_rssi' AND gateway = 'G22500002AAA' group by device order by device\",\r\n                  \"stats\": [\r\n                    {\r\n                      \"displayName\": \"Execution time (Grafana server ⇆ Timestream)\",\r\n                      \"value\": 176,\r\n                      \"unit\": \"ms\",\r\n                      \"decimals\": 2\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Fetch time (Browser ⇆ Grafana server w/o Timestream)\",\r\n                      \"value\": 177,\r\n                      \"unit\": \"ms\",\r\n                      \"decimals\": 2\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Fetch overhead\",\r\n                      \"value\": 50.14164305949008,\r\n                      \"unit\": \"percent\"\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Cumulative bytes metered\",\r\n                      \"value\": 10,\r\n                      \"unit\": \"MB\",\r\n                      \"decimals\": 2\r\n                    },\r\n                    {\r\n                      \"displayName\": \"Cumulative bytes scanned\",\r\n                      \"value\": 774,\r\n                      \"unit\": \"B\",\r\n                      \"decimals\": 2\r\n                    }\r\n                  ],\r\n                  \"transformations\": [\r\n                    \"labelsToFields\",\r\n                    \"labelsToFields\",\r\n                    \"labelsToFields\",\r\n                    \"labelsToFields\",\r\n                    \"labelsToFields\",\r\n                    \"labelsToFields\",\r\n                    \"labelsToFields\"\r\n                  ]\r\n                },\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"time\",\r\n                    \"type\": \"time\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"time.Time\"\r\n                    },\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"_col1\",\r\n                    \"type\": \"number\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"float64\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"labels\": {\r\n                      \"device\": \"gateway\"\r\n                    },\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    1683638096000,\r\n                    1683638667000,\r\n                    1683638766000,\r\n                    1683639337000,\r\n                    1683639437000,\r\n                    1683639506000,\r\n                    1683640044000,\r\n                    1683640115000,\r\n                    1683640654000,\r\n                    1683640723000,\r\n                    1683641263000,\r\n                    1683641336000,\r\n                    1683641881000,\r\n                    1683641950000,\r\n                    1683642491000,\r\n                    1683642561000,\r\n                    1683643099000,\r\n                    1683643170000\r\n                  ],\r\n                  [\r\n                    -67,\r\n                    -67,\r\n                    -65,\r\n                    -65,\r\n                    -65,\r\n                    -65,\r\n                    -63,\r\n                    -63,\r\n                    -63,\r\n                    -63,\r\n                    -63,\r\n                    -63,\r\n                    -63,\r\n                    -63,\r\n                    -63,\r\n                    -63,\r\n                    -65,\r\n                    -65\r\n                  ]\r\n                ]\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      \"title\": \"Reproduced with embedded data\",\r\n      \"transformations\": [\r\n        {\r\n          \"id\": \"labelsToFields\",\r\n          \"options\": {\r\n            \"valueLabel\": \"device\"\r\n          }\r\n        }\r\n      ],\r\n      \"type\": \"barchart\"\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003ebarchart @ 9.5.1 (bc353e4b2d)\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003eA[grafana-timestream-datasource]\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eTransforms (1)\u003c/th\u003e\\n      \u003ctd\u003elabelsToFields\u003c/td\u003e\\n  \u003c/tr\u003e\\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003e 1 frames, 2 fields, 18 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e9.5.1 (bc353e4b2d) // Open Source\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"title\": \"Original Panel JSON\",\r\n      \"type\": \"text\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 7\r\n      },\r\n      \"options\": {\r\n        \"content\": \"{\\n  \\\"datasource\\\": {\\n    \\\"type\\\": \\\"grafana-timestream-datasource\\\",\\n    \\\"uid\\\": \\\"ZGuWEpL4k\\\"\\n  },\\n  \\\"fieldConfig\\\": {\\n    \\\"defaults\\\": {\\n      \\\"custom\\\": {\\n        \\\"lineWidth\\\": 1,\\n        \\\"fillOpacity\\\": 80,\\n        \\\"gradientMode\\\": \\\"none\\\",\\n        \\\"axisPlacement\\\": \\\"auto\\\",\\n        \\\"axisLabel\\\": \\\"\\\",\\n        \\\"axisColorMode\\\": \\\"text\\\",\\n        \\\"scaleDistribution\\\": {\\n          \\\"type\\\": \\\"linear\\\"\\n        },\\n        \\\"axisCenteredZero\\\": false,\\n        \\\"hideFrom\\\": {\\n          \\\"tooltip\\\": false,\\n          \\\"viz\\\": false,\\n          \\\"legend\\\": false\\n        },\\n        \\\"thresholdsStyle\\\": {\\n          \\\"mode\\\": \\\"off\\\"\\n        }\\n      },\\n      \\\"color\\\": {\\n        \\\"mode\\\": \\\"palette-classic\\\"\\n      },\\n      \\\"mappings\\\": [],\\n      \\\"thresholds\\\": {\\n        \\\"mode\\\": \\\"absolute\\\",\\n        \\\"steps\\\": [\\n          {\\n            \\\"color\\\": \\\"yellow\\\",\\n            \\\"value\\\": null\\n          }\\n        ]\\n      }\\n    },\\n    \\\"overrides\\\": []\\n  },\\n  \\\"gridPos\\\": {\\n    \\\"h\\\": 14,\\n    \\\"w\\\": 24,\\n    \\\"x\\\": 0,\\n    \\\"y\\\": 41\\n  },\\n  \\\"id\\\": 21,\\n  \\\"options\\\": {\\n    \\\"orientation\\\": \\\"auto\\\",\\n    \\\"xTickLabelRotation\\\": 0,\\n    \\\"xTickLabelSpacing\\\": 0,\\n    \\\"showValue\\\": \\\"auto\\\",\\n    \\\"stacking\\\": \\\"none\\\",\\n    \\\"groupWidth\\\": 0.7,\\n    \\\"barWidth\\\": 0.71,\\n    \\\"barRadius\\\": 0.45,\\n    \\\"fullHighlight\\\": false,\\n    \\\"tooltip\\\": {\\n      \\\"mode\\\": \\\"single\\\",\\n      \\\"sort\\\": \\\"none\\\"\\n    },\\n    \\\"legend\\\": {\\n      \\\"showLegend\\\": true,\\n      \\\"displayMode\\\": \\\"list\\\",\\n      \\\"placement\\\": \\\"bottom\\\",\\n      \\\"calcs\\\": []\\n    }\\n  },\\n  \\\"targets\\\": [\\n    {\\n      \\\"database\\\": \\\"\\\\\\\"smartbee_draft\\\\\\\"\\\",\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"grafana-timestream-datasource\\\",\\n        \\\"uid\\\": \\\"ZGuWEpL4k\\\"\\n      },\\n      \\\"measure\\\": \\\"lte_rssi\\\",\\n      \\\"rawQuery\\\": \\\"SELECT device, CREATE_TIME_SERIES(time, measure_value::double) FROM $__database.$__table WHERE $__timeFilter AND measure_name = '$__measure' AND gateway = '$apiary' group by device order by device\\\",\\n      \\\"refId\\\": \\\"A\\\",\\n      \\\"table\\\": \\\"\\\\\\\"smartbee_devices\\\\\\\"\\\"\\n    }\\n  ],\\n  \\\"title\\\": \\\"LTE\\\",\\n  \\\"transformations\\\": [\\n    {\\n      \\\"id\\\": \\\"labelsToFields\\\",\\n      \\\"options\\\": {\\n        \\\"valueLabel\\\": \\\"device\\\"\\n      }\\n    }\\n  ],\\n  \\\"type\\\": \\\"barchart\\\"\\n}\",\r\n        \"mode\": \"code\",\r\n        \"code\": {\r\n          \"language\": \"json\",\r\n          \"showLineNumbers\": true,\r\n          \"showMiniMap\": true\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above (after transformations)\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"id\": 100,\r\n      \"title\": \"Data (before transformations)\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 24,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": false,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: LTE // 2023-05-09 17:01:43\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-barchart\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"2023-05-08T14:46:45.048Z\",\r\n    \"to\": \"2023-05-09T14:46:45.048Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\r\n\r\n### Grafana Platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### User's OS?\r\n\r\nUbuntu\r\n\r\n### User's Browser?\r\n\r\nFirefox 111.0.1\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\nNo\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["bot/no new info"]},{"id":83470,"title":"NodeGraph not clearing variable value","body":"### What happened?\n\nwhen i change input parameter from drop down variable, edges from previous node graph doesn't disappear. New node graph is super imposed on edges from previous graph.\r\nI am fetching data from MS SQL Server tables using native sql.\r\n![Capture](https://github.com/grafana/grafana/assets/161418932/92d3a2d4-5ab0-4dc6-ba41-09f6dc59090d)\r\n![Capture2](https://github.com/grafana/grafana/assets/161418932/71599cef-ee65-4890-a821-1990eef1ae57)\r\n\n\n### What did you expect to happen?\n\nI expect edges from previous node graph to disappear.\n\n### Did this work before?\n\nNot sure, this is my first time with node graph.\r\nBut i see someone else also reported the same issue https://github.com/grafana/grafana/issues/48956\r\nBut i am **not** using **[nodegraph-api-plugin](https://github.com/hoptical/nodegraph-api-plugin)**\n\n### How do we reproduce it?\n\n1.create nodegraph using system \"a\" as variable\r\n2.change variable value from drop down to system \"b\"\r\n3. edges from previous graph should still be visible in background\r\n\n\n### Is the bug inside a dashboard panel?\n\nyes, nodegraph\n\n### Environment (with versions)?\n\nGrafana: Grafana v10.3.1\r\nOS: windows 11\r\nBrowser: Chrome and Edge both show behaviour\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nUsing Native MS SQL  Datasource","labels":["area/panel/node-graph","triage/needs-confirmation"]},{"id":74967,"title":"Alerting: recording and data-source managed rules break when saving with variables","body":"### What happened?\n\nI created a new recording rule for process CPU usage where the data source is Mimir: `sum by(job, instance) (rate(namedprocess_namegroup_cpu_seconds_total[$__rate_interval]))`. Note that `$__rate_interval` was the default value from the builder when adding `rate`. In the UI, it shows the graph properly, however when saving I get the alert \"Failed to save rule: 6:13: group \"process\", rule 1, \"process_cpu_cores_percent\": could not parse expression: 1:70: parse error: missing unit character in duration\"\n\n### What did you expect to happen?\n\nIdeally, when saving the rule, Grafana should fill out the value before saving it to the remote source. Worst case, I'd expect the variable to not even show up as an option if it can't be supported\n\n### Did this work before?\n\nAFAIK, no.\n\n### How do we reproduce it?\n\n1. Create a new recording rule\r\n2. Use a Mimir data source with `$__rate_interval` somewhere in the query\r\n3. Hit save\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.1.1\r\nOS: Amazon Linux 2\r\nBrowser: Firefox 117.0.1\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\nMimir 2.9","labels":["area/alerting","triage/needs-confirmation"]},{"id":60297,"title":"Data links in Stat panel with __data.fields not working","body":"Copied from [here](https://community.grafana.com/t/data-links-in-stat-panel-with-data-fields/66604)\r\n\r\nWe have also this problem in v8.5.15. Thanks!\r\n\r\nGrafana v8.5.2 in Docker Container\r\n\r\nWhat are you trying to achieve?\r\nI want to have a Data link on the Stat Panel, with some data from the query\r\n\r\nHow are you trying to achieve it?\r\nhttps://example.com?foo=${__data.fields.foo} .\r\n\r\nWhat happened?\r\nI was able to select the data field in the Data Link dialog, but later it does not get substituted in the URL when I click or hover on the stat panel.\r\n\r\nWhat did you expect to happen?\r\nThe variable gets substituted like in the table panel.\r\n\r\n\r\n\u003cimg width=\"437\" alt=\"image (17)\" src=\"https://user-images.githubusercontent.com/30987258/207573712-e412302f-938e-4f01-9072-920e61622c84.png\"\u003e\r\n\r\n\r\n","labels":["area/dashboard/data-links","area/panel/stat","triage/needs-confirmation","team/grafana-dashboards"]},{"id":44323,"title":"UI is in background retrying failing logins once every second","body":"**What happened**:\r\nGrafana server was restarted.\r\n5 minutes later,  Grafana server logs started printing following errors once every second and has been doing so for several hours straight now:\r\n```\r\n{\"error\":\"user token not found\",\"logger\":\"context\",\"lvl\":\"eror\",\"msg\":\"Failed to look up user based on cookie\",\"t\":\"2022-01-21T14:16:15.898946008Z\"}\r\n{\"logger\":\"context\",\"lvl\":\"info\",\"method\":\"GET\",\"msg\":\"Request Completed\",\"orgId\":0,\"path\":\"/api/live/ws\",\"referer\":\"\",\"remote_addr\":\"XXXXXXXX\",\"size\":32,\"status\":401,\"t\":\"2022-01-21T14:16:15.720501961Z\",\"time_ms\":1,\"uname\":\"\",\"userId\":0}\r\n```\r\nI suspect some user has left a browser tab open somewhere and the cookie is not valid anymore. Unfortunately i can't find them so don't know exactly what it looks like on the client side.\r\n\r\n**What you expected to happen**:\r\nGrafana UI detects that it is unauthenticated and does not hammer the backend with more login attempts.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nSee above\r\n\r\n**Anything else we need to know?**:\r\nUsing oauth with azuread as login mechanism.\r\n\r\n**Environment**:\r\n- Grafana version: Grafana v8.3.3 (30bb7a93ca)\r\n- Data source type \u0026 version: Loki and Prometheus \r\n- OS Grafana is installed on: Official docker image\r\n- User OS \u0026 Browser: Don't know \r\n- Grafana plugins: None\r\n","labels":["needs more info","needs investigation","bot/no new info","area/logs"]},{"id":69080,"title":"AlertNG init 30 Second,but org over 5000，Causing Grafana to fail to start","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n  - ngalert.go initCtx, cancelFunc := context.WithTimeout(context.Background(), 30*time.Second)\r\n  - bug org over 5000,so Initialization time exceeds 30 seconds，error info is :\r\n  - `logger=infra.kvstore.sql t=2023-05-25T13:52:04.294781402Z level=debug msg=\"kvstore value not found\" orgId=27163 namespace=alertmanager key=silences\r\nlogger=alertmanager org=27461 t=2023-05-25T13:52:04.295114265Z level=debug msg=\"notification log snapshot file doesn't exist\" err=\"open /var/lib/grafana/alerting/27163/notifications: no such file or directory\"\r\nlogger=ngalert.multiorg.alertmanager t=2023-05-25T13:52:04.322007724Z level=error msg=\"failed to apply Alertmanager config for org\" org=27163 id=1814 error=\"unable to apply configuration: context deadline exceeded\"\r\nlogger=infra.kvstore.sql t=2023-05-25T13:52:04.322196466Z level=debug msg=\"error getting kvstore value\" orgId=20541 namespace=alertmanager key=notifications err=\"context deadline exceeded\"`\r\n\r\n**What did you expect to happen**:\r\n\r\n  - \r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Open Grafana and do X \r\n\r\n**Step 2**:\r\n\r\n- Now click button Y\r\n\r\n**Step 3**:\r\n\r\n- Wait for the browser to crash. Error message says: \"Error...\"\r\n\n\n### \n# What Grafana version are you using?\n\n\n9.4.3\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nKubernetes\n\n### User's OS?\n\n_No response_\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["needs more info","area/alerting"]},{"id":49358,"title":"Grafana plugin release fail by \"Lint Plugin\"","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nline 2: pushd: ./plugin-validator/cmd/plugincheck: No such file or directory\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\npush tag to trigger release action\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.0-pre \r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser: ubuntu\r\n- Grafana plugins:\r\nRun git clone https://github.com/grafana/plugin-validator\r\nCloning into 'plugin-validator'...\r\n/home/runner/work/_temp/61c29a20-f66a-4b4b-aa80-7af7f2f7d74a.sh: line 2: pushd: ./plugin-validator/cmd/plugincheck: No such file or directory\r\nError: Process completed with exit code 1.\r\n- Others:\r\n![image](https://user-images.githubusercontent.com/5517120/169656698-d634ef95-2e1c-43be-972f-7dcb211a512b.png)\r\n","labels":["needs more info","area/plugins","bot/no new info"]},{"id":72508,"title":"API: Invalid Response Code [DashboardsApi]","body":"### What happened?\n\nIf a dashboard should updated by api and a library pannel is invalid the server returns a 500 error instead of a 400.\r\n\r\nThe server saves the dashboard as a new version, with the wrong data, if this happens.\n\n### What did you expect to happen?\n\nReturn status 400 instead or accept request.\r\nIt should also be looked at, if this can happen in any other scenario.\n\n### Did this work before?\n\nI dont know\n\n### How do we reproduce it?\n\n1. Send an update request for a dashboard via api, with an invalid library-panel id\r\n2. the system return status 500 + response: {\r\n  message: 'Error while connecting library panels',\r\n  traceID: '6dcec8298e629d6814c5a4f65e802bc6'\r\n}\r\n\n\n### Is the bug inside a dashboard panel?\n\nno\n\n### Environment (with versions)?\n\nGrafana: 10\r\nOS: Docker\r\nBrowser: Edge\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\n_No response_","labels":["type/feature-request","area/dashboard","area/frontend/library-panels"]},{"id":46523,"title":"negative-y doesn't work when timeframe is \u003e250d ","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI use the new \"negative-y\" feature. (Used math*(-1) before). \r\nI use the graph to see dependency between outside temperature and power-consumption of my heating-system.\r\nWhen I now select a time which contains more than 249 days it doesn't render the line in the graph at all.\r\nWhen using time lower than 249d it works as expected. (See screenshots)\r\n\r\n\r\n**What you expected to happen**:\r\nLine should be rendered propper with any given time selected. Independend how long the period selected is.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nUsing Bar and Line graph in one chart. \r\nLine is \"negative-y\" (°C). \r\nSelect time period bigger then 250d.\r\n\r\n**Anything else we need to know?**:\r\nLet me know if I can provide any other useful information.\r\n\r\n**Environment**:\r\n- Grafana version: v8.4.3\r\n- Data source type \u0026 version: InfluxDB\r\n- OS Grafana is installed on: Docker in Homeassistant\r\n- User OS \u0026 Browser: Google Chrome v99\r\n- Grafana plugins: none\r\n- Others: none\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/12324196/158155198-14fe423d-2021-466f-b143-5c1dd7798919.png)\r\n\r\n![image](https://user-images.githubusercontent.com/12324196/158155220-6858fe73-89d9-4cee-927a-62cc11939784.png)\r\n\r\n","labels":["needs more info","area/panel/timeseries"]},{"id":55714,"title":"[Alerting] Copy and paste panel - alert rule is not shown","body":"**What happened**:\r\nI copied a panel Graph (old) with an alert rule to clipboard.\r\nI create a new empty dashboard in another folder.\r\nI paste the panel into this new dashboard and safe it.\r\n\r\n**What you expected to happen**:\r\nThat the pasted panel looks the original panel with alert in in.\r\n \r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nDo the steps unter \"what happened\"\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.1.6\r\n- Data source type \u0026 version: Prometheus\r\n- OS Grafana is installed on: as docker container\r\n- User OS \u0026 Browser: Windows 10, Browser: Chrome\r\n- Grafana plugins:\r\n grafana-clock-panel/\r\ngrafana-image-renderer/\r\ngrafana-piechart-panel/\r\ngrafana-polystat-panel/\r\ngrafana-simple-json-datasource/\r\ngrafana-singlestat-panel/\r\njdbranham-diagram-panel/\r\nmonitoringartist-monitoringart-datasource/\r\nnatel-plotly-panel/\r\nnovalabs-annotations-panel/\r\nradensolutions-netxms-datasource/\r\nryantxu-ajax-panel/\r\nsavantly-heatmap-panel/\r\nvonage-status-panel/\r\n\r\n- Others:\r\n\r\n\r\n![2022-09-26 09_01_19-Copy and paste panel - alert rule is not shown · Issue #55714 · grafana_grafana](https://user-images.githubusercontent.com/56024424/192213439-58207794-1152-43d2-aa00-72574c3ad224.gif)\r\n\r\n\r\n[Dashboard after import.json.txt](https://github.com/grafana/grafana/files/9643712/Dashboard.after.import.json.txt)\r\n","labels":["area/alerting","needs investigation","stale"]},{"id":75586,"title":"[Dashboards]: Search API is not consistent while loading dashboard list in a folder","body":"### What happened?\n\nWe have few folders in Grafana. When we browse the folder through Grafana UX and load the dashboards, the list seems to be consistent but, when we load it through URL, there are too many dashboards in the folder.\r\n\r\nI went through the network calls and found that search API is querying for `folderIDs=0` instead of the actual `folderID` which is returning all dashboards.\r\n\r\nIt's only happening for few folders and not all.\n\n### What did you expect to happen?\n\nSearch API should query for the actual folderID instead of 0\n\n### Did this work before?\n\nNot sure\n\n### How do we reproduce it?\n\n1. We chose a particular folder. Browsed it through Grafana UX and opened dashboard list in the folder\r\n2. Refresh the URL\r\n3. We will see too many dashboards not related to the folder\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 9.2.8\r\nOS: Linux\r\nBrowser: Chrome\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["type/bug","area/dashboard","area/dashboard/folders","area/backend","team/grafana-dashboards"]},{"id":83562,"title":"Math expression broken in v10.3.3","body":"### What happened?\r\n\r\nGrafana Math expression has broken since v10.3.3, and make charts mess up.\r\nbefore: \r\n![image](https://github.com/grafana/grafana/assets/3634305/8319e9b9-345a-4b7d-9413-d2e9762d70a5)\r\n\r\nafter:\r\n![image](https://github.com/grafana/grafana/assets/3634305/a7d225d3-9a37-45bf-af5f-7da622f23aeb)\r\n\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nGrafana Math expression works like 10.2.4\r\n\r\n### Did this work before?\r\n\r\nYes, it works fine in v10.2.4\r\n\r\n### How do we reproduce it?\r\n\r\n1. upgrade the version from 10.2.4 to 10.3.3\r\n2. use multi-frame data, and make 2 queries and one Math expression, let $A -$B\r\n3. $C should be the result of  $A -$B, but now it's messed up.\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nYes\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: v10.3.3\r\nOS: Ubuntu\r\nBrowser: Chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nDocker\r\n\r\n### Datasource(s)?\r\n\r\nElastcisearch","labels":["needs more info","area/expressions"]},{"id":69213,"title":"error loading alert group in UI when creating new alert via UI","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\n  We have positioned alerts and alert group e.g RWS-DEV\r\n\r\nduring creating of new alert via ui we wanted to load already existing RWS-DEV alert gourp but it was not loading existing alert groups and if we want to create add new one RWS-DEV it gives following error it can not create RWS-DEV since it is provistioned \r\n\r\n![MicrosoftTeams-image (18)](https://github.com/grafana/grafana/assets/56689311/d556dd21-7195-4079-9ad9-6107384e2473)\r\n\r\n\r\n\r\n**What did you expect to happen**:\r\n\r\n  We expect that already persisted alerts groups are loaded in uI and gave to users as option to be choosen\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\nGrafana 9.5.2 persist some alerts via file\r\n**Step 2**:\r\n\r\ncreate new alert\r\n\r\n**Step 3**:\r\n\r\nchoose alert group\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\n9.5.2\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\r\n\r\n### Grafana Platform?\r\n\r\nNone\r\n\r\n### User's OS?\r\n\r\n_No response_\r\n\r\n### User's Browser?\r\n\r\n_No response_\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\n_No response_\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["type/bug","area/alerting","area/frontend"]},{"id":51574,"title":"Table Panel - incoherent display value on rarely used column - null vs Blank","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI've noticed something weird in the displayed value on a rarely populated column.\r\n\r\nLet's say I run a plain select on InfluxDB, note that _NonExisting_ does not exist in the DB, this will return null values in the object received by Grafana (query inspector).\r\n`SELECT \"datacenter\", \"hostname\",\"value\",\"NonExisting\" FROM \"cpu\" WHERE $timeFilter`\r\n\r\nIf all the values of that column are `null` → the Grafana cell displays null, the cursor will become a \"hand\" (as for links), and there will also be a link-style window when you hover on top of it...\r\nIf even just one value **is not** `null` → The column will be blank when the value is null...\r\n\r\nIn both cases, a column filter will display Blank as a possible value (null is never shown in the filter), therefore I think something is wrong with the displayed value\r\n**What you expected to happen**:\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nI've been able to reproduce half of it the Grafana playground, the part in which null is displayed, which is the anomaly anyway...\r\nFor the other half you need a field/tag or generally a column even with just one single point, if the point is within the time range I see blanks, otherwise null\r\n\r\n\u003cdetails\u003e\r\n  \u003csummary\u003ehere is the panel code\u003c/summary\u003e\r\n  \r\n```\r\n{\r\n  \"id\": 1,\r\n  \"gridPos\": {\r\n    \"h\": 9,\r\n    \"w\": 24,\r\n    \"x\": 0,\r\n    \"y\": 0\r\n  },\r\n  \"type\": \"table\",\r\n  \"title\": \"Selected Servers\",\r\n  \"datasource\": {\r\n    \"uid\": \"000000002\",\r\n    \"type\": \"influxdb\"\r\n  },\r\n  \"interval\": \"$summarize\",\r\n  \"links\": [],\r\n  \"targets\": [\r\n    {\r\n      \"refId\": \"A\",\r\n      \"datasource\": {\r\n        \"type\": \"influxdb\",\r\n        \"uid\": \"000000002\"\r\n      },\r\n      \"policy\": \"default\",\r\n      \"resultFormat\": \"table\",\r\n      \"orderByTime\": \"ASC\",\r\n      \"tags\": [],\r\n      \"groupBy\": [\r\n        {\r\n          \"type\": \"time\",\r\n          \"params\": [\r\n            \"$__interval\"\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"tag\",\r\n          \"params\": [\r\n            \"datacenter\"\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"tag\",\r\n          \"params\": [\r\n            \"hostname\"\r\n          ]\r\n        },\r\n        {\r\n          \"type\": \"fill\",\r\n          \"params\": [\r\n            \"null\"\r\n          ]\r\n        }\r\n      ],\r\n      \"select\": [\r\n        [\r\n          {\r\n            \"type\": \"field\",\r\n            \"params\": [\r\n              \"value\"\r\n            ]\r\n          },\r\n          {\r\n            \"type\": \"mean\",\r\n            \"params\": []\r\n          }\r\n        ]\r\n      ],\r\n      \"measurement\": \"cpu\",\r\n      \"query\": \"SELECT \\\"datacenter\\\", \\\"hostname\\\",\\\"value\\\",\\\"NonExisting\\\" FROM \\\"cpu\\\" WHERE $timeFilter\",\r\n      \"rawQuery\": true\r\n    }\r\n  ],\r\n  \"options\": {\r\n    \"showHeader\": true,\r\n    \"footer\": {\r\n      \"show\": false,\r\n      \"reducer\": [\r\n        \"sum\"\r\n      ],\r\n      \"fields\": \"\"\r\n    }\r\n  },\r\n  \"fieldConfig\": {\r\n    \"defaults\": {\r\n      \"custom\": {\r\n        \"align\": \"auto\",\r\n        \"displayMode\": \"auto\",\r\n        \"inspect\": false\r\n      },\r\n      \"mappings\": [],\r\n      \"thresholds\": {\r\n        \"mode\": \"absolute\",\r\n        \"steps\": [\r\n          {\r\n            \"value\": null,\r\n            \"color\": \"green\"\r\n          },\r\n          {\r\n            \"value\": 80,\r\n            \"color\": \"red\"\r\n          }\r\n        ]\r\n      },\r\n      \"color\": {\r\n        \"mode\": \"thresholds\"\r\n      }\r\n    },\r\n    \"overrides\": []\r\n  },\r\n  \"pluginVersion\": \"9.0.2-2200920\",\r\n  \"timeFrom\": null,\r\n  \"timeShift\": null\r\n}\r\n```\r\n\u003c/details\u003e\r\n\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.2.5\r\n- Data source type \u0026 version: InflxDB 1.8\r\n- OS Grafana is installed on: Windows\r\n- User OS \u0026 Browser: Windows \u0026 Google Chrome\r\n- Grafana plugins: No\r\n\r\n","labels":["datasource/InfluxDB","prio/medium","stale","effort/medium"]},{"id":70515,"title":"Bar Chart does not change colors when defining Threshold values","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n  - Issue was initially reported on this community [post](https://community.grafana.com/t/threshold-color-for-bar-chart-not-working/88001)\r\n\r\n- The Bar chart seems to not show colors even after setting up threshold values.\r\n\r\n**What did you expect to happen**:\r\n\r\n  - The bar chart should so color bars based on the defined threshold values\r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Open Grafana and use Test DB (or any other) and create a bar chart (simply can use a CSV data for this)\r\n\r\n**Step 2**:\r\n\r\n- Now try to define some threshold values\r\n\r\n**Step 3**:\r\n\r\n- The panel does not reflect the colors based on the values\r\n\r\nI also tried it using the Override but does not seem to work.\r\n\n\n### \n# What Grafana version are you using?\n\n\n10.0.0\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### User's OS?\n\nNA\n\n### User's Browser?\n\nNA\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\nNo\n\n### Anything else to add?\n\n\n_No response_","labels":["needs more info","area/panel/barchart"]},{"id":80842,"title":"Dashboards: auto refresh not loaded correctly","body":"### What happened?\r\n\r\nOpening dashboard with set `refresh=auto` fails to properly load this value and fallbacks into disabled refresh.\r\n\r\n### What did you expect to happen?\r\n\r\nDashboard will open correctly with previously-saved value `refresh=auto`.\r\n\r\n### Did this work before?\r\n\r\nTried on versions 10.2.2 and 10.2.3 (latest) - both not working properly\r\n\r\n### How do we reproduce it?\r\n\r\n1. Create dashboard\r\n2. Set \"Refresh Interval\" in top-right corner to \"Auto\". Grafana automatically assigns refresh interval nicely.\r\n3. Get happy because you don't need to deal with this anymore and try to save your greatest dashboard :)\r\n\r\n   You see this so you are even more happy, because it gets saved:\r\n   \r\n   \u003cimg width=\"377\" alt=\"Screenshot 2024-01-18 at 21 29 40\" src=\"https://github.com/grafana/grafana/assets/783794/e71ccce4-c2e0-4b6e-a4e0-255f83b871e9\"\u003e\r\n   \r\n4. Go to other page in Grafana and try to load your dashboard again. Be sad, because your saved refresh config is not there anymore, refresh is disabled and you have to set it to auto everytime you enter your dashboard :(\r\n\r\n\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.2.2, 10.2.3\r\nOS: macOS Sonoma 14.2.1\r\nBrowser: Firefox 121.0\r\n\r\n\r\n### Grafana platform?\r\n\r\nKubernetes\r\n\r\n### Datasource(s)?\r\n\r\nPrometheus (from Mimir), Loki","labels":["type/bug","area/dashboard","team/grafana-dashboards"]},{"id":66194,"title":"v8.5 dashboard update HTTP API does not respect `id` or `uid` set in the request","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n[v8.5 Grafana HTTP update API](https://grafana.com/docs/grafana/v8.5/http_api/dashboard/#create--update-dashboard) doesn't seem to respect the `id` or `uid` set in the payload from an existing dashboard. Instead, it updates a dashboard with the same `title` instead.\r\n\r\nHere is my attempt updating title of a dashboard to be the same as another dashboard **in the same folder**:\r\n![Screenshot 2023-04-07 at 5 33 17 PM](https://user-images.githubusercontent.com/10676667/230695557-a92423c9-4555-4d3a-a870-6b22d8e20aea.png)\r\n(as you cam see in the last print statement, `O3Pnl5Y4z` was the uid of the dashboard I'm trying to update and used in the json payload, `hwq-lqb4k` is what actually got updated)\r\n\r\nHere is another attempt, the only difference from the previous run is that I did not update the title of the dashboard:\r\n![Screenshot 2023-04-07 at 5 35 31 PM](https://user-images.githubusercontent.com/10676667/230695652-d5e77044-81c2-4324-b294-88f6eebc83a5.png)\r\n\r\n\r\n**What you expected to happen**:\r\nwhen I update a dashboard, it should find the dashboard via `id` or `uid` in the request payload.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. create two dashboards with different titles (A and B)\r\n2. update the title of A to B, while specifying A's `id` and `uid` in the payload, with `overwirte` to be `true`\r\n3. observe that the update response is success(200), but with B's `id` and `uid` returned.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version:\r\n\"@grafana/data\": \"^8.5.10\",\r\n\"@grafana/experimental\": \"^1.0.2\",\r\n\"@grafana/runtime\": \"^8.5.10\",\r\n\"@grafana/ui\": \"^8.5.10\",\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/dashboard","bot/no new info"]},{"id":78035,"title":"Visualization Issue","body":"### What happened?\n\nHello, I updated Grafana to v.10.2.0 (895fbafb7a) 2 weeks ago and then I saw a problem with the panels. I use 2 types of panels. One of them is only for receiving alerts and I make them as small as possible, but on the main screen I see the values of the small panels and this spoils the visual.\r\n![Screenshot 2023-11-13 113759](https://github.com/grafana/grafana/assets/32447968/7f93322d-3501-4727-9ee8-465e8d979153)\r\n\n\n### What did you expect to happen?\n\nI don't want to see the values of the panels I minimized on the main screen\n\n### Did this work before?\n\nYes, the version was Grafana v10.1.5 (849c612fcb)\n\n### How do we reproduce it?\n\nvia getting back to visualization options from the older version maybe\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: Grafana v10.2.0 (895fbafb7a)\r\nOS:\r\nBrowser: Opera \r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\n_No response_","labels":["area/dashboard","team/grafana-dashboards"]},{"id":60937,"title":"Piechart proportion changes on resize","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:  the proportion of pie is shown as wrong in the dashboard, but when I view the pie in detail, the proportion turns to correct.\r\n\r\n**What you expected to happen**: the proportion of pie should be correct in the dashboard view.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: create the same data shown in the gif\r\n\r\n**Anything else we need to know?**:\r\n![img_v2_1cc82ca5-b01d-4132-8c6f-4a5305325f6g](https://user-images.githubusercontent.com/50096879/210479676-a6a6e31c-b93e-4112-8033-d461ab4f1540.gif)\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.0\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser: macOS chrome\r\n- Grafana plugins:\r\n- Others:\r\n- \r\n","labels":["type/bug","stale","area/panel/piechart"]},{"id":65316,"title":"Slack post `title_link` only goes to alerting page","body":"**What happened**:\r\nGrafana posts correctly to slack when an error fires \r\n\r\n\u003cimg width=\"605\" alt=\"image\" src=\"https://user-images.githubusercontent.com/2731258/227503135-878f314b-39e6-41ee-ab29-3b3a225dba21.png\"\u003e\r\n\r\nHowever, the slack `title_link` param is set to the alerting list (`https://grafana.mgmt.linkfire.co/alerting/list`) instead of the rule id\r\n\r\n**What you expected to happen**:\r\nThe slack title link should go to the rule id\r\n\r\n**Environment**:\r\n- Grafana version: v9.4.3\r\n- Data source type \u0026 version: Helm\r\n- User OS \u0026 Browser: Chrome\r\n- Grafana plugins: Using image renderer side car\r\n\r\n\r\nSlack authentication is setup using token auth. The panel reporting the alert has Panel ID and Dashboard UID set, and the app URL is correct. That seems to be all `GetRuleURL` needs (https://github.com/grafana/grafana/blob/3cfb7ac0ddec7ef200d6c9e6e39a933ccb6c44ab/pkg/services/alerting/eval_context.go#L138). There's also only one org for this Grafana instance","labels":["area/alerting","bot/no new info"]},{"id":79013,"title":"Prometheus: Lezer common only supports a few hundred binary expressions","body":"### What happened?\r\n\r\nWhen editing panel in my dashboard the cursor randomly jumps to the end. I haven't found a pattern, it just happens after a while. Sometimes I can type few words and sometimes it jumps on first keypress.\r\n\r\nIt does not happen when editing the same query in `explore`.\r\n\r\n[Screencast from 04.12.2023 12:51:26.webm](https://github.com/grafana/grafana/assets/12820484/84716e4a-849e-447f-8646-79e40c63cbdc)\r\n\r\n### What did you expect to happen?\r\n\r\nI can edit without the cursor jumping to the end.\r\n\r\n### Did this work before?\r\n\r\nIDK\r\n\r\n### How do we reproduce it?\r\n\r\nCreate a dashboard, create new panel there, edit panel query and observe these random jumps to the end.\r\n\r\nIt's more likely to happen with larger queries.\r\n\r\nI didn't reproduce it with this query:\r\n```\r\nwith (\r\n test = 1+1+1\r\n)\r\n1+1\r\n```\r\n\r\nIt was very easy to reproduce with this query:\r\n```\r\nwith (\r\n test = 1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+11+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1\r\n)\r\n1+1\r\n```\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n| Key | Value |\r\n|--|--|\r\n| Panel | timeseries @ 10.0.2 (unknown-dev) |\r\n| Grafana | 10.0.2 (unknown-dev) // Open Source |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"custom\": {\r\n            \"drawStyle\": \"line\",\r\n            \"lineInterpolation\": \"linear\",\r\n            \"barAlignment\": 0,\r\n            \"lineWidth\": 1,\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"spanNulls\": false,\r\n            \"showPoints\": \"auto\",\r\n            \"pointSize\": 5,\r\n            \"stacking\": {\r\n              \"mode\": \"none\",\r\n              \"group\": \"A\"\r\n            },\r\n            \"axisPlacement\": \"auto\",\r\n            \"axisLabel\": \"\",\r\n            \"axisColorMode\": \"text\",\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"axisCenteredZero\": false,\r\n            \"hideFrom\": {\r\n              \"tooltip\": false,\r\n              \"viz\": false,\r\n              \"legend\": false\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        },\r\n        \"legend\": {\r\n          \"showLegend\": true,\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"calcs\": []\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"grafana\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"snapshot\",\r\n          \"snapshot\": [\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"meta\": {\r\n                  \"type\": \"timeseries-multi\",\r\n                  \"typeVersion\": [\r\n                    0,\r\n                    1\r\n                  ],\r\n                  \"custom\": {\r\n                    \"resultType\": \"matrix\"\r\n                  },\r\n                  \"executedQueryString\": \"Expr: with (\\n test = 1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+11+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1\\n)\\n1+1\\nStep: 10s\",\r\n                  \"preferredVisualisationType\": \"graph\"\r\n                },\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"Time\",\r\n                    \"type\": \"time\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"time.Time\"\r\n                    },\r\n                    \"config\": {\r\n                      \"interval\": 10000\r\n                    }\r\n                  },\r\n                  {\r\n                    \"name\": \"Value\",\r\n                    \"type\": \"number\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"float64\"\r\n                    },\r\n                    \"labels\": {},\r\n                    \"config\": {\r\n                      \"displayNameFromDS\": \"with (\\n test = 1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+11+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1\\n)\\n1+1\"\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    1701669600000,\r\n                    1701669610000,\r\n                    1701669620000,\r\n                    1701669630000,\r\n                    1701669640000,\r\n                    1701669650000,\r\n                    1701669660000,\r\n                    1701669670000,\r\n                    1701669680000,\r\n                    1701669690000,\r\n                    1701669700000,\r\n                    1701669710000,\r\n                    1701669720000,\r\n                    1701669730000,\r\n                    1701669740000,\r\n                    1701669750000,\r\n                    1701669760000,\r\n                    1701669770000,\r\n                    1701669780000,\r\n                    1701669790000,\r\n                    1701669800000,\r\n                    1701669810000,\r\n                    1701669820000,\r\n                    1701669830000,\r\n                    1701669840000,\r\n                    1701669850000,\r\n                    1701669860000,\r\n                    1701669870000,\r\n                    1701669880000,\r\n                    1701669890000,\r\n                    1701669900000,\r\n                    1701669910000,\r\n                    1701669920000,\r\n                    1701669930000,\r\n                    1701669940000,\r\n                    1701669950000,\r\n                    1701669960000,\r\n                    1701669970000,\r\n                    1701669980000,\r\n                    1701669990000,\r\n                    1701670000000,\r\n                    1701670010000,\r\n                    1701670020000,\r\n                    1701670030000,\r\n                    1701670040000,\r\n                    1701670050000,\r\n                    1701670060000,\r\n                    1701670070000,\r\n                    1701670080000,\r\n                    1701670090000,\r\n                    1701670100000,\r\n                    1701670110000,\r\n                    1701670120000,\r\n                    1701670130000,\r\n                    1701670140000,\r\n                    1701670150000,\r\n                    1701670160000,\r\n                    1701670170000,\r\n                    1701670180000,\r\n                    1701670190000,\r\n                    1701670200000,\r\n                    1701670210000,\r\n                    1701670220000,\r\n                    1701670230000,\r\n                    1701670240000,\r\n                    1701670250000,\r\n                    1701670260000,\r\n                    1701670270000,\r\n                    1701670280000,\r\n                    1701670290000,\r\n                    1701670300000,\r\n                    1701670310000,\r\n                    1701670320000,\r\n                    1701670330000,\r\n                    1701670340000,\r\n                    1701670350000,\r\n                    1701670360000,\r\n                    1701670370000,\r\n                    1701670380000,\r\n                    1701670390000,\r\n                    1701670400000,\r\n                    1701670410000,\r\n                    1701670420000,\r\n                    1701670430000,\r\n                    1701670440000,\r\n                    1701670450000,\r\n                    1701670460000,\r\n                    1701670470000,\r\n                    1701670480000,\r\n                    1701670490000,\r\n                    1701670500000,\r\n                    1701670510000,\r\n                    1701670520000,\r\n                    1701670530000,\r\n                    1701670540000,\r\n                    1701670550000,\r\n                    1701670560000,\r\n                    1701670570000,\r\n                    1701670580000,\r\n                    1701670590000,\r\n                    1701670600000,\r\n                    1701670610000,\r\n                    1701670620000,\r\n                    1701670630000,\r\n                    1701670640000,\r\n                    1701670650000,\r\n                    1701670660000,\r\n                    1701670670000,\r\n                    1701670680000,\r\n                    1701670690000,\r\n                    1701670700000,\r\n                    1701670710000,\r\n                    1701670720000,\r\n                    1701670730000,\r\n                    1701670740000,\r\n                    1701670750000,\r\n                    1701670760000,\r\n                    1701670770000,\r\n                    1701670780000,\r\n                    1701670790000,\r\n                    1701670800000,\r\n                    1701670810000,\r\n                    1701670820000,\r\n                    1701670830000,\r\n                    1701670840000,\r\n                    1701670850000,\r\n                    1701670860000,\r\n                    1701670870000,\r\n                    1701670880000,\r\n                    1701670890000,\r\n                    1701670900000,\r\n                    1701670910000,\r\n                    1701670920000,\r\n                    1701670930000,\r\n                    1701670940000,\r\n                    1701670950000,\r\n                    1701670960000,\r\n                    1701670970000,\r\n                    1701670980000,\r\n                    1701670990000,\r\n                    1701671000000,\r\n                    1701671010000,\r\n                    1701671020000,\r\n                    1701671030000,\r\n                    1701671040000,\r\n                    1701671050000,\r\n                    1701671060000,\r\n                    1701671070000,\r\n                    1701671080000,\r\n                    1701671090000,\r\n                    1701671100000,\r\n                    1701671110000,\r\n                    1701671120000,\r\n                    1701671130000,\r\n                    1701671140000,\r\n                    1701671150000,\r\n                    1701671160000,\r\n                    1701671170000,\r\n                    1701671180000,\r\n                    1701671190000,\r\n                    1701671200000,\r\n                    1701671210000,\r\n                    1701671220000,\r\n                    1701671230000,\r\n                    1701671240000,\r\n                    1701671250000,\r\n                    1701671260000,\r\n                    1701671270000,\r\n                    1701671280000,\r\n                    1701671290000,\r\n                    1701671300000,\r\n                    1701671310000,\r\n                    1701671320000,\r\n                    1701671330000,\r\n                    1701671340000,\r\n                    1701671350000,\r\n                    1701671360000,\r\n                    1701671370000,\r\n                    1701671380000,\r\n                    1701671390000,\r\n                    1701671400000,\r\n                    1701671410000,\r\n                    1701671420000,\r\n                    1701671430000,\r\n                    1701671440000,\r\n                    1701671450000,\r\n                    1701671460000,\r\n                    1701671470000,\r\n                    1701671480000,\r\n                    1701671490000,\r\n                    1701671500000,\r\n                    1701671510000,\r\n                    1701671520000,\r\n                    1701671530000,\r\n                    1701671540000,\r\n                    1701671550000,\r\n                    1701671560000,\r\n                    1701671570000,\r\n                    1701671580000,\r\n                    1701671590000,\r\n                    1701671600000,\r\n                    1701671610000,\r\n                    1701671620000,\r\n                    1701671630000,\r\n                    1701671640000,\r\n                    1701671650000,\r\n                    1701671660000,\r\n                    1701671670000,\r\n                    1701671680000,\r\n                    1701671690000,\r\n                    1701671700000,\r\n                    1701671710000,\r\n                    1701671720000,\r\n                    1701671730000,\r\n                    1701671740000,\r\n                    1701671750000,\r\n                    1701671760000,\r\n                    1701671770000,\r\n                    1701671780000,\r\n                    1701671790000,\r\n                    1701671800000,\r\n                    1701671810000,\r\n                    1701671820000,\r\n                    1701671830000,\r\n                    1701671840000,\r\n                    1701671850000,\r\n                    1701671860000,\r\n                    1701671870000,\r\n                    1701671880000,\r\n                    1701671890000,\r\n                    1701671900000,\r\n                    1701671910000,\r\n                    1701671920000,\r\n                    1701671930000,\r\n                    1701671940000,\r\n                    1701671950000,\r\n                    1701671960000,\r\n                    1701671970000,\r\n                    1701671980000,\r\n                    1701671990000,\r\n                    1701672000000,\r\n                    1701672010000,\r\n                    1701672020000,\r\n                    1701672030000,\r\n                    1701672040000,\r\n                    1701672050000,\r\n                    1701672060000,\r\n                    1701672070000,\r\n                    1701672080000,\r\n                    1701672090000,\r\n                    1701672100000,\r\n                    1701672110000,\r\n                    1701672120000,\r\n                    1701672130000,\r\n                    1701672140000,\r\n                    1701672150000,\r\n                    1701672160000,\r\n                    1701672170000,\r\n                    1701672180000,\r\n                    1701672190000,\r\n                    1701672200000,\r\n                    1701672210000,\r\n                    1701672220000,\r\n                    1701672230000,\r\n                    1701672240000,\r\n                    1701672250000,\r\n                    1701672260000,\r\n                    1701672270000,\r\n                    1701672280000,\r\n                    1701672290000,\r\n                    1701672300000,\r\n                    1701672310000,\r\n                    1701672320000,\r\n                    1701672330000,\r\n                    1701672340000,\r\n                    1701672350000,\r\n                    1701672360000,\r\n                    1701672370000,\r\n                    1701672380000,\r\n                    1701672390000,\r\n                    1701672400000,\r\n                    1701672410000,\r\n                    1701672420000,\r\n                    1701672430000,\r\n                    1701672440000,\r\n                    1701672450000,\r\n                    1701672460000,\r\n                    1701672470000,\r\n                    1701672480000,\r\n                    1701672490000,\r\n                    1701672500000,\r\n                    1701672510000,\r\n                    1701672520000,\r\n                    1701672530000,\r\n                    1701672540000,\r\n                    1701672550000,\r\n                    1701672560000,\r\n                    1701672570000,\r\n                    1701672580000,\r\n                    1701672590000,\r\n                    1701672600000,\r\n                    1701672610000,\r\n                    1701672620000,\r\n                    1701672630000,\r\n                    1701672640000,\r\n                    1701672650000,\r\n                    1701672660000,\r\n                    1701672670000,\r\n                    1701672680000,\r\n                    1701672690000,\r\n                    1701672700000,\r\n                    1701672710000,\r\n                    1701672720000,\r\n                    1701672730000,\r\n                    1701672740000,\r\n                    1701672750000,\r\n                    1701672760000,\r\n                    1701672770000,\r\n                    1701672780000,\r\n                    1701672790000,\r\n                    1701672800000,\r\n                    1701672810000,\r\n                    1701672820000,\r\n                    1701672830000,\r\n                    1701672840000,\r\n                    1701672850000,\r\n                    1701672860000,\r\n                    1701672870000,\r\n                    1701672880000,\r\n                    1701672890000,\r\n                    1701672900000,\r\n                    1701672910000,\r\n                    1701672920000,\r\n                    1701672930000,\r\n                    1701672940000,\r\n                    1701672950000,\r\n                    1701672960000,\r\n                    1701672970000,\r\n                    1701672980000,\r\n                    1701672990000,\r\n                    1701673000000,\r\n                    1701673010000,\r\n                    1701673020000,\r\n                    1701673030000,\r\n                    1701673040000,\r\n                    1701673050000,\r\n                    1701673060000,\r\n                    1701673070000,\r\n                    1701673080000,\r\n                    1701673090000,\r\n                    1701673100000,\r\n                    1701673110000,\r\n                    1701673120000,\r\n                    1701673130000,\r\n                    1701673140000,\r\n                    1701673150000,\r\n                    1701673160000,\r\n                    1701673170000,\r\n                    1701673180000,\r\n                    1701673190000,\r\n                    1701673200000,\r\n                    1701673210000,\r\n                    1701673220000,\r\n                    1701673230000,\r\n                    1701673240000,\r\n                    1701673250000,\r\n                    1701673260000,\r\n                    1701673270000,\r\n                    1701673280000,\r\n                    1701673290000,\r\n                    1701673300000,\r\n                    1701673310000,\r\n                    1701673320000,\r\n                    1701673330000,\r\n                    1701673340000,\r\n                    1701673350000,\r\n                    1701673360000,\r\n                    1701673370000,\r\n                    1701673380000,\r\n                    1701673390000,\r\n                    1701673400000,\r\n                    1701673410000,\r\n                    1701673420000,\r\n                    1701673430000,\r\n                    1701673440000,\r\n                    1701673450000,\r\n                    1701673460000,\r\n                    1701673470000,\r\n                    1701673480000,\r\n                    1701673490000,\r\n                    1701673500000,\r\n                    1701673510000,\r\n                    1701673520000,\r\n                    1701673530000,\r\n                    1701673540000,\r\n                    1701673550000,\r\n                    1701673560000,\r\n                    1701673570000,\r\n                    1701673580000,\r\n                    1701673590000,\r\n                    1701673600000,\r\n                    1701673610000,\r\n                    1701673620000,\r\n                    1701673630000,\r\n                    1701673640000,\r\n                    1701673650000,\r\n                    1701673660000,\r\n                    1701673670000,\r\n                    1701673680000,\r\n                    1701673690000,\r\n                    1701673700000,\r\n                    1701673710000,\r\n                    1701673720000,\r\n                    1701673730000,\r\n                    1701673740000,\r\n                    1701673750000,\r\n                    1701673760000,\r\n                    1701673770000,\r\n                    1701673780000,\r\n                    1701673790000,\r\n                    1701673800000,\r\n                    1701673810000,\r\n                    1701673820000,\r\n                    1701673830000,\r\n                    1701673840000,\r\n                    1701673850000,\r\n                    1701673860000,\r\n                    1701673870000,\r\n                    1701673880000,\r\n                    1701673890000,\r\n                    1701673900000,\r\n                    1701673910000,\r\n                    1701673920000,\r\n                    1701673930000,\r\n                    1701673940000,\r\n                    1701673950000,\r\n                    1701673960000,\r\n                    1701673970000,\r\n                    1701673980000,\r\n                    1701673990000,\r\n                    1701674000000,\r\n                    1701674010000,\r\n                    1701674020000,\r\n                    1701674030000,\r\n                    1701674040000,\r\n                    1701674050000,\r\n                    1701674060000,\r\n                    1701674070000,\r\n                    1701674080000,\r\n                    1701674090000,\r\n                    1701674100000,\r\n                    1701674110000,\r\n                    1701674120000,\r\n                    1701674130000,\r\n                    1701674140000,\r\n                    1701674150000,\r\n                    1701674160000,\r\n                    1701674170000,\r\n                    1701674180000,\r\n                    1701674190000,\r\n                    1701674200000,\r\n                    1701674210000,\r\n                    1701674220000,\r\n                    1701674230000,\r\n                    1701674240000,\r\n                    1701674250000,\r\n                    1701674260000,\r\n                    1701674270000,\r\n                    1701674280000,\r\n                    1701674290000,\r\n                    1701674300000,\r\n                    1701674310000,\r\n                    1701674320000,\r\n                    1701674330000,\r\n                    1701674340000,\r\n                    1701674350000,\r\n                    1701674360000,\r\n                    1701674370000,\r\n                    1701674380000,\r\n                    1701674390000,\r\n                    1701674400000,\r\n                    1701674410000,\r\n                    1701674420000,\r\n                    1701674430000,\r\n                    1701674440000,\r\n                    1701674450000,\r\n                    1701674460000,\r\n                    1701674470000,\r\n                    1701674480000,\r\n                    1701674490000,\r\n                    1701674500000,\r\n                    1701674510000,\r\n                    1701674520000,\r\n                    1701674530000,\r\n                    1701674540000,\r\n                    1701674550000,\r\n                    1701674560000,\r\n                    1701674570000,\r\n                    1701674580000,\r\n                    1701674590000,\r\n                    1701674600000,\r\n                    1701674610000,\r\n                    1701674620000,\r\n                    1701674630000,\r\n                    1701674640000,\r\n                    1701674650000,\r\n                    1701674660000,\r\n                    1701674670000,\r\n                    1701674680000,\r\n                    1701674690000,\r\n                    1701674700000,\r\n                    1701674710000,\r\n                    1701674720000,\r\n                    1701674730000,\r\n                    1701674740000,\r\n                    1701674750000,\r\n                    1701674760000,\r\n                    1701674770000,\r\n                    1701674780000,\r\n                    1701674790000,\r\n                    1701674800000,\r\n                    1701674810000,\r\n                    1701674820000,\r\n                    1701674830000,\r\n                    1701674840000,\r\n                    1701674850000,\r\n                    1701674860000,\r\n                    1701674870000,\r\n                    1701674880000,\r\n                    1701674890000,\r\n                    1701674900000,\r\n                    1701674910000,\r\n                    1701674920000,\r\n                    1701674930000,\r\n                    1701674940000,\r\n                    1701674950000,\r\n                    1701674960000,\r\n                    1701674970000,\r\n                    1701674980000,\r\n                    1701674990000,\r\n                    1701675000000,\r\n                    1701675010000,\r\n                    1701675020000,\r\n                    1701675030000,\r\n                    1701675040000,\r\n                    1701675050000,\r\n                    1701675060000,\r\n                    1701675070000,\r\n                    1701675080000,\r\n                    1701675090000,\r\n                    1701675100000,\r\n                    1701675110000,\r\n                    1701675120000,\r\n                    1701675130000,\r\n                    1701675140000,\r\n                    1701675150000,\r\n                    1701675160000,\r\n                    1701675170000,\r\n                    1701675180000,\r\n                    1701675190000,\r\n                    1701675200000,\r\n                    1701675210000,\r\n                    1701675220000,\r\n                    1701675230000,\r\n                    1701675240000,\r\n                    1701675250000,\r\n                    1701675260000,\r\n                    1701675270000,\r\n                    1701675280000,\r\n                    1701675290000,\r\n                    1701675300000,\r\n                    1701675310000,\r\n                    1701675320000,\r\n                    1701675330000,\r\n                    1701675340000,\r\n                    1701675350000,\r\n                    1701675360000,\r\n                    1701675370000,\r\n                    1701675380000,\r\n                    1701675390000,\r\n                    1701675400000,\r\n                    1701675410000,\r\n                    1701675420000,\r\n                    1701675430000,\r\n                    1701675440000,\r\n                    1701675450000,\r\n                    1701675460000,\r\n                    1701675470000,\r\n                    1701675480000,\r\n                    1701675490000,\r\n                    1701675500000,\r\n                    1701675510000,\r\n                    1701675520000,\r\n                    1701675530000,\r\n                    1701675540000,\r\n                    1701675550000,\r\n                    1701675560000,\r\n                    1701675570000,\r\n                    1701675580000,\r\n                    1701675590000,\r\n                    1701675600000,\r\n                    1701675610000,\r\n                    1701675620000,\r\n                    1701675630000,\r\n                    1701675640000,\r\n                    1701675650000,\r\n                    1701675660000,\r\n                    1701675670000,\r\n                    1701675680000,\r\n                    1701675690000,\r\n                    1701675700000,\r\n                    1701675710000,\r\n                    1701675720000,\r\n                    1701675730000,\r\n                    1701675740000,\r\n                    1701675750000,\r\n                    1701675760000,\r\n                    1701675770000,\r\n                    1701675780000,\r\n                    1701675790000,\r\n                    1701675800000,\r\n                    1701675810000,\r\n                    1701675820000,\r\n                    1701675830000,\r\n                    1701675840000,\r\n                    1701675850000,\r\n                    1701675860000,\r\n                    1701675870000,\r\n                    1701675880000,\r\n                    1701675890000,\r\n                    1701675900000,\r\n                    1701675910000,\r\n                    1701675920000,\r\n                    1701675930000,\r\n                    1701675940000,\r\n                    1701675950000,\r\n                    1701675960000,\r\n                    1701675970000,\r\n                    1701675980000,\r\n                    1701675990000,\r\n                    1701676000000,\r\n                    1701676010000,\r\n                    1701676020000,\r\n                    1701676030000,\r\n                    1701676040000,\r\n                    1701676050000,\r\n                    1701676060000,\r\n                    1701676070000,\r\n                    1701676080000,\r\n                    1701676090000,\r\n                    1701676100000,\r\n                    1701676110000,\r\n                    1701676120000,\r\n                    1701676130000,\r\n                    1701676140000,\r\n                    1701676150000,\r\n                    1701676160000,\r\n                    1701676170000,\r\n                    1701676180000,\r\n                    1701676190000,\r\n                    1701676200000,\r\n                    1701676210000,\r\n                    1701676220000,\r\n                    1701676230000,\r\n                    1701676240000,\r\n                    1701676250000,\r\n                    1701676260000,\r\n                    1701676270000,\r\n                    1701676280000,\r\n                    1701676290000,\r\n                    1701676300000,\r\n                    1701676310000,\r\n                    1701676320000,\r\n                    1701676330000,\r\n                    1701676340000,\r\n                    1701676350000,\r\n                    1701676360000,\r\n                    1701676370000,\r\n                    1701676380000,\r\n                    1701676390000,\r\n                    1701676400000,\r\n                    1701676410000,\r\n                    1701676420000,\r\n                    1701676430000,\r\n                    1701676440000,\r\n                    1701676450000,\r\n                    1701676460000,\r\n                    1701676470000,\r\n                    1701676480000,\r\n                    1701676490000,\r\n                    1701676500000,\r\n                    1701676510000,\r\n                    1701676520000,\r\n                    1701676530000,\r\n                    1701676540000,\r\n                    1701676550000,\r\n                    1701676560000,\r\n                    1701676570000,\r\n                    1701676580000,\r\n                    1701676590000,\r\n                    1701676600000,\r\n                    1701676610000,\r\n                    1701676620000,\r\n                    1701676630000,\r\n                    1701676640000,\r\n                    1701676650000,\r\n                    1701676660000,\r\n                    1701676670000,\r\n                    1701676680000,\r\n                    1701676690000,\r\n                    1701676700000,\r\n                    1701676710000,\r\n                    1701676720000,\r\n                    1701676730000,\r\n                    1701676740000,\r\n                    1701676750000,\r\n                    1701676760000,\r\n                    1701676770000,\r\n                    1701676780000,\r\n                    1701676790000,\r\n                    1701676800000,\r\n                    1701676810000,\r\n                    1701676820000,\r\n                    1701676830000,\r\n                    1701676840000,\r\n                    1701676850000,\r\n                    1701676860000,\r\n                    1701676870000,\r\n                    1701676880000,\r\n                    1701676890000,\r\n                    1701676900000,\r\n                    1701676910000,\r\n                    1701676920000,\r\n                    1701676930000,\r\n                    1701676940000,\r\n                    1701676950000,\r\n                    1701676960000,\r\n                    1701676970000,\r\n                    1701676980000,\r\n                    1701676990000,\r\n                    1701677000000,\r\n                    1701677010000,\r\n                    1701677020000,\r\n                    1701677030000,\r\n                    1701677040000,\r\n                    1701677050000,\r\n                    1701677060000,\r\n                    1701677070000,\r\n                    1701677080000,\r\n                    1701677090000,\r\n                    1701677100000,\r\n                    1701677110000,\r\n                    1701677120000,\r\n                    1701677130000,\r\n                    1701677140000,\r\n                    1701677150000,\r\n                    1701677160000,\r\n                    1701677170000,\r\n                    1701677180000,\r\n                    1701677190000,\r\n                    1701677200000,\r\n                    1701677210000,\r\n                    1701677220000,\r\n                    1701677230000,\r\n                    1701677240000,\r\n                    1701677250000,\r\n                    1701677260000,\r\n                    1701677270000,\r\n                    1701677280000,\r\n                    1701677290000,\r\n                    1701677300000,\r\n                    1701677310000,\r\n                    1701677320000,\r\n                    1701677330000,\r\n                    1701677340000,\r\n                    1701677350000,\r\n                    1701677360000,\r\n                    1701677370000,\r\n                    1701677380000,\r\n                    1701677390000,\r\n                    1701677400000,\r\n                    1701677410000,\r\n                    1701677420000,\r\n                    1701677430000,\r\n                    1701677440000,\r\n                    1701677450000,\r\n                    1701677460000,\r\n                    1701677470000,\r\n                    1701677480000,\r\n                    1701677490000,\r\n                    1701677500000,\r\n                    1701677510000,\r\n                    1701677520000,\r\n                    1701677530000,\r\n                    1701677540000,\r\n                    1701677550000,\r\n                    1701677560000,\r\n                    1701677570000,\r\n                    1701677580000,\r\n                    1701677590000,\r\n                    1701677600000,\r\n                    1701677610000,\r\n                    1701677620000,\r\n                    1701677630000,\r\n                    1701677640000,\r\n                    1701677650000,\r\n                    1701677660000,\r\n                    1701677670000,\r\n                    1701677680000,\r\n                    1701677690000,\r\n                    1701677700000,\r\n                    1701677710000,\r\n                    1701677720000,\r\n                    1701677730000,\r\n                    1701677740000,\r\n                    1701677750000,\r\n                    1701677760000,\r\n                    1701677770000,\r\n                    1701677780000,\r\n                    1701677790000,\r\n                    1701677800000,\r\n                    1701677810000,\r\n                    1701677820000,\r\n                    1701677830000,\r\n                    1701677840000,\r\n                    1701677850000,\r\n                    1701677860000,\r\n                    1701677870000,\r\n                    1701677880000,\r\n                    1701677890000,\r\n                    1701677900000,\r\n                    1701677910000,\r\n                    1701677920000,\r\n                    1701677930000,\r\n                    1701677940000,\r\n                    1701677950000,\r\n                    1701677960000,\r\n                    1701677970000,\r\n                    1701677980000,\r\n                    1701677990000,\r\n                    1701678000000,\r\n                    1701678010000,\r\n                    1701678020000,\r\n                    1701678030000,\r\n                    1701678040000,\r\n                    1701678050000,\r\n                    1701678060000,\r\n                    1701678070000,\r\n                    1701678080000,\r\n                    1701678090000,\r\n                    1701678100000,\r\n                    1701678110000,\r\n                    1701678120000,\r\n                    1701678130000,\r\n                    1701678140000,\r\n                    1701678150000,\r\n                    1701678160000,\r\n                    1701678170000,\r\n                    1701678180000,\r\n                    1701678190000,\r\n                    1701678200000,\r\n                    1701678210000,\r\n                    1701678220000,\r\n                    1701678230000,\r\n                    1701678240000,\r\n                    1701678250000,\r\n                    1701678260000,\r\n                    1701678270000,\r\n                    1701678280000,\r\n                    1701678290000,\r\n                    1701678300000,\r\n                    1701678310000,\r\n                    1701678320000,\r\n                    1701678330000,\r\n                    1701678340000,\r\n                    1701678350000,\r\n                    1701678360000,\r\n                    1701678370000,\r\n                    1701678380000,\r\n                    1701678390000,\r\n                    1701678400000,\r\n                    1701678410000,\r\n                    1701678420000,\r\n                    1701678430000,\r\n                    1701678440000,\r\n                    1701678450000,\r\n                    1701678460000,\r\n                    1701678470000,\r\n                    1701678480000,\r\n                    1701678490000,\r\n                    1701678500000,\r\n                    1701678510000,\r\n                    1701678520000,\r\n                    1701678530000,\r\n                    1701678540000,\r\n                    1701678550000,\r\n                    1701678560000,\r\n                    1701678570000,\r\n                    1701678580000,\r\n                    1701678590000,\r\n                    1701678600000,\r\n                    1701678610000,\r\n                    1701678620000,\r\n                    1701678630000,\r\n                    1701678640000,\r\n                    1701678650000,\r\n                    1701678660000,\r\n                    1701678670000,\r\n                    1701678680000,\r\n                    1701678690000,\r\n                    1701678700000,\r\n                    1701678710000,\r\n                    1701678720000,\r\n                    1701678730000,\r\n                    1701678740000,\r\n                    1701678750000,\r\n                    1701678760000,\r\n                    1701678770000,\r\n                    1701678780000,\r\n                    1701678790000,\r\n                    1701678800000,\r\n                    1701678810000,\r\n                    1701678820000,\r\n                    1701678830000,\r\n                    1701678840000,\r\n                    1701678850000,\r\n                    1701678860000,\r\n                    1701678870000,\r\n                    1701678880000,\r\n                    1701678890000,\r\n                    1701678900000,\r\n                    1701678910000,\r\n                    1701678920000,\r\n                    1701678930000,\r\n                    1701678940000,\r\n                    1701678950000,\r\n                    1701678960000,\r\n                    1701678970000,\r\n                    1701678980000,\r\n                    1701678990000,\r\n                    1701679000000,\r\n                    1701679010000,\r\n                    1701679020000,\r\n                    1701679030000,\r\n                    1701679040000,\r\n                    1701679050000,\r\n                    1701679060000,\r\n                    1701679070000,\r\n                    1701679080000,\r\n                    1701679090000,\r\n                    1701679100000,\r\n                    1701679110000,\r\n                    1701679120000,\r\n                    1701679130000,\r\n                    1701679140000,\r\n                    1701679150000,\r\n                    1701679160000,\r\n                    1701679170000,\r\n                    1701679180000,\r\n                    1701679190000,\r\n                    1701679200000,\r\n                    1701679210000,\r\n                    1701679220000,\r\n                    1701679230000,\r\n                    1701679240000,\r\n                    1701679250000,\r\n                    1701679260000,\r\n                    1701679270000,\r\n                    1701679280000,\r\n                    1701679290000,\r\n                    1701679300000,\r\n                    1701679310000,\r\n                    1701679320000,\r\n                    1701679330000,\r\n                    1701679340000,\r\n                    1701679350000,\r\n                    1701679360000,\r\n                    1701679370000,\r\n                    1701679380000,\r\n                    1701679390000,\r\n                    1701679400000,\r\n                    1701679410000,\r\n                    1701679420000,\r\n                    1701679430000,\r\n                    1701679440000,\r\n                    1701679450000,\r\n                    1701679460000,\r\n                    1701679470000,\r\n                    1701679480000,\r\n                    1701679490000,\r\n                    1701679500000,\r\n                    1701679510000,\r\n                    1701679520000,\r\n                    1701679530000,\r\n                    1701679540000,\r\n                    1701679550000,\r\n                    1701679560000,\r\n                    1701679570000,\r\n                    1701679580000,\r\n                    1701679590000,\r\n                    1701679600000,\r\n                    1701679610000,\r\n                    1701679620000,\r\n                    1701679630000,\r\n                    1701679640000,\r\n                    1701679650000,\r\n                    1701679660000,\r\n                    1701679670000,\r\n                    1701679680000,\r\n                    1701679690000,\r\n                    1701679700000,\r\n                    1701679710000,\r\n                    1701679720000,\r\n                    1701679730000,\r\n                    1701679740000,\r\n                    1701679750000,\r\n                    1701679760000,\r\n                    1701679770000,\r\n                    1701679780000,\r\n                    1701679790000,\r\n                    1701679800000,\r\n                    1701679810000,\r\n                    1701679820000,\r\n                    1701679830000,\r\n                    1701679840000,\r\n                    1701679850000,\r\n                    1701679860000,\r\n                    1701679870000,\r\n                    1701679880000,\r\n                    1701679890000,\r\n                    1701679900000,\r\n                    1701679910000,\r\n                    1701679920000,\r\n                    1701679930000,\r\n                    1701679940000,\r\n                    1701679950000,\r\n                    1701679960000,\r\n                    1701679970000,\r\n                    1701679980000,\r\n                    1701679990000,\r\n                    1701680000000,\r\n                    1701680010000,\r\n                    1701680020000,\r\n                    1701680030000,\r\n                    1701680040000,\r\n                    1701680050000,\r\n                    1701680060000,\r\n                    1701680070000,\r\n                    1701680080000,\r\n                    1701680090000,\r\n                    1701680100000,\r\n                    1701680110000,\r\n                    1701680120000,\r\n                    1701680130000,\r\n                    1701680140000,\r\n                    1701680150000,\r\n                    1701680160000,\r\n                    1701680170000,\r\n                    1701680180000,\r\n                    1701680190000,\r\n                    1701680200000,\r\n                    1701680210000,\r\n                    1701680220000,\r\n                    1701680230000,\r\n                    1701680240000,\r\n                    1701680250000,\r\n                    1701680260000,\r\n                    1701680270000,\r\n                    1701680280000,\r\n                    1701680290000,\r\n                    1701680300000,\r\n                    1701680310000,\r\n                    1701680320000,\r\n                    1701680330000,\r\n                    1701680340000,\r\n                    1701680350000,\r\n                    1701680360000,\r\n                    1701680370000,\r\n                    1701680380000,\r\n                    1701680390000,\r\n                    1701680400000,\r\n                    1701680410000,\r\n                    1701680420000,\r\n                    1701680430000,\r\n                    1701680440000,\r\n                    1701680450000,\r\n                    1701680460000,\r\n                    1701680470000,\r\n                    1701680480000,\r\n                    1701680490000,\r\n                    1701680500000,\r\n                    1701680510000,\r\n                    1701680520000,\r\n                    1701680530000,\r\n                    1701680540000,\r\n                    1701680550000,\r\n                    1701680560000,\r\n                    1701680570000,\r\n                    1701680580000,\r\n                    1701680590000,\r\n                    1701680600000,\r\n                    1701680610000,\r\n                    1701680620000,\r\n                    1701680630000,\r\n                    1701680640000,\r\n                    1701680650000,\r\n                    1701680660000,\r\n                    1701680670000,\r\n                    1701680680000,\r\n                    1701680690000,\r\n                    1701680700000,\r\n                    1701680710000,\r\n                    1701680720000,\r\n                    1701680730000,\r\n                    1701680740000,\r\n                    1701680750000,\r\n                    1701680760000,\r\n                    1701680770000,\r\n                    1701680780000,\r\n                    1701680790000,\r\n                    1701680800000,\r\n                    1701680810000,\r\n                    1701680820000,\r\n                    1701680830000,\r\n                    1701680840000,\r\n                    1701680850000,\r\n                    1701680860000,\r\n                    1701680870000,\r\n                    1701680880000,\r\n                    1701680890000,\r\n                    1701680900000,\r\n                    1701680910000,\r\n                    1701680920000,\r\n                    1701680930000,\r\n                    1701680940000,\r\n                    1701680950000,\r\n                    1701680960000,\r\n                    1701680970000,\r\n                    1701680980000,\r\n                    1701680990000,\r\n                    1701681000000,\r\n                    1701681010000,\r\n                    1701681020000,\r\n                    1701681030000,\r\n                    1701681040000,\r\n                    1701681050000,\r\n                    1701681060000,\r\n                    1701681070000,\r\n                    1701681080000,\r\n                    1701681090000,\r\n                    1701681100000,\r\n                    1701681110000,\r\n                    1701681120000,\r\n                    1701681130000,\r\n                    1701681140000,\r\n                    1701681150000,\r\n                    1701681160000,\r\n                    1701681170000,\r\n                    1701681180000,\r\n                    1701681190000,\r\n                    1701681200000,\r\n                    1701681210000,\r\n                    1701681220000,\r\n                    1701681230000,\r\n                    1701681240000,\r\n                    1701681250000,\r\n                    1701681260000,\r\n                    1701681270000,\r\n                    1701681280000,\r\n                    1701681290000,\r\n                    1701681300000,\r\n                    1701681310000,\r\n                    1701681320000,\r\n                    1701681330000,\r\n                    1701681340000,\r\n                    1701681350000,\r\n                    1701681360000,\r\n                    1701681370000,\r\n                    1701681380000,\r\n                    1701681390000,\r\n                    1701681400000,\r\n                    1701681410000,\r\n                    1701681420000,\r\n                    1701681430000,\r\n                    1701681440000,\r\n                    1701681450000,\r\n                    1701681460000,\r\n                    1701681470000,\r\n                    1701681480000,\r\n                    1701681490000,\r\n                    1701681500000,\r\n                    1701681510000,\r\n                    1701681520000,\r\n                    1701681530000,\r\n                    1701681540000,\r\n                    1701681550000,\r\n                    1701681560000,\r\n                    1701681570000,\r\n                    1701681580000,\r\n                    1701681590000,\r\n                    1701681600000,\r\n                    1701681610000,\r\n                    1701681620000,\r\n                    1701681630000,\r\n                    1701681640000,\r\n                    1701681650000,\r\n                    1701681660000,\r\n                    1701681670000,\r\n                    1701681680000,\r\n                    1701681690000,\r\n                    1701681700000,\r\n                    1701681710000,\r\n                    1701681720000,\r\n                    1701681730000,\r\n                    1701681740000,\r\n                    1701681750000,\r\n                    1701681760000,\r\n                    1701681770000,\r\n                    1701681780000,\r\n                    1701681790000,\r\n                    1701681800000,\r\n                    1701681810000,\r\n                    1701681820000,\r\n                    1701681830000,\r\n                    1701681840000,\r\n                    1701681850000,\r\n                    1701681860000,\r\n                    1701681870000,\r\n                    1701681880000,\r\n                    1701681890000,\r\n                    1701681900000,\r\n                    1701681910000,\r\n                    1701681920000,\r\n                    1701681930000,\r\n                    1701681940000,\r\n                    1701681950000,\r\n                    1701681960000,\r\n                    1701681970000,\r\n                    1701681980000,\r\n                    1701681990000,\r\n                    1701682000000,\r\n                    1701682010000,\r\n                    1701682020000,\r\n                    1701682030000,\r\n                    1701682040000,\r\n                    1701682050000,\r\n                    1701682060000,\r\n                    1701682070000,\r\n                    1701682080000,\r\n                    1701682090000,\r\n                    1701682100000,\r\n                    1701682110000,\r\n                    1701682120000,\r\n                    1701682130000,\r\n                    1701682140000,\r\n                    1701682150000,\r\n                    1701682160000,\r\n                    1701682170000,\r\n                    1701682180000,\r\n                    1701682190000,\r\n                    1701682200000,\r\n                    1701682210000,\r\n                    1701682220000,\r\n                    1701682230000,\r\n                    1701682240000,\r\n                    1701682250000,\r\n                    1701682260000,\r\n                    1701682270000,\r\n                    1701682280000,\r\n                    1701682290000,\r\n                    1701682300000,\r\n                    1701682310000,\r\n                    1701682320000,\r\n                    1701682330000,\r\n                    1701682340000,\r\n                    1701682350000,\r\n                    1701682360000,\r\n                    1701682370000,\r\n                    1701682380000,\r\n                    1701682390000,\r\n                    1701682400000,\r\n                    1701682410000,\r\n                    1701682420000,\r\n                    1701682430000,\r\n                    1701682440000,\r\n                    1701682450000,\r\n                    1701682460000,\r\n                    1701682470000,\r\n                    1701682480000,\r\n                    1701682490000,\r\n                    1701682500000,\r\n                    1701682510000,\r\n                    1701682520000,\r\n                    1701682530000,\r\n                    1701682540000,\r\n                    1701682550000,\r\n                    1701682560000,\r\n                    1701682570000,\r\n                    1701682580000,\r\n                    1701682590000,\r\n                    1701682600000,\r\n                    1701682610000,\r\n                    1701682620000,\r\n                    1701682630000,\r\n                    1701682640000,\r\n                    1701682650000,\r\n                    1701682660000,\r\n                    1701682670000,\r\n                    1701682680000,\r\n                    1701682690000,\r\n                    1701682700000,\r\n                    1701682710000,\r\n                    1701682720000,\r\n                    1701682730000,\r\n                    1701682740000,\r\n                    1701682750000,\r\n                    1701682760000,\r\n                    1701682770000,\r\n                    1701682780000,\r\n                    1701682790000,\r\n                    1701682800000,\r\n                    1701682810000,\r\n                    1701682820000,\r\n                    1701682830000,\r\n                    1701682840000,\r\n                    1701682850000,\r\n                    1701682860000,\r\n                    1701682870000,\r\n                    1701682880000,\r\n                    1701682890000,\r\n                    1701682900000,\r\n                    1701682910000,\r\n                    1701682920000,\r\n                    1701682930000,\r\n                    1701682940000,\r\n                    1701682950000,\r\n                    1701682960000,\r\n                    1701682970000,\r\n                    1701682980000,\r\n                    1701682990000,\r\n                    1701683000000,\r\n                    1701683010000,\r\n                    1701683020000,\r\n                    1701683030000,\r\n                    1701683040000,\r\n                    1701683050000,\r\n                    1701683060000,\r\n                    1701683070000,\r\n                    1701683080000,\r\n                    1701683090000,\r\n                    1701683100000,\r\n                    1701683110000,\r\n                    1701683120000,\r\n                    1701683130000,\r\n                    1701683140000,\r\n                    1701683150000,\r\n                    1701683160000,\r\n                    1701683170000,\r\n                    1701683180000,\r\n                    1701683190000,\r\n                    1701683200000,\r\n                    1701683210000,\r\n                    1701683220000,\r\n                    1701683230000,\r\n                    1701683240000,\r\n                    1701683250000,\r\n                    1701683260000,\r\n                    1701683270000,\r\n                    1701683280000,\r\n                    1701683290000,\r\n                    1701683300000,\r\n                    1701683310000,\r\n                    1701683320000,\r\n                    1701683330000,\r\n                    1701683340000,\r\n                    1701683350000,\r\n                    1701683360000,\r\n                    1701683370000,\r\n                    1701683380000,\r\n                    1701683390000,\r\n                    1701683400000,\r\n                    1701683410000,\r\n                    1701683420000,\r\n                    1701683430000,\r\n                    1701683440000,\r\n                    1701683450000,\r\n                    1701683460000,\r\n                    1701683470000,\r\n                    1701683480000,\r\n                    1701683490000,\r\n                    1701683500000,\r\n                    1701683510000,\r\n                    1701683520000,\r\n                    1701683530000,\r\n                    1701683540000,\r\n                    1701683550000,\r\n                    1701683560000,\r\n                    1701683570000,\r\n                    1701683580000,\r\n                    1701683590000,\r\n                    1701683600000,\r\n                    1701683610000,\r\n                    1701683620000,\r\n                    1701683630000,\r\n                    1701683640000,\r\n                    1701683650000,\r\n                    1701683660000,\r\n                    1701683670000,\r\n                    1701683680000,\r\n                    1701683690000,\r\n                    1701683700000,\r\n                    1701683710000,\r\n                    1701683720000,\r\n                    1701683730000,\r\n                    1701683740000,\r\n                    1701683750000,\r\n                    1701683760000,\r\n                    1701683770000,\r\n                    1701683780000,\r\n                    1701683790000,\r\n                    1701683800000,\r\n                    1701683810000,\r\n                    1701683820000,\r\n                    1701683830000,\r\n                    1701683840000,\r\n                    1701683850000,\r\n                    1701683860000,\r\n                    1701683870000,\r\n                    1701683880000,\r\n                    1701683890000,\r\n                    1701683900000,\r\n                    1701683910000,\r\n                    1701683920000,\r\n                    1701683930000,\r\n                    1701683940000,\r\n                    1701683950000,\r\n                    1701683960000,\r\n                    1701683970000,\r\n                    1701683980000,\r\n                    1701683990000,\r\n                    1701684000000,\r\n                    1701684010000,\r\n                    1701684020000,\r\n                    1701684030000,\r\n                    1701684040000,\r\n                    1701684050000,\r\n                    1701684060000,\r\n                    1701684070000,\r\n                    1701684080000,\r\n                    1701684090000,\r\n                    1701684100000,\r\n                    1701684110000,\r\n                    1701684120000,\r\n                    1701684130000,\r\n                    1701684140000,\r\n                    1701684150000,\r\n                    1701684160000,\r\n                    1701684170000,\r\n                    1701684180000,\r\n                    1701684190000,\r\n                    1701684200000,\r\n                    1701684210000,\r\n                    1701684220000,\r\n                    1701684230000,\r\n                    1701684240000,\r\n                    1701684250000,\r\n                    1701684260000,\r\n                    1701684270000,\r\n                    1701684280000,\r\n                    1701684290000,\r\n                    1701684300000,\r\n                    1701684310000,\r\n                    1701684320000,\r\n                    1701684330000,\r\n                    1701684340000,\r\n                    1701684350000,\r\n                    1701684360000,\r\n                    1701684370000,\r\n                    1701684380000,\r\n                    1701684390000,\r\n                    1701684400000,\r\n                    1701684410000,\r\n                    1701684420000,\r\n                    1701684430000,\r\n                    1701684440000,\r\n                    1701684450000,\r\n                    1701684460000,\r\n                    1701684470000,\r\n                    1701684480000,\r\n                    1701684490000,\r\n                    1701684500000,\r\n                    1701684510000,\r\n                    1701684520000,\r\n                    1701684530000,\r\n                    1701684540000,\r\n                    1701684550000,\r\n                    1701684560000,\r\n                    1701684570000,\r\n                    1701684580000,\r\n                    1701684590000,\r\n                    1701684600000,\r\n                    1701684610000,\r\n                    1701684620000,\r\n                    1701684630000,\r\n                    1701684640000,\r\n                    1701684650000,\r\n                    1701684660000,\r\n                    1701684670000,\r\n                    1701684680000,\r\n                    1701684690000,\r\n                    1701684700000,\r\n                    1701684710000,\r\n                    1701684720000,\r\n                    1701684730000,\r\n                    1701684740000,\r\n                    1701684750000,\r\n                    1701684760000,\r\n                    1701684770000,\r\n                    1701684780000,\r\n                    1701684790000,\r\n                    1701684800000,\r\n                    1701684810000,\r\n                    1701684820000,\r\n                    1701684830000,\r\n                    1701684840000,\r\n                    1701684850000,\r\n                    1701684860000,\r\n                    1701684870000,\r\n                    1701684880000,\r\n                    1701684890000,\r\n                    1701684900000,\r\n                    1701684910000,\r\n                    1701684920000,\r\n                    1701684930000,\r\n                    1701684940000,\r\n                    1701684950000,\r\n                    1701684960000,\r\n                    1701684970000,\r\n                    1701684980000,\r\n                    1701684990000,\r\n                    1701685000000,\r\n                    1701685010000,\r\n                    1701685020000,\r\n                    1701685030000,\r\n                    1701685040000,\r\n                    1701685050000,\r\n                    1701685060000,\r\n                    1701685070000,\r\n                    1701685080000,\r\n                    1701685090000,\r\n                    1701685100000,\r\n                    1701685110000,\r\n                    1701685120000,\r\n                    1701685130000,\r\n                    1701685140000,\r\n                    1701685150000,\r\n                    1701685160000,\r\n                    1701685170000,\r\n                    1701685180000,\r\n                    1701685190000,\r\n                    1701685200000,\r\n                    1701685210000,\r\n                    1701685220000,\r\n                    1701685230000,\r\n                    1701685240000,\r\n                    1701685250000,\r\n                    1701685260000,\r\n                    1701685270000,\r\n                    1701685280000,\r\n                    1701685290000,\r\n                    1701685300000,\r\n                    1701685310000,\r\n                    1701685320000,\r\n                    1701685330000,\r\n                    1701685340000,\r\n                    1701685350000,\r\n                    1701685360000,\r\n                    1701685370000,\r\n                    1701685380000,\r\n                    1701685390000,\r\n                    1701685400000,\r\n                    1701685410000,\r\n                    1701685420000,\r\n                    1701685430000,\r\n                    1701685440000,\r\n                    1701685450000,\r\n                    1701685460000,\r\n                    1701685470000,\r\n                    1701685480000,\r\n                    1701685490000,\r\n                    1701685500000,\r\n                    1701685510000,\r\n                    1701685520000,\r\n                    1701685530000,\r\n                    1701685540000,\r\n                    1701685550000,\r\n                    1701685560000,\r\n                    1701685570000,\r\n                    1701685580000,\r\n                    1701685590000,\r\n                    1701685600000,\r\n                    1701685610000,\r\n                    1701685620000,\r\n                    1701685630000,\r\n                    1701685640000,\r\n                    1701685650000,\r\n                    1701685660000,\r\n                    1701685670000,\r\n                    1701685680000,\r\n                    1701685690000,\r\n                    1701685700000,\r\n                    1701685710000,\r\n                    1701685720000,\r\n                    1701685730000,\r\n                    1701685740000,\r\n                    1701685750000,\r\n                    1701685760000,\r\n                    1701685770000,\r\n                    1701685780000,\r\n                    1701685790000,\r\n                    1701685800000,\r\n                    1701685810000,\r\n                    1701685820000,\r\n                    1701685830000,\r\n                    1701685840000,\r\n                    1701685850000,\r\n                    1701685860000,\r\n                    1701685870000,\r\n                    1701685880000,\r\n                    1701685890000,\r\n                    1701685900000,\r\n                    1701685910000,\r\n                    1701685920000,\r\n                    1701685930000,\r\n                    1701685940000,\r\n                    1701685950000,\r\n                    1701685960000,\r\n                    1701685970000,\r\n                    1701685980000,\r\n                    1701685990000,\r\n                    1701686000000,\r\n                    1701686010000,\r\n                    1701686020000,\r\n                    1701686030000,\r\n                    1701686040000,\r\n                    1701686050000,\r\n                    1701686060000,\r\n                    1701686070000,\r\n                    1701686080000,\r\n                    1701686090000,\r\n                    1701686100000,\r\n                    1701686110000,\r\n                    1701686120000,\r\n                    1701686130000,\r\n                    1701686140000,\r\n                    1701686150000,\r\n                    1701686160000,\r\n                    1701686170000,\r\n                    1701686180000,\r\n                    1701686190000,\r\n                    1701686200000,\r\n                    1701686210000,\r\n                    1701686220000,\r\n                    1701686230000,\r\n                    1701686240000,\r\n                    1701686250000,\r\n                    1701686260000,\r\n                    1701686270000,\r\n                    1701686280000,\r\n                    1701686290000,\r\n                    1701686300000,\r\n                    1701686310000,\r\n                    1701686320000,\r\n                    1701686330000,\r\n                    1701686340000,\r\n                    1701686350000,\r\n                    1701686360000,\r\n                    1701686370000,\r\n                    1701686380000,\r\n                    1701686390000,\r\n                    1701686400000,\r\n                    1701686410000,\r\n                    1701686420000,\r\n                    1701686430000,\r\n                    1701686440000,\r\n                    1701686450000,\r\n                    1701686460000,\r\n                    1701686470000,\r\n                    1701686480000,\r\n                    1701686490000,\r\n                    1701686500000,\r\n                    1701686510000,\r\n                    1701686520000,\r\n                    1701686530000,\r\n                    1701686540000,\r\n                    1701686550000,\r\n                    1701686560000,\r\n                    1701686570000,\r\n                    1701686580000,\r\n                    1701686590000,\r\n                    1701686600000,\r\n                    1701686610000,\r\n                    1701686620000,\r\n                    1701686630000,\r\n                    1701686640000,\r\n                    1701686650000,\r\n                    1701686660000,\r\n                    1701686670000,\r\n                    1701686680000,\r\n                    1701686690000,\r\n                    1701686700000,\r\n                    1701686710000,\r\n                    1701686720000,\r\n                    1701686730000,\r\n                    1701686740000,\r\n                    1701686750000,\r\n                    1701686760000,\r\n                    1701686770000,\r\n                    1701686780000,\r\n                    1701686790000,\r\n                    1701686800000,\r\n                    1701686810000,\r\n                    1701686820000,\r\n                    1701686830000,\r\n                    1701686840000,\r\n                    1701686850000,\r\n                    1701686860000,\r\n                    1701686870000,\r\n                    1701686880000,\r\n                    1701686890000,\r\n                    1701686900000,\r\n                    1701686910000,\r\n                    1701686920000,\r\n                    1701686930000,\r\n                    1701686940000,\r\n                    1701686950000,\r\n                    1701686960000,\r\n                    1701686970000,\r\n                    1701686980000,\r\n                    1701686990000,\r\n                    1701687000000,\r\n                    1701687010000,\r\n                    1701687020000,\r\n                    1701687030000,\r\n                    1701687040000,\r\n                    1701687050000,\r\n                    1701687060000,\r\n                    1701687070000,\r\n                    1701687080000,\r\n                    1701687090000,\r\n                    1701687100000,\r\n                    1701687110000,\r\n                    1701687120000,\r\n                    1701687130000,\r\n                    1701687140000,\r\n                    1701687150000,\r\n                    1701687160000,\r\n                    1701687170000,\r\n                    1701687180000,\r\n                    1701687190000,\r\n                    1701687200000,\r\n                    1701687210000,\r\n                    1701687220000,\r\n                    1701687230000,\r\n                    1701687240000,\r\n                    1701687250000,\r\n                    1701687260000,\r\n                    1701687270000,\r\n                    1701687280000,\r\n                    1701687290000,\r\n                    1701687300000,\r\n                    1701687310000,\r\n                    1701687320000,\r\n                    1701687330000,\r\n                    1701687340000,\r\n                    1701687350000,\r\n                    1701687360000,\r\n                    1701687370000,\r\n                    1701687380000,\r\n                    1701687390000,\r\n                    1701687400000,\r\n                    1701687410000,\r\n                    1701687420000,\r\n                    1701687430000,\r\n                    1701687440000,\r\n                    1701687450000,\r\n                    1701687460000,\r\n                    1701687470000,\r\n                    1701687480000,\r\n                    1701687490000,\r\n                    1701687500000,\r\n                    1701687510000,\r\n                    1701687520000,\r\n                    1701687530000,\r\n                    1701687540000,\r\n                    1701687550000,\r\n                    1701687560000,\r\n                    1701687570000,\r\n                    1701687580000,\r\n                    1701687590000,\r\n                    1701687600000,\r\n                    1701687610000,\r\n                    1701687620000,\r\n                    1701687630000,\r\n                    1701687640000,\r\n                    1701687650000,\r\n                    1701687660000,\r\n                    1701687670000,\r\n                    1701687680000,\r\n                    1701687690000,\r\n                    1701687700000,\r\n                    1701687710000,\r\n                    1701687720000,\r\n                    1701687730000,\r\n                    1701687740000,\r\n                    1701687750000,\r\n                    1701687760000,\r\n                    1701687770000,\r\n                    1701687780000,\r\n                    1701687790000,\r\n                    1701687800000,\r\n                    1701687810000,\r\n                    1701687820000,\r\n                    1701687830000,\r\n                    1701687840000,\r\n                    1701687850000,\r\n                    1701687860000,\r\n                    1701687870000,\r\n                    1701687880000,\r\n                    1701687890000,\r\n                    1701687900000,\r\n                    1701687910000,\r\n                    1701687920000,\r\n                    1701687930000,\r\n                    1701687940000,\r\n                    1701687950000,\r\n                    1701687960000,\r\n                    1701687970000,\r\n                    1701687980000,\r\n                    1701687990000,\r\n                    1701688000000,\r\n                    1701688010000,\r\n                    1701688020000,\r\n                    1701688030000,\r\n                    1701688040000,\r\n                    1701688050000,\r\n                    1701688060000,\r\n                    1701688070000,\r\n                    1701688080000,\r\n                    1701688090000,\r\n                    1701688100000,\r\n                    1701688110000,\r\n                    1701688120000,\r\n                    1701688130000,\r\n                    1701688140000,\r\n                    1701688150000,\r\n                    1701688160000,\r\n                    1701688170000,\r\n                    1701688180000,\r\n                    1701688190000,\r\n                    1701688200000,\r\n                    1701688210000,\r\n                    1701688220000,\r\n                    1701688230000,\r\n                    1701688240000,\r\n                    1701688250000,\r\n                    1701688260000,\r\n                    1701688270000,\r\n                    1701688280000,\r\n                    1701688290000,\r\n                    1701688300000,\r\n                    1701688310000,\r\n                    1701688320000,\r\n                    1701688330000,\r\n                    1701688340000,\r\n                    1701688350000,\r\n                    1701688360000,\r\n                    1701688370000,\r\n                    1701688380000,\r\n                    1701688390000,\r\n                    1701688400000,\r\n                    1701688410000,\r\n                    1701688420000,\r\n                    1701688430000,\r\n                    1701688440000,\r\n                    1701688450000,\r\n                    1701688460000,\r\n                    1701688470000,\r\n                    1701688480000,\r\n                    1701688490000,\r\n                    1701688500000,\r\n                    1701688510000,\r\n                    1701688520000,\r\n                    1701688530000,\r\n                    1701688540000,\r\n                    1701688550000,\r\n                    1701688560000,\r\n                    1701688570000,\r\n                    1701688580000,\r\n                    1701688590000,\r\n                    1701688600000,\r\n                    1701688610000,\r\n                    1701688620000,\r\n                    1701688630000,\r\n                    1701688640000,\r\n                    1701688650000,\r\n                    1701688660000,\r\n                    1701688670000,\r\n                    1701688680000,\r\n                    1701688690000,\r\n                    1701688700000,\r\n                    1701688710000,\r\n                    1701688720000,\r\n                    1701688730000,\r\n                    1701688740000,\r\n                    1701688750000,\r\n                    1701688760000,\r\n                    1701688770000,\r\n                    1701688780000,\r\n                    1701688790000,\r\n                    1701688800000,\r\n                    1701688810000,\r\n                    1701688820000,\r\n                    1701688830000,\r\n                    1701688840000,\r\n                    1701688850000,\r\n                    1701688860000,\r\n                    1701688870000,\r\n                    1701688880000,\r\n                    1701688890000,\r\n                    1701688900000,\r\n                    1701688910000,\r\n                    1701688920000,\r\n                    1701688930000,\r\n                    1701688940000,\r\n                    1701688950000,\r\n                    1701688960000,\r\n                    1701688970000,\r\n                    1701688980000,\r\n                    1701688990000,\r\n                    1701689000000,\r\n                    1701689010000,\r\n                    1701689020000,\r\n                    1701689030000,\r\n                    1701689040000,\r\n                    1701689050000,\r\n                    1701689060000,\r\n                    1701689070000,\r\n                    1701689080000,\r\n                    1701689090000,\r\n                    1701689100000,\r\n                    1701689110000,\r\n                    1701689120000,\r\n                    1701689130000,\r\n                    1701689140000,\r\n                    1701689150000,\r\n                    1701689160000,\r\n                    1701689170000,\r\n                    1701689180000,\r\n                    1701689190000,\r\n                    1701689200000,\r\n                    1701689210000,\r\n                    1701689220000,\r\n                    1701689230000,\r\n                    1701689240000,\r\n                    1701689250000,\r\n                    1701689260000,\r\n                    1701689270000,\r\n                    1701689280000,\r\n                    1701689290000,\r\n                    1701689300000,\r\n                    1701689310000,\r\n                    1701689320000,\r\n                    1701689330000,\r\n                    1701689340000,\r\n                    1701689350000,\r\n                    1701689360000,\r\n                    1701689370000,\r\n                    1701689380000,\r\n                    1701689390000,\r\n                    1701689400000,\r\n                    1701689410000,\r\n                    1701689420000,\r\n                    1701689430000,\r\n                    1701689440000,\r\n                    1701689450000,\r\n                    1701689460000,\r\n                    1701689470000,\r\n                    1701689480000,\r\n                    1701689490000,\r\n                    1701689500000,\r\n                    1701689510000,\r\n                    1701689520000,\r\n                    1701689530000,\r\n                    1701689540000,\r\n                    1701689550000,\r\n                    1701689560000,\r\n                    1701689570000,\r\n                    1701689580000,\r\n                    1701689590000,\r\n                    1701689600000,\r\n                    1701689610000,\r\n                    1701689620000,\r\n                    1701689630000,\r\n                    1701689640000,\r\n                    1701689650000,\r\n                    1701689660000,\r\n                    1701689670000,\r\n                    1701689680000,\r\n                    1701689690000,\r\n                    1701689700000,\r\n                    1701689710000,\r\n                    1701689720000,\r\n                    1701689730000,\r\n                    1701689740000,\r\n                    1701689750000,\r\n                    1701689760000,\r\n                    1701689770000,\r\n                    1701689780000,\r\n                    1701689790000,\r\n                    1701689800000,\r\n                    1701689810000,\r\n                    1701689820000,\r\n                    1701689830000,\r\n                    1701689840000,\r\n                    1701689850000,\r\n                    1701689860000,\r\n                    1701689870000,\r\n                    1701689880000,\r\n                    1701689890000,\r\n                    1701689900000,\r\n                    1701689910000,\r\n                    1701689920000,\r\n                    1701689930000,\r\n                    1701689940000,\r\n                    1701689950000,\r\n                    1701689960000,\r\n                    1701689970000,\r\n                    1701689980000,\r\n                    1701689990000,\r\n                    1701690000000,\r\n                    1701690010000,\r\n                    1701690020000,\r\n                    1701690030000,\r\n                    1701690040000,\r\n                    1701690050000,\r\n                    1701690060000,\r\n                    1701690070000,\r\n                    1701690080000,\r\n                    1701690090000,\r\n                    1701690100000,\r\n                    1701690110000,\r\n                    1701690120000,\r\n                    1701690130000,\r\n                    1701690140000,\r\n                    1701690150000,\r\n                    1701690160000,\r\n                    1701690170000,\r\n                    1701690180000,\r\n                    1701690190000,\r\n                    1701690200000,\r\n                    1701690210000,\r\n                    1701690220000,\r\n                    1701690230000,\r\n                    1701690240000,\r\n                    1701690250000,\r\n                    1701690260000,\r\n                    1701690270000,\r\n                    1701690280000,\r\n                    1701690290000,\r\n                    1701690300000,\r\n                    1701690310000,\r\n                    1701690320000,\r\n                    1701690330000,\r\n                    1701690340000,\r\n                    1701690350000,\r\n                    1701690360000,\r\n                    1701690370000,\r\n                    1701690380000,\r\n                    1701690390000,\r\n                    1701690400000,\r\n                    1701690410000,\r\n                    1701690420000,\r\n                    1701690430000,\r\n                    1701690440000,\r\n                    1701690450000,\r\n                    1701690460000,\r\n                    1701690470000,\r\n                    1701690480000,\r\n                    1701690490000,\r\n                    1701690500000,\r\n                    1701690510000,\r\n                    1701690520000,\r\n                    1701690530000,\r\n                    1701690540000,\r\n                    1701690550000,\r\n                    1701690560000,\r\n                    1701690570000,\r\n                    1701690580000,\r\n                    1701690590000,\r\n                    1701690600000,\r\n                    1701690610000,\r\n                    1701690620000,\r\n                    1701690630000,\r\n                    1701690640000,\r\n                    1701690650000,\r\n                    1701690660000,\r\n                    1701690670000,\r\n                    1701690680000,\r\n                    1701690690000,\r\n                    1701690700000,\r\n                    1701690710000,\r\n                    1701690720000,\r\n                    1701690730000,\r\n                    1701690740000,\r\n                    1701690750000,\r\n                    1701690760000,\r\n                    1701690770000,\r\n                    1701690780000,\r\n                    1701690790000,\r\n                    1701690800000,\r\n                    1701690810000,\r\n                    1701690820000,\r\n                    1701690830000,\r\n                    1701690840000,\r\n                    1701690850000,\r\n                    1701690860000,\r\n                    1701690870000,\r\n                    1701690880000,\r\n                    1701690890000,\r\n                    1701690900000,\r\n                    1701690910000,\r\n                    1701690920000,\r\n                    1701690930000,\r\n                    1701690940000,\r\n                    1701690950000,\r\n                    1701690960000,\r\n                    1701690970000,\r\n                    1701690980000,\r\n                    1701690990000,\r\n                    1701691000000,\r\n                    1701691010000,\r\n                    1701691020000,\r\n                    1701691030000,\r\n                    1701691040000,\r\n                    1701691050000,\r\n                    1701691060000,\r\n                    1701691070000,\r\n                    1701691080000,\r\n                    1701691090000,\r\n                    1701691100000,\r\n                    1701691110000,\r\n                    1701691120000,\r\n                    1701691130000,\r\n                    1701691140000,\r\n                    1701691150000,\r\n                    1701691160000,\r\n                    1701691170000,\r\n                    1701691180000,\r\n                    1701691190000,\r\n                    1701691200000\r\n                  ],\r\n                  [\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2,\r\n                    2\r\n                  ]\r\n                ]\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      \"title\": \"Reproduced with embedded data\",\r\n      \"type\": \"timeseries\"\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003etimeseries @ 10.0.2 (unknown-dev)\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003eA[prometheus]\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003e 1 frames, 2 fields, 2161 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e10.0.2 (unknown-dev) // Open Source\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"title\": \"Original Panel JSON\",\r\n      \"type\": \"text\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 7\r\n      },\r\n      \"options\": {\r\n        \"content\": \"{\\n  \\\"datasource\\\": {\\n    \\\"uid\\\": \\\"P4169E866C3094E38\\\",\\n    \\\"type\\\": \\\"prometheus\\\"\\n  },\\n  \\\"fieldConfig\\\": {\\n    \\\"defaults\\\": {\\n      \\\"custom\\\": {\\n        \\\"drawStyle\\\": \\\"line\\\",\\n        \\\"lineInterpolation\\\": \\\"linear\\\",\\n        \\\"barAlignment\\\": 0,\\n        \\\"lineWidth\\\": 1,\\n        \\\"fillOpacity\\\": 0,\\n        \\\"gradientMode\\\": \\\"none\\\",\\n        \\\"spanNulls\\\": false,\\n        \\\"showPoints\\\": \\\"auto\\\",\\n        \\\"pointSize\\\": 5,\\n        \\\"stacking\\\": {\\n          \\\"mode\\\": \\\"none\\\",\\n          \\\"group\\\": \\\"A\\\"\\n        },\\n        \\\"axisPlacement\\\": \\\"auto\\\",\\n        \\\"axisLabel\\\": \\\"\\\",\\n        \\\"axisColorMode\\\": \\\"text\\\",\\n        \\\"scaleDistribution\\\": {\\n          \\\"type\\\": \\\"linear\\\"\\n        },\\n        \\\"axisCenteredZero\\\": false,\\n        \\\"hideFrom\\\": {\\n          \\\"tooltip\\\": false,\\n          \\\"viz\\\": false,\\n          \\\"legend\\\": false\\n        },\\n        \\\"thresholdsStyle\\\": {\\n          \\\"mode\\\": \\\"off\\\"\\n        }\\n      },\\n      \\\"color\\\": {\\n        \\\"mode\\\": \\\"palette-classic\\\"\\n      },\\n      \\\"mappings\\\": [],\\n      \\\"thresholds\\\": {\\n        \\\"mode\\\": \\\"absolute\\\",\\n        \\\"steps\\\": [\\n          {\\n            \\\"color\\\": \\\"green\\\",\\n            \\\"value\\\": null\\n          },\\n          {\\n            \\\"color\\\": \\\"red\\\",\\n            \\\"value\\\": 80\\n          }\\n        ]\\n      }\\n    },\\n    \\\"overrides\\\": []\\n  },\\n  \\\"gridPos\\\": {\\n    \\\"h\\\": 8,\\n    \\\"w\\\": 12,\\n    \\\"x\\\": 0,\\n    \\\"y\\\": 0\\n  },\\n  \\\"id\\\": 1,\\n  \\\"options\\\": {\\n    \\\"tooltip\\\": {\\n      \\\"mode\\\": \\\"single\\\",\\n      \\\"sort\\\": \\\"none\\\"\\n    },\\n    \\\"legend\\\": {\\n      \\\"showLegend\\\": true,\\n      \\\"displayMode\\\": \\\"list\\\",\\n      \\\"placement\\\": \\\"bottom\\\",\\n      \\\"calcs\\\": []\\n    }\\n  },\\n  \\\"targets\\\": [\\n    {\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"prometheus\\\",\\n        \\\"uid\\\": \\\"P4169E866C3094E38\\\"\\n      },\\n      \\\"editorMode\\\": \\\"code\\\",\\n      \\\"expr\\\": \\\"with (\\\\n test = 1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+11+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1+1\\\\n)\\\\n1+1\\\",\\n      \\\"instant\\\": false,\\n      \\\"range\\\": true,\\n      \\\"refId\\\": \\\"A\\\"\\n    }\\n  ],\\n  \\\"title\\\": \\\"Panel Title\\\",\\n  \\\"type\\\": \\\"timeseries\\\"\\n}\",\r\n        \"mode\": \"code\",\r\n        \"code\": {\r\n          \"language\": \"json\",\r\n          \"showLineNumbers\": true,\r\n          \"showMiniMap\": true\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: Panel Title // 2023-12-04 12:00:11.544\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-timeseries\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"2023-12-04T06:00:11.535Z\",\r\n    \"to\": \"2023-12-04T12:00:11.535Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.0.2\r\nOS: Ubuntu 22.04.3 LTS\r\nBrowser: Chrome `Version 119.0.6045.105 (Official Build) (64-bit)`\r\n\r\n\r\n\r\n### Grafana platform?\r\n\r\nNone\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["type/feature-request","area/dashboard","prio/low","datasource/Prometheus","area/query-editor","needs refinement"]},{"id":60474,"title":"Time series panel displays data incorrectly if timestamp has milliseconds and user timezone is not UTC","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nWe visualise time series data with millisecond precision and UTC timezone using the Grafana `Time series` panel using a PostgreSQL data source.\r\n\r\nIf the timezone selected in the user's preferences is UTC, the data is visualised correctly, irrespective of whether milliseconds are available or not.\r\n\r\nIn case the user selects a timezone other than UTC in their individual preferences (for example Europe/ Berlin), \r\n\r\n![user_preferences](https://user-images.githubusercontent.com/67360039/208104368-9a8425ad-c6fe-4854-927a-ac6aef62f2ce.png)\r\n\r\nand the timestamp contains milliseconds precision the data is incorrectly visualised (with a time shift of one hour) using the `Time series` panel while the tooltip is correct.\r\n\r\n![timestamp_with_milliseconds_bug](https://user-images.githubusercontent.com/67360039/208105512-31869320-1af0-4d93-98f0-21686c8dee18.png)\r\n\r\nIf the timestamp does not contain milliseconds the data is visualised correctly even though timezone is set to Europe/ Berlin.\r\n\r\n![timestamp_without_milliseconds](https://user-images.githubusercontent.com/67360039/208105716-a280bdeb-9b08-41e6-8c16-384c0787bfce.png)\r\n\r\n**What you expected to happen**:\r\n\r\nTimestamps with millisecond precision should be treated correctly and time axis should not be shifted if the user selects a different timezone other than UTC in their individual preferences.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nWe have created a customised data source to show the error in a reproducible way. \r\n\r\n[test-testmyplugin-datasource.zip](https://github.com/grafana/grafana/files/10246063/test-testmyplugin-datasource.zip)\r\n\r\nRun Docker with the following command\r\n\r\n```shell\r\ndocker run -d -p 3000:3000 -v \"$(pwd)\":/var/lib/grafana/plugins -e GF_DEFAULT_APP_MODE=development --name=grafana grafana/grafana:9.3.0\r\n```\r\n\r\nThe bug can be reproduced by providing `true` to `Enable bug?`.\r\n\r\nThe error occurs irrespective of the timezone set in the time range selection drop down on the dashboard itself.\r\n\r\n**Anything else we need to know?**:\r\n\r\nDataFrame JSON with UTC timestamp with bug:\r\n```json\r\n[\r\n  {\r\n    \"schema\": {\r\n      \"refId\": \"A\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"Time\",\r\n          \"type\": \"time\",\r\n          \"config\": {}\r\n        },\r\n        {\r\n          \"name\": \"Value 2022-12-16T11:00:00.1234Z\",\r\n          \"type\": \"number\",\r\n          \"config\": {}\r\n        }\r\n      ]\r\n    },\r\n    \"data\": {\r\n      \"values\": [\r\n        [\r\n          \"2022-12-16T11:00:00.1234Z\",\r\n          \"2022-12-16T11:30:00.1234Z\"\r\n        ],\r\n        [\r\n          10,\r\n          20\r\n        ]\r\n      ]\r\n    }\r\n  }\r\n]\r\n```\r\n\r\nDataFrame JSON without bug:\r\n```\r\n[\r\n  {\r\n    \"schema\": {\r\n      \"refId\": \"A\",\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"Time\",\r\n          \"type\": \"time\",\r\n          \"config\": {}\r\n        },\r\n        {\r\n          \"name\": \"Value 2022-12-16T11:00:00Z\",\r\n          \"type\": \"number\",\r\n          \"config\": {}\r\n        }\r\n      ]\r\n    },\r\n    \"data\": {\r\n      \"values\": [\r\n        [\r\n          \"2022-12-16T11:00:00Z\",\r\n          \"2022-12-16T11:30:00Z\"\r\n        ],\r\n        [\r\n          10,\r\n          20\r\n        ]\r\n      ]\r\n    }\r\n  }\r\n]\r\n```\r\n\r\n**Environment**:\r\n- Grafana version: Docker grafana/grafana:9.3.0\r\n- Data source type \u0026 version: \r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser: macOS Ventura 13.0.1, Chrome Version 108.0.5359.124 (Official Build) (arm64)\r\n- Grafana plugins:\r\n- Others:\r\n\r\n\r\n**Thanks a lot for your support!**","labels":["type/bug","needs more info","area/dashboard/timezone","area/panel/timeseries","timepicker"]},{"id":52304,"title":"Alerting: Grafana managed alert - Add query - shows no compatible data sources, if no default datasource is set","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI tried to edit an existing alert rule to add a query but the button is greyed out with an error \"You appear to have no compatible data sources\"\r\n![image](https://user-images.githubusercontent.com/452393/179133486-613b6aba-7be0-4553-ad91-55c3463e4fc5.png)\r\nAfter some diagnosis I discovered this was because I no longer had a datasource defined as a default.\r\n\r\n**What you expected to happen**:\r\nI expected to still be able to edit/create alerts, or be prevented from having no default data source.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n- Find your default data source\r\n- Turn off the default toggle\r\n- Save changes\r\n- Attempt to add/edit a Grafana managed alert\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.3\r\n- Data source type \u0026 version: N/A\r\n- OS Grafana is installed on: Docker\r\n- User OS \u0026 Browser: Windows 10, Edge\r\n- Grafana plugins: \r\n- Others:\r\n","labels":["type/bug","area/alerting","area/frontend"]},{"id":79886,"title":"Alerting: Silence is not matching alerts in the 'normal' state","body":"### What happened?\r\n\r\nSilence matcher in UI doesn't show alerts in normal (green) state\r\n\r\n### What did you expect to happen?\r\n\r\nI expect to see all alerts, for example i have 1120 targets matched with alert TargetUnreacheable, but only one of them in firing state when i trying to match by labels\r\n\r\n### Did this work before?\r\n\r\nI don't have a proof, but i remember earlier (in version 8-9) when i did silence i see all alerts and i can able to silence alerts in any states (firing, supressed, normal) for some instances\r\n\r\n### How do we reproduce it?\r\n\r\n1. Go to [Alerting] - [Silences] - Add silence\r\n2. Add matcher (alertname = TargetUnreachable)\r\n3. You will see only supressed and firing alerts\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n-\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: v10.1.5 849c612fcb\r\nOS: MacOS Sonoma 14.1.1\r\nBrowser: Google Chrome Version 120.0.6099.109 (Official Build) (arm64)\r\n\r\n\r\n### Grafana platform?\r\n\r\nKubernetes\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/alerting","area/frontend"]},{"id":50928,"title":"Grafana 9.0.0: autocomplete annotation tags","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWhen I try to create a new annotation in a metric and type (autocomplete) for the proper tag, the interface launch an error.\r\n![Screenshot from 2022-06-16 10-47-46](https://user-images.githubusercontent.com/6834252/174031600-b2e306e2-c6fc-4521-a0a2-5793ee8d3aa9.png)\r\n\r\n**What you expected to happen**:\r\nIn version 8.5.2 the annotation tag is autocomplete \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nIn a dashboard annotated with tags, try to create a new annotation and when the tag is searched may raise the error, in my case always the error is raised\r\n\r\n**Anything else we need to know?**:\r\nError raised in file https://github.com/grafana/grafana/blob/main/packages/grafana-ui/src/utils/tags.ts Line:70\r\nMaybe one value undefined is passed to this function?\r\n\r\n**Environment**:\r\n- Grafana version: OSS 9.0.0\r\n- Data source type \u0026 version: Prometheus 2.36.0\r\n- OS Grafana is installed on: Amazon Linux 2, binary .tar.gz\r\n- User OS \u0026 Browser: Chrome Linux\r\n- Grafana plugins: Default\r\n- Others: Grafana configuration database, postgres\r\n","labels":["type/bug","prio/high","area/annotations"]},{"id":67583,"title":"Grafana 9.4.3: All dashboards missing after sometime with no results found error","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n## What happened:\r\nI have a APP based on Grafana docker image hosting on AWS.\r\nAlso use dashboard.josn files for provisioning all the dashboards and datsoucres.\r\n\r\nAfter I migrate Grafana from v7.5.17 to 9.4.3 , I have this all dashboards missing with no results found issue…\r\n![image](https://user-images.githubusercontent.com/132237675/235383567-2da83ea3-f263-4ba7-b4e1-7ae7f3ea2dd2.png)\r\n\r\nSince I’ve never met this issue before with Grafana v7 or earlier versions, I’m wondering is this an known issue for Grafana V9.\r\n## What you expected to happen:\r\nAll the dashboards should not dissapear\r\n## How to reproduce it (as minimally and precisely as possible):\r\nThis issue is not reproduceable everytime. \r\nTo be more detailed, this issue occurs sometimes after I redeploy Grafana on AWS,\r\nthe redeploy meaning an install that re-pull the Grafana docker image and run the docker image in containers to deploy the change I made for dashboard.json files I manage in my code repo.\r\nSometimes, after an install, all the dashboards will missing right after the install or after several hours or days.\r\n## Anything else we need to know?:\r\nTo be more specific, I used an yaml file like this to config the provisioned dashboard,\r\n![image](https://user-images.githubusercontent.com/132237675/235383763-2c4b0226-7794-4805-8e26-1117eb57b5a6.png)\r\n\r\nAnd I tried to set the disableDeltion to true from false, but the dashboard missing issue still happen.\r\nWhen this issue happens, I query the Grafana database with SELECT * FROM public.dashboard_provisioning,\r\nand found there no records when the dashboards gone.\r\n## Environment:\r\n- Grafana version:Granfana 9.4.3\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n\n```[tasklist]\n### Tasks\n```\n","labels":["area/dashboard","area/provisioning","area/docker","stale"]},{"id":50307,"title":"Log lines are reordered when shown in Ascending order","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: \r\n\r\n@LizardWizzard told me that sometimes log messages get reordered when looking at them in Grafana. When I tried to reproduce this issue, I discovered that this happens only when you use Ascending logs order (oldest first). This bug exists both in logs panel and in Explore section.\r\n\r\nDefault logs order displays logs correctly with decreasing timestamps:\r\n\u003cimg width=\"440\" alt=\"image\" src=\"https://user-images.githubusercontent.com/8150127/172371199-6ef78cba-c82a-446b-b2f8-cc56c7c6b1aa.png\"\u003e\r\n\r\nFlipped logs order displays log timestamps in mixed order (look at the first 5 lines):\r\n\u003cimg width=\"459\" alt=\"image\" src=\"https://user-images.githubusercontent.com/8150127/172371556-64ec1ec3-4408-41c4-a79b-acf89a30fd8e.png\"\u003e\r\n\r\n\r\n\r\n**What you expected to happen**:\r\n\r\nI expected Ascending log order to work as an exact reverse of Descending log order.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nThat happens pretty often in our setup, I guess you just need to write about ~1000 log lines per second and try to Explore them with flipped order.\r\n\r\n**Anything else we need to know?**:\r\n\r\nOur promtail configuration is very basic and doesn't have a pipeline stage to parse timestamps from the text.\r\n\r\nI looked at the frontend code briefly, and it seems that logs order is defined here: https://github.com/grafana/grafana/blob/277a83215c1e20ff8c93768f93edf92d60deee5f/packages/grafana-data/src/utils/logs.ts\r\n\r\n**Environment**:\r\n- Grafana version: Grafana v8.3.5 (a53fcac7b1)\r\n- Data source type \u0026 version: Loki Helm Chart 2.8.2 (https://github.com/grafana/helm-charts/releases/tag/loki-2.8.2)\r\n- OS Grafana is installed on: -\r\n- User OS \u0026 Browser: macOS, Firefox\r\n- Grafana plugins: -\r\n- Others:\r\n","labels":["datasource/Loki","area/panel/logs"]},{"id":74965,"title":"Dashboards: Edit panel shows flickering at top right","body":"### What happened?\n\n![flicker](https://github.com/grafana/grafana/assets/761483/8ff1007a-f59c-4301-a85e-f86048dd0c26)\r\n\r\nhttps://github.com/grafana/grafana/assets/761483/e4795c41-40aa-4ecc-a64f-47a3ad6b3912\n\n### What did you expect to happen?\n\nNo flickering.\n\n### Did this work before?\n\nIt used to be ok in Grafana v7 releases, and bumping to v9.4.7 shows this behavior.\n\n### How do we reproduce it?\n\n1. Go to dashboards, pick any plot, click to Edit, and the Edit Panel screen shows it happening.\r\n\r\n\r\nResizing does not fix behavior. Cannot check if reproducible in other browsers (get the \"Grafana warning\" page about unsupported browser on CentOS7 (Firefox, Brave, etc...) -- only Chrome seems to work.\n\n### Is the bug inside a dashboard panel?\n\nHappens to all of them, rather than a specific one.\n\n### Environment (with versions)?\n\nGrafana: v9.4.7\r\nOS: 3.10.0-1127.el7.x86_64 (RedHat / CentOS7)\r\nBrowser: Chrome 87.0.4280.88 (64-bit)\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\n_No response_","labels":["area/dashboard","area/panel/edit","triage/needs-confirmation","team/grafana-dashboards"]},{"id":73798,"title":"Wecom contact channel @someone does not take effect.","body":"### What happened?\n\nI have tried to configure the wecom contact channel @mobile number and @all, but it does not work.\r\nMessage Type: Markdown\r\n![image](https://github.com/grafana/grafana/assets/53719692/398a03fa-5743-4f0d-b1aa-8b37b2c6b79f)\r\n\n\n### What did you expect to happen?\n\nThere is no @someone in the enterprise wechat alarm.\r\n![image](https://github.com/grafana/grafana/assets/53719692/8e5ff6cc-6853-4f4c-96a2-fbcc135f8479)\r\n\n\n### Did this work before?\n\nThe current version is v10.0.3.\r\nNot tested in other versions.\r\n![image](https://github.com/grafana/grafana/assets/53719692/8caf6b20-3092-49ab-8afd-6a284f3ee51d)\r\n\n\n### How do we reproduce it?\n\n1. New wecom contact point and setting @someone\r\n2. Sending a test alarm message\r\n\n\n### Is the bug inside a dashboard panel?\n\nＮot\n\n### Environment (with versions)?\n\nGrafana: v10.0.3\r\nOS: CentOS Linux release 7.6.1810\r\nBrowser: Chrome 116.0.5845.96\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\n_No response_","labels":["area/alerting/notifications","triage/needs-confirmation"]},{"id":61304,"title":"Alert rule panic; runtime error: invalid memory address or nil pointer dereference","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n- Grafana quits unexpectedly from time to time, logging alert rule panic (stacktrace below)\r\n\r\n**What you expected to happen**:\r\n- For it not to crash :wink: \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nI have the alert rule that I pasted below, if I click the Refresh button, it shows an error popup in the top right, I think this might be the cause. The screenshot below is of the rule with the uid from the stack trace.\r\n\r\n**Anything else we need to know?**:\r\n- Might be related to #58703\r\n- [Stack trace](https://github.com/grafana/grafana/files/10393720/stack.txt)\r\n\r\n**Environment**:\r\n- Grafana version: v9.3.2 \\(21c1d14e91\\)\r\n- Data source type \u0026 version: AlertManager, Athena, cloudwatch, ElasticSearch, OpenSearch, Prometheus\r\n- OS Grafana is installed on: Linux (AWS ECS)\r\n- User OS \u0026 Browser: EndeavourOS; Firefox 108.0.2\r\n- Grafana plugins: \r\n  - Amazon Athena\r\n  - Direct Input\r\n  - Grafana OnCall\r\n  - OpenSearch\r\n- Others:\r\n\r\n![image](https://user-images.githubusercontent.com/1043866/211846686-e31d12e6-69ac-4499-a430-6c7fd5d5a680.png)\r\n","labels":["type/bug","area/alerting/evaluation","area/expressions","triage/needs-confirmation"]},{"id":63429,"title":"mysql: TLS without certificates (no client-cert, no server-cert-verify) is not possible","body":"**What happened**:\r\nSince the database was switchted to TLS only mode \"--require_secure_transport=ON\" I can't connect to it anymore with Grafana.\r\nMySQL clients like Workbench or IntelliJ are automatically using TLS and connecting without any issue.\r\nError message:\r\n`“logger=tsdb.mysql t=2023-01-16T10:32:40.287979533+01:00 level=error msg=“Query error” error=“Error 3159: Connections using insecure transport are prohibited while --require_secure_transport=ON.””`\r\n\r\n\r\n**What you expected to happen**:\r\nI can connect to MySQL.\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nI'm not sure yet. I guess you need to configure a MySQL instance with said flag.\r\n\r\n\r\n**Anything else we need to know?**:\r\nI tried to get an answer in the forum but it didn't help https://community.grafana.com/t/cant-connect-to-mysql-datasource-since-switch-to-require-secure-transport-on-mode/79748\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.6 (taken from arch AUR)\r\n- Data source type \u0026 version:  dunno where to get this information\r\n- MySQL DBMS: Report from IntelliJ connection:\r\n```\r\nMySQL (ver. 8.0.28-19.1)\r\nCase sensitivity: plain=exact, delimited=exact\r\nDriver: MySQL Connector/J (ver. mysql-connector-java-8.0.25 (Revision: 08be9e9b4cba6aa115f9b27b215887af40b159e0), JDBC4.2)\r\n\r\n```\r\n- OS Grafana is installed on: Arch Linux\r\n- User OS \u0026 Browser: Endeavor OS which is based on arch\r\n- Grafana plugins: No extra\r\n\r\n\r\n\r\nThank you very much.","labels":["type/bug","datasource/MySQL","area/datasource","area/configuration"]},{"id":53283,"title":"The behavior of \"Show context\" for loki is incorrect.","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nWhen collecting tons of logs with loki, a common use case is to add `level` as a label to accelerate search speed, or add a sharding key in label to balance the load of each loki ingester. \r\n\r\nIn Grafana Explore, \"Show context\" applies all labels of the selected log line to the query before searching for logs around, that behavior makes returned context logs useless.\r\n\r\n**What you expected to happen**:\r\n\r\nFor example, the logs has two labels `{component=\"...\", level=\"...\"}`. We list logs with query `{component=\"foo\"} |= \"bar\"`. And click \"Show context\" for a line (with level=\"error\"), Grafana should returns logs around with label filter `{component=\"foo\"}`, not logs around with label filters`{component=\"foo\", level=\"error\"}`.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.6\r\n- Data source type \u0026 version: Loki\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/explore","datasource/Loki","triage/needs-confirmation"]},{"id":53313,"title":"__Potential memory leak__ The web-app crashes as long as you don't interact with it long enough","body":"**What happened**:\r\nThe Grafana dashboard page was left up on display.\r\nThe dashboard has 6 panels that use transformation methods.\r\nThe memory used by the page was observed to be increasing non-stop.\r\nThe page would eventually crash. (seen reach 5 GB at one point)\r\nInteracting with the page resets the memory usage to 150~300 MB.\r\n\r\n**What you expected to happen**:\r\nLeaving the page on display on an android device\r\nwith 2GB of RAM shouldn't cause the web-app to crash within an hour.\r\n(or at all for that matter)\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nOpen Grafana.\r\nLogin to a dashboard that has 6 panels that use the transformation feature.\r\nLeave it open without interacting with it. (you can interact with anything else)\r\nObserve the memory used by the tab/page/process going up.\r\n\r\n**Anything else we need to know?**:\r\nN/A\r\n\r\n**Environment**:\r\n- Grafana version: 9\r\n- Data source type \u0026 version:\r\n   -- Prometheus, with Prometheus v2.36.2 server\r\n   -- queries are many, about 20 of the following sort:\r\n       ---- \"sum( rate(ifInOctets{instance=\\~\"switch0[1-3].\\*\"}[2m]) + rate(ifOutOctets{instance=\\~\"switch0[1-3].\\*\"}[2m]) ) * 8\"\r\n       ---- *5* \"Add field from calculation\" transformations followed by *1* \"Organize fields\" transformation in **ONE** of the panels.\r\n       ---- *1* \"Rename by regex\" transformation in **ONE** of the other panels.\r\n- OS Grafana is installed on: Linux\r\n- User OS \u0026 Browser: (Windows 10 / Windows 11 / Android 9) \u0026 (Chrome / Firefox / Brave / Opera)\r\n- Grafana plugins: N/A\r\n- Others: N/A\r\n","labels":["needs more info","type/performance","area/frontend"]},{"id":52018,"title":"Show context empty after refresh","body":"**What happened**:\r\n\r\nShow context empty after refresh window.\r\n\r\n**What you expected to happen**:\r\n\r\nShow context should display the surrounding logs.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n1. Goto log browser and filter some logs.\r\n1. Click \"Show context\" button on a log line, then surrounding logs displayed.\r\n1. Refresh the window.\r\n1. Click \"Show context\" button on same line, but no other logs displayed except the original one.\r\n1. Click \"Run query\" then \"Show context\", still same problem.\r\n1. Goto home or any other page then go back and repeat step 1.\r\n1. Click \"Show context\" button on a log line, the problem gone.\r\n1. Refresh and the problem back.\r\n\r\n**Anything else we need to know?**:\r\n\r\nWe checked the network calls in Chrome debug tools, and found the difference on `/api/ds/query` after clicked \"Show context\".\r\n\r\nthe request payload if no problem:\r\n\r\n```\r\n{\r\n    \"queries\": [\r\n        {\r\n            \"expr\": \"{app_instance=\\\"example\\\",cluster=\\\"example-cluster\\\",component=\\\"api\\\",container=\\\"example-api\\\",filename=\\\"/var/log/pods/example_example-api-6ccb895f9d-4lbkb_3fe840d5-d3db-4173-b5ff-2260584c5887/example-api/0.log\\\",job=\\\"example-api\\\",namespace=\\\"example\\\",node=\\\"example01.example-cluster.example.com\\\",pod=\\\"example-api-6ccb895f9d-4lbkb\\\",stream=\\\"stdout\\\",tenant=\\\"example\\\"}\",\r\n            \"queryType\": \"range\",\r\n            \"refId\": \"\",\r\n            \"maxLines\": 10,\r\n            \"direction\": \"backward\",\r\n            \"legendFormat\": \"\",\r\n            \"datasource\": {\r\n                \"type\": \"loki\",\r\n                \"uid\": \"PFBF92862F95315B6\"\r\n            },\r\n            \"datasourceId\": 9,\r\n            \"intervalMs\": 7200000\r\n        }\r\n    ],\r\n    \"range\": {\r\n        \"from\": \"2022-07-11T04:17:24.357Z\",\r\n        \"to\": \"2022-07-11T06:17:24.357Z\",\r\n        \"raw\": {\r\n            \"from\": \"2022-07-11T04:17:24.357Z\",\r\n            \"to\": \"2022-07-11T06:17:24.357Z\"\r\n        }\r\n    },\r\n    \"from\": \"1657513044357\",\r\n    \"to\": \"1657520244357\"\r\n}\r\n```\r\n\r\nthe request payload if there is problem (**the difference is expr is empty**):\r\n\r\n```\r\n{\r\n    \"queries\": [\r\n        {\r\n            \"expr\": \"{}\",\r\n            \"queryType\": \"range\",\r\n            \"refId\": \"\",\r\n            \"maxLines\": 10,\r\n            \"direction\": \"backward\",\r\n            \"legendFormat\": \"\",\r\n            \"datasource\": {\r\n                \"type\": \"loki\",\r\n                \"uid\": \"PFBF92862F95315B6\"\r\n            },\r\n            \"datasourceId\": 9,\r\n            \"intervalMs\": 7200000\r\n        }\r\n    ],\r\n    \"range\": {\r\n        \"from\": \"2022-07-11T04:15:26.456Z\",\r\n        \"to\": \"2022-07-11T06:15:26.456Z\",\r\n        \"raw\": {\r\n            \"from\": \"2022-07-11T04:15:26.456Z\",\r\n            \"to\": \"2022-07-11T06:15:26.456Z\"\r\n        }\r\n    },\r\n    \"from\": \"1657512926456\",\r\n    \"to\": \"1657520126456\"\r\n}\r\n```\r\n\r\nand the response is 400:\r\n\r\n```\r\n{\"results\":{\"\":{\"error\":\"parse error at line 1, col 2: syntax error: unexpected }, expecting IDENTIFIER\"}}}\r\n```\r\n\r\nThere are similar issue [Show context missing entries](https://github.com/grafana/grafana/issues/32044) but I think it is not same.\r\n\r\n**Environment**:\r\n\r\n- Grafana version: v9.0.2\r\n- Data source type \u0026 version: MySQL 8.0.29\r\n- OS Grafana is installed on: Ubuntu 20.04.4 LTS\r\n- User OS \u0026 Browser: Chrome Version 103.0.5060.114\r\n- Grafana plugins: Default","labels":["type/bug","datasource/Loki","area/panel/logs"]},{"id":81935,"title":"500 Error in Query Builder with new MSSQL tables","body":"### What happened?\r\n\r\nWhen I run the query builder:\r\n\r\n\r\n`logger=tsdb.mssql endpoint=queryData pluginId=mssql dsName=\"grafanadb.local - (MSDB)\" dsUID=a9a3b5b6-9bf3-4e13-b7bf-65174a56e0e1 uname=grafana-test t=2024-02-06T09:08:50.7282003+01:00 level=error msg=\"ExecuteQuery panic\" error=\"runtime error: invalid memory address or nil pointer dereference\" stack=[]`\r\n\r\n\r\nOther \"old\" tables work perfectly, i think grafana can't create cache/infos about the db in the configuration db.\r\nDB is running on postgres\r\n\r\n### What did you expect to happen?\r\n\r\nA succesful Query, the Query work on MSSQL\r\n\r\n### Did this work before?\r\n\r\nOn 10.2.2 OSS\r\n\r\n### How do we reproduce it?\r\n\r\n1. Add MSSQL Connection\r\n2. Try to run Query on a table with more than 100 rows or emtpy table\r\n3.\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.3.1 OSS\r\nOS: Windows\r\nBrowser: Firefox\r\n\r\n\r\n### Grafana platform?\r\n\r\nA downloaded binary\r\n\r\n### Datasource(s)?\r\n\r\nmssql\n```[tasklist]\n### Tasks\n```\n","labels":["datasource/MSSQL","area/backend/db/postgres","area/datasource","area/configuration","effort/medium"]},{"id":81222,"title":"Graph widget : Y-axis showing same number","body":"### What happened?\r\n\r\nIt is an intermittent issue. On y-axis in the graph widget I see same number at all the scale.\r\n\r\nScreenshot attached.\r\n![image](https://github.com/grafana/grafana/assets/18478858/016c83fc-807b-4ef8-a877-e22f5226b392)\r\n\r\n\r\n\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nOn y-axis as we go up number should increase.\r\n\r\n### Did this work before?\r\n\r\nyes.\r\n\r\n### How do we reproduce it?\r\n\r\nTry creating widget having graphs.\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana:\r\nOS:\r\nBrowser:\r\n\r\n\r\n### Grafana platform?\r\n\r\nNone\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/panel/timeseries","triage/pending"]},{"id":61015,"title":"Unable to view icon in side nav bar while creating application plugin","body":"I'm creating an app plugin following the example app-basic at https://github.com/grafana/grafana-plugin-examples/tree/main/examples/app-basic\r\n\r\nI have used \"icon\": \"cog\" in the includes section in plugin.json for a menu item but the icon did not show up. Here is my plugin.json\r\n\r\n{\r\n\"$schema\": \"https://raw.githubusercontent.com/grafana/grafana/master/docs/sources/developers/plugins/plugin.schema.json\",\r\n\"type\": \"app\",\r\n\"name\": \"Another Navigation\",\r\n\"id\": \"side-nav-app\",\r\n\"info\": {\r\n\"keywords\": [\"basic\", \"app\", \"example\"],\r\n\"description\": \"A basic side nav app plugin\",\r\n\"author\": {\r\n\"name\": \"Your name\"\r\n},\r\n\"logos\": {\r\n\"small\": \"img/logo.svg\",\r\n\"large\": \"img/logo.svg\"\r\n},\r\n\"screenshots\": [],\r\n\"version\": \"%VERSION%\",\r\n\"updated\": \"%TODAY%\"\r\n},\r\n\"includes\": [\r\n{\r\n\"type\": \"page\",\r\n\"icon\": \"cog\",\r\n\"name\": \"Reports\",\r\n\"path\": \"d/1B03Q_F4k/reportee-coverage-details?orgId=1\",\r\n\"role\": \"Admin\",\r\n\"addToNav\": true,\r\n\"defaultNav\": false\r\n}\r\n],\r\n\"dependencies\": {\r\n\"grafanaDependency\": \"\u003e=9.2.1\",\r\n\"plugins\": []\r\n}\r\n}\r\n\r\nHere the configuration item has an icon which is what I'm trying to achieve.\r\n\r\n![image](https://user-images.githubusercontent.com/58066198/210702622-c25b04ba-f4b8-49ae-934f-257bc41ff16d.png)\r\nMy grafana version is 9.2.0. I have tried in the latest version too and it remains the same.\r\n\r\n\r\nHow to reproduce it (as minimally and precisely as possible): Build the plugin example app-basic and enable in grafana\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.0\r\n- OS Grafana is installed on: MacOS\r\n- User OS \u0026 Browser: MacOS \u0026 Brave/Chrome\r\n\r\n","labels":["area/devenv","bot/no new info"]},{"id":88364,"title":"Dashboards: Unable to disable angularDeprecationUI feature using environment variables","body":"### What happened?\r\n\r\nSetting the environment variable \r\n`GF_FEATURE_TOGGLES_ANGULARDEPRECATIONUI=False`\r\ndoes not prevent the Angular deprecation warning popup.\r\nIt could be that this the wrong syntax, but it is not well documented how to use environment variables to disable feature toggles.\r\n\r\n### What did you expect to happen?\r\n\r\nNo Angular deprecation warning is displayed when I open a dashboard with a deprecated panel.\r\n\r\n### Did this work before?\r\n\r\nNo, I have not used the GF_FEATURE_TOGGLES env vars before Grafana v11.0, but I use env vars to do all the other Grafana configuration.\r\n\r\n### How do we reproduce it?\r\n\r\n1. Set env var GF_FEATURE_TOGGLES_ANGULARDEPRECATIONUI=False\r\n2. Start Grafana\r\n3. Create a dashboard with a panel visualization using Angular, for example FlowCharting\r\n4. Observe warning\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nNo\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 11.0\r\nDocker image: grafana/grafana-oss:11.0.0\r\n\r\n\r\n### Grafana platform?\r\n\r\nDocker\r\n\r\n### Datasource(s)?\r\n\r\n_No response_\n```[tasklist]\n### Tasks\n```\n","labels":["area/plugins","area/frontend"]},{"id":71364,"title":"Alerting: contact point/notifications policies pages are broken \"scheme required for webhook url\"","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\n  - I use Grafana with Alertmanager datasource (mimir)\r\n  - When I define a `webhook_configs` receivers, I have an error on contacts points and notications policies pages\r\n  - When I omit `webhook_configs` alertmanager receivers block,  pages are working and restitute the state of my alertmanager configuration\r\n\r\n**What did you expect to happen**:\r\n\r\n  - Contact points and notifications policies pages are working when I define a `webhook_configs` receivers in my alertmanager configuration\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\n- Define an alert manager configuration with a webhook configuration block, eg:\r\n\r\n```\r\nglobal:\r\n  resolve_timeout: 5m\r\n  http_config:\r\n    follow_redirects: true\r\n    enable_http2: true\r\n  smtp_hello: localhost\r\n  smtp_require_tls: true\r\n  slack_api_url: \u003csecret\u003e\r\n  pagerduty_url: https://events.pagerduty.com/v2/enqueue\r\n  opsgenie_api_url: https://api.eu.opsgenie.com/\r\n  opsgenie_api_key: \u003csecret\u003e\r\n  wechat_api_url: https://qyapi.weixin.qq.com/cgi-bin/\r\n  victorops_api_url: https://alert.victorops.com/integrations/generic/20131114/alert/\r\n  telegram_api_url: https://api.telegram.org\r\n  webex_api_url: https://webexapis.com/v1/messages\r\n\r\nroute:\r\n  receiver: slack\r\n  group_by:\r\n  - alertname\r\n  - severity\r\n  continue: false\r\n  routes:\r\n  - receiver: \"null\"\r\n    matchers:\r\n    - alertname=~\"KubeAPIErrorBudgetBurn|InfoInhibitor|KubeClientCertificateExpiration\"\r\n    continue: false\r\n  group_wait: 30s\r\n  group_interval: 5m\r\n  repeat_interval: 12h\r\n\r\ninhibit_rules:\r\n- source_matchers:\r\n  - severity=\"critical\"\r\n  target_matchers:\r\n  - severity=~\"warning|info\"\r\n  equal:\r\n  - namespace\r\n  - alertname\r\n- source_matchers:\r\n  - severity=\"warning\"\r\n  target_matchers:\r\n  - severity=\"info\"\r\n  equal:\r\n  - namespace\r\n  - alertname\r\n- source_matchers:\r\n  - alertname=\"InfoInhibitor\"\r\n  target_matchers:\r\n  - severity=\"info\"\r\n  equal:\r\n  - namespace\r\n\r\nreceivers:\r\n  - name: \"null\"\r\n  - name: \"opsgenie-heartbeat\"\r\n     webhook_configs:\r\n       - url: 'https://api.eu.opsgenie.com/v2/heartbeats/redacted/ping'\r\n          send_resolved: true\r\n          http_config:\r\n              authorization:\r\n                type: GenieKey\r\n                credentials: REDACTED\r\ntemplates: []\r\n```\r\n\r\n**Step 2**:\r\n\r\n- Add this Grafana alertmanager datasource (ideally mimir)\r\n\r\n**Step 3**:\r\n\r\n- Try to access \"Notification policies\" or \"Contacts points\" pages\r\n\r\n\u003cimg width=\"1066\" alt=\"Screenshot 2023-07-11 at 14 48 55\" src=\"https://github.com/grafana/grafana/assets/245284/61f217dd-3cdb-4295-92cf-e153c57bf5f2\"\u003e\r\n\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\n10.0.1 and 10.0.2\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\r\n\r\n### Grafana Platform?\r\n\r\nNone\r\n\r\n### User's OS?\r\n\r\n_No response_\r\n\r\n### User's Browser?\r\n\r\n_No response_\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\n_No response_\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["type/bug","area/alerting/notifications","needs investigation"]},{"id":46576,"title":"Migration failing for user table with error \"no account id found\"","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nInternal migration for user table is failing with error \r\nt=2022-03-15T10:20:37+0000 lvl=eror msg=\"Executing migration failed\" logger=migrator id=\"copy data_source v1 to v2\" error=\"no such column: account_id\"\r\nt=2022-03-15T10:20:37+0000 lvl=eror msg=\"Exec failed\" logger=migrator error=\"no such column: account_id\" sql=\"INSERT INTO `user` (`is_admin`\\n, `created`\\n, `login`\\n, `name`\\n, `password`\\n, `salt`\\n, `company`\\n, `org_id`\\n, `updated`\\n, `id`\\n, `version`\\n, `email`\\n, `rands`) SELECT `is_admin`\\n, `created`\\n, `login`\\n, `name`\\n, `password`\\n, `salt`\\n, `company`\\n, `account_id`\\n, `updated`\\n, `id`\\n, `version`\\n, `email`\\n, `rands` FROM `user_v1`\"\r\nservice init failed: migration failed: no such column: account_id\r\n\r\n\r\n**What you expected to happen**:\r\nThe internal migration should have passed gracefully.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nWe dont have much idea about this, and we havent changed or interacted with the sqllite3 database directly.\r\n\r\n**Anything else we need to know?**:\r\n\r\n\r\n**Environment**:\r\n- Grafana version:  [v7.5.4 ]\r\n- Data source type \u0026 version: Clickhouse\r\n- OS Grafana is installed on: Linux\r\n\r\n- User OS \u0026 Browser:  Docker container with linux image and chrome browser\r\n- Grafana plugins:\r\n- Others:\r\n\r\n\r\nMigration log:\r\n```t=2022-03-15T10:20:37+0000 lvl=info msg=\"Starting Grafana\" logger=server version=7.5.4 commit=615c153b3a branch=HEAD compiled=2021-04-14T09:07:34+0000\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Config loaded from\" logger=settings file=/usr/share/grafana/conf/defaults.ini\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Config loaded from\" logger=settings file=/etc/grafana/grafana.ini\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Config overridden from command line\" logger=settings arg=\"default.paths.data=/var/lib/grafana/data\"\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Config overridden from command line\" logger=settings arg=\"default.paths.logs=/var/log/grafana\"\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Config overridden from command line\" logger=settings arg=\"default.paths.plugins=/var/lib/grafana/plugins\"\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Config overridden from command line\" logger=settings arg=\"default.paths.provisioning=/etc/grafana/provisioning\"\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Config overridden from command line\" logger=settings arg=\"default.log.mode=console\"\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Config overridden from command line\" logger=settings arg=\"default.log.level=debug\"\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Config overridden from Environment variable\" logger=settings var=\"GF_PATHS_DATA=/var/lib/grafana/data\"\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Config overridden from Environment variable\" logger=settings var=\"GF_PATHS_LOGS=/var/log/grafana\"\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Config overridden from Environment variable\" logger=settings var=\"GF_PATHS_PLUGINS=/var/lib/grafana/plugins\"\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Config overridden from Environment variable\" logger=settings var=\"GF_PATHS_PROVISIONING=/etc/grafana/provisioning\"\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Path Home\" logger=settings path=/usr/share/grafana\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Path Data\" logger=settings path=/var/lib/grafana/data\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Path Logs\" logger=settings path=/var/log/grafana\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Path Plugins\" logger=settings path=/var/lib/grafana/plugins\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Path Provisioning\" logger=settings path=/etc/grafana/provisioning\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"App mode production\" logger=settings\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Connecting to DB\" logger=sqlstore dbtype=sqlite3\r\nt=2022-03-15T10:20:37+0000 lvl=warn msg=\"SQLite database file has broader permissions than it should\" logger=sqlstore path=/var/lib/grafana/data/grafana.db mode=-rw-r--r-- expected=-rw-r-----\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Starting DB migrations\" logger=migrator\r\nt=2022-03-15T10:20:37+0000 lvl=dbug msg=\"Skipping migration: Already executed\" logger=migrator id=\"create migration_log table\"\r\nt=2022-03-15T10:20:37+0000 lvl=dbug msg=\"Skipping migration: Already executed\" logger=migrator id=\"create user table\"\r\nt=2022-03-15T10:20:37+0000 lvl=dbug msg=\"Skipping migration: Already executed\" logger=migrator id=\"add unique index user.login\"\r\nt=2022-03-15T10:20:37+0000 lvl=dbug msg=\"Skipping migration: Already executed\" logger=migrator id=\"add unique index user.email\"\r\nt=2022-03-15T10:20:37+0000 lvl=dbug msg=\"Skipping migration: Already executed\" logger=migrator id=\"drop index UQE_user_login - v1\"\r\nt=2022-03-15T10:20:37+0000 lvl=dbug msg=\"Skipping migration: Already executed\" logger=migrator id=\"drop index UQE_user_email - v1\"\r\nt=2022-03-15T10:20:37+0000 lvl=dbug msg=\"Skipping migration: Already executed\" logger=migrator id=\"Rename table user to user_v1 - v1\"\r\nt=2022-03-15T10:20:37+0000 lvl=dbug msg=\"Skipping migration: Already executed\" logger=migrator id=\"create user table v2\"\r\nt=2022-03-15T10:20:37+0000 lvl=dbug msg=\"Skipping migration: Already executed\" logger=migrator id=\"create index UQE_user_login - v2\"\r\nt=2022-03-15T10:20:37+0000 lvl=dbug msg=\"Skipping migration: Already executed\" logger=migrator id=\"create index UQE_user_email - v2\"\r\nt=2022-03-15T10:20:37+0000 lvl=info msg=\"Executing migration\" logger=migrator id=\"copy data_source v1 to v2\"\r\nt=2022-03-15T10:20:37+0000 lvl=dbug msg=\"Executing sql migration\" logger=migrator id=\"copy data_source v1 to v2\" sql=\"INSERT INTO `user` (`is_admin`\\n, `created`\\n, `login`\\n, `name`\\n, `password`\\n, `salt`\\n, `company`\\n, `org_id`\\n, `updated`\\n, `id`\\n, `version`\\n, `email`\\n, `rands`) SELECT `is_admin`\\n, `created`\\n, `login`\\n, `name`\\n, `password`\\n, `salt`\\n, `company`\\n, `account_id`\\n, `updated`\\n, `id`\\n, `version`\\n, `email`\\n, `rands` FROM `user_v1`\"\r\nt=2022-03-15T10:20:37+0000 lvl=eror msg=\"Executing migration failed\" logger=migrator id=\"copy data_source v1 to v2\" error=\"no such column: account_id\"\r\nt=2022-03-15T10:20:37+0000 lvl=eror msg=\"Exec failed\" logger=migrator error=\"no such column: account_id\" sql=\"INSERT INTO `user` (`is_admin`\\n, `created`\\n, `login`\\n, `name`\\n, `password`\\n, `salt`\\n, `company`\\n, `org_id`\\n, `updated`\\n, `id`\\n, `version`\\n, `email`\\n, `rands`) SELECT `is_admin`\\n, `created`\\n, `login`\\n, `name`\\n, `password`\\n, `salt`\\n, `company`\\n, `account_id`\\n, `updated`\\n, `id`\\n, `version`\\n, `email`\\n, `rands` FROM `user_v1`\"\r\nservice init failed: migration failed: no such column: account_id\r\n```\r\n\r\nDb.migration_log table records\r\n```sqlite\u003e select * from db.migration_log;\r\n1|create migration_log table|CREATE TABLE IF NOT EXISTS `migration_log` (\r\n`id` INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL\r\n, `migration_id` TEXT NOT NULL\r\n, `sql` TEXT NOT NULL\r\n, `success` INTEGER NOT NULL\r\n, `error` TEXT NOT NULL\r\n, `timestamp` DATETIME NOT NULL\r\n);|1||2022-03-09 21:25:49\r\n2|create user table|CREATE TABLE IF NOT EXISTS `user` (\r\n`id` INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL\r\n, `version` INTEGER NOT NULL\r\n, `login` TEXT NOT NULL\r\n, `email` TEXT NOT NULL\r\n, `name` TEXT NULL\r\n, `password` TEXT NULL\r\n, `salt` TEXT NULL\r\n, `rands` TEXT NULL\r\n, `company` TEXT NULL\r\n, `account_id` INTEGER NOT NULL\r\n, `is_admin` INTEGER NOT NULL\r\n, `created` DATETIME NOT NULL\r\n, `updated` DATETIME NOT NULL\r\n);|1||2022-03-09 21:25:58\r\n3|add unique index user.login|CREATE UNIQUE INDEX `UQE_user_login` ON `user` (`login`);|1||2022-03-09 21:35:19\r\n43|add unique index user.email|CREATE UNIQUE INDEX `UQE_user_email` ON `user` (`email`);|1||2022-03-09 21:48:41\r\n44|drop index UQE_user_login - v1|DROP INDEX `UQE_user_login`|1||2022-03-09 21:48:48\r\n45|drop index UQE_user_email - v1|DROP INDEX `UQE_user_email`|1||2022-03-09 22:00:45\r\n46|Rename table user to user_v1 - v1|ALTER TABLE `user` RENAME TO `user_v1`|1||2022-03-09 22:00:47\r\n47|create user table v2|CREATE TABLE IF NOT EXISTS `user` (\r\n`id` INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL\r\n, `version` INTEGER NOT NULL\r\n, `login` TEXT NOT NULL\r\n, `email` TEXT NOT NULL\r\n, `name` TEXT NULL\r\n, `password` TEXT NULL\r\n, `salt` TEXT NULL\r\n, `rands` TEXT NULL\r\n, `company` TEXT NULL\r\n, `org_id` INTEGER NOT NULL\r\n, `is_admin` INTEGER NOT NULL\r\n, `email_verified` INTEGER NULL\r\n, `theme` TEXT NULL\r\n, `created` DATETIME NOT NULL\r\n, `updated` DATETIME NOT NULL\r\n);|1||2022-03-09 22:00:47\r\n48|create index UQE_user_login - v2|CREATE UNIQUE INDEX `UQE_user_login` ON `user` (`login`);|1||2022-03-09 22:00:47\r\n49|create index UQE_user_email - v2|CREATE UNIQUE INDEX `UQE_user_email` ON `user` (`email`);|1||2022-03-09 22:00:48\r\nsqlite\u003e\r\n```\r\n\r\nThe migration log are there before the copy task.\r\n\r\nResults from some operation on sqlite grafana db.\r\n```sqlite\u003e select * from db.user_v1;\r\nsqlite\u003e select * from db.user;\r\nsqlite\u003e .schema db.user\r\nsqlite\u003e .schema db.user_v1\r\nsqlite\u003e .schema user_v1\r\nsqlite\u003e .schema user\r\nsqlite\u003e\r\n```\r\nPerformed similar operation on other running grafana and it gave some results. Also, the migration is successful on other setup. \r\n","labels":["needs more info","needs investigation","area/backend/db/migration"]},{"id":48821,"title":"Logs auto scroll up when time is set to now","body":"**What happened**:\r\nWhen scrolling the logs we are brought back every few seconds at the top without the refresh being enabled. The issue seems to be happening when the `to` is set to `now`, if i set it to `now-1s` for example, everything is fine.\r\n![Kapture 2022-05-06 at 16 41 11](https://user-images.githubusercontent.com/101106228/167156016-0da992ca-7e95-4a21-b310-e483d6409a63.gif)\r\n\r\n\r\n**What you expected to happen**:\r\nBeing able to scroll down in the logs.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n- Setup an elasticsearch datasource\r\n- Create a log pannel inside a dashboard\r\n- Try to scroll down\r\n\r\n**Anything else we need to know?**:\r\nIt seems like the shorter the period selected, the shorter is the time between 2 refresh. It also seems like it doesn't occur on initial page load, just after the time period has been edited.\r\n\r\n**Environment**:\r\n- Grafana version: 8.5.1\r\n- Data source type \u0026 version: Elasticsearch 8.0\r\n- OS Grafana is installed on: Ubuntu\r\n- User OS \u0026 Browser: Mac Chrome/Safari\r\n- Grafana plugins: /\r\n- Others: /\r\n","labels":["needs more info","area/panel/logs","bot/no new info"]},{"id":61209,"title":"Field name corrupts on auto refresh","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWhen I have auto-refresh activated, the name of a field changes from 'foo' to '{name=foo}'.\r\n\r\n**What you expected to happen**:\r\nThe name should stay the same\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nAdd a panel (i've tested it with timeseries) and load some data via sql, turn on auto refresh and hover over the metric until it refreshes.\r\n\r\n**Anything else we need to know?**:\r\n```sql\r\n-- query from gif\r\nSELECT\r\n    $timeSeries as t,\r\n    sum(status='CLOSED') as Closed,\r\n    sum(status='WAIT_FOR_DETAILS') as `Wait for Details`,\r\n    sum(status='IN_PROGRESS') as `In Progress`,\r\n    sum(status='ASSIGNED') as Assigned\r\nFROM $table\r\nWHERE $timeFilter\r\nGROUP BY t\r\nORDER BY t DESC\r\n```\r\n\r\n**Environment**:\r\n- Grafana version: Grafana OSS 9.3.1\r\n- Data source type \u0026 version: vertamedia-clickhouse-datasource / 2.5.2\r\n- OS Grafana is installed on: Archlinux\r\n- User OS \u0026 Browser: Archlinux / Firefox 108.0.2\r\n- Grafana plugins: /\r\n- Others:\r\n\r\n![screen_recording](https://user-images.githubusercontent.com/43087936/211516125-b4fc0080-1abc-40c6-bd7f-47cba6af57c5.gif)\r\n\r\n","labels":["area/dashboard","stale","area/panel/timeseries","triage/needs-confirmation"]},{"id":60002,"title":"Bar Chart error with MySQL queries","body":"Hi, \r\nSince the last update, Bar Chars does not work anymore with our MySQL queries.\r\nWe have this error: \r\n![image](https://user-images.githubusercontent.com/24936778/206399966-67f033cc-a560-4484-85c2-4e7c06b30144.png)\r\nBut if we switch to the Table view it works: \r\n![image](https://user-images.githubusercontent.com/24936778/206400108-eb2e1ee1-28b0-4aff-a774-376e40808cf5.png)\r\n\r\nAnd the SQL query works with other visualizations.\r\n\r\nGrafana Version: 9.3.1 on Debian 11\r\n\r\nIf you have an idea, that's would be helpful :)\r\n\r\n\r\n\r\n","labels":["type/bug","area/panel/barchart"]},{"id":62904,"title":"Provisioning API alert_rule validation of limits","body":"**What happened**:\r\nWhen creating provisioned alert rules using the API, if the uid for the alert exceeds the 40 char limit creation succeeds and the resulting uid is truncated. \r\n\r\nThese truncated uid alert rules don't retain the provisioned status in the UI, It's not clear if that's a feature. \r\n\r\nThe deletion of alert rules does not also truncate the incoming uid, which leads to an automated deletion problem. \r\n\r\n**What you expected to happen**:\r\nCreation of an alert rule where the uid or other fields exceed the limits should fail\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate an alert-rule using the provisioner api with a uid exceeding 40 chars\r\n\r\n**Anything else we need to know?**:\r\n\r\n- Grafana version: 9.3.6","labels":["type/bug","area/provisioning"]},{"id":58305,"title":"Annotation update not possible.","body":"**What happened**:\r\nA created annotation can no longer be updated afterwards\r\n\r\n**What you expected to happen**:\r\nGenerated annotations should be changeable afterwards\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n### Create\r\ncurl -s -XPOST http://127.0.0.1:3000/api/annotations -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'Authorization: Bearer ###' -m 10 -d '{\"text\": \"deployment\", \"time\": 1667806221000, \"timeEnd\": 1667806221000, \"tags\": [\r\n  \"progress\",\r\n  \"live\",\r\n  \"foo\",\r\n  \"deployment\"\r\n]}'\r\n{\"id\":2,\"message\":\"Annotation added\"}%\r\n\r\n### Update\r\ncurl -s -XPATCH http://127.0.0.1:3000/api/annotations/2 -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'Authorization: Bearer ###' -m 10 -d '{\"timeEnd\": 1667806243000, \"tags\": [\r\n  \"success\",\r\n  \"live\",\r\n  \"foo\",\r\n  \"deployment\"\r\n]}'\r\n\r\n\r\n**Anything else we need to know?**:\r\nlogger=accesscontrol.service t=2022-11-07T07:31:24.568292652Z level=debug msg=\"fetch permissions from store\" key=rbac-permissions-1-apikey-1\r\nlogger=accesscontrol.service t=2022-11-07T07:31:24.568659652Z level=debug msg=\"cache permissions\" key=rbac-permissions-1-apikey-1\r\nlogger=accesscontrol.evaluator t=2022-11-07T07:31:24.568757111Z level=debug msg=\"matched scope\" userscope=annotations:* targetscope=annotations:id:2\r\nlogger=ngalert t=2022-11-07T07:31:27.186687112Z level=debug msg=\"recording state cache metrics\" now=2022-11-07T07:31:27.186645903Z\r\nlogger=sqlstore.transactions t=2022-11-07T07:31:29.70051628Z level=info msg=\"Database locked, sleeping then retrying\" error=\"database is locked\" retry=0\r\nlogger=sqlstore.transactions t=2022-11-07T07:31:34.829799532Z level=info msg=\"Database locked, sleeping then retrying\" error=\"database is locked\" retry=1\r\nlogger=context userId=0 orgId=1 uname= t=2022-11-07T07:31:34.83063499Z level=error msg=\"Failed to update annotation\" error=\"context canceled\" remote_addr=172.17.0.1 traceID=\r\nlogger=context userId=0 orgId=1 uname= t=2022-11-07T07:31:34.830767324Z level=error msg=\"Request Completed\" method=PATCH path=/api/annotations/2 status=500 remote_addr=172.17.0.1 time_ms=10282 duration=10.282997504s size=54 referer= handler=/api/annotations/:annotationId\r\nlogger=ngalert t=2022-11-07T07:31:34.844757532Z level=debug msg=\"Alert rules fetched\" rulesCount=0 foldersCount=0\r\n\r\n\r\n**Environment**:\r\n- Grafana version:  9.2.3 (docker tag)\r\n- Data source type \u0026 version: All\r\n- OS Grafana is installed on: Official Docker image\r\n- Grafana plugins:\r\n- Others:\r\n\r\n\r\n**Workaround**:\r\n- Delete grafana.db File\r\n- Deploy Grafana version 7.5.x\r\n- create an Annotation\r\n- update an Annotation\r\n- Update to grafana 9.2.x\r\n\r\nNow you can create and update new annotations with grafana 9.2.x\r\n","labels":["type/bug","area/annotations","area/backend/api","area/docker"]},{"id":58694,"title":"Admin/User: Got TypeError while searching for users","body":"![image](https://user-images.githubusercontent.com/87159979/201597881-d2e02c02-f7c1-4d42-a116-9dffe58cdd03.png)\r\n\r\n**What happened**:\r\nWhen we try to search user in User Admin page and it returns no result. The page immediately throws an error \"TypeError: Cannot read properties of null (reading 'some')\". It was fine in Grafana 8.3.2 where we upgraded from. User search API calls returned a null value for user field instead an empty array in version v8.\r\n\r\n**What you expected to happen**:\r\nThe page updated with no user on the list.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nGo to user admin page.  Enter any text that doesn't match an existing user.\r\n \r\n**Anything else we need to know?**:\r\nAble to reproduce the same issue with a new installation.\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.4\r\n- Data source type \u0026 version: N/A\r\n- OS Grafana is installed on: CentOS 7\r\n- User OS \u0026 Browser: MacOS 12.5.1, Google Chrome Version 107.0.5304.110 (Official Build) (arm64)\r\n- Grafana plugins: N/A\r\n- Others: N/A\r\n","labels":["needs more info","area/search","area/admin/user"]},{"id":64374,"title":"Annotation table in Grafana grows beyond established limits","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: \r\nThe annotation table of the Grafana database is growing beyond the established limits.\r\n\r\n**What you expected to happen**:\r\nThat annotations are deleted when they exceed the established limit and do not accumulate.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.6\r\n- Data source type \u0026 version: Prometheus, ElasticSearch\r\n- OS Grafana is installed on: Kuberentes through the helm chart\r\n- User OS \u0026 Browser: Chrome, Firefox, Safari\r\n- Grafana plugins:\r\n- Others:\r\n\r\nConfiguration:\r\n\r\n[alerting]\r\nconcurrent_render_limit = 8\r\nenabled = false\r\nmax_annotation_age = 15d\r\nmax_annotations_to_keep = 100000\r\n[annotations]\r\ncleanupjob_batchsize = 20000\r\n[annotations.dashboard]\r\nmax_age = 6M\r\nmax_annotations_to_keep = 15\r\n[annotations.api]\r\nmax_age = 6M\r\n\r\nQuery:\r\n\r\nSELECT COUNT(*) FROM annotation;\r\n\r\n269707\r\n\r\n\r\n","labels":["area/dashboard","needs more info","area/annotations","area/backend"]},{"id":67713,"title":"depricated github.com/golang/protobuf package present in latest grafana","body":"### \n# What went wrong?\n\n\n**What happened**:\r\ndepricated code present\r\n[  - ](https://github.com/golang/protobuf)\r\n\r\n\r\n**What did you expect to happen**:\r\nto replace github/golang/protobuf with google code\r\n  - \r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\nVerify versions of protobuf present\r\n\r\n\n\n### \n# What Grafana version are you using?\n\n\nv9.5.1\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nNone\n\n### User's OS?\n\n_No response_\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["needs more info","prio/medium","area/backend"]},{"id":51735,"title":"Alerts broken after upgrading to v9","body":"**What happened**:\r\nI've just upgraded Grafana from v8 to v9 (.0.2) and started to get alerts from old / deprecated dashboards. I've deleted the dashboards or even the org, but i still get alerts from these. I've tried to restart Grafana service after deleting these resources, thinking of a caching issue, but it did not help, i still get these alerts and i don't have any way to delete them.\r\n\r\nI just browsed other dashboards having alerts and i see the alert thresholds in the graph, but the alert panel is completely empty, as if there was no alert defined there.\r\n\r\nIt seems there's a global issue to display alerts with v9, it seems there are running in the background and sending notifications, but somehow they cannot be displayed in the UI.\r\n\r\nNot sure if there's any specific migration task to perform following upgrade to v9?\r\n\r\n**What you expected to happen**:\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.2\r\n- Data source type \u0026 version: InfluxDB\r\n- OS Grafana is installed on: running as docker image\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["needs more info","area/alerting"]},{"id":74974,"title":"Grafana 9.5.9 / alert rule panic runtime error: index out of range [0] with length 0 - occurs when no data is returned by the query","body":"### What happened?\n\nI've just upgraded from grafana 9.3.8 to 9.5.9 and I got suddenly multiple grafana rules causing this error in the log.\r\n```\r\nlogger=ngalert.eval rule_uid=pABl7yFVz org_id=1 t=2023-09-17T16:05:01.116794133+02:00 level=error msg=\"alert rule panic\" error=\"runtime error: index out of range [0] with length 0\" stack=\"goroutine 673 [running]:\r\nruntime/debug.Stack()\r\n\truntime/debug/stack.go:24 +0x5e\r\ngithub.com/grafana/grafana/pkg/services/ngalert/eval.(*conditionEvaluator).EvaluateRaw.func1()\r\n\tgithub.com/grafana/grafana/pkg/services/ngalert/eval/eval.go:58 +0x7d\r\npanic({0xb2e480?, 0xc0024485a0?})\r\n\truntime/panic.go:914 +0x21f\r\ngithub.com/grafana/grafana/pkg/expr.(*DSNode).Execute(0xc0022682c0, {0x1633840, 0xc0033251f0}, {0xc0025a8f68?, 0x33a51a5?, 0x61579e0?}, 0x7feea5b7cb10?, 0xc000f8c8a0)\r\n\tgithub.com/grafana/grafana/pkg/expr/nodes.go:317 +0x171b\r\n```\r\n\r\nOr from the alerting =\u003e rules editor \r\n```\r\nlogger=ngalert.eval t=2023-09-17T19:14:52.256796788+02:00 level=error msg=\"alert rule panic\" error=\"runtime error: index out of range [0] with length 0\" stack=\"goroutine 45929 [running]:\r\nruntime/debug.Stack()\r\n\truntime/debug/stack.go:24 +0x5e\r\ngithub.com/grafana/grafana/pkg/services/ngalert/eval.(*conditionEvaluator).EvaluateRaw.func1()\r\n\tgithub.com/grafana/grafana/pkg/services/ngalert/eval/eval.go:58 +0x7d\r\npanic({0xb2e480?, 0xc00313c3c0?})\r\n\truntime/panic.go:914 +0x21f\r\ngithub.com/grafana/grafana/pkg/expr.(*DSNode).Execute(0xc002390bb0, {0x1633840, 0xc00258df80}, {0xc0017a7a88?, 0x33a51a5?, 0x61579e0?}, 0x7f6d14e347a0?, 0xc000fe0cc0)\r\n\tgithub.com/grafana/grafana/pkg/expr/nodes.go:317 +0x171b\r\ngithub.com/grafana/grafana/pkg/expr.(*DataPipeline).execute(0xc0017a7c10, {0x1633840, 0xc00258df80}, {0x34bb150?, 0xc00258df80?, 0x61579e0?}, 0x61579e0?)\r\n\tgithub.com/grafana/grafana/pkg/expr/graph.go:53 +0xfe\r\ngithub.com/grafana/grafana/pkg/expr.(*Service).ExecutePipeline(0x1633798?, {0x1633840, 0xc00258df80}, {0xc002d1a300?, 0xc003c630e0?, 0x61579e0?}, {0xc002d1a2d0, 0x3, 0x3})\r\n\tgithub.com/grafana/grafana/pkg/expr/service.go:68 +0xcf\r\ngithub.com/grafana/grafana/pkg/services/ngalert/eval.(*conditionEvaluator).EvaluateRaw(0xc001ff0840?, {0x1633798?, 0xc002193bc0?}, {0xc001a64f00?, 0xc002477760?, 0x61579e0?})\r\n\tgithub.com/grafana/grafana/pkg/services/ngalert/eval/eval.go:74 +0x139\r\ngithub.com/grafana/grafana/pkg/services/ngalert/api.TestingApiSrv.RouteEvalQueries({0xc000b7bd70, {0x161a9c0, 0xc000fe05a0}, {0x1644750, 0xc000db70e0}, {0x162ade8, 0xc001034540}, {0x161c450, 0xc000db6e40}, 0xc0002b3368, ...}, ...)\r\n\tgithub.com/grafana/grafana/pkg/services/ngalert/api/api_testing.go:142 +0x555\r\ngithub.com/grafana/grafana/pkg/services/ngalert/api.(*TestingApiHandler).handleRouteEvalQueries(...)\r\n\tgithub.com/grafana/grafana/pkg/services/ngalert/api/testing_api.go:29\r\n```\r\n\n\n### What did you expect to happen?\n\nNo error\n\n### Did this work before?\n\nNo problem up to grafana 9.3.8, upgrading directly to 9.5.9 caused this error\n\n### How do we reproduce it?\n\nWith an influxdb datasource, create a rule with a working query\r\nEdit your query to add a condition to return an empty result, ex : SELECT metric FROM measurement WHERE ... `AND \"mytag\"= 'this will crash' ` ...\r\nClick on preview\r\nGrafana goes on error immediately. \r\n\r\nGiven the error message `index out of range [0] with length 0`, it seems Grafana expects before anything that the query will always return some data\r\n\r\nThis can be confirmed on an existing rule where from time to time there's no data (like with on-demand services, or similar).\r\nWhen the crash occurs due to the absence of data, just increase the time range to `now-12h to now` and it will start working correctly, because the range is enough to have some data.\r\n\n\n### Is the bug inside a dashboard panel?\n\nRelated to Grafana alerting rules\n\n### Environment (with versions)?\n\nGrafana: 9.5.9\r\nOS: Ubuntu 22.04\r\nBrowser: Firefox ESR 115.2\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\nInfluxdb 1.9","labels":["type/bug","area/alerting"]},{"id":60715,"title":"Timeseries panel: can't highlight a value from the legend in Firefox","body":"Here is how it works in Google Chrome\r\n\r\n\r\n![grafana_firefox_highlighting_issue](https://user-images.githubusercontent.com/212955/209236375-7b2655fd-40f5-49d6-a114-570b652a63c1.gif)\r\n\r\nFor some reason, it doesn't work the same way in Firefox - it just doesn't highlight.\r\nI remember that it used to work in some old version of grafana. I can't recall which exact version broke it, but it works in grafana 8.4.4\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.2\r\n- Data source type \u0026 version: p8s\r\n- OS Grafana is installed on: official Docker container with -ubuntu\r\n- User OS \u0026 Browser: KDE Neon. Works in Google Chrome, doesn't work in Firefox\r\n","labels":["type/bug","area/panel/timeseries"]},{"id":63389,"title":"Bar values disappear when rotate bar labels ","body":"Problem:\r\nI use a Bar Char like this one:\r\n![image](https://user-images.githubusercontent.com/13017349/219362916-548a7839-b2f9-4d81-977e-dcd90f95d5ac.png)\r\nWhen I rotate the bar labels to a value other than 0, the values above the bars disappear\r\n![image](https://user-images.githubusercontent.com/13017349/219369785-769353c0-3d81-4d7b-b526-98907554feed.png)\r\n\r\nWhat can I do to see the values again?\r\n\r\n**Environment**:\r\n- Grafana version: [v9.3.6 (978237e7cb)]\r\n- Browser Chrome:latest","labels":["area/panel/barchart"]},{"id":77682,"title":"Table cell lcd cellOptions shows wrong length and color","body":"### What happened?\n\n![image](https://github.com/grafana/grafana/assets/36036872/c924fc42-afc2-4df4-93de-63ec3efe9f89)\r\nProgress bar display is inaccurate.\n\n### What did you expect to happen?\n\nShow progress evenly in segments between 0 and 1\n\n### Did this work before?\n\nSometimes it's good\n\n### How do we reproduce it?\n\nI don't know\n\n### Is the bug inside a dashboard panel?\n\nYes.\n\n### Environment (with versions)?\n\nGrafana: 10.2.0\r\nOS: ubuntu bionic\r\nBrowser: google\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\n_No response_","labels":["area/panel/bargauge","triage/needs-confirmation"]},{"id":67272,"title":"HAProxy blocks websocket requests to non-websocket endpoints","body":"## What happened:\r\n\r\nWe want to enable Live streaming/tailing for our Loki datasource. As suggested [here](https://github.com/grafana/grafana/issues/22905#issuecomment-628442315), we added the `Connection` and `Upgrade` http headers to the Loki datasource.\r\n\r\nBut as soon, as we add it, all connections to loki, except for the websocket connections, are not working anymore. We have a HAProxy in front of Loki, to loadbalance the traffic between our Loki instances. HAProxy marks the requests as invalid, as soon as the headers are added on Grafana side and the endpoint isn't a websocket endpoint.\r\n\r\nIn other words: Live tailing is working, when we add these headers, but all other requests are dropped by HAProxy because of the invalid request. So for example it's not possible to retrieve the label list from Loki.\r\n\r\nThe invalid request received by HAProxy looks like that:\r\n\r\n```\r\n[26/Apr/2023:09:38:52.479] frontend loki (#2): invalid request\r\n  backend \u003cNONE\u003e (#-1), server \u003cNONE\u003e (#-1), event #4, src 2a00:c320:1000:f::24:60372\r\n  buffer starts at 0 (including 0 out), 15706 free,\r\n  len 678, wraps at 16336, error at position 678\r\n  H1 connection flags 0x00000000, H1 stream flags 0x00000810\r\n  H1 msg state MSG_DONE(30), H1 msg flags 0x00009590\r\n  H1 chunk len 0 bytes, H1 body len 0 bytes :\r\n\r\n  00000  GET /loki/api/v1/labels?start=1682491132353000000\u0026end=1682494732353000\r\n  00070+ 000 HTTP/1.1\\r\\n\r\n  00084  Host: loki\\r\\n\r\n  00107  User-Agent: Grafana/9.4.7\\r\\n\r\n  00134  Accept: application/json, text/plain, */*\\r\\n\r\n  00177  Accept-Encoding: gzip, deflate, br\\r\\n\r\n  00213  Accept-Language: de,en-US;q=0.9,en-GB;q=0.8,en;q=0.7\\r\\n\r\n  00267  Connection: upgrade\\r\\n\r\n  00288  Dnt: 1\\r\\n\r\n  00296  Sec-Ch-Ua: \"Chromium\";v=\"112\", \"Not:A-Brand\";v=\"99\"\\r\\n\r\n  00349  Sec-Ch-Ua-Mobile: ?0\\r\\n\r\n  00371  Sec-Ch-Ua-Platform: \"macOS\"\\r\\n\r\n  00400  Sec-Fetch-Dest: empty\\r\\n\r\n  00423  Sec-Fetch-Mode: cors\\r\\n\r\n  00445  Sec-Fetch-Site: same-origin\\r\\n\r\n  00474  Upgrade: websocket\\r\\n\r\n  00494  X-Datasource-Uid: abcdefgh\\r\\n\r\n  00523  X-Forwarded-For: 89.145.13.4, 127.0.0.1\\r\\n\r\n  00564  X-Grafana-Org-Id: 3\\r\\n\r\n  00585  X-Grafana-Referer: \\r\\n\r\n  00606  X-Plugin-Id: loki\\r\\n\r\n  00625  X-Real-Ip: 89.145.13.4\\r\\n\r\n  00649  X-Scope-Orgid: loki.tenant\\r\\n\r\n  00676  \\r\\n\r\n```\r\n\r\n## What you expected to happen:\r\n\r\nWebsocket specific headers should bet set automatically for websocket connections, for example for the `/loki/api/v1/tail` endpoint of Loki.\r\n\r\n## How to reproduce it (as minimally and precisely as possible):\r\n\r\nConnect Grafana to Loki via HAProxy in front of Loki and add the websocket headers to the Loki datasource.\r\n\r\n## Anything else we need to know?:\r\n\r\nIt works if we connect Grafana directly to Loki without HAProxy in the middle.\r\n\r\n## Environment:\r\n- Grafana version: 9.4.7\r\n- Data source type \u0026 version: Loki 2.7.4\r\n- OS Grafana is installed on: Ubuntu 20.04.6\r\n- User OS \u0026 Browser: MacOS Ventura, latest Chrome and latest Firefox\r\n","labels":["needs more info","area/datasource/proxy","datasource/Loki"]},{"id":72256,"title":"Configuration: versions_to_keep has no effect","body":"### What happened?\n\nI set [versions_to_keep](https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/#versions_to_keep) to 20 in grafana.ini (which is also the default value). However, Grafana keeps creating new versions after exceeding 20.\n\n### What did you expect to happen?\n\nThat there would only be 20 versions of a given dashboard.\n\n### Did this work before?\n\nNot sure.\n\n### How do we reproduce it?\n\n1. Create a dashboard.\n2. Update the dashboard (through UI or API)  until you exceed 20 versions.\n3. There are more than 20 recorded versions of the dashboard now.\n\n\n### Is the bug inside a dashboard panel?\n\nNo.\n\n### Environment (with versions)?\n\nGrafana: 10.0.3\nOS: Linux\nBrowser: Firefox\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\n_No response_","labels":["prio/high","area/dashboard","area/backend","area/configuration","triage/needs-confirmation","team/grafana-dashboards"]},{"id":68998,"title":"Grafana Alerting - Authorization Header - Scheme\" isn't working","body":"### \n# What went wrong?\n\n\n**What happened**:\r\nI configured contact point using webhook with below details\r\nIntegration : webhook\r\nURL : API Gateway URL\r\nAuthorization Header - Scheme : x-api-key\r\nAuthorization Header - Credentials : API Key\r\n\r\nand tested alert contact point. IT gives me below error \r\n![image](https://github.com/grafana/grafana/assets/89400147/7968ba77-5cfe-4d90-84c4-f6303794a2ca)\r\n\r\nFailed to send test alert.: webhook response status 403 Forbidden\r\n\r\nURL is working with x-api-key in header with postman.\r\n\r\n**What did you expect to happen**:\r\n\r\n It should call the Api gateway URL without any issues.\r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Open Grafana and open contact points in alerting\r\n\r\n**Step 2**:\r\n\r\nI have created api gateway endpoint with api key.\r\n\r\n- Create new contact point and add below details\r\n\r\nIntegration : webhook\r\nURL : API Gateway URL\r\nAuthorization Header - Scheme : x-api-key\r\nAuthorization Header - Credentials : API Key\r\n\r\n**Step 3**:\r\n\r\nclick on Test\r\n\n\n### \n# What Grafana version are you using?\n\n\nGrafana v9.5.1\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nDocker\n\n### User's OS?\n\nUbuntu 20.04.5 LTS (Focal Fossa)\n\n### User's Browser?\n\nFirefox\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\ngrafana image - grafana/grafana:9.5.1-ubuntu","labels":["area/alerting/notifications","triage/needs-confirmation"]},{"id":75046,"title":"Alerting: Grafana 10.1 no longer shows existing labels as options when creating a new alert","body":"### What happened?\r\n\r\nWe recently upgraded from 10.0.x to 10.1.1 and one change I noticed in the UI is that when creating new alerts, existing labels are no longer being shown as options.  Not sure why this would have been removed but I feel like it's helpful to see what labels already exist and to have the choice to pick from them.  This is under section 5 when creating an alert.\r\n\r\n### What did you expect to happen?\r\n\r\nExisting tags to be shown, as it was in 10.0.x\r\n\r\n### Did this work before?\r\n\r\nYes\r\n\r\n### How do we reproduce it?\r\n\r\n1.  Create an alert and at the bottom on step 5 go to add labels and you do not get prompted with choices for existing ones.\r\n2.\r\n3.\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nNo\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: grafana/grafana:10.1.1\r\nOS: Mac OS Monterey\r\nBrowser: Chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nKubernetes\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["type/bug","area/alerting","area/frontend"]},{"id":65248,"title":"the \"Grouping to matrix\" transformation duplicates values","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nIf I want to use \"grouping to matrix\" transformation for data like (time column is hidden by other transforms, only aggregated data here):\r\n\u003ctable\u003e\r\n\u003ctr\u003e\u003ctd\u003eA\u003c/td\u003e\u003ctd\u003eB\u003c/td\u003e\u003ctd\u003eC\u003c/td\u003e\u003c/tr\u003e\r\n\u003ctr\u003e\u003ctd\u003efoo\u003c/td\u003e\u003ctd\u003e1\u003c/td\u003e\u003ctd\u003ewhat\u003c/td\u003e\u003c/tr\u003e\r\n\u003ctr\u003e\u003ctd\u003efoo\u003c/td\u003e\u003ctd\u003e2\u003c/td\u003e\u003ctd\u003esome\u003c/td\u003e\u003c/tr\u003e\r\n\u003ctr\u003e\u003ctd\u003ebar\u003c/td\u003e\u003ctd\u003e3\u003c/td\u003e\u003ctd\u003ewhat\u003c/td\u003e\u003c/tr\u003e\r\n\u003ctr\u003e\u003ctd\u003ebar\u003c/td\u003e\u003ctd\u003e4\u003c/td\u003e\u003ctd\u003esome\u003c/td\u003e\u003c/tr\u003e\r\n\u003ctr\u003e\u003ctd\u003ebuz\u003c/td\u003e\u003ctd\u003e5\u003c/td\u003e\u003ctd\u003ewhat\u003c/td\u003e\u003c/tr\u003e\r\n\u003ctr\u003e\u003ctd\u003ebuz\u003c/td\u003e\u003ctd\u003e6\u003c/td\u003e\u003ctd\u003esome\u003c/td\u003e\u003c/tr\u003e\r\n\u003c/table\u003e\r\n\r\nI select \"A\" as Column, \"C\" as Row and \"B\" as Cell Value\r\n\r\nand I got this:\r\n\r\n\u003ctable\u003e\r\n\u003ctr\u003e\u003ctd\u003eC\\A\u003c/td\u003e\u003ctd\u003efoo\u003c/td\u003e\u003ctd\u003ebar\u003c/td\u003e\u003ctd\u003ebaz\u003c/td\u003e\u003c/tr\u003e\r\n\u003ctr\u003e\u003ctd\u003ewhat\u003c/td\u003e\u003ctd\u003e1\u003c/td\u003e\u003ctd\u003e1\u003c/td\u003e\u003ctd\u003e1\u003c/td\u003e\u003c/tr\u003e\r\n\u003ctr\u003e\u003ctd\u003esome\u003c/td\u003e\u003ctd\u003e2\u003c/td\u003e\u003ctd\u003e2\u003c/td\u003e\u003ctd\u003e2\u003c/td\u003e\u003c/tr\u003e\r\n\u003ctr\u003e\u003ctd\u003ewhat\u003c/td\u003e\u003ctd\u003e3\u003c/td\u003e\u003ctd\u003e3\u003c/td\u003e\u003ctd\u003e3\u003c/td\u003e\u003c/tr\u003e\r\n\u003ctr\u003e\u003ctd\u003esome\u003c/td\u003e\u003ctd\u003e4\u003c/td\u003e\u003ctd\u003e4\u003c/td\u003e\u003ctd\u003e4\u003c/td\u003e\u003c/tr\u003e\r\n\u003ctr\u003e\u003ctd\u003ewhat\u003c/td\u003e\u003ctd\u003e5\u003c/td\u003e\u003ctd\u003e5\u003c/td\u003e\u003ctd\u003e5\u003c/td\u003e\u003c/tr\u003e\r\n\u003ctr\u003e\u003ctd\u003esome\u003c/td\u003e\u003ctd\u003e6\u003c/td\u003e\u003ctd\u003e6\u003c/td\u003e\u003ctd\u003e6\u003c/td\u003e\u003c/tr\u003e\r\n\u003c/table\u003e\r\n\r\n**What you expected to happen**:\r\nbut I expect to obtain this:\r\n\u003ctable\u003e\r\n\u003ctr\u003e\u003ctd\u003eC\\A\u003c/td\u003e\u003ctd\u003efoo\u003c/td\u003e\u003ctd\u003ebar\u003c/td\u003e\u003ctd\u003ebaz\u003c/td\u003e\u003c/tr\u003e\r\n\u003ctr\u003e\u003ctd\u003ewhat\u003c/td\u003e\u003ctd\u003e1\u003c/td\u003e\u003ctd\u003e3\u003c/td\u003e\u003ctd\u003e5\u003c/td\u003e\u003c/tr\u003e\r\n\u003ctr\u003e\u003ctd\u003esome\u003c/td\u003e\u003ctd\u003e2\u003c/td\u003e\u003ctd\u003e4\u003c/td\u003e\u003ctd\u003e6\u003c/td\u003e\u003c/tr\u003e\r\n\u003c/table\u003e\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n1. Use grafana Table panel and influxdb\r\n2. Select data with grouping by 2 tags (grouping should bring unique rows. Do not group by time)\r\n3. Use \"organize fields\" to hide the time column\r\n4. Use \"Grouping to matrix\" to try to pivot data with unique cols and rows\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version:9.0.7\r\n- Data source type \u0026 version: InfluxDB \r\n- OS Grafana is installed on: Debian 10\r\n- User OS \u0026 Browser: Win10 \u0026 Firefox Developer Ed 112.0b3 (64-разрядный)\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/transformations"]},{"id":59539,"title":"Error when importing dashboard from JSON as Editor","body":"**What happened**:\r\nWhen importing a dashboard from JSON as an Editor, message `Access denied to this dashboard` appears and dashboard is not loaded. \r\nBrowser developer console shows 403 accessing `/api/dashboards/uid/[UID]`\r\n\r\nRefreshing the page after a few seconds will load the dashboard.\r\n\r\n**What you expected to happen**:\r\nDashboard is immediately visible\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n1. Run `docker run -d --name=grafana -p 3000:3000 grafana/grafana:9.2.7`\r\n2. Login as admin, and create a user with the Editor role\r\n3. Login as the user with the Editor role, import any dashboard from JSON\r\n4. Error occurs and dashboard is not loaded\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.7 (seems to have been introduced in 9.2.0, worked in 9.1.8)\r\n- Data source type \u0026 version: N/A\r\n- OS Grafana is installed on: Official Docker image\r\n- User OS \u0026 Browser: macOS 12.6 \u0026 Firefox 107.0\r\n- Grafana plugins: None\r\n- Others:\r\n","labels":["type/bug","area/dashboard","area/dashboard/import","team/grafana-dashboards","prio/future"]},{"id":79920,"title":"Explore - no way to exit back to dashboard","body":"### What happened?\r\n\r\nv 10.2.3  (is not a new issue though, exists in prior versions)\r\n\r\nif you are looking at a dashboard,  then click on a panel (in that dashboard), **then Explore ,** \r\nthere is **no way to exit back to the dashboard (ie exit out of Explore mode)**\r\n\r\nThe keyboard help says pressing escape should do this (it does not although a ESC does work on other pages).\r\n\r\n(you could click \"add to dashboard\",  but In my use case this is not what I'm looking to do, I'm generally looking to see deeper data on a specific panel of a dashboard, then go back to that dashboard).   I do realize there are other use cases of the Explore page/function.\r\n\r\n(there is no cancel button, And after doing a few runs or changes the browser back button now reverts to to within the same explore page)  -  I'm not sure how this affects if you have made if you have unsaved changes to a dashboard but at a minimum it may cause confusion and Unintentional lost unsaved dashboard changes.\r\n\r\nsee screen cap below showing what im referring to, please:\r\n\r\nthanks,\r\nLOVE GRAFANA!\r\n\r\n![grafanaExplore2](https://github.com/grafana/grafana/assets/60830628/8fdf7461-5706-4612-a507-30d3f78026fd)\r\n\r\n\r\n### What did you expect to happen?\r\n\r\na cancel or back button should exist - or pressing escape should bring you back to the dashboard \r\n\r\n### Did this work before?\r\n\r\nno, is not a new bug\r\n\r\n### How do we reproduce it?\r\n\r\n1.see screen cap video \r\n2.\r\n3.\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.2.3\r\nOS:  win11\r\nBrowser: FF v120 ,  or chrome  \r\n\r\n\r\n### Grafana platform?\r\n\r\nNone\r\n\r\n### Datasource(s)?\r\n\r\ntested w InfluxDB and Graphite (i think applies to all DSes though)","labels":["type/feature-request","area/dashboard","area/panel/edit","team/grafana-dashboards"]},{"id":59334,"title":"Alert notification has blank image - image render reports \"RangeError: Invalid array length\" ","body":"**What happened**: \r\n\r\nI set up a very simple chart based on elasticsearch data set. It shows count of records only. When I use the \"Direct link rendered image\" from Share panel, everything is rendered as expected:\r\n\r\n![image](https://user-images.githubusercontent.com/138919/203961249-85d083f6-0f9c-4af6-b0c7-26fa9b4188dc.png)\r\n\r\nWhen an alert is fired the attached image of the same panel is rendered without data chart although the stats in legend column are shown (data from elasticsearch must be delivered). Here is the screenshot of the whole alert:\r\n\r\n![image](https://user-images.githubusercontent.com/138919/203962594-db536ba1-a9d4-4293-869d-c2b66f7ab569.png)\r\n\r\nAnd here is enlarged chart from the message:\r\n![image](https://user-images.githubusercontent.com/138919/203962780-4bb62b0f-3674-416b-9b31-d9408640a03e.png)\r\n\r\nThere is a suspicious line with javascript error in renderer debug log (whole log is attached to this issue - [grafana-renderer.log.txt](https://github.com/grafana/grafana/files/10091805/grafana-renderer.log.txt) ):\r\n\r\n```\r\ngrafana-renderer-1  | 2022-11-25T10:18:08.617496444Z {\"error\":\"Error: RangeError: Invalid array length\\n    at Array.push (http://grafana:3000/public/build/4713.8a8cb5e884bc8a897819.js:2:1529240)\\n    at Object.splits (http://grafana:3000/public/build/4713.8a8cb5e884bc8a897819.js:2:2830524)\\n    at http://grafana:3000/public/build/4713.8a8cb5e884bc8a897819.js:2:2852114\\n    at Array.forEach (\u003canonymous\u003e)\\n    at ir (http://grafana:3000/public/build/4713.8a8cb5e884bc8a897819.js:2:2851710)\\n    at http://grafana:3000/public/build/4713.8a8cb5e884bc8a897819.js:2:2854174\\n    at xr (http://grafana:3000/public/build/4713.8a8cb5e884bc8a897819.js:2:2854234)\",\"level\":\"error\",\"message\":\"Browser uncaught exception\"}\r\n```\r\n\r\nI tried different versions with the same result:\r\n\r\n- grafana/grafana:latest (9.6.2) with grafana/grafana-image-renderer:3.6.2\r\n- grafana/grafana-oss:latest (9.6.2) with grafana/grafana-image-renderer:3.6.2\r\n- grafana/grafana-oss:9.6.1 with grafana/grafana-image-renderer:3.6.1\r\n\r\n**What you expected to happen**:\r\n\r\nImage is rendered for alert with data chart.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: docker images\r\n\r\n```\r\nrroot@grafana:/opt/grafana# docker images --digests\r\nREPOSITORY                       TAG       DIGEST                                                                    IMAGE ID       CREATED      SIZE\r\ngrafana/grafana                  9.2.6     sha256:541b84ab152f675aae0a4a0aeead142923c39e45dddb7a19eeee96493eb6d778   eb4a939d5821   2 days ago   342MB\r\ngrafana/grafana-image-renderer   3.6.2     sha256:cbb508cee8a55c9f2f850e33bfcf7e487757e309a5a417df82d2d590b1333698   e21625b496ab   3 days ago   846MB\r\n```\r\n\r\n- Data source type \u0026 version: elasticsearch 7.10+\r\n- OS Grafana is installed on: Debian 11.5 with Docker - community version 20.10.19\r\n- User OS \u0026 Browser: -\r\n- Grafana plugins: -\r\n- Others: -\r\n\r\n","labels":["type/bug","prio/high","area/alerting","area/alerting/screenshots"]},{"id":59460,"title":"Webhook duplicate send","body":"Hello,\r\n\r\nHave you ever encountered the case of a double send during a grafana alert with a webhook ?\r\n\r\nI’ve trouble seeing why I have a duplicate in the sending and its resolution","labels":["type/question","area/alerting"]},{"id":66211,"title":"Notification send error using slack contact point","body":"**What happened**:  I got an error while sending notification through slack webhook integration, but message has seccesfully delivered. The bug appeared in Grafana v9.4.X\r\n\r\n**What you expected to happen**: Susses status notification in Grafana.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nInstall Grafana 9.4.X, Add rocketchat (slack not tested) as contact point through slack integration, click `Send test notification` button.\r\n\r\n**Anything else we need to know?**:\r\n\r\nGrafana logs\r\n```\r\nlogger=ngalert.notifier.slack t=2023-04-03T15:07:29.501002719Z level=error msg=\"Missing receiver\"\r\nlogger=ngalert.notifier.slack t=2023-04-03T15:07:29.501093799Z level=error msg=\"Missing group labels\"\r\nlogger=ngalert.notifier.slack t=2023-04-03T15:07:29.584433499Z level=error msg=\"The request was unsuccessful\" body=\"{\\\"success\\\":true}\" err=\r\nlogger=ngalert.notifier.slack t=2023-04-03T15:07:29.584522011Z level=error msg=\"Failed to send Slack message\" err=\"failed to send request: \"\r\nlogger=context userId=1 orgId=1 uname=admin t=2023-04-03T15:07:29.584805398Z level=info msg=\"Request Completed\" method=POST path=/api/alertmanager/grafana/config/api/v1/receivers/test status=207 remote_addr=172.18.0.1 time_ms=184 duration=184.826928ms size=413 referer= handler=/api/alertmanager/grafana/config/api/v1/receivers/test\r\n```\r\nGrafana UI\r\n\u003cimg width=\"668\" alt=\"Screenshot 2023-04-03 at 18 12 55\" src=\"https://user-images.githubusercontent.com/65022127/229552883-9eb6825b-ddd9-4d42-b458-03cf10f3518c.png\"\u003e\r\n\r\nIn version previous to 9.4.0 this contact point has worked.\r\n\r\nBecause of this error, I don't receive resolved status and notification retries by `Group interval` timeout.\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.7\r\n- Data source type \u0026 version: Doesn't matter\r\n- OS Grafana is installed on: Docker\r\n- User OS \u0026 Browser: Doesn't matter\r\n- Grafana plugins: Doesn't matter\r\n- Others:\r\n","labels":["area/alerting","prio/low","triage/needs-confirmation"]},{"id":43862,"title":"Graph does not display data when max data points is too small","body":"**What happened**:\r\nWhen viewing a graph on a smaller screen size, the graph displays \"No data\", however resizing the screen and refreshing makes the data appear. This seems to be caused by the \"Max data points\" query option, which is automatically set to ~900. When viewing the same graph on a larger screen max data points is ~1400, and the graph displays as normal. If I view the graph on the smaller screen, but update max data points to be 1400 the graph displays as normal. Similarly, when viewing on the larger screen, setting max data points to be ~900 \"No data\" is shown.\r\n\r\n**What you expected to happen**:\r\nGraphs to display as normal regardless of screen size/max data points.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n- View a graph on a smaller screen\r\n- Modify max data points and refresh graph until \"No data\" message appears\r\n\r\n**Environment**:\r\n- Grafana version: 7.5.11\r\n- Data source type \u0026 version: Prometheus\r\n- OS Grafana is installed on: Linux\r\n- User OS \u0026 Browser: macOS Big Sur 11.5.2, Google Chrome 96 \r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/panel/graph","needs more info","area/panel/data","bot/no new info","area/panel/timeseries"]},{"id":78368,"title":"First repeating library panel erroneously shows no data","body":"### What happened?\n\nWhen using repeating library panels and the panel is repeated (i.e. there is more than one value for the configured variable), the first panel will return \"No data\" until the dashboard is refreshed.\r\n\r\nThis looks to be a regression with the fix for #59805. Unlinking the library panel and saving the dashboard resolves; but re-linking the dashboard panel will introduce the bug again.\n\n### What did you expect to happen?\n\nRepeating library panels should work just like regularly repeating panels and show the correct data (not no data).\n\n### Did this work before?\n\nYes.\n\n### How do we reproduce it?\n\n1. Create a dashboard with a variable and two values, and allow multi-value and include all option\r\n2. Create a library panel that repeats based on that variable\r\n3. Select the all option and save the dashboard, selecting the option to save current variable values as default\r\n4. Navigate to a different dashboard\r\n5. Navigate back\r\n6. Notice that the repeating library panel shows \"No data\" until the refresh button is clicked\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: Grafana Cloud v10.3.0-63516 (5096806eab)\r\nOS: Linux\r\nBrowser: Firefox\r\n\n\n### Grafana platform?\n\nI use Grafana Cloud\n\n### Datasource(s)?\n\nPrometheus","labels":["area/dashboard","triage/needs-confirmation","team/grafana-dashboards"]},{"id":63130,"title":"Annotations API does not return Alert Annotations if `from` and `to` are specified.","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: When a time range using `from` and `to` is passed to the Annotations API, Alert annotations are not returned. Only manually created annotations are returned.\r\n\r\n**What you expected to happen**: All annotations relevant to the query should be returned, regardless of type.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: \r\n\r\n- Create a dashboard, with a panel that you want to annotate with Alert annotations.\r\n- Create an alert and set Dashboard UID and Panel ID to the appropriate values.\r\n- Create an instance where that alert fires.\r\n- Go to the dashboard, although the heart (indicating theres an associated alert) will show on the panel, no alerts will fire.\r\n- Open the network tab, look for the annotations API query the board is making, open this in a new tab.\r\n- The returned array will be empty. Remove the `from` and `to` parameters from the query.\r\n- The desired Alert annotations will be returned as expected.\r\n\r\n**Anything else we need to know?**:\r\n- This doesn't affect the \"Status History\" window as it only passes `alertId` and not any time range.\r\n- Manually created annotations are returned with time range as expected.\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.6\r\n- Data source type \u0026 version: Grafana, 9.3.6\r\n- OS Grafana is installed on: Linux\r\n- User OS \u0026 Browser: Chrome for Mac\r\n- Grafana plugins: None\r\n- Others:\r\n","labels":["area/annotations","triage/needs-confirmation"]},{"id":64552,"title":"Alerting: failed to evaluate queries and expressions: input data must be a wide series but got type long (input refid)","body":"**What happened**:\r\n\r\nCreating alerts with InfluxDB (Flux query) datasource fails with obscure error.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nFollowing self containing expression triggers the problem:\r\n\r\n```\r\nimport \"csv\"\r\n\r\ncsvData = \"\r\n#group,false,false,false,true,true,true,true,false,false\r\n#datatype,string,long,dateTime:RFC3339,string,string,string,string,long,string\r\n#default,_result,,,,,,,,\r\n,result,table,_time,container_name,mc_zone,namespace,pod_name,_value,_field\r\n,,1,2023-03-09T17:16:02Z,app,zone1,p-project1,app-1,10037694,cpu\r\n,,2,2023-03-09T17:16:02Z,app,zone1,p-project1,app-0,92576117,cpu\r\n\"\r\n\r\ncsv.from(csv: csvData)\r\n```\r\n\r\n**Anything else we need to know?**:\r\n\r\nThere were mentions of this error in issues, but they seem to be related to missing data condition, but in my case data clearly presents.\r\n\r\nNot every influxdb query fails to create alert, some work fine. \r\n\r\n**Environment**:\r\n- Grafana version: 9.4.3 on Grafana cloud\r\n\r\n","labels":["datasource/InfluxDB","area/alerting"]},{"id":76423,"title":"ServiceAccounts: missing pagination","body":"### What happened?\n\nUnder Administration \u003e Service Accounts. When the number of items no longer fit on one page, there are no page navigation elements at either the top or bottom of the page. Items that don't fit the first page can only be found by using the search bar.\n\n### What did you expect to happen?\n\nNavigation buttons should appear\n\n### Did this work before?\n\nDon't know\n\n### How do we reproduce it?\n\nCreate \u003e100 service accounts\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.1.2\r\nOS: Ubuntu\r\nBrowser: Chrome\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\n_No response_","labels":["area/auth/serviceaccount","triage/needs-confirmation"]},{"id":68941,"title":"Alerting: Datasource error appears periodically","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n  - Every day there is a Datasource Error that appears at the same time. \r\n\r\n**What did you expect to happen**:\r\n\r\n  - It shouldn't appear\r\n\n\n### \n# How do we reproduce it?\n\n\nNot sure how to reproduce. \r\nThere are two datasources for which alerts are defined. \r\nOne Datasource is Microsoft SQL Server, one is InfluxDB.\r\nFrom InfluxDB there are around 175 alerts defined, for SQL Server there is only one alert defined.\r\nThe alert defined for data coming from SQL Server is attached to an email contact point, the others are attached to a webhook CP.\r\nEveryday (for around 2 weeks now), at the same hour, there are Datasource Error alerts generated, for both datasources (i receive an email for the first one, i catch the webhook for the second one).\n\n### \n# What Grafana version are you using?\n\n\nGrafana v9.5.2 (cfcea75916)\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nNot in a dashboard panel\n\n### Grafana Platform?\n\nA downloaded binary\n\n### User's OS?\n\nUbuntu 22.04.2 LTS (GNU/Linux 5.15.0-70-generic x86_64)\n\n### User's Browser?\n\nMicrosoft Edge Version 112.0.1722.39 (Official build) (64-bit)\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\nInfluxDB, Microsoft SQL Server\n\n### Anything else to add?\n\n\n_No response_","labels":["area/alerting","area/backend","triage/needs-confirmation"]},{"id":64084,"title":"Grafana 9.3 and 9.4 \"Copy\" disabled for legend text","body":"**What happened**:\r\n\r\nIn earlier versions of Grafana, you could copy the text from the legend in the Legacy Graph and Time Series panels.\r\n\r\nThis appears to have gone away in 9.3 and 9.4 and is breaking some workflows.\r\n\r\n**What you expected to happen**:\r\n\r\nHighlight text in the legend, copy, and then paste into either the dashboard as a filter or else where for analysis.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nAttempt to highlight text in legend on the Time Series or Legacy Graph panels.\r\n\r\n**Anything else we need to know?**:\r\n\r\nIf you want to do a solid, add a \"copy to pasteboard\" shortcut option to legend labels. It's often critical to workflows to take data from the legends to use as a filter or jumping off point for an investigation. \r\n\r\nThere may be some \"UX Guideline\" somewhere that suggests removing the highlight here is better, but without a \"copy to pasteboard\" option, it completely breaks all of our workflows.\r\n\r\nWe have \"overview\" dashboards that display a number of graphs bubbling \"top N\"s up to view. We typically pivot by trying to click on those and add them as filters.  This has never been an option with Time Series or Legacy Graphs (but is in the Table View). It would be *really* useful to have that as well.\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.1 and 9.4.3\r\n- Data source type \u0026 version: Any\r\n- OS Grafana is installed on: CentOS 7\r\n- User OS \u0026 Browser: MacOS Firefox\r\n- Grafana plugins: N/A\r\n- Others: N/A\r\n","labels":["type/bug","area/panel/timeseries","triage/needs-confirmation","area/legend"]},{"id":59326,"title":"Error moving variable up or down","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n \u003eWhen I move the order of variables, disorder may occur\r\n\r\n**What you expected to happen**:\r\n\u003eDisplayed in the order of movement\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n![image](https://user-images.githubusercontent.com/16489768/203885036-b7084e39-3d35-480c-bfe9-fc0497cc0483.png)\r\nmove a variable up or down the list using drag and drop.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: v8.4.5\r\n- Data source type \u0026 version: Altinity plugin for ClickHouse\r\n- OS Grafana is installed on: docker\r\n- User OS \u0026 Browser: chome\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/dashboard","needs more info","bot/no new info"]},{"id":69387,"title":"Dashboard Panel: not showing data for mixed datasources when adding an expression","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\nThe dashboard panel is not showing any graphs or data when I am using mixed datasources and add an expression, even when the expression is just dealing with one of the sources.\r\n\r\n**What did you expect to happen**:\r\n\r\n Showing the expressions value, as it is working with a single data source.\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\n- Open Grafana and ad a new panel\r\n\r\n**Step 2**:\r\n\r\n- Now switch the datasource to mixed\r\n\r\n**Step 3**:\r\n\r\n- add some queries\r\n\r\n**Step 4**:\r\n\r\n- add an expression, as soon as you leave the field the panel is showing an error\r\n\r\n\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\nGrafana v9.5.2 (cfcea75916)\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\n| Key | Value |\r\n|--|--|\r\n| Panel | timeseries @ 9.5.2 (cfcea75916) |\r\n| Grafana | 9.5.2 (cfcea75916) // Open Source |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"custom\": {\r\n            \"drawStyle\": \"line\",\r\n            \"lineInterpolation\": \"linear\",\r\n            \"barAlignment\": 0,\r\n            \"lineWidth\": 1,\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"spanNulls\": false,\r\n            \"showPoints\": \"auto\",\r\n            \"pointSize\": 5,\r\n            \"stacking\": {\r\n              \"mode\": \"none\",\r\n              \"group\": \"A\"\r\n            },\r\n            \"axisPlacement\": \"auto\",\r\n            \"axisLabel\": \"\",\r\n            \"axisColorMode\": \"text\",\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"axisCenteredZero\": false,\r\n            \"hideFrom\": {\r\n              \"tooltip\": false,\r\n              \"viz\": false,\r\n              \"legend\": false\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": [\r\n          {\r\n            \"matcher\": {\r\n              \"id\": \"byName\",\r\n              \"options\": \"Sonnenhöhe\"\r\n            },\r\n            \"properties\": [\r\n              {\r\n                \"id\": \"unit\",\r\n                \"value\": \"degree\"\r\n              },\r\n              {\r\n                \"id\": \"color\",\r\n                \"value\": {\r\n                  \"fixedColor\": \"orange\",\r\n                  \"mode\": \"fixed\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          {\r\n            \"matcher\": {\r\n              \"id\": \"byName\",\r\n              \"options\": \"Netzzukauf\"\r\n            },\r\n            \"properties\": [\r\n              {\r\n                \"id\": \"unit\",\r\n                \"value\": \"watt\"\r\n              },\r\n              {\r\n                \"id\": \"custom.fillOpacity\",\r\n                \"value\": 51\r\n              },\r\n              {\r\n                \"id\": \"color\",\r\n                \"value\": {\r\n                  \"fixedColor\": \"dark-purple\",\r\n                  \"mode\": \"fixed\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          {\r\n            \"matcher\": {\r\n              \"id\": \"byName\",\r\n              \"options\": \"Solarertrag\"\r\n            },\r\n            \"properties\": [\r\n              {\r\n                \"id\": \"unit\",\r\n                \"value\": \"watt\"\r\n              },\r\n              {\r\n                \"id\": \"color\",\r\n                \"value\": {\r\n                  \"fixedColor\": \"yellow\",\r\n                  \"mode\": \"fixed\"\r\n                }\r\n              },\r\n              {\r\n                \"id\": \"custom.fillOpacity\",\r\n                \"value\": 100\r\n              }\r\n            ]\r\n          },\r\n          {\r\n            \"matcher\": {\r\n              \"id\": \"byName\",\r\n              \"options\": \"Stromverbrauch\"\r\n            },\r\n            \"properties\": [\r\n              {\r\n                \"id\": \"unit\",\r\n                \"value\": \"watt\"\r\n              },\r\n              {\r\n                \"id\": \"color\",\r\n                \"value\": {\r\n                  \"fixedColor\": \"dark-blue\",\r\n                  \"mode\": \"fixed\"\r\n                }\r\n              },\r\n              {\r\n                \"id\": \"custom.fillOpacity\",\r\n                \"value\": 50\r\n              }\r\n            ]\r\n          },\r\n          {\r\n            \"matcher\": {\r\n              \"id\": \"byName\",\r\n              \"options\": \"Netzverkauf\"\r\n            },\r\n            \"properties\": [\r\n              {\r\n                \"id\": \"unit\",\r\n                \"value\": \"watt\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        },\r\n        \"legend\": {\r\n          \"showLegend\": true,\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"calcs\": []\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"grafana\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"snapshot\",\r\n          \"snapshot\": []\r\n        }\r\n      ],\r\n      \"title\": \"Reproduced with embedded data\",\r\n      \"type\": \"timeseries\"\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003etimeseries @ 9.5.2 (cfcea75916)\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003eSonnenhöhe[fetzerch-sunandmoon-datasource], Solarertrag[influxdb], Stromverbrauch[__expr__], Netzzukauf[influxdb], Netzverkauf_raw[influxdb], Netzverkauf[__expr__]\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003eError 0 frames, 0 fields, 0 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e9.5.2 (cfcea75916) // Open Source\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"title\": \"Original Panel JSON\",\r\n      \"type\": \"text\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 7\r\n      },\r\n      \"options\": {\r\n        \"content\": \"{\\n  \\\"datasource\\\": {\\n    \\\"uid\\\": \\\"-- Mixed --\\\",\\n    \\\"type\\\": \\\"datasource\\\"\\n  },\\n  \\\"fieldConfig\\\": {\\n    \\\"defaults\\\": {\\n      \\\"custom\\\": {\\n        \\\"drawStyle\\\": \\\"line\\\",\\n        \\\"lineInterpolation\\\": \\\"linear\\\",\\n        \\\"barAlignment\\\": 0,\\n        \\\"lineWidth\\\": 1,\\n        \\\"fillOpacity\\\": 0,\\n        \\\"gradientMode\\\": \\\"none\\\",\\n        \\\"spanNulls\\\": false,\\n        \\\"showPoints\\\": \\\"auto\\\",\\n        \\\"pointSize\\\": 5,\\n        \\\"stacking\\\": {\\n          \\\"mode\\\": \\\"none\\\",\\n          \\\"group\\\": \\\"A\\\"\\n        },\\n        \\\"axisPlacement\\\": \\\"auto\\\",\\n        \\\"axisLabel\\\": \\\"\\\",\\n        \\\"axisColorMode\\\": \\\"text\\\",\\n        \\\"scaleDistribution\\\": {\\n          \\\"type\\\": \\\"linear\\\"\\n        },\\n        \\\"axisCenteredZero\\\": false,\\n        \\\"hideFrom\\\": {\\n          \\\"tooltip\\\": false,\\n          \\\"viz\\\": false,\\n          \\\"legend\\\": false\\n        },\\n        \\\"thresholdsStyle\\\": {\\n          \\\"mode\\\": \\\"off\\\"\\n        }\\n      },\\n      \\\"color\\\": {\\n        \\\"mode\\\": \\\"palette-classic\\\"\\n      },\\n      \\\"mappings\\\": [],\\n      \\\"thresholds\\\": {\\n        \\\"mode\\\": \\\"absolute\\\",\\n        \\\"steps\\\": [\\n          {\\n            \\\"color\\\": \\\"green\\\",\\n            \\\"value\\\": null\\n          },\\n          {\\n            \\\"color\\\": \\\"red\\\",\\n            \\\"value\\\": 80\\n          }\\n        ]\\n      }\\n    },\\n    \\\"overrides\\\": [\\n      {\\n        \\\"matcher\\\": {\\n          \\\"id\\\": \\\"byName\\\",\\n          \\\"options\\\": \\\"Sonnenhöhe\\\"\\n        },\\n        \\\"properties\\\": [\\n          {\\n            \\\"id\\\": \\\"unit\\\",\\n            \\\"value\\\": \\\"degree\\\"\\n          },\\n          {\\n            \\\"id\\\": \\\"color\\\",\\n            \\\"value\\\": {\\n              \\\"fixedColor\\\": \\\"orange\\\",\\n              \\\"mode\\\": \\\"fixed\\\"\\n            }\\n          }\\n        ]\\n      },\\n      {\\n        \\\"matcher\\\": {\\n          \\\"id\\\": \\\"byName\\\",\\n          \\\"options\\\": \\\"Netzzukauf\\\"\\n        },\\n        \\\"properties\\\": [\\n          {\\n            \\\"id\\\": \\\"unit\\\",\\n            \\\"value\\\": \\\"watt\\\"\\n          },\\n          {\\n            \\\"id\\\": \\\"custom.fillOpacity\\\",\\n            \\\"value\\\": 51\\n          },\\n          {\\n            \\\"id\\\": \\\"color\\\",\\n            \\\"value\\\": {\\n              \\\"fixedColor\\\": \\\"dark-purple\\\",\\n              \\\"mode\\\": \\\"fixed\\\"\\n            }\\n          }\\n        ]\\n      },\\n      {\\n        \\\"matcher\\\": {\\n          \\\"id\\\": \\\"byName\\\",\\n          \\\"options\\\": \\\"Solarertrag\\\"\\n        },\\n        \\\"properties\\\": [\\n          {\\n            \\\"id\\\": \\\"unit\\\",\\n            \\\"value\\\": \\\"watt\\\"\\n          },\\n          {\\n            \\\"id\\\": \\\"color\\\",\\n            \\\"value\\\": {\\n              \\\"fixedColor\\\": \\\"yellow\\\",\\n              \\\"mode\\\": \\\"fixed\\\"\\n            }\\n          },\\n          {\\n            \\\"id\\\": \\\"custom.fillOpacity\\\",\\n            \\\"value\\\": 100\\n          }\\n        ]\\n      },\\n      {\\n        \\\"matcher\\\": {\\n          \\\"id\\\": \\\"byName\\\",\\n          \\\"options\\\": \\\"Stromverbrauch\\\"\\n        },\\n        \\\"properties\\\": [\\n          {\\n            \\\"id\\\": \\\"unit\\\",\\n            \\\"value\\\": \\\"watt\\\"\\n          },\\n          {\\n            \\\"id\\\": \\\"color\\\",\\n            \\\"value\\\": {\\n              \\\"fixedColor\\\": \\\"dark-blue\\\",\\n              \\\"mode\\\": \\\"fixed\\\"\\n            }\\n          },\\n          {\\n            \\\"id\\\": \\\"custom.fillOpacity\\\",\\n            \\\"value\\\": 50\\n          }\\n        ]\\n      },\\n      {\\n        \\\"matcher\\\": {\\n          \\\"id\\\": \\\"byName\\\",\\n          \\\"options\\\": \\\"Netzverkauf\\\"\\n        },\\n        \\\"properties\\\": [\\n          {\\n            \\\"id\\\": \\\"unit\\\",\\n            \\\"value\\\": \\\"watt\\\"\\n          }\\n        ]\\n      }\\n    ]\\n  },\\n  \\\"gridPos\\\": {\\n    \\\"h\\\": 15,\\n    \\\"w\\\": 21,\\n    \\\"x\\\": 0,\\n    \\\"y\\\": 15\\n  },\\n  \\\"id\\\": 7,\\n  \\\"options\\\": {\\n    \\\"tooltip\\\": {\\n      \\\"mode\\\": \\\"single\\\",\\n      \\\"sort\\\": \\\"none\\\"\\n    },\\n    \\\"legend\\\": {\\n      \\\"showLegend\\\": true,\\n      \\\"displayMode\\\": \\\"list\\\",\\n      \\\"placement\\\": \\\"bottom\\\",\\n      \\\"calcs\\\": []\\n    }\\n  },\\n  \\\"targets\\\": [\\n    {\\n      \\\"refId\\\": \\\"Sonnenhöhe\\\",\\n      \\\"hide\\\": false,\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"fetzerch-sunandmoon-datasource\\\",\\n        \\\"uid\\\": \\\"de7cd6fa-bc51-417a-b402-6e381e9c0202\\\"\\n      },\\n      \\\"target\\\": []\\n    },\\n    {\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"influxdb\\\",\\n        \\\"uid\\\": \\\"6m95lwRgk\\\"\\n      },\\n      \\\"alias\\\": \\\"Solarertrag\\\",\\n      \\\"groupBy\\\": [\\n        {\\n          \\\"params\\\": [\\n            \\\"2m\\\"\\n          ],\\n          \\\"type\\\": \\\"time\\\"\\n        },\\n        {\\n          \\\"params\\\": [\\n            \\\"none\\\"\\n          ],\\n          \\\"type\\\": \\\"fill\\\"\\n        }\\n      ],\\n      \\\"hide\\\": false,\\n      \\\"measurement\\\": \\\"PV Garage Leistung Anlage\\\",\\n      \\\"orderByTime\\\": \\\"ASC\\\",\\n      \\\"policy\\\": \\\"autogen\\\",\\n      \\\"refId\\\": \\\"Solarertrag\\\",\\n      \\\"resultFormat\\\": \\\"time_series\\\",\\n      \\\"select\\\": [\\n        [\\n          {\\n            \\\"params\\\": [\\n              \\\"value\\\"\\n            ],\\n            \\\"type\\\": \\\"field\\\"\\n          },\\n          {\\n            \\\"params\\\": [],\\n            \\\"type\\\": \\\"mean\\\"\\n          }\\n        ]\\n      ],\\n      \\\"tags\\\": []\\n    },\\n    {\\n      \\\"datasource\\\": {\\n        \\\"name\\\": \\\"Expression\\\",\\n        \\\"type\\\": \\\"__expr__\\\",\\n        \\\"uid\\\": \\\"__expr__\\\"\\n      },\\n      \\\"expression\\\": \\\"$Netzzukauf - $Netzverkauf + $Solarertrag\\\",\\n      \\\"hide\\\": false,\\n      \\\"refId\\\": \\\"Stromverbrauch\\\",\\n      \\\"type\\\": \\\"math\\\"\\n    },\\n    {\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"influxdb\\\",\\n        \\\"uid\\\": \\\"6m95lwRgk\\\"\\n      },\\n      \\\"alias\\\": \\\"Netzzukauf\\\",\\n      \\\"groupBy\\\": [\\n        {\\n          \\\"params\\\": [\\n            \\\"2m\\\"\\n          ],\\n          \\\"type\\\": \\\"time\\\"\\n        },\\n        {\\n          \\\"params\\\": [\\n            \\\"linear\\\"\\n          ],\\n          \\\"type\\\": \\\"fill\\\"\\n        }\\n      ],\\n      \\\"hide\\\": false,\\n      \\\"measurement\\\": \\\"Stromzähler_Momentanverbrauch\\\",\\n      \\\"orderByTime\\\": \\\"ASC\\\",\\n      \\\"policy\\\": \\\"autogen\\\",\\n      \\\"refId\\\": \\\"Netzzukauf\\\",\\n      \\\"resultFormat\\\": \\\"time_series\\\",\\n      \\\"select\\\": [\\n        [\\n          {\\n            \\\"params\\\": [\\n              \\\"value\\\"\\n            ],\\n            \\\"type\\\": \\\"field\\\"\\n          },\\n          {\\n            \\\"params\\\": [],\\n            \\\"type\\\": \\\"mean\\\"\\n          }\\n        ]\\n      ],\\n      \\\"tags\\\": [\\n        {\\n          \\\"key\\\": \\\"value::field\\\",\\n          \\\"operator\\\": \\\"\u003e\\\",\\n          \\\"value\\\": \\\"0\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"influxdb\\\",\\n        \\\"uid\\\": \\\"6m95lwRgk\\\"\\n      },\\n      \\\"groupBy\\\": [\\n        {\\n          \\\"params\\\": [\\n            \\\"2m\\\"\\n          ],\\n          \\\"type\\\": \\\"time\\\"\\n        },\\n        {\\n          \\\"params\\\": [\\n            \\\"0\\\"\\n          ],\\n          \\\"type\\\": \\\"fill\\\"\\n        }\\n      ],\\n      \\\"hide\\\": true,\\n      \\\"measurement\\\": \\\"Stromzähler_Momentanverbrauch\\\",\\n      \\\"orderByTime\\\": \\\"ASC\\\",\\n      \\\"policy\\\": \\\"autogen\\\",\\n      \\\"refId\\\": \\\"Netzverkauf_raw\\\",\\n      \\\"resultFormat\\\": \\\"time_series\\\",\\n      \\\"select\\\": [\\n        [\\n          {\\n            \\\"params\\\": [\\n              \\\"value\\\"\\n            ],\\n            \\\"type\\\": \\\"field\\\"\\n          },\\n          {\\n            \\\"params\\\": [],\\n            \\\"type\\\": \\\"mean\\\"\\n          }\\n        ]\\n      ],\\n      \\\"tags\\\": [\\n        {\\n          \\\"key\\\": \\\"value::field\\\",\\n          \\\"operator\\\": \\\"\u003c\\\",\\n          \\\"value\\\": \\\"0\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"datasource\\\": {\\n        \\\"name\\\": \\\"Expression\\\",\\n        \\\"type\\\": \\\"__expr__\\\",\\n        \\\"uid\\\": \\\"__expr__\\\"\\n      },\\n      \\\"expression\\\": \\\"$Netzverkauf_raw * (-1)\\\",\\n      \\\"hide\\\": true,\\n      \\\"refId\\\": \\\"Netzverkauf\\\",\\n      \\\"type\\\": \\\"math\\\"\\n    }\\n  ],\\n  \\\"title\\\": \\\"Panel Title\\\",\\n  \\\"type\\\": \\\"timeseries\\\"\\n}\",\r\n        \"mode\": \"code\",\r\n        \"code\": {\r\n          \"language\": \"json\",\r\n          \"showLineNumbers\": true,\r\n          \"showMiniMap\": true\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: Panel Title // 2023-06-01 16:37:17\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-timeseries\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"2023-05-31T22:00:00.000Z\",\r\n    \"to\": \"2023-06-01T21:59:59.999Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\r\n\r\n### Grafana Platform?\r\n\r\nNone\r\n\r\n### User's OS?\r\n\r\nMacOS 13.3.1\r\n\r\n### User's Browser?\r\n\r\n_No response_\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\nioBroker,  Sun and Moon\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["bot/no new info"]},{"id":67405,"title":"Openening a dashboard results in \"An unexpected error happened - v.from is null\"","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n## What happened:\r\nOpenening (navigating to) a dashboard results in \r\n\r\n\u003e An unexpected error happened\r\n\u003e \r\n\u003e TypeError: v.from is null\r\n\r\n## What you expected to happen:\r\nno error \r\n\r\n## How to reproduce it (as minimally and precisely as possible):\r\nThe problem is reproducible, but I do not know exactly how it began. I believe I clicked a \"history link\" labeled \"Invalid date to Invalid date\" on the time selection control. \r\n\r\n## Anything else we need to know?:\r\nRestarting Grafana **doesn't help**. \r\nLog off and log on with the same user **doesn't help**\r\nStarting Grafana with the same user in a different browser or in browser's \"Private Mode\" **does help**.\r\nIt doesn't matter which dashboard I open - it hapens even if I create a new dashboard. \r\n\r\n## Environment:\r\n- Grafana version: 9.4.7\r\n- Data source type \u0026 version: Prometheus 2.43.0\r\n- OS Grafana is installed on: macos 13.3.1\r\n- User OS \u0026 Browser: macos 13.3.1 Firefox 112.0.1 (64-Bit)\r\n- Grafana plugins: standard\r\n- Others: development environment\r\n\r\nStacktrace:\r\n`\r\nd@http://localhost:3000/public/build/4232.94b431ebdb4e9ef559bf.js:4668:140\r\nc\r\nr@http://localhost:3000/public/build/4232.94b431ebdb4e9ef559bf.js:5941:198\r\ndiv\r\ndiv\r\n8618/o\u003c@http://localhost:3000/public/build/4232.94b431ebdb4e9ef559bf.js:3632:161\r\nnav\r\n84770/r\u003c@http://localhost:3000/public/build/4232.94b431ebdb4e9ef559bf.js:2590:1049\r\n51008/le\u003c@http://localhost:3000/public/build/4232.94b431ebdb4e9ef559bf.js:5944:337\r\nxt@http://localhost:3000/public/build/6607.e58452a26b51b6e2dd5d.js:154:127640\r\nheader\r\ndiv\r\ny@http://localhost:3000/public/build/4232.94b431ebdb4e9ef559bf.js:4847:1009\r\nnt@http://localhost:3000/public/build/DashboardPage.2ac03a5f1de42abe340a.js:387:425\r\nDashboardPage\r\nxt@http://localhost:3000/public/build/6607.e58452a26b51b6e2dd5d.js:154:127640\r\nSuspense\r\ni@http://localhost:3000/public/build/4232.94b431ebdb4e9ef559bf.js:1270:169\r\ndm@http://localhost:3000/public/build/4232.94b431ebdb4e9ef559bf.js:9734:330\r\nKt@http://localhost:3000/public/build/6607.e58452a26b51b6e2dd5d.js:158:13493\r\nKt@http://localhost:3000/public/build/6607.e58452a26b51b6e2dd5d.js:158:15688\r\nmain\r\nUu@http://localhost:3000/public/build/4232.94b431ebdb4e9ef559bf.js:9695:2468\r\nKt@http://localhost:3000/public/build/6607.e58452a26b51b6e2dd5d.js:158:9780\r\ndiv\r\nd@http://localhost:3000/public/build/4232.94b431ebdb4e9ef559bf.js:2525:4095\r\np@http://localhost:3000/public/build/6607.e58452a26b51b6e2dd5d.js:32:52079\r\ni@http://localhost:3000/public/build/4232.94b431ebdb4e9ef559bf.js:5204:16791\r\ni@http://localhost:3000/public/build/4232.94b431ebdb4e9ef559bf.js:1270:169\r\nf@http://localhost:3000/public/build/4232.94b431ebdb4e9ef559bf.js:1270:720\r\nS@http://localhost:3000/public/build/6607.e58452a26b51b6e2dd5d.js:154:125330\r\nBm@http://localhost:3000/public/build/4232.94b431ebdb4e9ef559bf.js:9747:122\r\n`","labels":["needs more info","area/dashboard/timerange","team/grafana-dashboards"]},{"id":68174,"title":"[Legacy Alerting / Slack]: Dashboard links in alert description are getting rewritten","body":"# What went wrong?\r\n\r\n**What happened**:\r\n\r\n  - I added a link to the Grafana dashboard in an alert's description. The corresponding Slack notification has the dashboard link but it's rewritten and uses the load balancer's (AWS ALB) address as the root URL instead of the actual root URL (`root_url` is also configured).\r\n    \r\n    So instead of saying `grafana.\u003corg\u003e.io/\u003cdashboard\u003e`, it says `\u003caws alb url\u003e/\u003cdashboard\u003e`. And since we have `root_url` configured alongside Google OAuth, accessing Grafana via any other URL doesn't work.\r\n\r\n**What did you expect to happen**:\r\n\r\n  - The dashboard link should use the actual root URL.\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\nv9.3.8. Alerting system is the legacy one.\r\n\r\n### Grafana Platform?\r\n\r\nDocker\r\n\r\n### Anything else to add?\r\n\r\nOur OSS Grafana is hosted as following,\r\n\r\nAkamai Access -\u003e AWS ALB -\u003e Multiple EC2 instances.\r\n\r\nThe root URL is set at Akamai and is also set in the Grafana configuration (`root_url`). But when the alert description is rendered in Slack, the root URL is set to the AWS ALB's URL.","labels":["bot/no new info","area/alerting-legacy"]},{"id":52026,"title":"Table: Inconsistent names for queried values","body":"**What happened**:\r\n\r\nWhen there are multiple Prometheus queries but only one of them contains data and \"Merge\" transformation cannot be applied, the value column is named as `Value` (no matter which query the value comes from)\r\n\r\n**What you expected to happen**:\r\n\r\nValue should be named like `Value #A`, `Value #B`, etc regardless whether merge is applied, otherwise cell overriding and other transformations depending on the names simply can't work because there is no way to tell which query \"Value\" comes from.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nCreate a table of:\r\n- query A: clamp_max(absent(notExists{label=\"a\"}),10)\r\n- query B: clamp_max(absent(notExists{label=\"b\"}),2)\r\n\r\nwhich displays `Value #A = 1` and `Value #B = 2`\r\n\r\nNow change query B to `notExists{label=\"b\"}` - instead of displaying \"Value #A = 1\" it shows \"Value = 1\"\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.4","labels":["area/panel/table","needs investigation"]},{"id":61512,"title":"Grafana in HA mode does not deduplicate query evaluations","body":"**What happened**:\nRunning Grafana in HA mode causes double the traffic to downstream metrics systems.\n\n**What you expected to happen**:\nMultiple replicas of Grafana would deduplicate alert evaluations and not multiply the load\n\n**How to reproduce it (as minimally and precisely as possible)**:\nWe ran two instances of Grafana in HA mode, per official documentation [https://grafana.com/docs/grafana-cloud/alerting/set-up/configure-high-availability/]\nThe Grafana instances uses Prometheus as a metrics source.  \n\nWe noticed that with two Grafana instances, we have double the qps on Prometheus.  This results in double the load for downstream systems.  \n\nDoes HA configuration only deduplicate the alerts, and not the alert evaluations?  \n\n**Anything else we need to know?**:\n\n**Environment**:\n- Grafana version: 9.3.1\n- Data source type \u0026 version: Postgresql\n- OS Grafana is installed on: Kubernetes, image: grafana:9.3.1-ubuntu\n- User OS \u0026 Browser: any\n- Grafana plugins:\n- Others (configuration snippets below):\n\nGrafana.ini snippet\n```\n[unified_alerting]\nenabled = true\nha_listen_address = \"${POD_IP}:9094\"\nha_peers = \"grafana-alerting.grafana:9094\"\nha_advertise_address = \"${POD_IP}:9094\"\n```\n\nDeployment.yaml snippet\n```\n  containerPorts:\n  - name: http\n    containerPort: 3000\n  - name: grafana-alert\n    containerPort: 9094\n\n  servicePorts:\n  - name: http\n    port: 3000\n    protocol: TCP\n    targetPort: 3000\n  - name: grafana-alert\n    port: 9094\n    protocol: TCP\n    targetPort: 9094\n    ...\n   env:\n    ...\n    - name: POD_IP\n      valueFrom:\n        fieldRef:\n          fieldPath: status.podIP\n```\n\ngrafana-alerting-service.yaml\n```\n# Creates a headless service for High Availability Alerting\n#  https://grafana.com/docs/grafana/latest/alerting/set-up/configure-high-availability/#enable-alerting-high-availability\napiVersion: v1\nkind: Service\nmetadata:\n  name: grafana-alerting\n  namespace: grafana\n  labels:\n    app.kubernetes.io/name: grafana-alerting\n    app.kubernetes.io/part-of: grafana\nspec:\n  type: ClusterIP\n  clusterIP: 'None'\n  ports:\n    - port: 9094\n  selector:\n    app: grafana\n```\n\n\n\n\n","labels":["type/feature-request","area/alerting"]},{"id":59220,"title":"Data links not render label variables when label is hidden","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nWhen I want to use data links, i.e. with Stat gauge showing single label, but I use other labels in link itself, it is not resolved properly, i.e. \r\n\r\n\u003cimg width=\"1243\" alt=\"image\" src=\"https://user-images.githubusercontent.com/9568421/203562656-7bce0bac-5a72-4e24-9618-7bcc88f95757.png\"\u003e\r\nthen when I click it, the variables not used to show at panel are not resolved.\r\n\r\n\r\nSimilar issue with table, only when all table rows are showed it renders properly.\r\n\r\nBut I want just to compose clickable link, and necessity to have displayed all the labels used to compose the link is not bet UX.\r\n\r\n(Note - in table I remove labels via `Organize fields`  transformation, in both cases all labels are present in the query)\r\n\r\n**What you expected to happen**:\r\n\r\nDuring data link interpolation, it uses data from the query, not the data being actually visualised. \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.1.6\r\n- Data source type \u0026 version: Prometheus\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser: MacOS/ Chrome\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/feature-request","area/dashboard/data-links"]},{"id":57457,"title":"Alert panic for some alerts while others are working just fine","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n Some of the new alerts are going into alert panic mode.  Following the logs It looked like this is related to the image renderer plugin, so I installed all the missing libraries. I have even tried unchecking the Send Image checkbox in notification settings but it still doesn't work. For other alerts notification with and without images works just fine as expected.\r\nWhen I test the notification channel, it works without a problem, test rule is also working fine but when Grafana tries to send a notification for said alert it fails \r\n\r\n**What you expected to happen**:\r\nThe alert to be sent to the appropriate slack channel \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate a time series with a 95 percentile on response_time \r\n`SELECT percentile(\"response_time_ms\", 95) FROM \"{$INFLUXDB_MEASUREMENT}\" WHERE $timeFilter GROUP BY time($__interval) fill(null)`\r\n\r\nCreate an alert \r\n\u003cimg width=\"848\" alt=\"image\" src=\"https://user-images.githubusercontent.com/96191/197217427-70ddc362-5c5a-4ec4-a8c3-2eda389b71db.png\"\u003e\r\n\r\n\r\n**Anything else we need to know?**:\r\n`/var/lib/grafana/plugins/grafana-image-renderer# ldd chrome-linux/chrome  | grep notfound | wc -l\r\n0`\r\n**Environment**:\r\n\r\n- Grafana version: 8.4.7\r\n- Data source type \u0026 version: InfluxDB \r\n- OS Grafana is installed on:  Ubuntu 20.04.4 LTS\r\n- User OS \u0026 Browser: Chorome, OSX 12.0\r\n- Grafana plugins: \r\n\r\n1.  blackmirror1-singlestat-math-panel\r\n2. flant-statusmap-panel\r\n3. grafana-clock-panel\r\n4.  grafana-image-renderer\r\n5. grafana-piechart-panel\r\n6. grafana-singlestat-panel\r\n7.  grafana-synthetic-monitoring-app\r\n8.  grafana-worldmap-panel\r\n9.  natel-discrete-panel\r\n\r\n- Others:\r\n","labels":["type/bug","area/alerting","area/image-rendering","bot/no new info"]},{"id":46912,"title":"Grafana alert in pending state is not reset when the alert condition is not met (flapping value)","body":"**What happened**:\r\nA value crosses a threshold (alert condition is met) and alert is set to pending state due to \"for 5m\" setting of the alert.\r\nValue then changes (alert condition is not met) - with the same rate as the check is ran - so I would expect the alert is cleared from pending state. But that does not happen (see attached picture).\r\n\r\n**What you expected to happen**:\r\nAlert state changed from pending to off when the alert condition is not met even for a while.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nGenerate a metric with flapping value like in the picture and try to set alert to fire only when the value is stale for a while.\r\n\r\n**Environment**:\r\n- Grafana version: 8.2.5\r\n- Data source type \u0026 version: Prometheus 2.26.0\r\n- OS Grafana is installed on: Linux kernel 5.4.0 (Ubuntu)\r\n- User OS \u0026 Browser: Ubuntu linux \u0026 Firefox 98.0.1\r\n- Grafana plugins: Core only\r\n","labels":["needs more info","area/alerting","bot/no new info"]},{"id":48948,"title":"Alerting: externalLabels are missing for grouping or filtering in Alert list panel","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWhen wanting to group alerts according to an external label, the external labels are missing from the available ones. Same behaviours happens when using an external label to filter alerts, the list comes up empty.\r\n\r\n**What you expected to happen**:\r\nAs with the Unified Alerting view, I'm expecting external labels to be available for filtering alerts in the alert list panel\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nHave a set up where external labels are applied to alerts and metrics (using Thanos as a datasource for instance). Create an Alert List panel. Confirm that external labels are missing from grouping options and are not recognized when filtering.\r\n\r\n**Anything else we need to know?**:\r\nThis is very very annoying for creating multi-cluster dashboards for instance where the cluster name is typically an external label\r\n\r\n**Environment**:\r\n- Grafana version: 8.5.0\r\n- Data source type \u0026 version: Prometheus Operator 0.56.2 \u0026 Thanos 0.24 \r\n- OS Grafana is installed on: Helm Chart on Kubernetes \r\n- User OS \u0026 Browser: MacOS\r\n- Grafana plugins:\r\n- Others:\r\n\r\n```[tasklist]\r\n- [ ] https://github.com/grafana/grafana/issues/63570\r\n```","labels":["area/alerting","area/panel/alertlist","needs investigation","area/frontend","stale"]},{"id":58891,"title":"[9.2.4] Importing dashboard via JSON file or panel JSON overwrites every panel's Data Source and query.","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: When importing dashboard either via JSON file or panel JSON, Grafana overwrites any provided Data Source with garbage Grafana DS with query type \"Random Walk\". \r\n\r\n**What you expected to happen**: to preserve original Data Source from JSON configuration file.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: Save Dashboard JSON to file and try to import it to other Grafana instance with same Data Sources (and disabled default flag).\r\n\r\n**Anything else we need to know?**: When I'm trying to manually modify JSON model, I'm getting \"Dashboard not found\" error (404 on backend). No other error appears in debug logs. I'll be happy to provide further deets if needed.\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.4 (clean install after fuckup with upgrade from 8.5.14 -\u003e 9.0 -\u003e 9.2.4, described broadly [here](https://github.com/grafana/grafana/issues/58804))\r\n- Data source type \u0026 version: Elasticsearch 7.10+\r\n- OS Grafana is installed on: Ubuntu 20.04\r\n- User OS \u0026 Browser: N/A\r\n- Grafana plugins: N/A\r\n- Others: N/A\r\n\r\n![Przechwytywanie](https://user-images.githubusercontent.com/20375860/202433844-8f21e7f9-1867-40b3-b4d3-10d444a4952a.PNG)\r\n![1](https://user-images.githubusercontent.com/20375860/202433904-b834634e-2c0e-4a0d-93a4-c75ad992ca25.PNG)","labels":["area/dashboard/import","bot/no new info"]},{"id":82027,"title":"Alerts: Graph does not display","body":"### What happened?\r\n\r\nUser created a new dashboard, Attempted to create a new alert for the dashboard. When the query was executed data was returned but the UI only shows a table view with the first data point value from the JSON data section. \r\n\r\n### What did you expect to happen?\r\n\r\nUser should have seen a graph of the resulting data. \r\n\r\n### Did this work before?\r\n\r\nYes prior to Grafana version 10.3.1\r\n\r\n### How do we reproduce it?\r\n\r\nSee what happened section\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.3.1\r\nOS: Linux Centos 7\r\nBrowser: Chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### Datasource(s)?\r\nTSDB\r\n\r\n","labels":["datasource/OpenTSDB","prio/medium","area/panel/timeseries","effort/medium"]},{"id":76324,"title":"time-series panel not displaying all data except when zoomed","body":"### What happened?\n\nwhen I filter the dashboard for 30 days\r\nthe dashboard doesn't show all the data but when I zoom the dashboard that I can see the data\n\n### What did you expect to happen?\n\ndoesn't show the data\n\n### Did this work before?\n\nI don't know exactly\n\n### How do we reproduce it?\n\n1.\r\n2.\r\n3.\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.1.4\r\nOS: Linux ubuntu 20.04.6\r\nBrowser: chrome\r\n![1](https://github.com/grafana/grafana/assets/25286551/02a0ca34-83c4-4cc2-be8e-1da302bfdcb1)\r\n![2](https://github.com/grafana/grafana/assets/25286551/f3a5b57b-747f-474e-8dd0-858f358209c7)\r\n\n\n### Grafana platform?\n\nOther\n\n### Datasource(s)?\n\n_No response_","labels":["area/panel/timeseries","triage/needs-confirmation"]},{"id":61062,"title":"Graph Rendering Bad Data","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nTimeline graph contains incorrect (unsorted?) data when zoomed out, issue disappears when zooming in.\r\n\r\n**What you expected to happen**:\r\n\r\nGraph to show properly ordered time series dasta.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nThe issue comes up when using a the average clause in a SQL query (e.g. `SELECT AVG(height) OVER (ROWS 50 PRECEDING) as height`) but doesn't occur when using just the raw value from the table (e.g. `SELECT height ...`).\r\n\r\nThere's no reason the zoom level should effect the data ordering.\r\n\r\n**Anything else we need to know?**:\r\n\r\nHere's a screen grab of the issue:\r\n\r\n![grafana_bug](https://user-images.githubusercontent.com/195741/210849171-aa414cd6-5ecf-433f-842d-d1fd77104950.gif)\r\n\r\nThanks!\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.6\r\n- Data source type \u0026 version: SQL / Postgres\r\n- OS Grafana is installed on: Heroku / Docker\r\n- User OS \u0026 Browser: Chrome 108.0.5359.124 (Official Build) (arm64)\r\n- Grafana plugins: None\r\n- Others: None\r\n","labels":["needs more info","area/panel/timeseries"]},{"id":75135,"title":"Alerting: graphLink unable to parse variables","body":"### What happened?\n\nWhen attempting to use graphLink in alerting with metric based variables, they are printed as text rather then their value query below\r\n\r\n```\r\n{{ graphLink \"{\\\"expr\\\": \\\"{container=`azure-resourcemanager`}| json | resourceHealth_properties_availabilityState=`{{$labels.availabilityState}}` | resourceHealth_properties_reasonType!=`Customer Initiated` | resourceID=`{{$labels.resourceID}}`\\\", \\\"datasource\\\": \\\"Loki\\\"}\" }}\r\n```\r\n\r\nThis then exports the below\r\n\r\n```\r\n/explore?left={\"datasource\":\"Loki\",\"queries\":[{\"datasource\":\"Loki\",\"expr\":\"%7Bcontainer%3D%60azure-resourcemanager%60%7D%7C+json+%7C+resourceHealth_properties_availabilityState%3D%60%7B%7B%24labels.availabilityState%7D%7D%60+%7C+resourceHealth_properties_reasonType%21%3D%60Customer+Initiated%60+%7C+resourceID%3D%60%7B%7B%24labels.resourceID%7D%7D%60\",\"instant\":false,\"range\":true,\"refId\":\"A\"}],\"range\":{\"from\":\"now-1h\",\"to\":\"now\"}}\r\n```\n\n### What did you expect to happen?\n\nOutput to be as below\r\n\r\n```\r\n/explore?left={\"datasource\":\"Loki\",\"queries\":[{\"datasource\":\"Loki\",\"expr\":\"%7Bcontainer%3D%60azure-resourcemanager%60%7D%7C+json+%7C+resourceHealth_properties_availabilityState%3D%60Unhealthy%60+%7C+resourceHealth_properties_reasonType%21%3D%60Customer+Initiated%60+%7C+resourceID%3D%60/subuscriptionid/stuff/resourceid/3245345235-234524234-2342342%60\",\"instant\":false,\"range\":true,\"refId\":\"A\"}],\"range\":{\"from\":\"now-1h\",\"to\":\"now\"}}\r\n```\n\n### Did this work before?\n\nNo\n\n### How do we reproduce it?\n\n1. Create loki metric based alert\r\n2. For Summary set below query\r\n```\r\n{{ graphLink \"{\\\"expr\\\": \\\"{container=`azure-resourcemanager`}| json | resourceHealth_properties_availabilityState=`{{$labels.availabilityState}}` | resourceHealth_properties_reasonType!=`Customer Initiated` | resourceID=`{{$labels.resourceID}}`\\\", \\\"datasource\\\": \\\"Loki\\\"}\" }}\r\n```\r\n3. Save alert\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 9.4.7\r\nOS: Ubuntu 22.04.2 LTS\r\nBrowser: Chrome\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\nPrometheus. Loki","labels":["type/feature-request","area/alerting"]},{"id":69522,"title":"Docker Swarm secrets not working with docker enviroment ","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\n  - The stack starts but it not take the password defined using `echo \"mypassword\" | docker secret create password.pwd -` and it still use the default “admin” password\r\n  - If I connect to my docker using docker exec -it xxxxxxxxx bash I can see the expected password with cat /run/secrets/password.pwd\r\n\r\n**What did you expect to happen**:\r\n\r\n  - I expected that the grafana take the enviroment `- GF_SECURITY_ADMIN_PASSWORD_FILE=/run/secrets/password.pwd`\r\n  - If I use `- GF_SECURITY_ADMIN_PASSWORD=mypassword` it works\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\n- Setup a docker swarm enviroment \r\n\r\n**Step 2**:\r\n\r\n- With Docker Swarm created, create a secret using `echo \"mypassword\" | docker secret create password.pwd -`\r\n\r\n**Step 3**:\r\n\r\n- Modify docker compose to use the secret like this: \r\n\r\nversion: \"3.9\"\r\nservices:\r\n  grafana:\r\n    image: grafana/grafana:9.5.2\r\n    volumes:\r\n      - grafanadata:/var/lib/grafana\r\n      - ./grafana.ini:/etc/grafana/grafana.ini\r\n    environment:\r\n      - GF_SECURITY_ADMIN_PASSWORD_FILE=/run/secrets/password.pwd\r\n    secrets:\r\n      -\r\n        source: password.pwd\r\n        target: /run/secrets/password.pwd\r\n        mode: 0444\r\nsecrets:\r\n  password.pwd:\r\n    external: true\r\nvolumes:\r\n  grafanadata: {}\r\n\r\n\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\n9.5.2\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\r\n\r\n### Grafana Platform?\r\n\r\nDocker\r\n\r\n### User's OS?\r\n\r\nUbuntu 22.04\r\n\r\n### User's Browser?\r\n\r\n_No response_\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\n_No response_\r\n\r\n### Anything else to add?\r\n\r\n\r\nI followed this guide \r\n[https://efrecon.github.io/docker-secrets-with-grafana/](url)","labels":["needs more info","area/backend/config","area/docker"]},{"id":54966,"title":"Grafana Alert not re-arming using the \"Alert state if no data or all values are null\"","body":"**What happened**:\r\nI have an alert on that checks if a single log passes through the query.\r\n`count_over_time({critical=\"very-critical\"} [1m])` with condition `Classic Condition: When Last() of A is above 0` evaluation every 10s for 20s.\r\nThe alert fires but does not go returns to \"normal\" state until after ~8h\r\n[here's a proof](http://prntscr.com/rROXS6VqA8ax)\r\n\r\n**What you expected to happen**:\r\nGiven after a minute; the query returns 0/null (given theres no input) it should rearm and be ready to listen for another log\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nDescribed above; I just use a container that sends one log to Grafana through Loki every 15min.\r\n\r\n**Anything else we need to know?**:\r\n**Environment**:\r\n\r\n- Grafana version: latest dockerfile\r\n- Data source type \u0026 version: raw logs being querried\r\n- OS Grafana is installed on: Official Grafana image \r\n- User OS \u0026 Browser: Ubuntu Dockerfile\r\n- Grafana plugins: None that should interact with this.\r\n- Others:\r\nEnvironment variables:\r\n`     - GF_SERVER_PROTOCOL=https\r\n      - GF_SERVER_SERVE_FROM_SUB_PATH=true\r\n      - GF_SERVER_CERT_FILE=/usr/share/grafana/grafana.crt\r\n      - GF_SERVER_CERT_KEY=/usr/share/grafana/grafana.key\r\n      - GF_SECURITY_COOKIE_SAMESITE=none\r\n      - GF_SECURITY_COOKIE_SECURE=true\r\n      - GF_PLUGINS_ALLOW_LOADING_UNSIGNED_PLUGINS=meln5674-\r\n      - GF_SECURITY_ALLOW_EMBEDDING=true\r\n      - GF_AUTH_ANONYMOUS_ENABLED=true`\r\n\r\n[Docker-compose.yml file](https://pastebin.com/4RAuYskD)","labels":["needs more info","area/alerting"]},{"id":47733,"title":"alerting: slack webhook alerted with a different state than seen in the dashboard","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nThe slack integration, that uses the Grafana webhook, notified a problem `Alerting`, but Grafana's dashboard marked as `OK`. And even after hours of the platform being stable, the OK status only came back after we forced the threshold to be low enough for a real `alerting` to occur.\r\n\r\n![print-grafana-slack-bug](https://user-images.githubusercontent.com/19523324/163246728-5da64368-35c5-462f-9e1b-9db4385eb4a6.jpg)\r\n![Screenshot from 2022-04-13 15-21-33](https://user-images.githubusercontent.com/19523324/163246732-30412c6e-30dd-4d9c-996a-e53f5433a3a1.png)\r\n![print-grafana-until-now](https://user-images.githubusercontent.com/19523324/163246740-693c916b-112c-4fe5-9ebb-e254fcc03467.jpg)\r\n\r\n\r\n**What you expected to happen**:\r\nThe webhook, used by the slack integration, to follow what is shown in the dashboard.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nIt's an Grafana automation/integration, don't know how to replicate.\r\n\r\n**Anything else we need to know?**:\r\nNotice how the value was very close to the threshold: `120.03832816886` vs `120`\r\nMaybe the problem is related to that.\r\n\r\n**Environment**:\r\n- Grafana version: v8.4.0\r\n- Data source type \u0026 version: NA\r\n- OS Grafana is installed on: NA\r\n- User OS \u0026 Browser: Ubuntu 20.04.4 LTS \u0026 Chrome 100.0.4896.60 (Official Build) (64-bit)\r\n- Grafana plugins: NA\r\n- Others: NA\r\n","labels":["needs more info","area/alerting/notifications","area/alerting/evaluation","area/alerting-legacy"]},{"id":82394,"title":"Grafana Annotations persist across graphs made from different variables","body":"### Grafana Annotations persist across graphs made from different variables\r\n\r\n##### Is there a way for Grafana to only show the annotation for a particular panel for that set of variables. I have 1 panel that changes based on some variables selected. Can I make it such that if I make an annotation for one variable, it doesn't show up on the other. \r\n\r\n\u003cimg width=\"755\" alt=\"Screenshot 2024-02-13 at 2 23 59 PM\" src=\"https://github.com/grafana/grafana/assets/106616061/74e74f03-8d88-4e86-a1e8-7d85eb23acf1\"\u003e","labels":["area/annotations","triage/needs-confirmation"]},{"id":61999,"title":"LibraryPanel: stats panel with variables related to a library used in a loop row has default value different entering into page","body":"I'm on Grafana 9.3.1 and I got strange behavior between variables and \"stats panels\" linked to libraries inside a loop in a ROW panel.  Seems that anything is related a library has a default value entering into page... before a force change using a combo menù on top.\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate a ROW panel and loop over a hidden variable.\r\nIn this row introducing a panel with a simle prometheus query from panel linked to a library.\r\nThis panel must have a query using the variable of loop.\r\n\r\nExemple:\r\n\u003cimg width=\"551\" alt=\"image\" src=\"https://user-images.githubusercontent.com/43847440/214322074-667e48e8-ca1f-466b-a276-961b19e6e84b.png\"\u003e\r\n\r\nthe query...\r\ntopk (1,ag_details{ag_name=\"$agname\", replica_server_name=\"$dbinstance\", primary_replica=\"$dbinstance\", job=\"$job\"})\r\n\r\n$agname is the loop variable used for ROW panel\r\n\r\n\u003cimg width=\"577\" alt=\"image\" src=\"https://user-images.githubusercontent.com/43847440/214323575-ded5354d-95eb-42dc-8af2-30292eaecbc8.png\"\u003e\r\n\r\n\r\nafter change from TOP menù... all is ok\r\n\r\n\u003cimg width=\"222\" alt=\"image\" src=\"https://user-images.githubusercontent.com/43847440/214322461-315dd76d-7f00-4c31-b964-d3d120a1c622.png\"\u003e\r\n\r\n\r\nonly entering into page I got stat panel with same values not like the ones that I put on hi-light above in this thread.\r\n\r\nAlen\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.1\r\n- Data source type \u0026 version: Prometheus\r\n- OS Grafana is installed on: RHES\r\n- User OS \u0026 Browser: Chrome\r\n","labels":["needs more info","area/frontend/library-panels","area/dashboard/rows"]},{"id":64190,"title":"Dashboards: Flickering toolbar","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: grafana version 9.2.8 on a Raspery is showing the „show more items“ flickering on usage in a dashboard. Means it disappears and shows up again in flickering (0.01sec) frequency. It seems to be related with the time picker. Flickers if I use „today“, „last 2 days“ does not show if I use „yesterday“. But does not show if I use 0d/d interval. \r\ni have to day, that Raspi is connected with hdmi cable to a tv.\r\n\r\n**What you expected to happen**: why this „show more items“ is shown I donˋt know, and it looks like Grafana is not sure about this too :)\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: I could sent the dashboard? But I dońt know if this helps if data is missing. I could make a video out of this?\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**: grafana on a RaspberryPi\r\n- Grafana version: 9.2.8\r\n- Data source type \u0026 version: influxDB 1.8.10\r\n- OS Grafana is installed on: raspbian GNU\r\n- User OS \u0026 Browser: Chrome on Chrome OS 13597.84\r\n- Grafana plugins: sun and moon, compareQuery\r\n- Others:\r\n","labels":["area/dashboard","bot/no new info","timepicker","triage/needs-confirmation","team/grafana-dashboards"]},{"id":51334,"title":"unable to get alert-notifications or dashboards from API","body":"**What happened**:\r\ntrying to export alert notifications, data-sources and dashboard through API but only getting [] with /api/alert-notifications and only receiving dashboards folder names with /api/dashboards, data-source getting all information with /api/datasources/\r\n\r\n**What you expected to happen**:\r\n\r\nexpecting to get every alert notifications with there parameters and dashboards information\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nfresh helm grafana installation with any dashboard, data source or alert notification\r\n\r\n**Anything else we need to know?**:\r\n\r\ntried with api key auth, user/passwiord auth, with different orgs, different permitions etc...\r\n\r\n**Environment**:\r\n- Grafana version: open source 8.5.3\r\n- Data source type \u0026 version: prometheus 2.34.0/ loki 2.4.2\r\n- OS Grafana is installed on: helm installation\r\n- User OS \u0026 Browser: manjaro kde, curl/postman\r\n- Grafana plugins: json\r\n- Others:\r\n","labels":["needs more info","area/backend/api"]},{"id":60552,"title":"date group by not working ","body":"Date group by not working as expected when date range is from 1-nov the group by feature working correctly but when the date range set to after 1 nov date group by not working see the screenshots below\r\n\r\nGrafana version: 9.3.1\r\nData Source: infinity\r\n\r\n![perfect time range](https://user-images.githubusercontent.com/51694624/208634787-181ae253-a84c-4d96-8036-26b73bb881a8.PNG)\r\n![wrong time range](https://user-images.githubusercontent.com/51694624/208634795-1dd1d280-942d-4ed0-9c1e-752501b06d54.PNG)","labels":["needs more info","area/transformations"]},{"id":51534,"title":"Alert emitted from non-existing rules","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: Following the update to Grafana 9 a bunch of legacy alerts are not migrated properly and are triggered but are no longer manageable\r\n\r\n**What you expected to happen**: All alerting rules should be manageable (delete, silence, view, ...)\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: \r\n\r\nI am not a 100% sure but:\r\n\r\n- Create an alert on a panel in Grafana 8.5\r\n- Migrate the instance to Grafana 9\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: Grafana 9.0.1\r\n- Data source type \u0026 version: Prometheus (various versions)\r\n- OS Grafana is installed on: Grafana provided Docker Image\r\n- User OS \u0026 Browser: Windows - Chrome\r\n- Grafana plugins: N/A\r\n- Others: On-premise installation\r\n","labels":["needs more info","area/alerting","area/backend"]},{"id":59273,"title":"BarChart legend labels from wrong series","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nLegend of a BarChart shows label of X-axis series rather than plotted series.\r\n\r\n**What you expected to happen**:\r\nSee a legend that shows the names of the series in the chart.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nMy data is a table form result from InfluxDB with 3 columns (apart from time). First column is the group name used as X-axis, the other two columns are used and free.\r\n![Screenshot from 2022-11-24 10-45-06](https://user-images.githubusercontent.com/11174694/203752109-fdf10df2-1bb2-475b-80f9-d1426b252368.png)\r\n\r\nI show them in a stacked bar chart, so you see the amount of used \u0026 free in relation to the other groups.\r\n![Screenshot from 2022-11-24 10-51-26](https://user-images.githubusercontent.com/11174694/203752826-9b125981-f798-4ce7-a10d-3556788e43ca.png)\r\n\r\nThe problem is that the legend shows the label of the column used as X-axis rather than the first data-column. The color in the legend is also green rather than the blue used for the data itself.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.5\r\n- Data source type \u0026 version: InfluxDB 1.8.10\r\n- OS Grafana is installed on: RHEL 9.1\r\n- User OS \u0026 Browser: Linux \u0026 Chrome \r\n- Grafana plugins: standard core \r\n- Others:\r\n","labels":["type/bug","area/panel/barchart"]},{"id":69551,"title":"404 error when fetching prometheus metrics under docker","body":"### \n# What went wrong?\n\n\n\r\nI just set up grafana and prometheus using docker and grafana says that the prometheus data source is working and connected. Yet when I try to press the metrics button, I get a 404 error.\r\n\r\n```\r\ngrafana       | logger=context userId=1 orgId=1 uname=admin t=2023-06-05T09:02:22.284601617Z level=info msg=\"Request Completed\" method=GET path=/api/datasources/uid/c431ba2e-27e1-43f0-ba39-edeca288c4d6/resources/api/v1/label/__name__/values status=404 remote_addr=172.18.0.4 time_ms=2 duration=2.87022ms size=19 referer=\"https://xxx.xxx.dk/grafana/explore?left=%7B%22datasource%22%3A%22c431ba2e-27e1-43f0-ba39-edeca288c4d6%22%2C%22queries%22%3A%5B%7B%22refId%22%3A%22A%22%2C%22datasource%22%3A%7B%22type%22%3A%22prometheus%22%2C%22uid%22%3A%22c431ba2e-27e1-43f0-ba39-edeca288c4d6%22%7D%7D%5D%2C%22range%22%3A%7B%22from%22%3A%22now-1h%22%2C%22to%22%3A%22now%22%7D%7D\u0026orgId=1\" handler=/api/datasources/uid/:uid/resources/*\r\n```\r\n\r\ngrafana.ini\r\n```\r\n[server]\r\ndomain = localhost\r\nenable_gzip = false\r\nhttp_addr = \r\nhttp_port = 3000\r\nprotocol = http\r\nroot_url = %(protocol)s://%(domain)s:%(http_port)s/grafana/\r\nrouter_logging = false\r\nstatic_root_path = public\r\n```\r\n\r\ndocker-compose.yml\r\n```\r\nservices:\r\n\r\n  grafana:\r\n    container_name: grafana\r\n    image: grafana/grafana-enterprise:latest\r\n    restart: 'no'\r\n    volumes:\r\n      - .grafana/grafana.ini:/etc/grafana/grafana.ini\r\n    ports:\r\n     - 3000:3000\r\n\r\n  prometheus:\r\n    container_name: prometheus\r\n    image: prom/prometheus:latest\r\n    volumes:\r\n      - .prometheus/prometheus.yml:/etc/prometheus/prometheus.yml\r\n    command:\r\n      - --web.external-url=/prometheus/\r\n      - --web.route-prefix=/prometheus/\r\n      - --config.file=/etc/prometheus/prometheus.yml\r\n    restart: 'no'\r\n    expose:\r\n      - 9090\r\n\r\n\r\n```\r\n\r\nIts trying to access : \r\n\r\n`remote_addr=172.18.0.4`\r\n\r\nLooking at prometheus/metrics we can see them listed\r\n```\r\n# HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.\r\n# TYPE go_gc_duration_seconds summary\r\ngo_gc_duration_seconds{quantile=\"0\"} 5.1868e-05\r\ngo_gc_duration_seconds{quantile=\"0.25\"} 5.6971e-05\r\ngo_gc_duration_seconds{quantile=\"0.5\"} 0.000291352\r\ngo_gc_duration_seconds{quantile=\"0.75\"} 0.002653431\r\ngo_gc_duration_seconds{quantile=\"1\"} 0.003634381\r\ngo_gc_duration_seconds_sum 0.006688003\r\ngo_gc_duration_seconds_count 5\r\n# HELP go_goroutines Number of goroutines that \r\n```\n\n### \n# How do we reproduce it?\n\n\n-\n\n### \n# What Grafana version are you using?\n\n\nenterprise:latest\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nNone\n\n### User's OS?\n\n_No response_\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["needs more info","area/docker"]},{"id":68737,"title":"Elasticsearch: Grafana randomly provisioning datasources with incomplete information (missing Index name)","body":"### \n# What went wrong?\n\n\n**What happened**:\r\nGrafana is randomly provisioning Elasticsearch datasources from git that are missing an Index name, which makes these not functional.  We've seen this quite a bit lately, restarting the pod usually fixes it however I just hit this in production where I had to restart grafana 7 or 8 times until it provisioned it correctly.\r\n\r\nWhen this happens we end up with a datasource that looks like so:\r\n![Screen Shot 2023-05-18 at 3 04 04 PM](https://github.com/grafana/grafana/assets/5891946/d59ebf9e-5a38-4963-89a9-b5a41802fb66)\r\n\r\nhere are the logs I captured from grafana starting up when this happens:\r\n[grafana_datasource_issue.txt](https://github.com/grafana/grafana/files/11511712/grafana_datasource_issue.txt)\r\n\r\n\r\nWhen this happens it happens to all of our elasticsearch datasources.  None of them will have an Index name, it will be blank for all of them\r\n\r\n**What did you expect to happen**:\r\nGrafana to consistently load the file from git in the same manner each time it starts up\r\n\r\n\r\n  - \r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\nrestart grafana pod and see if it loaded datasources correctly or not\r\n\r\n**Step 2**:\r\n\r\nif it didn't, restart grafana and hope for the best\r\n\n\n### \n# What Grafana version are you using?\n\n\nFROM grafana/grafana:9.4.7\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nNone\n\n### User's OS?\n\nFROM grafana/grafana:9.4.7\n\n### User's Browser?\n\nsafari\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\nyes, elasticsearch\n\n### Anything else to add?\n\n\n_No response_","labels":["needs more info","datasource/Elasticsearch","area/provisioning"]},{"id":54680,"title":" Error 1062: Duplicate entry '114-xxxxxxxx' for key 'UQE_alert_rule_org_id_uid' ","body":"What happened:\r\nI want to update grafana from v7.3.5 to v8.4.6, so I copied history data from our live environment, and then start grafana.\r\nI upgraded grafana from version 8.4.2 to 9.1.0 without unified alerting. DB was cloned before upgrade. Now while trying to enable unified alerting I am getting below error:\r\n\r\nlevel=error msg=\"Executing migration failed\" id=\"move dashboard alerts to unified alerting\" error=\"Error 1062: Duplicate entry '114-rMBR2ZGVz' for  │\r\n│ logger=migrator t=2022-09-03T03:19:21.502720885Z level=error msg=\"Exec failed\" error=\"Error 1062: Duplicate entry '114-rMBR2ZGVz' for key 'UQE_alert_rule_org_id_uid'\" sql=\"code migration\"        │\r\n│ Failed to start grafana. error: migration failed (id = move dashboard alerts to unified alerting): Error 1062: Duplicate entry '114-rMBR2ZGVz' for key 'UQE_alert_rule_org_id_uid'                 │\r\n│ migration failed (id = move dashboard alerts to unified alerting): Error 1062: Duplicate entry '114-rMBR2ZGVz' for key 'UQE_alert_rule_org_id_uid'\r\n\r\nWhat you expected to happen:\r\nMigration is done successfully with other environment having less data.\r\n\r\nHow to reproduce it (as minimally and precisely as possible):\r\nGF_UNIFIED_ALERTING_ENABLED: false\r\n  alerting:\r\n    enabled: true  \r\n  unified_alerting:\r\n    enabled: false  \r\nadd these values in grafana.ini\r\n\r\nAnything else we need to know?:\r\nProduction there are 25000 alerts to be migrated across 150 organisations and it is failing for multiple org_ids. DB size is 50 GB.\r\n\r\n\r\nEnvironment:\r\n\r\nGrafana version: v9.1.0\r\nData source type \u0026 version:\r\nOS Grafana is installed on: linux\r\nUser OS \u0026 Browser:\r\nGrafana plugins:\r\nplugins:\r\n  - instana-datasource\r\n  - farski-blendstat-panel\r\n  - yesoreyeram-boomtable-panel\r\n  - jdbranham-diagram-panel\r\n  - natel-discrete-panel\r\n  - agenty-flowcharting-panel\r\n  - pierosavi-imageit-panel\r\n  - simpod-json-datasource\r\n  - marcusolsson-json-datasource\r\n  - grafana-piechart-panel\r\n  - natel-plotly-panel \r\n  - vonage-status-panel\r\n  - grafana-worldmap-panel\r\n  - https://github.com/GoshPosh/grafana-meta-queries/archive/refs/tags/0.0.9.zip;goshposh-metaqueries-datasource\r\n  - flant-statusmap-panel\r\n  - grafana-athena-datasource\r\n  - grafana-timestream-datasource\r\nOthers:\r\n","labels":["type/bug","area/alerting"]},{"id":73785,"title":"Alerting: Navigating away from a partially created alert clears entered info","body":"### What happened?\n\nIf you click the Create New Alert button, fill out the page and then accidentally click Notification Policies (or any other outgoing link) it happily takes you there and there is no way to regain all the configuration that you entered.\n\n### What did you expect to happen?\n\nI sometimes get an \"ARE YOU SURE?\" dialog when navigating away from a dashboard after making changes; I would expect the same to happen for alerts.\n\n### Did this work before?\n\nNot sure\n\n### How do we reproduce it?\n\n1. Click create new alert button\r\n2. Make some changes\r\n3. Click Notification Policies on the left sidebar\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 9.5.1\r\nOS: CentOS 7\r\nBrowser: Google Chrome 114.0.5735.198\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\n_No response_","labels":["type/feature-request","area/alerting","area/frontend"]},{"id":66263,"title":"cert_file config for SMTP does not provide reasonable errors","body":"We run our own mailserver, which uses a certificate which is issued by a pretty big and common CA.\r\n\r\nGrafana runs as the `grafana/grafana:9.4.7` Docker image.\r\n\r\nAnalogous config in the prometheus alertmanager suggested to me that the\r\n```\r\n[stmp]\r\ncert_file = [...]\r\n```\r\nconfig expects a path to a copy of said certificate.\r\nHowever, whenever this path points to any specific file (certificate or not) trying to send a test mail from Grafana returns an error:\r\n\r\n\u003e Failed to send test alert.: could not load cert or key file: open : no such file or directory\r\n\r\nPointing to any non-existing file gives the error\r\n\r\n\u003e Failed to send test alert.: could not load cert or key file: open /path/to/nonexisting/file : no such file or directory\r\n\r\nSo first thing is, the error message in case the config option points to an actual file is wrong, the file pointed to by the config definitely exists. There is the extra weirdness to it that in case the file exists, the path is not included in the error message.\r\n\r\nThis occurs both with files that are owned by the grafana user and the root user and both when the file is mounted to the container and copied to the Dockerfile, and both when the path in the .ini is quoted (`'/path/to/cert.crt'`, `\"/path/to/cert.pam\"`) or unquoted.\r\n\r\nFinally I would very much appreciate any hint what the correct way to configure this is, because the only (non-)solution I have found so far is to just skip tls_verify.","labels":["effort/small","type/docs","area/backend/config"]},{"id":44605,"title":"Autorefresh causes a full reload on Panels and loses the selected filters","body":"**What happened**:\r\nWe have a dashboard configured with auto-refresh every 30 seconds. When we select filtering on a panel and the auto-refresh is triggered, the filters are reset and panels are completely reloaded. You can see in the video at 21 seconds how the filters are reset.\r\n\r\nhttps://user-images.githubusercontent.com/43004087/151588459-f383dda2-92f1-45db-bc0e-e41f7759fe4b.mov\r\n\r\n**What you expected to happen**:\r\nOn an auto-refresh filters are still in place.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\nThis started occuring after upgrading from 8.3.1 to 8.3.3. We downgraded to 8.3.1 and confirmed that it works as expected using the older version.\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.3\r\n- Data source type \u0026 version: Prometheus 2.28.1\r\n- OS Grafana is installed on: Kubernetes 1.20\r\n- User OS \u0026 Browser: Firefox 96.0.2\r\n","labels":["type/bug","area/dashboard/templating","area/templating/repeating"]},{"id":44180,"title":"Grafana alert template variables usually not working - label value is not injected","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI am using template variables in my Grafana alert.  In a minority of instances, the template works and the value is injected into the notification message.  In a majority of instances, the template doesn't work and the raw text of the template variable is output.\r\n\r\n**What you expected to happen**:\r\nI expected the label value to be injected into the notification message consistently.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nHere is an example of a query and a notification that IS WORKING and injecting the label value:\r\n\r\n\u003cimg width=\"409\" alt=\"query - working\" src=\"https://user-images.githubusercontent.com/40893895/149997533-1bde711d-0843-43c4-a4a7-d37c6394ae49.png\"\u003e\r\n\r\n\u003cimg width=\"473\" alt=\"notification - working\" src=\"https://user-images.githubusercontent.com/40893895/149997558-e5db4463-32f6-4f31-ac81-38b9ded5da87.png\"\u003e\r\n \r\nHere is an example of a query and a notification that IS NOT WORKING and is instead outputting the variable formula verbatim:\r\n\r\n\u003cimg width=\"437\" alt=\"query - NOT working\" src=\"https://user-images.githubusercontent.com/40893895/149997667-58fafcf2-7fea-4424-830a-bf21708c5e83.png\"\u003e\r\n\r\n\u003cimg width=\"583\" alt=\"notification - NOT working\" src=\"https://user-images.githubusercontent.com/40893895/149997680-619ae930-49c0-47bb-8875-f060c6770c73.png\"\u003e\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.3\r\n- Data source type \u0026 version: Prometheus\r\n- OS Grafana is installed on: hosted in Kubernetes\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["needs more info","area/alerting/notifications"]},{"id":43833,"title":"FreeIPA and Grafana","body":"Hi,\r\n\r\ni try to connect FreeIPA  with Grafana (v8.3.3 in a Docker).\r\nI am fresh in FreeIPA and Access controlling.\r\n\r\nBy loggin in i get following event in the Log:\r\n\r\n`t=2022-01-09T16:01:35+0100 lvl=info msg=\"Request Completed\" logger=context userId=0 orgId=0 uname= method=GET path=/ status=302 remote_addr=162.158.90.88 time_ms=0 size=29 referer=https://myauthentification/`\r\n\r\nI can get data if i am logged in in the Security/LDAP menu, i can search for a username which i created in FreeIPA, i can see names, Emails, if it is a Grafana Admin, Status is active and i have done some groups for Viewer, editor and Admin and all shows correctly.\r\n\r\nmy ldap.toml looks like this:\r\n```\r\n[[servers]]\r\n# Ldap server host (specify multiple hosts space separated)\r\nhost = \"ip.of.freeipserver\"\r\n# Default port is 389 or 636 if use_ssl = true\r\nport = 389\r\n# Set to true if LDAP server should use an encrypted TLS connection (either with STARTTLS or LDAPS)\r\nuse_ssl = false\r\n# If set to true, use LDAP with STARTTLS instead of LDAPS\r\nstart_tls = false\r\n# set to true if you want to skip SSL cert validation\r\nssl_skip_verify = true\r\n\r\n\r\n# set to the path to your root CA certificate or leave unset to use system defaults\r\n# root_ca_cert = \"/path/to/certificate.crt\"\r\n# Authentication against LDAP servers requiring client certificates\r\n# client_cert = \"/path/to/client.crt\"\r\n# client_key = \"/path/to/client.key\"\r\n\r\n# Search user bind dn\r\nbind_dn = \"uid=admin,cn=users,cn=accounts,dc=myipa,dc=server\"\r\n# Search user bind password\r\n# If the password contains # or ; you have to wrap it with triple quotes. Ex \"\"\"#password;\"\"\"\r\nbind_password = 'averystrongpassword'\r\n\r\n# User search filter, for example \"(cn=%s)\" or \"(sAMAccountName=%s)\" or \"(uid=%s)\"\r\n# Allow login from email or username, example \"(|(sAMAccountName=%s)(userPrincipalName=%s))\"\r\nsearch_filter = \"(uid=%s)\"\r\n\r\n# An array of base dns to search through\r\nsearch_base_dns = [\"cn=accounts,dc=myipa,dc=server\"]\r\n\r\n# group_search_filter = \"(cn=grafana_admin,cn=groups)\"\r\n# group_search_filter_user_attribute = \"distinguishedName\"\r\n# group_search_base_dns = [\"cn=groups,cn=accounts,dc=myipa,dc=server\"]\r\n\r\n# Specify names of the LDAP attributes your LDAP uses\r\n[servers.attributes]\r\nsurname = \"sn\"\r\nname = \"givenName\"\r\nusername = \"mail\"\r\nmember_of = \"memberOf\"\r\nemail =  \"mail\"\r\n\r\n[[servers.group_mappings]]\r\ngroup_dn = \"cn=grafana_admin,cn=groups,cn=accounts,dc=myipa,dc=server\"\r\norg_role = \"Admin\"\r\ngrafana_admin = true\r\n\r\n[[servers.group_mappings]]\r\ngroup_dn = \"cn=grafana_editor,cn=groups,cn=accounts,dc=myipa,dc=server\"\r\norg_role = \"Editor\"\r\n\r\n[[servers.group_mappings]]\r\ngroup_dn = \"cn=grafana_viewer,cn=groups,cn=accounts,dc=myipa,dc=server\"\r\norg_role = \"Viewer\"\r\n```\r\n\r\nand my Grafana.ini looks like this:\r\n\r\n```\r\n[auth.ldap]\r\nenabled = true\r\nconfig_file = /etc/grafana/ldap.toml\r\nallow_sign_up = true\r\n```\r\n\r\nif i go to my Grafana board, it redirects me to Authelia where i have to login, after loggin in it shows me the login of Grafana, which under my knowledge shouldn't be? If a user is logged in which is in the FreeIPA it should log in if the user is known, or if the user is unknown grafana should do a new user?\r\n\r\nMaybe someone can help me get it work.. \r\n\r\nThank you\r\n\r\nGreetings","labels":["needs more info","area/auth/ldap"]},{"id":52370,"title":"Yellow \"unauthorized\" on snapshot when accessing as guest","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nOpening snapshot by link triggers yellow \"Unauthorized\" popup when opening snapshot as guest. Snapshot is usable, balloon disappear after a while.\r\n\r\n**What you expected to happen**:\r\n\r\nNo error.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nShare snapshot and open in incognito.\r\n\r\n**Anything else we need to know?**:\r\n\r\n`GET http://grafana:3000/api/search 401 (Unauthorized)` - from console, probably causes this warning.\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.3\r\n- Data source type \u0026 version: -\r\n- OS Grafana is installed on: Debian 11\r\n- User OS \u0026 Browser: Chrome 103\r\n- Grafana plugins: -\r\n- Others: -\r\n","labels":["type/bug","needs more info","area/dashboard/snapshot","needs investigation","bot/no new info"]},{"id":63613,"title":"Getting Error \"Cannot read properties of undefined (reading 'eventTrackingNamespace')\"","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: We had recently upgraded our Grafana from v8.2.7 to v9.3.1 and after that Whenever we are Hitting any DASHBOARD or ORGID, we are getting 502 error .\r\n\r\n![image](https://user-images.githubusercontent.com/78014471/220873609-d51c3e46-945c-4494-a2ea-e175d2d25337.png)\r\n\r\nWhen We checked in Developer portal under networking, we got below error\r\n![image](https://user-images.githubusercontent.com/78014471/220911032-89a3cd67-81d4-4e1e-9a18-b42b561f188a.png)\r\n\r\n![image](https://user-images.githubusercontent.com/78014471/220912810-55974aa1-1c6c-4c5c-97c7-60ca7e9df53c.png)\r\n\r\n![image](https://user-images.githubusercontent.com/78014471/220912921-8668c528-2bf8-4a72-bb30-acb72d178694.png)\r\n\r\n\r\n**What you expected to happen**: It should not give any error / pop up as it was working fine in last version whish was 8.2.7\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: Can install Grafana v9.3.1 \r\n\r\n**Anything else we need to know?**: This  issue is very frequent if we are trying to hit the dashboard url without login as an anonymous user, \r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.1\r\n- Data source type \u0026 version: NA\r\n- OS Grafana is installed on: AKS \r\n- User OS \u0026 Browser: Windows , Chrome , Edge\r\n- Grafana plugins: Plugins are working fine , only issue is with Grafana UI specially manage dashboard \r\n- Others: \r\n","labels":["area/dashboard","bot/no new info"]},{"id":61520,"title":"Validation missing for field \"name\" when creating a datasource via POST","body":"**What happened**:\r\nIf you issue a curl command to create (via POST) a datasource containing a space in its \"name\" field, you are allowed to do it. Other operations on the obtained datasource partially fail later.\r\n\r\n**What you expected to happen**:\r\nReceive the same Validation error as for the PUT method.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nRun this on a fresh Grafana installation: \r\n\r\n```bash\r\ncurl 'http://localhost:3000/api/datasources' \\\r\n  -u admin:admin \\\r\n  -H 'content-type: application/json' \\\r\n  --data-raw '{\"name\":\"Loki 1\",\"type\":\"loki\",\"access\":\"proxy\",\"isDefault\":false}'\r\n```\r\nYou can see that you receive a newly created datasource instead of a validation error.\r\n\r\n**Anything else we need to know?**:\r\nYou can't reproduce this in the browser because, the app automatically creates a proper name there.\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.2\r\n- Data source type \u0026 version: Loki 2.7.1\r\n- OS Grafana is installed on: Linux\r\n- User OS \u0026 Browser: not relevant\r\n- Grafana plugins: not relevant\r\n- Others: none\r\n","labels":["needs more info","area/backend/api"]},{"id":47499,"title":"Grafana 8 Nodata status not respecting “Evaluate” setting","body":"Questions should be posted to: https://community.grafana.com/t/grafana-8-nodata-status-not-respecting-evaluate-setting/62676\r\n\r\n**What happened**: Grafana 8 Nodata status not respecting “Evaluate” setting\r\n\r\n**What you expected to happen**: Grafana 8 Nodata status should respect “Evaluate” setting\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: I set “Evaluate every 1m for 20m” and if NoData occurs it will send the notification after 1min and not waiting 20mins\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.3\r\n- Data source type \u0026 version: InfluxDB\r\n- OS Grafana is installed on: RHEL 8.5\r\n- User OS \u0026 Browser: OSX \u0026 Safari/Chrome\r\n- Grafana plugins: none\r\n- Others: none\r\n","labels":["effort/small","type/docs","area/alerting","prio/medium","area/alerting/evaluation","area/backend","migrate/status-icebox"]},{"id":61011,"title":"Teams with dashboard view permission can no longer load panels","body":"**What happened**: users with viewer role can no longer view dashboard panels, making Grafana unusable for a bunch of use cases. Only editors can load panels.\r\n\r\n**What you expected to happen**: viewers should be able to load dashboard panels.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: create a dashboard and add a Team with \"View\" only permission. Add a user to that team and login. You'll see the message \"Panel plugin not found: Unable to load library panel: XYZ\" for each panel.\r\n\r\n![206810065-59c1f71a-51a8-46e1-aa19-5e537fba36a8](https://user-images.githubusercontent.com/79376156/210666876-64cfc4a4-498a-485d-bd81-d1a26997d930.jpg)\r\n\r\n**Anything else we need to know?**: there are a bunch of bug reports for a similar issue with public dashboards (see #54802), but the problem is a lot worse and affects logged in users with view permission.\r\n\r\n**Environment**:\r\n- Grafana version: v9.3.1","labels":["area/dashboard","needs more info","area/permissions"]},{"id":88871,"title":"Alerting: Labels not matching to notification policies","body":"### What happened?\n\nI created an alert and set the labels to \"severity=critical\".\r\nIn notification polices, I created a policy with the same matching policies.\r\nWhen I click Preview routing in the alert, it doesn't pick up the policy.  It returns the default policy.\r\nWhen I look at the details, it says No matching labels but in the box to the right, it says severity=critical.\r\n\r\nIf I do the same thing but use a different label pair like team=Blah, it works.  Is \"severity\" reserved?\n\n### What did you expect to happen?\n\nThe Preview button should have showed me the policy with the matching labels.\n\n### Did this work before?\n\nv10.4.1\r\nThis did work a few days ago.  No versions have been updated.\n\n### How do we reproduce it?\n\n1.  Create a notification policy with matching severity=critical\r\n2.  Create an alert that has Configure labels and notifications,  severity=critical\r\n3.  Click Preview Routing\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.4.1\r\nOS: k3s on RHEL9\r\nBrowser: Firefox 126.0.1\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nPrometheus 2.34.0","labels":["needs more info","area/alerting"]},{"id":51937,"title":"Dashboards: Difference Percent Legend unit displays 0.0-1.0 when 0-100 expected","body":"**What happened**:\r\nDifference Percent legend values formatted as 0.0-1.0 but displays a % sign for 0-100.\r\n\r\n![](https://user-images.githubusercontent.com/1832518/177885747-2628baf7-ba8b-4b22-a820-45a5ba8d295c.png)\r\n\r\n\r\n**What you expected to happen**:\r\n\r\n![](https://user-images.githubusercontent.com/1832518/177885777-6b0444e8-f0ab-4f39-ad8b-bf041a4a6630.png)\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nGrafana latest on Docker connecting to TimescaleDB, use Difference Percent in the Legend in a Time Series panel.\r\n\r\n**Anything else we need to know?**:\r\nhttps://github.com/grafana/grafana/pull/49004 tried to resolve there being no units at all - their screenshot shows the value being formatted correctly, however I had to make this change to get the value to format correctly on my end:\r\n\r\n```diff\r\n--- a/packages/grafana-ui/src/components/uPlot/PlotLegend.tsx\r\n+++ b/packages/grafana-ui/src/components/uPlot/PlotLegend.tsx\r\n@@ -86,7 +86,7 @@ export const PlotLegend: React.FC\u003cPlotLegendProps\u003e = ({\r\n                   ...field,\r\n                   config: {\r\n                     ...field.config,\r\n-                    unit: 'percent',\r\n+                    unit: 'percentunit',\r\n                   },\r\n                 },\r\n                 theme,\r\n```\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.2\r\n- Data source type \u0026 version: Postgres 12+ /w TimescaleDB\r\n- OS Grafana is installed on: Docker (alpine)\r\n- User OS \u0026 Browser: All browsers\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/bug","area/panel/timeseries"]},{"id":44791,"title":"Reduce tranformations shows incorrect values","body":"\r\n**What happened**:\r\n\r\nThis issue is the same as described in  #24950 \r\n\r\nReduction  transformations show incorrect values in table in 'Series to rows mode'\r\n\r\n**What you expected to happen**:\r\n\r\nReduction  transformations show correct values in table in 'Series to rows mode'\r\n\r\nIn editing mode values are correct:\r\n\r\n![grafana_editing](https://user-images.githubusercontent.com/1822286/152203354-a18b960b-77ca-4f46-a845-7ff2ab74344a.png)\r\n\r\nBack to dashboard:\r\n\r\n![grafana_dashboard_before_refresh](https://user-images.githubusercontent.com/1822286/152203623-10b2e6a7-d8b5-4458-bd09-4fcaa4b5888c.png)\r\n\r\nAfter refreshing the dashboard values are incorrects:\r\n\r\n![grafana_dashboard_after_refresh](https://user-images.githubusercontent.com/1822286/152203636-121b9309-e2da-4a76-b00b-b1b31b6a5cea.png)\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n1. Edit table panel\r\n1. Create table Reduction in 'Series to 'rows' mode\r\n2. Create two Calculations 'Max' and 'Mean' .\r\n3. Back to dashboard\r\n4. Refresh dashboard\r\n\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.4\r\n- Data source type \u0026 version: Influxdb (InfluxQL)\r\n- OS Grafana is installed on: Docker image\r\n- User OS \u0026 Browser: Linux Ubuntu 18.04 , Firefox 96.0.3\r\n- Grafana plugins: Core plugins only\r\n- Others:\r\n","labels":["prio/medium","needs investigation","area/transformations","triage/needs-confirmation"]},{"id":56623,"title":"Time Series: line color not the one in legend or tooltip","body":"I have time series graph of 25 sensors with values between 0 and 100. Lines are stacked. \r\nIf I hover my tooltip I see the lines mentioned but for example group10 is shown as yellow in both legends but the line is red or purple. \r\nThe background fill is yellow though?\r\nLine is the same color as on the far to right?\r\n\r\n![image](https://user-images.githubusercontent.com/10828880/194841991-ba57bd3d-1dfa-4eb6-a4c3-bb276022d269.png)\r\n\r\n\r\n**What happened**:\r\nline color is red/purple\r\n\r\n**What you expected to happen**:\r\nline color should be yellow\r\n\r\n**Environment**:\r\n- Grafana version: 9.1.1 and 9.1.7, same thing\r\n- Data source type \u0026 version: TimescaleDB PostgreSQL\r\n- OS Grafana is installed on: Ubuntu 16.04\r\n- User OS \u0026 Browser: Win10 \u0026 Chrome 105 / Firefox 105\r\n- Grafana plugins: if relevant, please ask\r\n- Others:\r\n","labels":["area/panel/timeseries","area/tooltip","discussion/consideration"]},{"id":45982,"title":"Unable to access all template variables when using templates for alerting/notifications in 8.4.1 cloud","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWhen using grafana cloud v8.4.1 and trying to template or customise my notifications, it seems you are only able to access `{{ .Labels }}`. \r\nIf you iterate over the alerts, you should get given Labels, Value, Annotations etc. However it seems you can only access Labels. \r\nIf you leave the template as default, in this case I am using Slack, I get all of the information/variables. \r\nAlso, using the format of `{{ $value }}` or `{{ $labels }}` does not work.\r\nThe only way to get all of this information, is to actually leave the default template that grafana has. However, you end up getting too much information and it's not in a nice format. \r\nOne thing to note too, this is the same if you are using templates, or you are modifying the \"Text Body\" inside the slack contact point.\r\n\r\n**What you expected to happen**:\r\nYou should be able to access the values in the alert, such as the value. \r\n`{{ $value }}` and `{{ $labels }}` should return information. \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate an alert, whether grafana managed or Cortex/Loki. \r\nUse Slack as a contact point, in the \"Text Body\" leave it as default, and you will get all the information from your alert, including \"Value\" or the alert that you setup. \r\nIf you loop through the alerts, you cannot access Value or anything else apart from Labels:\r\n```golang \r\n{{ range .Alerts }}\r\n{{ .Labels }}\r\n{{ .Value }}\r\n{{ end }}\r\n```\r\nYou will notice that only the labels are presented. \r\nIf you remove the following config/text, you will see more information that you can use, more precisely, the `Value` of the alert.\r\nIt is \"OK\" to have just the labels, but actually it would be nice to actually give back to the user the value. In my case I'm alerting on linux disk space, so it would be nice to see the percent of the disk space from the query. \r\nMy query:\r\n```\r\nA:\r\n100 - ((node_filesystem_avail_bytes{instance=\"hostname:12345\",job=\"integrations/node_exporter\",mountpoint=~\"/data\",fstype!=\"rootfs\"} * 100) / node_filesystem_size_bytes{instance=\"hostname:12345\",job=\"integrations/node_exporter\",mountpoint=~\"/data\",fstype!=\"rootfs\"}) \u003e 77\r\n```\r\n```\r\nB:\r\nReduce, Last, Input = A\r\n```\r\n```\r\nC: \r\n$B \u003e 77\r\n```\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**: Grafana Cloud \r\n- Grafana version: 8.4.1\r\n- Data source type \u0026 version: Grafana cloud/Prometheus cloud\r\n- OS Grafana is installed on: NA\r\n- User OS \u0026 Browser: MacOS/Chrome\r\n- Grafana plugins: Cloud default\r\n- Others: N/A\r\n","labels":["area/alerting","stale"]},{"id":63464,"title":"Unable to edit Teams message template with images","body":"**What happened**:\r\nWe have successfully set up a Teams connector to send alert notifications to a specific channel, and have integrated Azure Blob storage as an external image provider. However, we now need to modify the message template to better suit our needs while still retaining the image functionality.\r\n\r\nWe cannot find a way to include the image in the new template.\r\n\r\n**What you expected to happen**:\r\n\r\nI expected to have a template data element to embedd the image uploaded in the Azure Blob Storage.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n1. Configure Azure Blob store as external image provider\r\n2. Create an alert\r\n3. Setup and test a Teams contact point\r\n\r\n**Anything else we need to know?**:\r\n\r\nIf we try to specify a template, the Teams connector does not send messages anymore, with no error in logs.\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.6\r\n- Data source type \u0026 version: PostgreSQL 12\r\n- OS Grafana is installed on: Kubernetes (grafana/grafana image)\r\n- User OS \u0026 Browser: Edge running on Windows\r\n- Grafana plugins: none\r\n- Others:\r\n","labels":["needs more info","area/alerting","area/image-rendering"]},{"id":52329,"title":"Bar chart tool tip doesn't show values properly.","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: Tooltip doesn't properly show (single | all) values.\r\n\r\n**What you expected to happen**: Tooltip to show either single or all values on hover.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: Use a bar chart with Stacking Normal and different tooltip modes.\r\n\r\n**Anything else we need to know?**: A similar table on Time series shows the tooltip properly, which is how it is expected.\r\n\r\n**Environment**:\r\n\r\n- Grafana version: v8.3.3 (30bb7a93ca)\r\n- Data source type \u0026 version: Postgresql \r\n- OS Grafana is installed on: Ubuntu 20.04.4 LTS\r\n- User OS \u0026 Browser: Ubuntu 20.04.4 LTS\r\n- Grafana plugins: Bar Chart\r\n- Others: see attached screenshots\r\n\r\n![not_stacked_tooltip_single](https://user-images.githubusercontent.com/71791731/179226359-4ed24d34-3e9a-40a6-b33b-7b0e95180c71.png)\r\n![not_stacked_tooltip_all](https://user-images.githubusercontent.com/71791731/179226367-3992276e-f6e2-4199-a108-13519bc915e6.png)\r\n![stacked_tooltip_single](https://user-images.githubusercontent.com/71791731/179226369-0d0add54-f3dc-42f6-bc10-b75ebf50185c.png)\r\n![stacked_tooltip_all](https://user-images.githubusercontent.com/71791731/179226371-5c01ac95-d922-4bae-82c6-9ca6a2814d01.png)\r\n","labels":["type/bug","area/panel/barchart","area/tooltip"]},{"id":63269,"title":"An unexpected error happened  TypeError: u is null","body":"Hi,\r\n\r\nCentOS Linux release 7.9.2009 (Core)\r\nGrafana 9.2.3 OSS\r\nMysql rds 8.0.31\r\n\r\nWhen use administrator Manage all users and orgs, the search user bug if the \"name\" is wrong and no exist in database.\r\n\r\nit be required to refresh \"F5\" to regain the control.\r\n\r\nThis bug is know ?\r\n\r\nThanks for your help.\r\n\r\nBest regards.\r\n\r\n\u003cimg width=\"764\" alt=\"grafana1\" src=\"https://user-images.githubusercontent.com/113979255/218128874-42ac50cf-099e-445a-8bd9-4da8ee8604ce.PNG\"\u003e\r\n\u003cimg width=\"478\" alt=\"grafana2\" src=\"https://user-images.githubusercontent.com/113979255/218128885-b1bdf81b-2f69-44a9-958f-fcf4dda6dd78.PNG\"\u003e\r\n\r\n\r\n\r\nlog in grafana GUI : (no log in /var/log/grafana.log)\r\n\r\nAn unexpected error happened\r\nTypeError: u is null\r\n37128/W\u003c@https://olg-grafana.ca-central-1.dtshared.prod.fdjaws.corp/public/build/UserListAdminPage.087cea19e9d0bce92422.js:30:155\r\ng@https://olg-grafana.ca-central-1.dtshared.prod.fdjaws.corp/public/build/4713.9debbfba7033186a58bf.js:2:999564\r\nSuspense\r\nc@https://olg-grafana.ca-central-1.dtshared.prod.fdjaws.corp/public/build/3593.68f2b385d6dfe4902410.js:1194:301\r\nfc@https://olg-grafana.ca-central-1.dtshared.prod.fdjaws.corp/public/build/3593.68f2b385d6dfe4902410.js:8749:362\r\nt@https://olg-grafana.ca-central-1.dtshared.prod.fdjaws.corp/public/build/4713.9debbfba7033186a58bf.js:2:1014882\r\nt@https://olg-grafana.ca-central-1.dtshared.prod.fdjaws.corp/public/build/4713.9debbfba7033186a58bf.js:2:1016903","labels":["needs more info","area/admin/user"]},{"id":70279,"title":"Explore: Tempo TraceToLogs - Logs for Span link Disabled after upgrading Grafana 9.4 to 9.5","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n  - After upgrading to Grafana 9.5 the Link to Loki Logs from Tempo Traces is disabled despite it working on 9.4 with the current configuration. Log Icons along side of Traces are also missing.\r\n\r\n**What did you expect to happen**:\r\n\r\n  - The Link to continue to work since the TraceID pattern hasn't changed and is still configured in the Datasource\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\n- Open Grafana in Explore tab and search for a Trace\r\n\r\n**Step 2**:\r\n\r\n- Click on Trace and Expand the Trace - the Logs for this Span link is Disabled and Log Icon that was previously in left bar of traces is missing - I'm not able to get to the trace without going specifically to Loki in Explore and search for the traceID\r\n\r\n\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\n9.5.3\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\r\n\r\n### Grafana Platform?\r\n\r\nNone\r\n\r\n### User's OS?\r\n\r\n_No response_\r\n\r\n### User's Browser?\r\n\r\n_No response_\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\n_No response_\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["needs more info","area/explore","type/regression"]},{"id":81049,"title":"Stat: Data link field substitution not working","body":"### What happened?\n\nI created a Stat visualization for the following postgres query:\r\n\r\n```sql\r\nSELECT\r\n  CASE msp_organization_id\r\n    WHEN NULL THEN 'none'\r\n    ELSE (SELECT name FROM organizations WHERE id = msp_organization_id AND $__timeFilter(period) LIMIT 1)\r\n  END AS msp,\r\n  msp_organization_id\r\nFROM organization_licenses\r\nWHERE\r\n  $__timeFilter(period) AND\r\n  id = '$orgid'\r\nORDER BY period DESC\r\nLIMIT 1\r\n```\r\n\r\nThe `msp` field is shown correctly. I now went to create a data link like so: `https://some.url/path?orgid=${__data.fields.msp_organization_id}`\r\n\r\nI used Ctrl-Space to insert the field variable template string. However, when applying and saving the dashboard, the variable never gets replaced and the data link points to the literal url `https://some.url/path?orgid=${__data.fields.msp_organization_id}` which is wrong.\n\n### What did you expect to happen?\n\nThe data link should point to `https://some.url/path?orgid=123456789`, the variable shoud have been substituted.\n\n### Did this work before?\n\nI don't know. I have only used data links on tables so far and they all work fine.\n\n### How do we reproduce it?\n\n1. Create a dashboard\r\n2. Create a Stat visualization\r\n3. Fetch two fields from SQL\r\n4. Show only one field\r\n5. Create a data link that contains the other field\r\n6. Apply and save\r\n7. Try to use the link and observe that nothing is substituted and the link is broken.\n\n### Is the bug inside a dashboard panel?\n\n| Key | Value |\r\n|--|--|\r\n| Panel | stat @ 10.2.3 |\r\n| Grafana | 10.2.3 (1e84fede543acc892d2a2515187e545eb047f237) // Open Source |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"text\",\r\n                \"value\": null\r\n              }\r\n            ]\r\n          },\r\n          \"color\": {\r\n            \"mode\": \"thresholds\"\r\n          },\r\n          \"links\": [\r\n            {\r\n              \"targetBlank\": true,\r\n              \"title\": \"Go to MSP org\",\r\n              \"url\": \"https://some.url/path?orgid=${__data.fields.msp_organization_id}\"\r\n            }\r\n          ]\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"reduceOptions\": {\r\n          \"values\": false,\r\n          \"calcs\": [\r\n            \"last\"\r\n          ],\r\n          \"fields\": \"/^msp$/\"\r\n        },\r\n        \"orientation\": \"auto\",\r\n        \"textMode\": \"auto\",\r\n        \"wideLayout\": true,\r\n        \"colorMode\": \"value\",\r\n        \"graphMode\": \"area\",\r\n        \"justifyMode\": \"auto\"\r\n      },\r\n      \"pluginVersion\": \"10.2.3\",\r\n      \"targets\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"grafana\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"snapshot\",\r\n          \"snapshot\": [\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"meta\": {\r\n                  \"typeVersion\": [\r\n                    0,\r\n                    0\r\n                  ],\r\n                  \"executedQueryString\": \"SELECT\\n  CASE msp_organization_id\\n    WHEN NULL THEN 'none'\\n    ELSE (SELECT name FROM organizations WHERE id = msp_organization_id AND period BETWEEN '2023-12-24T10:33:21.599Z' AND '2024-01-23T10:33:21.599Z' LIMIT 1)\\n  END AS msp,\\n  msp_organization_id\\nFROM organization_licenses\\nWHERE\\n  period BETWEEN '2023-12-24T10:33:21.599Z' AND '2024-01-23T10:33:21.599Z' AND\\n  id = 'c5bf6a56-cf05-41c1-bd55-381e81c0d562'\\nORDER BY period DESC\\nLIMIT 1\"\r\n                },\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"msp\",\r\n                    \"type\": \"string\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"string\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"msp_organization_id\",\r\n                    \"type\": \"string\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"string\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    \"redacted\"\r\n                  ],\r\n                  [\r\n                    \"31e0ccb0-14d0-455c-9758-bd4a8d8cb8a1\"\r\n                  ]\r\n                ]\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      \"title\": \"Reproduced with embedded data\",\r\n      \"type\": \"stat\"\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003estat @ 10.2.3\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003eA[postgres]\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003e 1 frames, 2 fields, 1 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e10.2.3 (1e84fede543acc892d2a2515187e545eb047f237) // Open Source\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"title\": \"Original Panel JSON\",\r\n      \"type\": \"text\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 7\r\n      },\r\n      \"options\": {\r\n        \"content\": \"{\\n  \\\"datasource\\\": {\\n    \\\"uid\\\": \\\"taYgXUHnk\\\",\\n    \\\"type\\\": \\\"grafana-postgresql-datasource\\\"\\n  },\\n  \\\"fieldConfig\\\": {\\n    \\\"defaults\\\": {\\n      \\\"mappings\\\": [],\\n      \\\"thresholds\\\": {\\n        \\\"mode\\\": \\\"absolute\\\",\\n        \\\"steps\\\": [\\n          {\\n            \\\"color\\\": \\\"text\\\",\\n            \\\"value\\\": null\\n          }\\n        ]\\n      },\\n      \\\"color\\\": {\\n        \\\"mode\\\": \\\"thresholds\\\"\\n      },\\n      \\\"links\\\": [\\n        {\\n          \\\"targetBlank\\\": true,\\n          \\\"title\\\": \\\"Go to MSP org\\\",\\n          \\\"url\\\": \\\"https://some.url/path?orgid=${__data.fields.msp_organization_id}\\\"\\n        }\\n      ]\\n    },\\n    \\\"overrides\\\": []\\n  },\\n  \\\"gridPos\\\": {\\n    \\\"h\\\": 4,\\n    \\\"w\\\": 3,\\n    \\\"x\\\": 17,\\n    \\\"y\\\": 12\\n  },\\n  \\\"id\\\": 32,\\n  \\\"options\\\": {\\n    \\\"reduceOptions\\\": {\\n      \\\"values\\\": false,\\n      \\\"calcs\\\": [\\n        \\\"last\\\"\\n      ],\\n      \\\"fields\\\": \\\"/^msp$/\\\"\\n    },\\n    \\\"orientation\\\": \\\"auto\\\",\\n    \\\"textMode\\\": \\\"auto\\\",\\n    \\\"wideLayout\\\": true,\\n    \\\"colorMode\\\": \\\"value\\\",\\n    \\\"graphMode\\\": \\\"area\\\",\\n    \\\"justifyMode\\\": \\\"auto\\\"\\n  },\\n  \\\"pluginVersion\\\": \\\"10.2.3\\\",\\n  \\\"targets\\\": [\\n    {\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"postgres\\\",\\n        \\\"uid\\\": \\\"taYgXUHnk\\\"\\n      },\\n      \\\"editorMode\\\": \\\"code\\\",\\n      \\\"format\\\": \\\"table\\\",\\n      \\\"group\\\": [],\\n      \\\"metricColumn\\\": \\\"none\\\",\\n      \\\"rawQuery\\\": true,\\n      \\\"rawSql\\\": \\\"SELECT\\\\n  CASE msp_organization_id\\\\n    WHEN NULL THEN 'none'\\\\n    ELSE (SELECT name FROM organizations WHERE id = msp_organization_id AND $__timeFilter(period) LIMIT 1)\\\\n  END AS msp,\\\\n  msp_organization_id\\\\nFROM organization_licenses\\\\nWHERE\\\\n  $__timeFilter(period) AND\\\\n  id = '$orgid'\\\\nORDER BY period DESC\\\\nLIMIT 1\\\",\\n      \\\"refId\\\": \\\"A\\\",\\n      \\\"select\\\": [\\n        [\\n          {\\n            \\\"params\\\": [\\n              \\\"license_right\\\"\\n            ],\\n            \\\"type\\\": \\\"column\\\"\\n          }\\n        ]\\n      ],\\n      \\\"sql\\\": {\\n        \\\"columns\\\": [\\n          {\\n            \\\"parameters\\\": [],\\n            \\\"type\\\": \\\"function\\\"\\n          }\\n        ],\\n        \\\"groupBy\\\": [\\n          {\\n            \\\"property\\\": {\\n              \\\"type\\\": \\\"string\\\"\\n            },\\n            \\\"type\\\": \\\"groupBy\\\"\\n          }\\n        ],\\n        \\\"limit\\\": 50\\n      },\\n      \\\"table\\\": \\\"organizations\\\",\\n      \\\"timeColumn\\\": \\\"period\\\",\\n      \\\"timeColumnType\\\": \\\"timestamptz\\\",\\n      \\\"where\\\": [\\n        {\\n          \\\"name\\\": \\\"$__timeFilter\\\",\\n          \\\"params\\\": [],\\n          \\\"type\\\": \\\"macro\\\"\\n        },\\n        {\\n          \\\"datatype\\\": \\\"uuid\\\",\\n          \\\"name\\\": \\\"\\\",\\n          \\\"params\\\": [\\n            \\\"id\\\",\\n            \\\"=\\\",\\n            \\\"'$orgid'\\\"\\n          ],\\n          \\\"type\\\": \\\"expression\\\"\\n        }\\n      ]\\n    }\\n  ],\\n  \\\"title\\\": \\\"MSP\\\",\\n  \\\"type\\\": \\\"stat\\\"\\n}\",\r\n        \"mode\": \"code\",\r\n        \"code\": {\r\n          \"language\": \"json\",\r\n          \"showLineNumbers\": true,\r\n          \"showMiniMap\": true\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: MSP // 2024-01-23 11:39:40\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-stat\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"2023-12-24T10:39:40.237Z\",\r\n    \"to\": \"2024-01-23T10:39:40.237Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\n\n### Environment (with versions)?\n\nGrafana: 10.2.3\r\nOS: Windows 11\r\nBrowser: Firefox 116.0.3\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\n_No response_","labels":["needs more info","area/dashboard/data-links","triage/needs-confirmation","team/grafana-dashboards"]},{"id":45502,"title":"Unescape JSON logs in Grafana for better UX","body":"\u003c!-- Please keep the structure below, or your issue may be closed. --\u003e\r\n\r\n**Is your feature request related to a problem? Please describe.**\r\nLog messages and especially multiline exception stack traces are hard to read when contain valid escaped JSON strings.\r\n\r\n**Describe the solution you'd like**\r\nI think it is expected that when we apply the `| json` formatter it should unescape JSON strings for better UX.\r\n\r\n**Additional context**\r\nCurrently strings containing escaped `\\\"` are not very pleasant to read:\r\n![image](https://user-images.githubusercontent.com/1997978/154408744-bd5322c6-a35e-43b2-b488-100d6fc9526b.png)\r\n\r\nException stack traces are very hard to read because `\\n` was not unescaped:\r\n![image](https://user-images.githubusercontent.com/1997978/154408939-8559b731-ba7e-490e-beb4-aa65388e88f3.png)\r\n\r\n","labels":["needs investigation","area/explore","area/panel/logs","area/logs"]},{"id":50979,"title":"Permissions needed, user scope is not returned correctly: userId=0 and uname= empty","body":"**What happened**:\r\n- User cannot _editing_, _creating_ alert rules\r\n- User has **admin** role and is even **grafana admin**\r\n![Grafana Alert Editing No Permissions](https://user-images.githubusercontent.com/61626020/174125327-46eeb325-1903-4800-b47b-62ddeaff9c9f.gif)\r\n\r\n---\r\n\r\n**What you expected to happen**:\r\n- User should be able to _edit_ existing alert-rules, if user is admin or permissions are granted\r\n\r\n---\r\n\r\n**Anything else we need to know?**:\r\n\r\nIt seams, that Grafana does not recognize my user, because watching the logs I could see, that the `userId=0` is not correct and no `uname=` is recorded.\r\n\r\ncorresponding error log:\r\n```txt\r\nlogger=ngalert t=2022-06-16T16:49:22.032616748+02:00 level=debug msg=\"alert rules fetched\" count=4 disabled_orgs=\"unsupported value type\"\r\nlogger=provisioning.dashboard type=file name=default t=2022-06-16T16:49:22.706820195+02:00 level=debug msg=\"Start walking disk\" path=/var/lib/grafana/dashboards\r\nlogger=accesscontrol.resolver t=2022-06-16T16:49:22.946317766+02:00 level=debug msg=\"resolved '%v' to '%v'\" folders:name:ABC=\"unsupported value type\"\r\nlogger=accesscontrol.resolver t=2022-06-16T16:49:22.946404924+02:00 level=debug msg=\"used cache to resolve '%v' to '%v'\" folders:name:ABC=\"unsupported value type\"\r\nlogger=accesscontrol.resolver t=2022-06-16T16:49:22.946425572+02:00 level=debug msg=\"used cache to resolve '%v' to '%v'\" folders:name:ABC=\"unsupported value type\"\r\nlogger=context traceID=00000000000000000000000000000000 userId=0 orgId=1 uname= t=2022-06-16T16:49:22.9464519+02:00 level=info msg=\"Access denied\" userID=0 accessErrorID=ACE7174620033 permissions=\"any(alert.rules:write alert.rules:create alert.rules:delete)\"\r\nlogger=context traceID=00000000000000000000000000000000 userId=0 orgId=1 uname= t=2022-06-16T16:49:22.946639748+02:00 level=info msg=\"Request Completed\" method=POST path=/api/ruler/grafana/api/v1/rules/ABC status=403 remote_addr=x.x.x.x time_ms=2 duration=2.437298ms size=214 referer=\"https://\u003cmyhost\u003e/grafana/alerting/T6dYefjnz/edit?returnTo=%2Falerting%2Flist\" traceID=00000000000000000000000000000000\r\n```\r\n\r\nOn other Grafana pages the logging is getting my correct `userId=9`\r\n```txt\r\nlogger=context traceID=00000000000000000000000000000000 userId=9 orgId=1 uname=\u003cmyusername\u003e t=2022-06-16T16:49:16.507469208+02:00 level=info msg=\"Request Completed\" method=GET path=/api/live/ws status=400 remote_addr=x.x.x.x time_ms=16 duration=16.732875ms size=12 referer= traceID=00000000000000000000000000000000\r\n```\r\n\r\nDuring some researches, I could find out, that this code block is executed:\r\nhttps://github.com/grafana/grafana/blob/b5c56f63710e09f37b8557ddd8b99ae3fc583169/pkg/services/accesscontrol/resolvers.go#L44\r\n\r\nCurrent I use Grafana version: `Version 9.0.0 (commit: b5c56f6371, branch: HEAD)`\r\nThis line mentioned above is already changed during some refactoring:\r\nhttps://github.com/grafana/grafana/blob/c043a8818a978fba05e54420a2f3dcad047f1af6/pkg/services/accesscontrol/resolvers.go#L44\r\n\r\nBut actually, only the logging was fixed. Therefore I am sure, this dysfunction still exists :/\r\n\r\nUser Authentication:\r\n```sh\r\nroot@\u003cmyhost\u003e:~# grep \"\\[auth\\]\" -A14 /etc/grafana/grafana.ini \r\n[auth]\r\ndisable_login_form = False\r\noauth_auto_login = False\r\ndisable_signout_menu = False\r\nsignout_redirect_url = https://\u003cmyhost\u003e/Shibboleth.sso/Logout?return=https://\u003cmyhost\u003e/grafana\r\n[auth.proxy]\r\nenabled = True\r\nheader_name = X-WEBAUTH-USER\r\nheader_property = username\r\nheaders = Name:X-WEBAUTH-NAME Email:X-WEBAUTH-EMAIL\r\nauto_sign_up = True\r\n\r\n[auth.anonymous]\r\nenabled = True\r\n```\r\n---\r\n\r\n**Environment**: Debian GNU/Linux 11 (bullseye)\r\n- Grafana version: \r\n```txt\r\nVersion 9.0.0 (commit: b5c56f6371, branch: HEAD)\r\n```\r\n- Data source type \u0026 version:\r\n```sh\r\nroot@\u003cmyhost\u003e:~# apt policy grafana\r\ngrafana:\r\n  Installed: 9.0.0\r\n  Candidate: 9.0.0\r\n  Version table:\r\n *** 9.0.0 500\r\n        500 https://packages.grafana.com/oss/deb stable/main amd64 Packages\r\n        100 /var/lib/dpkg/status\r\n```\r\n- User OS \u0026 Browser: FireFox 101.0 (64-bit) and Chromium Version 102.0.5005.61 (Official Build) (64-bit)\r\n- Grafana plugins:\r\n```sh\r\nroot@\u003cmyhost\u003e:~# ls /var/lib/grafana/plugins\r\ngrafana-image-renderer\r\n```\r\n","labels":["needs more info","area/alerting","area/backend","area/auth/rbac"]},{"id":51948,"title":"Dashboard Preview - Crawler auth setup failed - role not found","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: Unable to get dashboard Previews to work in Grafana docker image (grafana/grafana-enterprise:9.0.2) \r\n\r\n**What you expected to happen**: \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:  \r\nDockerfile:\r\n```\r\nFROM grafana/grafana-enterprise:9.0.2\r\nCOPY grafana.ini /etc/grafana/grafana.ini\r\n```\r\ngrafana.ini:\r\n```\r\n[rendering]\r\n# Options to configure a remote HTTP image rendering service, e.g. using https://github.com/grafana/grafana-image-renderer.\r\n# URL to a remote HTTP image renderer service, e.g. http://localhost:8081/render, will enable Grafana to render panels and dashboards to PNG-images using HTTP requests to an external service.\r\nserver_url = http://grafana-image-renderer:8081/render\r\n# If the remote HTTP image renderer service runs on a different server than the Grafana server you may have to configure this to a URL where Grafana is reachable, e.g. http://grafana.domain/.\r\ncallback_url = https://\u003chostname\u003e.com/grafana/\r\nrendering_ignore_https_errors = true\r\n\r\n[feature_toggles]\r\n# enable features, separated by spaces\r\nenable = dashboardPreviews serviceAccounts\r\n \r\n[server]\r\n# Protocol (http, https, h2, socket)\r\nprotocol = http\r\n\r\n# The ip address to bind to, empty will bind to all interfaces\r\n;http_addr =\r\n\r\n# The http port  to use\r\n;http_port = 3000\r\n\r\n# The public facing domain name used to access grafana from a browser\r\ndomain = \u003chostname\u003e.com\r\n\r\n# Redirect to correct domain if host header does not match domain\r\n# Prevents DNS rebinding attacks\r\n;enforce_domain = false\r\n\r\n# The full public facing url you use in browser, used for redirects and emails\r\n# If you use reverse proxy and sub path specify full url (with sub path)\r\nroot_url = %(protocol)s://%(domain)s/grafana/\r\n\r\n# Serve Grafana from subpath specified in `root_url` setting. By default it is set to `false` for compatibility reasons.\r\nserve_from_sub_path = true\r\n```\r\n\r\n**Anything else we need to know?**:  \r\nlogger=previews_service t=2022-07-08T04:32:48.28109841Z level=error msg=\"Crawler auth setup failed\" err=\"role not found\" crawlerAuthSetupTime=1.866039ms\r\n\r\n**Environment**:\r\n- Grafana version: v9.0.2 (0641b5d0c)\r\n- Data source type \u0026 version: MySQL\r\n- OS Grafana is installed on: Kubernetes\r\n- User OS \u0026 Browser: \r\n- Grafana plugins:\r\n- Others: \r\n","labels":["needs more info","area/dashboard/previews"]},{"id":79203,"title":"Excessive memory usage -\u003e grafana crashes","body":"### What happened?\r\n\r\nGrafana allocates too much memory when uses table panels. This leads to out of memory. \r\n\r\n### What did you expect to happen?\r\n\r\nThe table will use the new query instead of either letting the existing one run out or terminating the existing one. Or there is much worse memory management.\r\n\r\n### Did this work before?\r\n\r\nNO\r\n\r\n### How do we reproduce it?\r\n\r\n1. Create Table \r\n2. Use a large number of records\r\n3. Click the refresh button as fast as the browser allows.\r\n\r\n```\r\n{\r\n  \"datasource\": {\r\n    \"type\": \"elasticsearch\",\r\n    \"uid\": \"vASHHiT7z\"\r\n  },\r\n  \"fieldConfig\": {\r\n    \"defaults\": {\r\n      \"custom\": {\r\n        \"align\": \"auto\",\r\n        \"cellOptions\": {\r\n          \"type\": \"auto\"\r\n        },\r\n        \"inspect\": false,\r\n        \"filterable\": true\r\n      },\r\n      \"mappings\": [],\r\n      \"thresholds\": {\r\n        \"mode\": \"absolute\",\r\n        \"steps\": [\r\n          {\r\n            \"color\": \"green\",\r\n            \"value\": null\r\n          },\r\n          {\r\n            \"color\": \"red\",\r\n            \"value\": 80\r\n          }\r\n        ]\r\n      },\r\n      \"color\": {\r\n        \"mode\": \"thresholds\"\r\n      }\r\n    },\r\n    \"overrides\": [\r\n      {\r\n        \"matcher\": {\r\n          \"id\": \"byName\",\r\n          \"options\": \"attack_type\"\r\n        },\r\n        \"properties\": [\r\n          {\r\n            \"id\": \"custom.width\",\r\n            \"value\": 294\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        \"matcher\": {\r\n          \"id\": \"byName\",\r\n          \"options\": \"geoip.city_name\"\r\n        },\r\n        \"properties\": [\r\n          {\r\n            \"id\": \"custom.width\",\r\n            \"value\": 152\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  },\r\n  \"gridPos\": {\r\n    \"h\": 10,\r\n    \"w\": 24,\r\n    \"x\": 0,\r\n    \"y\": 1\r\n  },\r\n  \"id\": 26,\r\n  \"options\": {\r\n    \"showHeader\": true,\r\n    \"cellHeight\": \"sm\",\r\n    \"footer\": {\r\n      \"show\": false,\r\n      \"reducer\": [\r\n        \"sum\"\r\n      ],\r\n      \"countRows\": false,\r\n      \"fields\": \"\"\r\n    },\r\n    \"sortBy\": []\r\n  },\r\n  \"pluginVersion\": \"10.1.2\",\r\n  \"targets\": [\r\n    {\r\n      \"alias\": \"\",\r\n      \"bucketAggs\": [],\r\n      \"datasource\": {\r\n        \"type\": \"elasticsearch\",\r\n        \"uid\": \"vASHHiT7z\"\r\n      },\r\n      \"metrics\": [\r\n        {\r\n          \"id\": \"1\",\r\n          \"settings\": {\r\n            \"limit\": \"5000\"\r\n          },\r\n          \"type\": \"logs\"\r\n        }\r\n      ],\r\n      \"query\": \"host_header: $host_header\",\r\n      \"refId\": \"A\",\r\n      \"timeField\": \"@timestamp\"\r\n    }\r\n  ],\r\n  \"title\": \" \",\r\n  \"transformations\": [\r\n    {\r\n      \"id\": \"filterFieldsByName\",\r\n      \"options\": {\r\n        \"include\": {\r\n          \"names\": [\r\n            \"@timestamp\",\r\n            \"attack_type\",\r\n            \"geoip.city_name\",\r\n            \"geoip.country_name\",\r\n            \"message\",\r\n            \"policy_name\",\r\n            \"request\",\r\n            \"request_status\",\r\n            \"response_code\",\r\n            \"severity_label\",\r\n            \"unit_hostname\",\r\n            \"uri\",\r\n            \"violations\",\r\n            \"vs_name\",\r\n            \"host_header\"\r\n          ]\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": \"organize\",\r\n      \"options\": {\r\n        \"excludeByName\": {},\r\n        \"indexByName\": {\r\n          \"@timestamp\": 0,\r\n          \"attack_type\": 2,\r\n          \"geoip.city_name\": 4,\r\n          \"geoip.country_name\": 5,\r\n          \"host_header\": 1,\r\n          \"message\": 6,\r\n          \"policy_name\": 7,\r\n          \"request\": 8,\r\n          \"request_status\": 3,\r\n          \"response_code\": 9,\r\n          \"severity_label\": 10,\r\n          \"unit_hostname\": 11,\r\n          \"uri\": 12,\r\n          \"violations\": 13,\r\n          \"vs_name\": 14\r\n        },\r\n        \"renameByName\": {}\r\n      }\r\n    }\r\n  ],\r\n  \"type\": \"table\"\r\n}\r\n```\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.2.0 to latest (10.2.2).\r\nOS: Windows 10 Enterprise\r\nBrowser: MS Edge\r\n\r\n\r\n### Grafana platform?\r\n\r\nI don't know\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["datasource/Elasticsearch","area/backend","triage/needs-confirmation"]},{"id":69166,"title":"Support setting dashboard variables from annotations","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\n  - **Set Dashboard and panel** should afaik allow defining variables by modifying **Dashboard URL**\r\n  - **Panel ID** doesn't allow anything to be added, only integer allowed; additions have to be done on **Dashboard URL**\r\n  - **if dashboard referred in the alert has variables, like \"instance\", there is no way to define them without dirty hack like this.**\r\n  \r\n  Configuration:\r\n  ```\r\n  Dashboard URL: asdfqwerty?var-instance={{ $labels.instance }}\r\n  ```\r\n  Results in broken link in alert:\r\n  ```\r\n  https://grafanahost.foo.bar/grafana/d/asdfqwerty%3Fvar-instance=problemhost.foo.bar?orgId=1\u0026viewPanel=1\r\n  ```\r\n\r\n**What did you expect to happen**:\r\n\r\n  - Working link to be generated\r\n  - orgId parameter separator to be \u0026 instead of ?\r\n  - orgId added as last parameter instead of right after **Dashboard URL**, as when **Dashboard URL** is defined, **Panel ID** seems to be mandatory\r\n\r\n  Working link:\r\n  ```\r\n  https://grafanahost.foo.bar/grafana/d/asdfqwerty?var-instance=prooblemhost.foo.bar\u0026viewPanel=1\u0026orgId=1\r\n  ```\r\n \r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\n- Define an alert with Dashboard URL and Panel ID defined\r\n\r\n**Step 2**:\r\n\r\n- have the alert be triggered\r\n\r\n**Step 3**:\r\n\r\n- admire borked link\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\nv9.5.2, v9.5.1, probably other versions\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Anything else to add?\r\n\r\nThere seems to be some oddity with orgId:\r\nIf you take the generated broken link:\r\n```\r\nhttps://grafanahost.foo.bar/grafana/d/asdfqwerty%3Fvar-instance=problemhost.foo.bar?orgId=1\u0026viewPanel=1\r\n```\r\n\r\nAnd fix the separator only for the orgId...\r\n```\r\nhttps://grafanahost.foo.bar/grafana/d/asdfqwerty%3Fvar-instance=problemhost.foo.bar\u0026orgId=1\u0026viewPanel=1\r\n```\r\n\r\n...opening the (still broken) link results in even more orgId with a separator `?` instead of separator `\u0026`:\r\n```\r\nhttps://grafanahost.foo.bar/grafana/d/asdfqwerty%3Fvar-instance=problemhost.foo.bar\u0026orgId=1\u0026viewPanel=1?orgId=1\r\n```\r\n\r\nIt would be nice and convenient in some cases to be able to link to an dashboard only, without being forced to choose a panel as well.\r\n","labels":["type/feature-request","area/alerting","stale"]},{"id":64664,"title":"Grafana 9.4.3 dies silently (on high HDD load?)","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nI updated Grafana to 9.4.3 (from 9.3.8). Everything looks good but from time to time (and at least every night) Grafana is just not working anymore. I think this happens when the HDD load is high.\r\n\r\n**What you expected to happen**:\r\n\r\nGrafana should keep running\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\nI set the loglevel to debug, then started updating my FreeBSD ports. Short time after that Grafana was not running anymore. The last lines in the Logfile are\r\n\r\n```\r\nlogger=alertmanager org=1 t=2023-03-13T07:15:09.327144881+01:00 level=debug component=alertmanager orgID=1 component=dispatcher msg=\"Received alert\" alert=CO2-Alarm[24842ab][active]\r\nlogger=datasources rule_uid=lp_in6Rnk org_id=1 t=2023-03-13T07:15:09.689849835+01:00 level=debug msg=\"Querying for data source via SQL store\" uid=L5jNJVZ7z orgId=1\r\nlogger=ngalert.state.historian rule_uid=TaUBLwd4z org_id=1 t=2023-03-13T07:15:09.991378496+01:00 level=debug msg=\"Done saving alert annotation batch\"\r\nlogger=ngalert.state.historian rule_uid=EtFi3-x4z org_id=1 t=2023-03-13T07:15:10.901337212+01:00 level=debug msg=\"Done saving alert annotation batch\"\r\nlogger=datasources t=2023-03-13T07:15:14.007294232+01:00 level=error msg=\"Failed getting data source\" err=\"database is locked\" uid=cb_4ryF7k id=0 name= orgId=1\r\nlogger=sqlstore.transactions rule_uid=aYormIFVz org_id=1 t=2023-03-13T07:15:14.007424053+01:00 level=info msg=\"Database locked, sleeping then retrying\" error=\"database is locked\" retry=1 code=\"database is locked\"\r\n```\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.3\r\n- Data source type \u0026 version: InfluxDB 1.8\r\n- OS Grafana is installed on: FreeBSD 13.1\r\n- User OS \u0026 Browser: \r\n- Grafana plugins:\r\n- Others:\r\n","labels":["needs more info","area/backend/config","area/backend/db/sqlite"]},{"id":77669,"title":"Not able to add data source as prometheus  ","body":"\u003c!--\r\nPlease only use this template for submitting accessibility issues.\r\n\r\nThis is a new feature area for Grafana that we want to improve. We have long way to go\r\nto really improve accessibility and would like your help to know where to start.\r\n--\u003e\r\n\r\n**Steps to reproduce**:\r\n\r\n**Actual Result**: i am not able to add data source  Prometheus  \r\nit shows error \r\n\r\nthis is the error i am facing \r\n\r\nPost \"http://localhost:31989/api/v1/query\": dial tcp 127.0.0.1:31989: connect: connection refused - There was an error returned querying the Prometheus API\r\n\r\nwhen i add the URL of local docker desktop Prometheus address  http://localhost:31989/\r\ni can able to access the Prometheus by this url . even i tried with 127.0.0.1:3189 but same problem. \r\n![Screenshot (51)](https://github.com/grafana/grafana/assets/72142581/13638317-3d1b-4957-9098-adc37d53cb41)\r\n![Screenshot (50)](https://github.com/grafana/grafana/assets/72142581/753f7e57-b1ff-4e7a-b626-7af37a397483)\r\n\r\n\r\n\r\n**Expected Result**\r\n\r\n**Relevant WCAG Criteria:** [#.#.# WCAG Criterion](link to https://www.w3.org/WAI/WCAG21/quickref/?versions=2.0)\r\n\r\n**Environment**: Docker Desktop \r\n- Grafana version: dont know today i downloaded both grafana and prometheus \r\n- Data source type \u0026 version: Prometheus latest\r\n- User OS \u0026 Browser: Windows 10 pro and chrome \r\n- Others:\r\n","labels":["area/docker","bot/no new info"]},{"id":47322,"title":"Elasticsearch query panel date histogram field should default to datasource's Time field name","body":"Using v8.3.3 (30bb7a93ca) and Elasticsearch 7.10+ datasource.\r\n\r\nWe have a datasource that has `timestamp` as \"Time field name\":\r\n\r\n![image](https://user-images.githubusercontent.com/112638/161759382-ad93b5ac-01b8-4b73-898f-175be8e58730.png)\r\n\r\nWhen creating a new panel, the default time field for `Group by date histogram` is `@timestamp`:\r\n\r\n![image](https://user-images.githubusercontent.com/112638/161759208-72a5dd1b-778c-4679-9014-f20280f6bc32.png)\r\n\r\nI expect it to be `timestamp` instead: it's very confusing to the user as it gives empty results.","labels":["needs more info","datasource/Elasticsearch","area/datasource","bot/no new info"]},{"id":52554,"title":"Go back button in Alerting / View rule doesn't work","body":"1. Go to https://play.grafana.org/d/000000083/influxdb-raw-query-template-var?orgId=1\u0026editPanel=1\u0026tab=alert (InfluxDB Raw Query Template Var / Edit Panel / Alert)\r\n2. Click alert's \"View\" button\r\n3. Press Esc / click \"Go back\" arrow in upper left corner - Grafana will redirect to https://play.grafana.org/alerting/list instead of previous page indicated in `returnTo` argument present in URL\r\n\r\nIssue is present in Grafana 9.0.3 and 8.5.6.","labels":["type/bug","needs more info","area/alerting","prio/low","area/frontend"]},{"id":58798,"title":"XY Chart: X values showing as time in tooltip","body":"I've created an XY chart with data loaded from InfluxDB. The graph looks fine, but when I enable point display and tooltips and hover above a point, I see the x value reported as timestamp, apparently interpreted as milliseconds for a UNIX timestamp. This should be the raw value instead.\r\n\r\nThe Grafana version used is v.9.2.4\r\n\r\n![grafana_xy](https://user-images.githubusercontent.com/55980052/202122333-ca48ff7a-30a5-4ba9-b2a6-156ebf06ae2d.jpg)\r\n","labels":["area/panel/xychart","area/tooltip"]},{"id":70567,"title":"OAuth - Unable to override insecure email lookup in 9.3.16","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\nUpgraded our docker based deployment of Grafana 9.3.14 to 9.3.16 and noticed that I could no longer authenticate.\r\nWe are using the generic OAuth configuration in combination with Azure AD.\r\nI read about the breaking change and added the GF_AUTH_OAUTH_ALLOW_INSECURE_EMAIL_LOOKUP=true environment variable which did not solve the issue.\r\nFurther investigation showed that the setting was not overridden and still set to false when looking at the config settings in the Grafana UI.\r\n\r\n**What did you expect to happen**:\r\n\r\nUpgrade to 9.3.16 and adding the environment variable should have allowed me to authenticate.\r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Upgrade grafana docker image from version 9.3.14 to 9.3.16\r\n\r\n**Step 2**:\r\n\r\n- Add environment variable GF_AUTH_OAUTH_ALLOW_INSECURE_EMAIL_LOOKUP=true\r\n\r\n**Step 3**:\r\n\r\n- Log on to Grafana using Azure AD credentials\r\n\r\n\r\n\n\n### \n# What Grafana version are you using?\n\n\nv9.3.16\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\n_No response_\n\n### Grafana Platform?\n\nKubernetes\n\n### User's OS?\n\n_No response_\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nYes\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\nLooks like https://github.com/grafana/grafana/commit/26b48dbf19a709ac4a1523ce1c5e8e42323aa62a was not backported to the 9.x branch","labels":["needs more info","area/auth/oauth","area/docker"]},{"id":67247,"title":"Grafana Graphs are Flickering on Postgres Data Source ","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\nGraphs are flickering and jumping right to left. \r\n![Sonatusv](https://user-images.githubusercontent.com/115821082/234494272-9516e37d-62de-4445-b74d-7283aed1aba6.gif)\r\n## What happened:\r\nI am exploring the Grafana and installed its open source application using its helm charts repo. However, I encountered some UI issues during the exploration and my testing. I implemented a PoC project where I consume time series data constantly and visualize it on my dashboards. I used the Postgres Data Source to feed my graphs, but soon later I realized that Graphs are flickering. This especially happens when you switch the wifi network and test it on the slower network. In the case of slower network, Graphs are jumping right to left during the rendering phase.  \r\n\r\n## What you expected to happen:\r\nI expected to be smooth visualization no matter how fast and slow the network is. I was expecting graphs to not flicker and pass network. testing. Maybe, not render at all, but rendering with flickering causes bad experience. \r\n\r\n## How to reproduce it (as minimally and precisely as possible):\r\nIt is hard to reproduce quickly, even for me, but the reproduce step would be having dashboards ready and then switching to slow network during the time series data consumption. This should cause to flickering.  \r\n\r\n## Anything else we need to know?:\r\n- Postgres Data Source \r\n- Time Series Graphs \r\n- Real time data consumption\r\n\r\n## Environment:\r\n- Grafana version: V9.2.6\r\n- Data source type \u0026 version: Postgres Data Source \r\n- OS Grafana is installed on: Using Helm Charts installation on Kubernetes  \r\n- User OS \u0026 Browser: Chrome, Mac OS, (M1)\r\n- Grafana plugins: \r\n- Others:\r\n","labels":["stale","area/panel/timeseries","triage/needs-confirmation"]},{"id":88962,"title":"Grafana does not restart after upgrade.","body":"### What happened?\r\n\r\nAfter an upgrade from Grafana 10 to 11 (on Ubuntu 20.04.4), grafana server does not start.\r\n\r\n`sudo -u grafana /usr/share/grafana/bin/grafana server --config /etc/grafana/grafana.ini`\r\n\r\nis working but\r\n\r\n`sudo systemctl restart grafana-server.service `\r\n\r\ndoes not complete.\r\n\r\n```\r\nsudo systemctl status grafana-server.service \r\n○ grafana-server.service - Grafana instance\r\n     Loaded: loaded (/lib/systemd/system/grafana-server.service; enabled; vendor preset: enabled)\r\n     Active: inactive (dead)\r\n       Docs: http://docs.grafana.org\r\n```\r\n\r\nI added debug logs in the ini file but nothing is showing up. I do not use SSH in this configuration, it is proxied by nginx.\r\nIt works well if started via the sudo line above.\r\n\r\nIdeas?\r\n\r\n### What did you expect to happen?\r\n\r\nI expect Grafana to start :)\r\n\r\n### Did this work before?\r\n\r\nYes\r\n\r\n### How do we reproduce it?\r\n\r\n1.\r\n2.\r\n3.\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nNo\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 11\r\nOS: ubuntu 20.04.4\r\nBrowser: all\r\n\r\n\r\n### Grafana platform?\r\n\r\nAPT \r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["needs more info","area/backend"]},{"id":65521,"title":"failed to load dashboard via provisioning","body":"What happened:\r\nI provisioned a grafana instance in k8s with prometheus. Datasources work, and stock dashboards work fine,  I use additional dashboard provider/provisioner to a new Dashboard folder, json dashboard files are empty in grafana.\r\n\r\n```\r\ndashboardProviders:\r\n  dashboardproviders.yaml:\r\n    apiVersion: 1\r\n    providers:\r\n    - name: 'default'\r\n      orgId: 1\r\n      folder: ''\r\n      type: file\r\n      disableDeletion: false\r\n      allowUiUpdates: true\r\n      editable: true\r\n      updateIntervalSeconds: 10\r\n      options:\r\n        path: /var/lib/grafana/dashboards\r\n```\r\n\r\n\r\n[log]\r\nmode = console \r\nlogs:\r\n\r\n```\r\nt=2023-03-29T11:53:45+0000 lvl=eror msg=\"failed to load dashboard from \" logger=provisioning.dashboard type=file name=default file=/var/lib/grafana/dashboards/cluster/Resources_Namespace.json error=EOF\r\nt=2023-03-29T11:53:45+0000 lvl=eror msg=\"failed to load dashboard from \" logger=provisioning.dashboard type=file name=default file=/var/lib/grafana/dashboards/cluster/pod-dashboard.json error=EOF\r\nt=2023-03-29T11:53:45+0000 lvl=eror msg=\"failed to load dashboard from \" logger=provisioning.dashboard type=file name=default file=/var/lib/grafana/dashboards/eslog/TI-Log-event-dashboard.json error=EOF\r\nt=2023-03-29T11:53:45+0000 lvl=eror msg=\"failed to load dashboard from \" logger=provisioning.dashboard type=file name=default file=/var/lib/grafana/dashboards/ti-inf/gpu-dcgm.json error=EOF\r\nt=2023-03-29T11:53:45+0000 lvl=eror msg=\"failed to load dashboard from \" logger=provisioning.dashboard type=file name=default file=/var/lib/grafana/dashboards/cluster/Ceph-Cluster.json error=EOF\r\nt=2023-03-29T11:53:45+0000 lvl=eror msg=\"failed to load dashboard from \" logger=provisioning.dashboard type=file name=default file=/var/lib/grafana/dashboards/cluster/prom-dashboard.json error=EOF\r\nt=2023-03-29T11:53:45+0000 lvl=eror msg=\"failed to load dashboard from \" logger=provisioning.dashboard type=file name=default file=/var/lib/grafana/dashboards/eslog/TI-k8s-log-dashboatd.json error=EOF\r\nt=2023-03-29T11:53:45+0000 lvl=eror msg=\"failed to load dashboard from \" logger=provisioning.dashboard type=file name=default file=/var/lib/grafana/dashboards/ti-inf/Mysql-Tables.json error=EOF\r\n```\r\n\r\nWhat you expected to happen:\r\nauto reload dashboard to grafana ui\r\n\r\nAnything else we need to know?:\r\nUI error : Failed to load home dashboard\r\nEnvironment:\r\n\r\nGrafana version:8.3.3\r\nData source type \u0026 version:sqllite3\r\nOS Grafana is installed on:linux\r\nUser OS \u0026 Browser:Linux + Chrome\r\nGrafana plugins:\r\nOthers:","labels":["area/dashboard","area/provisioning","triage/needs-confirmation"]},{"id":66666,"title":"Panel link not working in collapsed row with repeated panels","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n## What happened:\r\nWe have a dashboard with collapsed rows by default that contain automatically generated panels (repeated by variable). Trying to open any panel (except the first one in a row) by link gives \"Panel not found\" error. However, if the rows are expanded by default everything works fine.\r\n\r\n## What you expected to happen:\r\nOpening a panel link in collapsed row with generated panels displays the required panel.\r\n\r\n## How to reproduce it (as minimally and precisely as possible):\r\n1. Create a row.\r\n2. Create a variable with custom variable type and fill it with few items. For example: test, test1, test2. Enable the \"Include All\" option.\r\n3. Create a new panel, place it inside the created row and in repeat options choose to repeat it by variable that was created in the previous step. Choose 'All' option for this variable.\r\n4. Collapse the row and save the dashboard.\r\n5. Open any panel (except the first one), copy the link and open it in the new tab.\r\n\r\n## Anything else we need to know?:\r\nGif of the error:\r\n![Animation](https://user-images.githubusercontent.com/20677175/232482289-db9f64bc-b839-449e-8938-69ce50bf5409.gif)\r\nGif with expanded row by default, but still with generated panels:\r\n![ezgif-3-f258a7fe84](https://user-images.githubusercontent.com/20677175/232483963-e26c9e2b-beae-464d-8511-217e505e7397.gif)\r\n\r\n## Environment:\r\n- Grafana version: v9.3.6 (978237e7cb)\r\n- Data source type \u0026 version: PostgreSQL\r\n- OS Grafana is installed on: \r\n- User OS \u0026 Browser: Windows, Google Chrome\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/bug","area/dashboard","os/windows","team/grafana-dashboards","prio/future"]},{"id":85709,"title":"inappropriate status code for alerting: invalid relative time range: {From:0s To:0s}","body":"### What happened?\r\n\r\nWhen adding an alert, 500 status code is returned when the time range is set as now to now\r\n![image](https://github.com/grafana/grafana/assets/36128312/eb123098-0e15-46ac-bb7a-d7bc3e49f1ea)\r\n![image](https://github.com/grafana/grafana/assets/36128312/eb43e708-9aaf-420f-aa0c-a34e55bcd1c5)\r\n\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nThis is caused by user error, returning 500 is inappropriate, 400 should be returned instead.\r\n\r\n### Did this work before?\r\n\r\nnot sure\r\n\r\n### How do we reproduce it?\r\n\r\n1.create an alert rule\r\n2.set the time range for the query as now to now\r\n3.click save\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 9.5.17, 10.3.4\r\n\r\n\r\n### Grafana platform?\r\n\r\nNone\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/alerting","wontfix","triage/needs-confirmation"]},{"id":87483,"title":"Alerting: condition precedence order is not expected","body":"\u003c!-- Please only use this template for submitting feature requests --\u003e\r\n\r\n**Why is this needed**:\r\n\r\nWhen computing multiple alert rules in Grafana, the current logic evaluates all rules before determining whether to fire an alert based on their \"and/or\" relationships. For example, given four rules with the relationship:\r\n\r\n- rule1: result `true`, operator `N/A`(first rule don't need an operator)\r\n- rule2: result `true`, operator `and`\r\n- rule3: result `false`, operator `or`\r\n- rule4: result `false`, operator `and`\r\n\r\nthe algorithm computes as follow (excerpt from [pkg/expr/classic/classic.go](https://github.com/grafana/grafana/blob/v11.0.0-preview/pkg/expr/classic/classic.go)):\r\n\r\n```go\r\nfunc (cmd *ConditionsCmd) exec() {\r\n\tfor i, cond := range cmd.Conditions {\r\n\t\tisCondFiring, isCondNoData, condMatches, err := cmd.executeCond(ctx, t, cond, vars)\r\n\t\tif err != nil { return }\r\n\r\n\t\tif i == 0 { // first rule have no operator\r\n\t\t\tisFiring = isCondFiring\r\n\t\t\tisNoData = isCondNoData\r\n\t\t} else {\r\n\t\t\tisFiring = compareWithOperator(isFiring, isCondFiring, cond.Operator)\r\n\t\t\tisNoData = compareWithOperator(isNoData, isCondNoData, cond.Operator)\r\n\t\t}\r\n\r\n\t\tmatches = append(matches, condMatches...)\r\n\t}\r\n}\r\n\r\nfunc compareWithOperator(b1, b2 bool, operator ConditionOperatorType) bool {\r\n\tif operator == \"or\" {\r\n\t\treturn b1 || b2\r\n\t} else {\r\n\t\treturn b1 \u0026\u0026 b2\r\n\t}\r\n}\r\n```\r\n\r\nThis computation yields a result of `false` because:\r\n\r\n- `true AND true` equals to `true`\r\n- `true OR false` equals to `true`\r\n- `true AND false` equals to `false`\r\n\r\nI expected the computation is same as the logical order: `true \u0026\u0026 true || false \u0026\u0026 false`, resulting in `true`.\r\n\r\n```go\r\nfunc True() bool {\r\n\tprint(\"True, \")\r\n\treturn true\r\n}\r\nfunc False() bool {\r\n\tprint(\"False, \")\r\n\treturn false\r\n}\r\n\r\nfunc main()  {\r\n\tprint(True() \u0026\u0026 True() || False() \u0026\u0026 False()) // True, True, true\r\n}\r\n```\r\n\r\n**What would you like to be added**:\r\n\r\nTo enhance the logic flow, we can implement a check to return `true` if we encounter `true` before an `or` operation:\r\n\r\n```go\r\nfor i, cond := range cmd.Conditions {\r\n\tif cond.Operator == \"or\" \u0026\u0026 isFiring {\r\n\t\tbreak\r\n\t}\r\n\t// ...\r\n}\r\n```\r\n\r\nIntroducing a new operator, perhaps named `lowerPrecedenceOr`, could facilitate this enhancement without causing breaking changes.\r\n\r\n**Who is this feature for?**\r\n\r\nThis feature is essential for users implementing Google's *The Site Reliability Workbook* [Multiple Burn Rate Alerts](https://sre.google/workbook/alerting-on-slos/#5-multiple-burn-rate-alerts).\r\nIn production, missing alerts due to the following scenario has highlighted the necessity for improvement:\r\n\r\n- Alert structure:  `{short_term} OR {mid_term} OR {long_term}`\r\n- Example scenario:\r\n  - The `{short_term}` rule was triggered as `{5_minutes} AND {1_hour}`, resulting in `true AND true`.\r\n  - However, the `{mid_term}` rule failed to trigger because of `{30_minutes} AND {6_hours}`, which evaluates to `true AND false`.\r\n  - Similarly, the `{long_term}` rule also failed to trigger because of `{6_hours} AND {72_hours}`, resulting in `false AND false`.\r\n  - Getting the `false` result and the alert didn't fired.\r\n- After the improvement, the alert should be fired.\r\n\r\nImproving this functionality is crucial for ensuring timely and accurate alerting in complex operational environments.\r\n","labels":["type/feature-request","area/alerting","area/expressions","triage/needs-confirmation"]},{"id":80211,"title":"Snapshots: values are connected despite `Connect null values` set to `never`","body":"### What happened?\n\nI have a dashboard from performance tests, with each test separated by a quiet period. The dashboard sets `Connect null values` to `never` and that works as expected, for example here are the results of 6 different tests:\r\n\u003cimg width=\"687\" alt=\"Screenshot 2024-01-09 at 13 00 04\" src=\"https://github.com/grafana/grafana/assets/9566114/90f67125-c6ec-4de8-9c39-d4af1eaff0c2\"\u003e\r\n\r\nHowever, when I export a snapshot of this dashboards, values are connected, making the dashboard much less readable:\r\n\r\n\u003cimg width=\"433\" alt=\"Screenshot 2024-01-09 at 13 02 36\" src=\"https://github.com/grafana/grafana/assets/9566114/9839e4b4-ec06-4a2c-b1c1-922121e76d11\"\u003e\r\n\n\n### What did you expect to happen?\n\nI'd like the snapshot to look just like the dashboard\n\n### Did this work before?\n\nDon't know.\n\n### How do we reproduce it?\n\n1. Create a dashboard with some \"gaps\" (null values)\r\n2. Set `Connect null values` to `never`\r\n3. Publish a snapshot\r\n\r\nA sample snapshot with the issue:\r\nhttps://snapshots.raintank.io/dashboard/snapshot/WVtYt4of7WCUm2Oy114StXUhieI8jLAZ?orgId=2\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: v10.2.2 (161e3cac5075540918e3a39004f2364ad104d5bb)\r\nOS: Linux\r\nBrowser: Chrome/macOS\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nPrometheus","labels":["area/dashboard/snapshot","triage/needs-confirmation"]},{"id":46424,"title":"X-Axis display broken on Brave Browser","body":"Grafana version: 8.4.3\r\n\r\nEven if brave is Chromium + specifics, I didn't expected Brave to behave differently.\r\nthe X axis don't seem to adapt to the size. The legend always step on each others.\r\nChange zoom level, sometimes somewhat work around that issue. but not all the time.\r\n\r\n![Comparison](https://user-images.githubusercontent.com/474302/157713803-2722bfd4-1b5c-4ae9-a5d4-a6c23a83d17f.png)\r\n\r\n![Larger](https://user-images.githubusercontent.com/474302/157714245-8616461b-d07f-4efa-a3a0-a6d8642602be.png)\r\n","labels":["needs more info","area/panel/timeseries"]},{"id":73982,"title":"DOMException: Failed to execute 'removeChild' on 'Node' in Grafana v.9.4.3 on Microsoft Edge","body":"### What happened?\r\n\r\nHi, we have a problem with the display of a State Timeline Chart in Microsoft Edge.\r\n\r\nIf the translation of the website is active, after a short time (chart is already displayed), this error appears:\r\n\r\nDOMException: Failed to execute 'removeChild' on 'Node': The node to be removed is not a child of this node.\r\n\r\nAs a workaround we can disable the translation on the page, then everything seems to work so far.\r\n\r\n### What did you expect to happen?\r\n\r\nI did not expect any error due to translations\r\n\r\n### Did this work before?\r\n\r\nI don't know.\r\n\r\n### How do we reproduce it?\r\n\r\n1. Open Dashboard with State Timeline Chart without any translation\r\n2. Enable Edge Translation to German\r\n3. Refresh Dashboard or load it again and aftzer a short time the error occur\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nyes we see it only in State Timeline Chart. Another Pie Chart works\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: v.9.4.3\r\nOS: Windows 11\r\nBrowser: Microsoft Edge Version 116.0.1938.62\r\n\r\n\r\n### Grafana platform?\r\n\r\nDocker\r\n\r\n### Datasource(s)?\r\n\r\nMySql","labels":["type/bug","area/panel/state-timeline"]},{"id":45744,"title":"8.4.1 Alert list panel - Alert instance label filter doesn't render with grafana variables","body":"**What happened**: Trying to use the new Alert instance label filter in the Alert list panel and it doesn't work with grafana variables\r\n\r\nIn the form: ``` { label = \"$variable\" }```\r\n\r\n**What you expected to happen**: I expected it to render the variable value and filter on the value, it doesn't filter at all.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.1\r\n\r\n","labels":["type/bug","area/panel/alertlist","needs investigation"]},{"id":58690,"title":"error using unix socket connection for postgres metadata database","body":"**What happened**:\r\nAn error is raised when using a postgres instead of the default sqlite database and assigning a unix socket path to `GF_DATABASE_HOST` (e.g. /cloudsql/projectid:region:instance)\r\n\r\n```\r\nFailed to start grafana. error: failed to connect to database: invalid host specifier '/cloudsql/xxx:xxx:xxx': net.SplitHostPort failed for '/cloudsql/xxx:xxx:xxx': address /cloudsql/xxx:xxx:xxx: too many colons in address\r\n```\r\n\r\nThis might not be directly related to grafana but to the pg driver, but since it affects my use of grafana I'd like to raise this here to see if there are workarounds or other options.\r\n\r\n**What you expected to happen**:\r\nTo not split but accept the string and establish a connection to the database.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nAssign a socket path to `GF_DATABASE_HOST` when starting grafana\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.4","labels":["needs more info","area/backend/db","stale"]},{"id":47284,"title":"Time picker: absolute time range highlights the next day","body":"**What happened**:\r\nWhen selecting an absolute time range, the feedback on the UI highlights the end day + 1\r\n\r\n**What you expected to happen**:\r\n\r\nThe background to highlight the selected range\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nhttps://user-images.githubusercontent.com/201163/161592255-8120d5a5-be31-42da-99ab-75121c14cc9a.mov\r\n\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: v8.4.5\r\n- Data source type \u0026 version: n/a\r\n- OS Grafana is installed on: n/a\r\n- User OS \u0026 Browser: OSX / Chrome\r\n- Grafana plugins: n/a\r\n- Others: n/a","labels":["needs more info","area/dashboard/timerange"]},{"id":64659,"title":"Trace to log custom query not working in provisioning file","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nI am configuring the data source in grafana using a provisioning file and everything works except for custom query in the \"trace to log\" section\r\n\r\n**What you expected to happen**:\r\n\r\nthe use custom query should be toggled on and the query populated\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n```\r\ndatasources:\r\n- name: Tempo\r\n  type: tempo\r\n  uid: tempo\r\n  access: proxy\r\n  orgId: 1\r\n  url: http://tempo:3200\r\n  basicAuth: false\r\n  isDefault: false\r\n  editable: true\r\n  jsonData:\r\n    httpMethod: GET\r\n    tracesToLogs:\r\n      datasourceUid: loki\r\n      spanStartTimeShift: '-1h'\r\n      spanEndTimeShift: '+1h'\r\n      filterByTraceID: false\r\n      filterBySpanID: false\r\n      customQuery: true\r\n      query: '{{exporter=\"OTLP\"} | json | line_format \"{{.body}}\" | json | trace_id=\"${__span.traceId}\" | span_id=\"${__span.spanId}\"}'\r\n    serviceMap:\r\n      datasourceUid: prometheus\r\n```\r\n\u003cimg width=\"688\" alt=\"image\" src=\"https://user-images.githubusercontent.com/11771887/224571839-82e4daa8-6fec-4dd7-998a-938879bf4107.png\"\u003e\r\n\r\n**Anything else we need to know?**:\r\n\r\nif i manually toggle it on and enter the query, everything works fine :) but i want to use the provisioning file since I am using docker containers\r\n\r\n**Environment**:\r\n- Grafana version: \r\n\r\nv9.3.3\r\n\r\n\u003cimg width=\"294\" alt=\"image\" src=\"https://user-images.githubusercontent.com/11771887/224571870-c3a55857-0ef9-4d1b-9db9-06479492d2fb.png\"\u003e\r\n\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/docs","area/provisioning","datasource/Loki","datasource/Tempo"]},{"id":57994,"title":"Logs histogram Y-axis values get truncated","body":"notes by @gabor : when displaying a logs-histogram in explore, if a Y-axis number starts with a \"wide\" digit, like `2` or `0.`, it's left-side will get slightly truncated. \r\n\r\n---\r\n\u003c!-- Please keep the structure below, or your issue may be closed. --\u003e\r\n\r\n**Describe the bug**\r\nThe Y-axis values in Loki log browser are truncated.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Launch Chrome\r\n2. Login to Grafana\r\n3. Explore and navigate to Loki log browser\r\n4. Search for logs and when search returns witness that the y-axis values are truncated:\r\n\u003cdetails\u003e\r\n\u003csummary\u003eTruncated Y-axis values\u003c/summary\u003e\r\n\r\n![image](https://user-images.githubusercontent.com/6629646/199258770-809d44da-433f-4d7b-af09-105ef3f95758.png)\r\n\r\n\u003c/details\u003e\r\n\r\n**Expected behavior**\r\nI expected the y-axis values to be clearly visible.\r\n\r\nThe issue is present on both Firefox (105.0) and Chrome (107.0.5304.68)","labels":["type/bug","area/explore","area/logs"]},{"id":60550,"title":"Public Dashboard Error 500 \"plugin.unavailable\"","body":"I use Grafana with Docker installed from Plesk. All data sources use JSON. Using only built-in time history charts and bar charts. The only plugin I use is \"separator\"\r\n\r\nWhen sharing a public dashboard, all charts are broken showing the message \"No Data\"\r\n\r\nIn the dev console, all queries fail with Error 500 and the message \"plugin.unavailable\"\r\n\r\n![image](https://user-images.githubusercontent.com/2366002/208579749-c2eebba5-4cd0-4110-b747-d0a2e1a5531d.png)\r\n","labels":["area/plugins","area/docker","area/public-dashboards","triage/needs-confirmation"]},{"id":46460,"title":"Run grafana with docker without internet. Client.Timeout exceeded while awaiting headers","body":"It seems grafana or some plugins need internet during the start up\r\n\r\n```\r\ngrafana   | Error: ✗ Get \"https://grafana.com/api/plugins/repo/grafana-clock-panel\": context deadline exceeded (Client.Timeout exceeded while awaiting headers)\r\n```","labels":["needs more info","area/plugins","not implemented"]},{"id":63679,"title":"Variables definition page is not updating.  ","body":"On the Variables page, there is a preview of the variable definition.  This is showing a config that I had previously defined, and isn't updating when I change that variable query.  \r\n\r\nHere's what the preview looks like:\r\n\u003cimg width=\"828\" alt=\"Screenshot 2023-02-23 at 11 11 02 AM\" src=\"https://user-images.githubusercontent.com/4067216/220995880-dc38ec52-4de4-4afc-ba88-9611bd8b0d39.png\"\u003e\r\n\r\nHere's what the variable is actually configured as:\r\n\u003cimg width=\"1113\" alt=\"Screenshot 2023-02-23 at 11 11 21 AM\" src=\"https://user-images.githubusercontent.com/4067216/220995903-6ed42c07-7025-4b63-b107-4cc5027bd1f5.png\"\u003e\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.6\r\n- Data source type \u0026 version: CloudWatch 5.0.0\r\n- OS Grafana is installed on: Ubuntu 20.04\r\n- User OS \u0026 Browser: Chrome and Safari\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/dashboard/templating","bot/no new info"]},{"id":59470,"title":"Time Series graph tooltip displays wrong time","body":"**What happened**:\r\nThe tooltip information is not correct  when I hover over data points in the time series graph.\r\nThe time of the tooltip is 8 hours longer than the time on the X-axis. The timezone is CST.\r\n![image](https://user-images.githubusercontent.com/26373043/204495557-d7786a5a-b78c-4eb0-8a7f-2190567c8439.png)\r\n![image](https://user-images.githubusercontent.com/26373043/204495729-e579ef9f-7200-45e0-9128-0d46815fe836.png)\r\n\r\n**What you expected to happen**:\r\nThe time information of the tooltip is consistent with the time on the X axis.\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nQuery data with clickhouse datasource plugin and using  a DateTime column as time field could reproduce it. while query using  a timestamp column as time field it is ok.  The data query from clickhouse is shown as below. It would reproduce if the timestamp filed is datetime string format while timestamp format works normal. \r\n![image](https://user-images.githubusercontent.com/26373043/204501160-c5c153bf-0651-4400-ba4e-400eaf8092d9.png)\r\n\r\n![image](https://user-images.githubusercontent.com/26373043/204497689-9d196ab2-a9c4-479e-a250-5f7b01a90843.png)\r\n\r\n**Environment**:\r\n- Grafana version: v9.2.5\r\n- Data source type \u0026 version: Altinity plugin for ClickHouse \u0026 version 2.5.3\r\n- OS Grafana is installed on:  linux\r\n- User OS \u0026 Browser: mac \u0026 chrome\r\n- Grafana plugins:  Altinity plugin for ClickHouse \r\n","labels":["bot/no new info","area/tooltip"]},{"id":45814,"title":"Geomap Panel - Geohash Doesn't Work","body":"**What happened**:\r\n\r\nWhen I select geohash, I get no result. \r\n\r\n![image](https://user-images.githubusercontent.com/43188411/155425204-76f49cf0-dd18-4c5f-be6b-dbfdf8367ce5.png)\r\n\r\nThis is the raw data:\r\n\r\n![image](https://user-images.githubusercontent.com/43188411/155425269-4a851ff2-379e-4a92-80c5-96c587da2e95.png)\r\n\r\n**What you expected to happen**:\r\n\r\nI expect to see markers on the map.\r\n\r\n**Anything else we need to know?**:\r\n\r\nPOSTGIS Version:\r\n\r\n```\r\nPOSTGIS=\"3.1.2 cbe925d\" [EXTENSION] PGSQL=\"130\" GEOS=\"3.7.1-CAPI-1.11.1 27a5e771\" PROJ=\"Rel. 5.2.0, September 15th, 2018\" LIBXML=\"2.9.4\" LIBJSON=\"0.12.1\" LIBPROTOBUF=\"1.3.1\" WAGYU=\"0.5.0 (Internal)\"\r\n```\r\n\r\nData Type of the column: ```geography(Point, 4326)```\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.1\r\n- OS Grafana is installed on: official docker image, grafana/grafana:latest\r\n- Grafana plugins: GEOMAP\r\n","labels":["type/bug","area/panel/geomap"]},{"id":61186,"title":"Query builder features from angular-version missing in react-version","body":"**What happened**:\r\nAfter an upgrade from Grafana 9.2 to 9.3,2 the query builder in a panel does not show the advanced UI for TimescaleDB queries anymore but only the standard UI for normal Postgresql queries\r\n\r\n**What you expected to happen**:\r\nthe advanced UI for TimescaleDB queries should still be available\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nupgrade from Grafana 9.2 to 9.3,2\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.2\r\n- Data source type \u0026 version: Postgesql 13 + TimescaleDB 2.9.1\r\n- OS Grafana is installed on: Debian 11\r\n- User OS \u0026 Browser: Windows 10, Vivaldi 5.6\r\n- Grafana plugins: none\r\n- Others:\r\n","labels":["datasource/Postgres","type/debt","area/query-editor"]},{"id":63113,"title":"We are not able to see data (Array[0]) while in prometheus query works","body":"Hello Team,\r\nWe are facing one strange issue. We have deployed grafana and prometheus via operator in openshift. For some of the query we don't see data in grafana, while for the same query, we see data in prometheus. \r\n\r\nFor ex query: `sum((seldon_api_executor_client_requests_seconds_summary_count))`\r\nwe see data in prometheus, while nothing in grafana. \r\n```\r\n{\r\n  \"request\": {\r\n    \"url\": \"api/datasources/proxy/1/api/v1/query_range?query=sum(rate(seldon_api_executor_client_requests_seconds_count%7Bnamespace%3D~%22dl-mlopssoftwareevaluation-dev%22%2Cdeployment_name%3D~%22wine-classifier%22%7D%5B10000m%5D))%20by%20(namespace%2Cdeployment_name)\u0026start=1675862580\u0026end=1675884180\u0026step=20\",\r\n    \"method\": \"GET\",\r\n    \"hideFromInspector\": false\r\n  },\r\n  \"response\": {\r\n    \"status\": \"success\",\r\n    \"data\": {\r\n      \"resultType\": \"matrix\",\r\n      \"result\": []\r\n    }\r\n  }\r\n}\r\n```\r\nThese queries are for summary \u0026 histogram type metrics. Can you help here?\r\nWe are using Grafana v7.5.17 with Prometheus as a data source. \r\nMany Thanks ","labels":["datasource/Prometheus","area/panel/data","bot/no new info"]},{"id":89874,"title":"Alerting: Image renderer screenshots cannot be used in custom templates","body":"### What happened?\r\n\r\nUsing a custom alerting notification template for E-mail does not include image renderer screenshots\r\n\r\nExample default template output: \r\n![image](https://github.com/grafana/grafana/assets/92876786/41d86b76-013f-4fe4-b3bf-617f7a663734)\r\n\r\nExample custom template output: \r\n![image](https://github.com/grafana/grafana/assets/92876786/037f4f8c-1767-458d-9fb7-1db7133e3efe)\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nAlert emails include panel screenshots\r\n\r\n### Did this work before?\r\n\r\nNo\r\n\r\n### How do we reproduce it?\r\n\r\n1. Set up image renderer as a separate docker container\r\n2. Create custom alert template\r\n3. Create an alert panel and trigger an alert\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: v10.3.3\r\nOn K8s\r\n\r\n\r\n### Grafana platform?\r\n\r\nKubernetes\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/alerting","area/frontend","triage/needs-confirmation"]},{"id":60544,"title":"Hovering over an annotation causes the graph to disappear (with an error)","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nHovering over an annotation causes the graph to disappear and an error to appear in the top left: u.map is not a function.\r\n\r\n![image](https://user-images.githubusercontent.com/116244/208525853-a1108efb-a9da-49cb-b0c6-491bd51c6b6b.png)\r\n![image](https://user-images.githubusercontent.com/116244/208525900-89910796-b739-4038-8712-2777ab1281dd.png)\r\n\r\n\r\n**What you expected to happen**:\r\n\r\nTooltip should appear, graph should not disappear\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nNot sure. I'm using postgres as a data source.\r\n\r\n**Anything else we need to know?**:\r\n\r\nDashboard is a public dashboard. Annotations do not appear on the public dashboard at all, even with the toggle enabled.\r\nThe private view of it demonstrates the error\r\n\r\n**Environment**:\r\n- Grafana version: `8aac426005cb   grafana/grafana-oss:main`\r\n- Data source type \u0026 version: `postgresql 15`\r\n- OS Grafana is installed on: ubuntu 20.04\r\n- User OS \u0026 Browser: linux mint 20.3, chrome\r\n- Grafana plugins:\r\n- Others:\r\n\r\nAnnotation query:\r\n```\r\nSELECT\r\n  value AS \"time\",\r\n  max(interval) as \"Interval\"\r\nFROM\r\n  interval_metrics\r\nWHERE\r\n  $__timeFilter(time)\r\n  AND metric = 'startTime'\r\nGROUP BY\r\n  1\r\nORDER BY\r\n  1,\r\n  2;\r\n```\r\n![image](https://user-images.githubusercontent.com/116244/208527748-524be113-de1a-4ed2-88ea-f84008b2bc51.png)\r\n\r\n","labels":["area/annotations","team/grafana-dashboards"]},{"id":70301,"title":"Timestamp formatting on Grafana 10.0 is not working anymore","body":"### \r\n# What went wrong?\r\n\r\n\r\nOn bar gauage naming, I was using timestamp with formatting time value with` ${__cell_0:date:DD.MM} `,but on new release 10.0 it returns query itself.\r\n`$__cell_0` instead of `${__cell_0:date:DD.MM}` is working without formatting.\r\n`${__from:date:DD.MM}` is still works but how to format `$__cell_0` ? \r\n\r\n### \r\n# How do we reproduce it?\r\n\r\nOn Bar Gaugae edit section try yo set Display Name to ${__cell_0:date:DD.MM}\r\n![image](https://github.com/grafana/grafana/assets/39090711/bfe58cbb-4148-4543-8080-194aa3ddb9ae)\r\n\r\n\r\nIt looks like this on version 10.0.0\r\n![image](https://github.com/grafana/grafana/assets/39090711/7274c07a-cbc1-4c45-8a98-d5d822dfb0d4)\r\n\r\nBut on previous releases it was \r\n![image](https://github.com/grafana/grafana/assets/39090711/2c2badd0-0291-421a-a562-7562d55e1304)\r\n\r\n\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\nv10.0.0\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\nOn every panel that bar gauge exist \r\n\r\n### Grafana Platform?\r\nDocker\r\n\r\n### User's OS?\r\nraspbian\r\n\r\n### User's Browser?\r\nChrome\r\n\r\n### Is this a Regression?\r\nYes\r\n\r\n### Are Datasources involved?\r\n_No response_\r\n\r\n### Anything else to add?\r\n_No response_","labels":["type/bug","area/dashboard","type/regression","team/grafana-dashboards","prio/planned"]},{"id":58020,"title":"Trace View crashes when using the \"Find\" functionality with TypeError: Cannot read properties of null (reading 'toString')","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: \r\nWhen using the \"Find\" functionality in the Trace pane if you start searching for a word that does exist and then typo or for any reason your input doesn't match some text in the trace the whole pane will crash with this error: \r\n`TypeError: Cannot read properties of null (reading 'toString')`\r\n![GIFrecord_2022-11-01_171203](https://user-images.githubusercontent.com/101663794/199358489-9efed76a-62b8-4a11-b2f1-0df0aa529d7a.gif)\r\n\r\nIn the gif I typed Q to cause the crash, where \"brokerage\" works and \"brokeQ\" crashes, but we've been able to reproduce it essentially any time someone typos.\r\n\r\n**What you expected to happen**:\r\nFind functionality should gracefully fail and stop highlighting previously matching results\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nOpen a trace from the Trace search. Type any character that doesn't exist in the trace. We've found that \"/\" is an almost guaranteed crash.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.2\r\n- Data source type \u0026 version: Tempo v1.5.0 (helm chart 0.24.2)\r\n- OS Grafana is installed on: Linux, deployed with kube-prometheus-stack\r\n- User OS \u0026 Browser: Ubuntu 22.04, Vivaldi, Chrome, Brave, Firefox\r\n- Grafana plugins: \r\n1. Core\r\n2. Chaos Mesh\r\n3. Cloudflare Grafana App\r\n4. Discrete\r\n5. Node Graph API\r\n6. Pie Chart\r\n7. Polystat\r\n8. Scatter\r\n9. StatusMap\r\n10. Synthetic Monitoring\r\n11. Worldmap Panel\r\n\r\n- Others:\r\n","labels":["needs investigation","area/explore","stale","datasource/Tempo"]},{"id":51143,"title":"Loki Dashboard - Table Transformation \"Reduce\" - Calculation \"Last\" error","body":"\u003c!-- Please keep the structure below, or your issue may be closed. --\u003e\r\n\r\n**Describe the bug**\r\nA clear and concise description of what the bug is.\r\n\r\nAfter querying Loki logs, I reached a table with 2 time stamps, and two group of values at these timestamps. I tried to keep the last timestamp, so I use transformation \"Reduce\", and calculation \"Last\".\r\n\r\nMost of the time, the result is correct.\r\nBut sometimes the result becomes \"First\" instead of \"Last\"\r\n\r\nPlease check the attached screen captures for details.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Started Loki (SHA or version)\r\n2. Started Promtail (SHA or version) to tail '...'\r\n3. Query: `{} term`\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n\"Last\" should always be the timestamp later in time.\r\n\r\n**Environment:**\r\n - Infrastructure: [e.g., Kubernetes, bare-metal, laptop]\r\n - Deployment tool: [e.g., helm, jsonnet]\r\nCompany Grafana Cloud\r\n\r\n**Screenshots, Promtail config, or terminal output**\r\nIf applicable, add any output to help explain your problem.\r\n![Loki-dashboard-table-reduce-last-error-1](https://user-images.githubusercontent.com/40083253/174712246-98581573-ecd6-4f54-8276-5c4318129506.png)\r\n![Loki-dashboard-table-reduce-last-error-2](https://user-images.githubusercontent.com/40083253/174712259-7c9a6875-fb80-46b6-88f5-2cc7d86a0197.png)\r\n![Loki-dashboard-table-reduce-last-error-3](https://user-images.githubusercontent.com/40083253/174712268-6bf6e1ff-7066-4f68-ae7a-360db1622b9a.png)\r\n![Loki-dashboard-table-reduce-last-error-4](https://user-images.githubusercontent.com/40083253/174712277-ddb74447-d4ba-49ed-bc07-c5b1ead8c0c4.png)\r\n\r\n","labels":["needs more info","area/transformations"]},{"id":58550,"title":"Provision - error with environment variable interpolation for notification policies","body":"**What happened**:\r\nDuring provision for notifications policies, environment variable interpolation don't seems to work correcly.\r\n\r\n**What you expected to happen**:\r\nFollow the same pattern as others provisions endpoint and interpolate variable.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n```\r\n# cat docker-compose.yml\r\nversion: '2'\r\nservices:\r\n  grafana_tmp:\r\n    image: grafana/grafana-oss:9.2.4\r\n    user: root\r\n    volumes:\r\n      - ./notifications_policies.yml:/etc/grafana/provisioning/alerting/notifications_policies.yml:ro\r\n    environment:\r\n      NOTIFIER_EMAIL_REMINDER_FREQUENCY: 4h\r\n```\r\n\r\n```\r\n# cat notifications_policies.yml\r\napiVersion: 1\r\n\r\npolicies:\r\n  - orgId: 1\r\n    receiver: test\r\n    group_by: [alertname]\r\n    matchers:\r\n      - alertname = test\r\n    group_wait: 30s\r\n    group_interval: 1m\r\n    repeat_interval: ${NOTIFIER_EMAIL_REMINDER_FREQUENCY}\r\n```\r\n\r\n```\r\n# docker-compose up\r\n...\r\ngrafana_tmp_1  | Failed to start grafana. error: failure to parse file notifications_policies.yml: not a valid duration string: \"${NOTIFIER_EMAIL_REMINDER_FREQUENCY}\"\r\ngrafana_tmp_1  | failure to parse file notifications_policies.yml: not a valid duration string: \"${NOTIFIER_EMAIL_REMINDER_FREQUENCY}\"\r\nroot_grafana_tmp_1 exited with code 1\r\n```\r\n\r\n**Anything else we need to know?**:\r\n\r\nNot sure maybe related to this PR https://github.com/grafana/grafana/pull/55666\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.4\r\n- Data source type \u0026 version: None\r\n- OS Grafana is installed on: Docker\r\n- User OS \u0026 Browser: None\r\n- Grafana plugins: None\r\n- Others: None\r\n","labels":["effort/small","prio/medium","area/alerting/notifications","area/provisioning"]},{"id":73588,"title":"Canvas: \"No data\" when trying to visualize metric values from multiple queries","body":"### What happened?\n\nIf you have a query that returns multiple data frames with the same field names, you can't use them in the canvas panel. It will instead show \"No data\". Here is a video that shows the issue:\r\n\r\nhttps://github.com/grafana/grafana/assets/9257800/129b3ac6-d2f5-4fee-a0da-fb1954ce111c\r\n\n\n### What did you expect to happen?\n\nThe canvas panel should be able to display the fields from separate data frames independently.\n\n### Did this work before?\n\nNot as far as I know\n\n### How do we reproduce it?\n\n1. Create a panel with the \"TestData\" data source.\r\n2. Select the \"Raw Frames\" scenario.\r\n3. Input:\r\n```json\r\n[{\r\n\"name\": \"Frame 1\",\r\n\"fields\": [{ \"name\": \"value\", \"values\": [3.14]}]\r\n},\r\n{\r\n  \"name\": \"Frame 2\",\r\n  \"fields\": [{ \"name\": \"value\", \"values\": [2.72]}]\r\n}]\r\n```\r\n4. Select the Canvas visualization, and then try to pick \"Frame 1 value\" as the backing filed of a \"Metric Value\" element.\r\n\r\nWe first ran into this issue with a data source that I'm developing. The issue occurs when trying to use multiple query rows for the same panel. The \"Raw frames\" above are intended to emulate this use case.\r\nI'm open to the possibility that I'm doing something wrong. **Is it incorrect for a data source to return multiple frames with the same field names?**\n\n### Is the bug inside a dashboard panel?\n\n| Key | Value |\r\n|--|--|\r\n| Panel | canvas @ 9.5.8 |\r\n| Grafana | 9.5.8 (4c140fd26e) // Open Source |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"type\": \"canvas\",\r\n      \"title\": \"Reproduced with embedded data\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"targets\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"grafana\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"snapshot\",\r\n          \"snapshot\": [\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"name\": \"Frame 1\",\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"value\",\r\n                    \"type\": \"number\",\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    3.14\r\n                  ]\r\n                ]\r\n              }\r\n            },\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"name\": \"Frame 2\",\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"value\",\r\n                    \"type\": \"number\",\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    2.72\r\n                  ]\r\n                ]\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      \"options\": {\r\n        \"inlineEditing\": true,\r\n        \"showAdvancedTypes\": false,\r\n        \"root\": {\r\n          \"type\": \"frame\",\r\n          \"elements\": [\r\n            {\r\n              \"config\": {\r\n                \"align\": \"center\",\r\n                \"valign\": \"middle\",\r\n                \"color\": {\r\n                  \"fixed\": \"#000000\"\r\n                },\r\n                \"text\": {\r\n                  \"fixed\": \"\",\r\n                  \"field\": \"Frame 2 value\",\r\n                  \"mode\": \"field\"\r\n                },\r\n                \"size\": 20\r\n              },\r\n              \"background\": {\r\n                \"color\": {\r\n                  \"field\": \"Frame 2 value\",\r\n                  \"fixed\": \"#D9D9D9\"\r\n                }\r\n              },\r\n              \"placement\": {\r\n                \"top\": 100,\r\n                \"height\": 50,\r\n                \"left\": 100,\r\n                \"width\": 260\r\n              },\r\n              \"type\": \"metric-value\",\r\n              \"name\": \"Element 1\",\r\n              \"constraint\": {\r\n                \"vertical\": \"top\",\r\n                \"horizontal\": \"left\"\r\n              },\r\n              \"border\": {\r\n                \"color\": {\r\n                  \"fixed\": \"dark-green\"\r\n                }\r\n              }\r\n            },\r\n            {\r\n              \"config\": {\r\n                \"align\": \"center\",\r\n                \"valign\": \"middle\",\r\n                \"color\": {\r\n                  \"fixed\": \"#000000\"\r\n                },\r\n                \"text\": {\r\n                  \"fixed\": \"\",\r\n                  \"field\": \"Frame 1 value\",\r\n                  \"mode\": \"field\"\r\n                },\r\n                \"size\": 20\r\n              },\r\n              \"background\": {\r\n                \"color\": {\r\n                  \"field\": \"Frame 1 value\",\r\n                  \"fixed\": \"#D9D9D9\"\r\n                }\r\n              },\r\n              \"placement\": {\r\n                \"top\": 100,\r\n                \"height\": 50,\r\n                \"left\": 100,\r\n                \"width\": 260\r\n              },\r\n              \"type\": \"metric-value\",\r\n              \"constraint\": {\r\n                \"vertical\": \"top\",\r\n                \"horizontal\": \"left\"\r\n              },\r\n              \"border\": {\r\n                \"color\": {\r\n                  \"fixed\": \"dark-green\"\r\n                }\r\n              },\r\n              \"name\": \"Element 2\"\r\n            }\r\n          ],\r\n          \"background\": {\r\n            \"color\": {\r\n              \"fixed\": \"transparent\"\r\n            }\r\n          },\r\n          \"border\": {\r\n            \"color\": {\r\n              \"fixed\": \"dark-green\"\r\n            }\r\n          },\r\n          \"name\": \"Element 1692662936655\"\r\n        }\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"value\": null,\r\n                \"color\": \"green\"\r\n              },\r\n              {\r\n                \"value\": 80,\r\n                \"color\": \"red\"\r\n              }\r\n            ]\r\n          },\r\n          \"color\": {\r\n            \"mode\": \"thresholds\"\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"pluginVersion\": \"9.5.8\"\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003ecanvas @ 9.5.8\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003eA[testdata]\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003e 2 frames, 2 fields, 2 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e9.5.8 (4c140fd26e) // Open Source\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"title\": \"Original Panel JSON\",\r\n      \"type\": \"text\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 7\r\n      },\r\n      \"options\": {\r\n        \"content\": \"{\\n  \\\"datasource\\\": {\\n    \\\"uid\\\": \\\"f84d64ff-fde3-418a-b8da-e75c59a86462\\\",\\n    \\\"type\\\": \\\"testdata\\\"\\n  },\\n  \\\"type\\\": \\\"canvas\\\",\\n  \\\"title\\\": \\\"Panel Title\\\",\\n  \\\"gridPos\\\": {\\n    \\\"x\\\": 0,\\n    \\\"y\\\": 0,\\n    \\\"w\\\": 12,\\n    \\\"h\\\": 8\\n  },\\n  \\\"id\\\": 123124,\\n  \\\"targets\\\": [\\n    {\\n      \\\"scenarioId\\\": \\\"raw_frame\\\",\\n      \\\"refId\\\": \\\"A\\\",\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"testdata\\\",\\n        \\\"uid\\\": \\\"f84d64ff-fde3-418a-b8da-e75c59a86462\\\"\\n      },\\n      \\\"alias\\\": \\\"\\\",\\n      \\\"rawFrameContent\\\": \\\"[{\\\\n  \\\\\\\"name\\\\\\\": \\\\\\\"Frame 1\\\\\\\",\\\\n  \\\\\\\"fields\\\\\\\": [{ \\\\\\\"name\\\\\\\": \\\\\\\"value\\\\\\\", \\\\\\\"values\\\\\\\": [3.14]}]\\\\n},\\\\n{\\\\n  \\\\\\\"name\\\\\\\": \\\\\\\"Frame 2\\\\\\\",\\\\n  \\\\\\\"fields\\\\\\\": [{ \\\\\\\"name\\\\\\\": \\\\\\\"value\\\\\\\", \\\\\\\"values\\\\\\\": [2.72]}]\\\\n}]\\\"\\n    }\\n  ],\\n  \\\"options\\\": {\\n    \\\"inlineEditing\\\": true,\\n    \\\"showAdvancedTypes\\\": false,\\n    \\\"root\\\": {\\n      \\\"type\\\": \\\"frame\\\",\\n      \\\"elements\\\": [\\n        {\\n          \\\"config\\\": {\\n            \\\"align\\\": \\\"center\\\",\\n            \\\"valign\\\": \\\"middle\\\",\\n            \\\"color\\\": {\\n              \\\"fixed\\\": \\\"#000000\\\"\\n            },\\n            \\\"text\\\": {\\n              \\\"fixed\\\": \\\"\\\",\\n              \\\"field\\\": \\\"Frame 2 value\\\",\\n              \\\"mode\\\": \\\"field\\\"\\n            },\\n            \\\"size\\\": 20\\n          },\\n          \\\"background\\\": {\\n            \\\"color\\\": {\\n              \\\"field\\\": \\\"Frame 2 value\\\",\\n              \\\"fixed\\\": \\\"#D9D9D9\\\"\\n            }\\n          },\\n          \\\"placement\\\": {\\n            \\\"top\\\": 100,\\n            \\\"height\\\": 50,\\n            \\\"left\\\": 100,\\n            \\\"width\\\": 260\\n          },\\n          \\\"type\\\": \\\"metric-value\\\",\\n          \\\"name\\\": \\\"Element 1\\\",\\n          \\\"constraint\\\": {\\n            \\\"vertical\\\": \\\"top\\\",\\n            \\\"horizontal\\\": \\\"left\\\"\\n          },\\n          \\\"border\\\": {\\n            \\\"color\\\": {\\n              \\\"fixed\\\": \\\"dark-green\\\"\\n            }\\n          }\\n        },\\n        {\\n          \\\"config\\\": {\\n            \\\"align\\\": \\\"center\\\",\\n            \\\"valign\\\": \\\"middle\\\",\\n            \\\"color\\\": {\\n              \\\"fixed\\\": \\\"#000000\\\"\\n            },\\n            \\\"text\\\": {\\n              \\\"fixed\\\": \\\"\\\",\\n              \\\"field\\\": \\\"Frame 1 value\\\",\\n              \\\"mode\\\": \\\"field\\\"\\n            },\\n            \\\"size\\\": 20\\n          },\\n          \\\"background\\\": {\\n            \\\"color\\\": {\\n              \\\"field\\\": \\\"Frame 1 value\\\",\\n              \\\"fixed\\\": \\\"#D9D9D9\\\"\\n            }\\n          },\\n          \\\"placement\\\": {\\n            \\\"top\\\": 100,\\n            \\\"height\\\": 50,\\n            \\\"left\\\": 100,\\n            \\\"width\\\": 260\\n          },\\n          \\\"type\\\": \\\"metric-value\\\",\\n          \\\"constraint\\\": {\\n            \\\"vertical\\\": \\\"top\\\",\\n            \\\"horizontal\\\": \\\"left\\\"\\n          },\\n          \\\"border\\\": {\\n            \\\"color\\\": {\\n              \\\"fixed\\\": \\\"dark-green\\\"\\n            }\\n          },\\n          \\\"name\\\": \\\"Element 2\\\"\\n        }\\n      ],\\n      \\\"background\\\": {\\n        \\\"color\\\": {\\n          \\\"fixed\\\": \\\"transparent\\\"\\n        }\\n      },\\n      \\\"border\\\": {\\n        \\\"color\\\": {\\n          \\\"fixed\\\": \\\"dark-green\\\"\\n        }\\n      },\\n      \\\"name\\\": \\\"Element 1692662936655\\\"\\n    }\\n  },\\n  \\\"fieldConfig\\\": {\\n    \\\"defaults\\\": {\\n      \\\"mappings\\\": [],\\n      \\\"thresholds\\\": {\\n        \\\"mode\\\": \\\"absolute\\\",\\n        \\\"steps\\\": [\\n          {\\n            \\\"value\\\": null,\\n            \\\"color\\\": \\\"green\\\"\\n          },\\n          {\\n            \\\"value\\\": 80,\\n            \\\"color\\\": \\\"red\\\"\\n          }\\n        ]\\n      },\\n      \\\"color\\\": {\\n        \\\"mode\\\": \\\"thresholds\\\"\\n      }\\n    },\\n    \\\"overrides\\\": []\\n  },\\n  \\\"pluginVersion\\\": \\\"9.5.8\\\"\\n}\",\r\n        \"mode\": \"code\",\r\n        \"code\": {\r\n          \"language\": \"json\",\r\n          \"showLineNumbers\": true,\r\n          \"showMiniMap\": true\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: Panel Title // 2023-08-21 19:15:41\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-canvas\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"2023-08-21T18:15:41.385Z\",\r\n    \"to\": \"2023-08-22T00:15:41.385Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\n\n### Environment (with versions)?\n\nGrafana: 9.5.8\r\nOS: MacOS\r\nBrowser: Chromium\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\n_No response_","labels":["area/panel/canvas","triage/needs-confirmation"]},{"id":66203,"title":"Resolved Notifications stacking up","body":"**What happened**:\r\nIn some cases I continuously get alerts from different machines. For example, I have an OpenVAS scanning all existing servers. This will pump up the CPU load on most machines to 100% for a few dozens of minutes. As it should this triggers alerts in Grafana. These alerts are being resolved after a couple of minutes. However, the problem is that the list of resolved alerts is not being cleared as long as some machines are still firing alerts. The result is that the list of resolved messages increases over time. After 24h I get messages like \"[FIRING:3, RESOLVED:36]\". This itself would not really be an issue, but the list is really long and most messengers cannot cope with multiple messages after each other with each message filling dozens of screens. Specifically Element and Rocket.Chat basically become unusable.\r\n\r\n**What you expected to happen**:\r\nResolved Notifications should either not stack until the last alert is resolved, or time out after some time (for example with a setting).\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Create a panel with an alert and different time series differentiated by tags.\r\n2. Let one series trigger an alert\r\n3. Let a second series trigger the alert as well which overlaps the first one\r\n4. The resolved message of the first alert will continue to appear until the second alert is also resolved\r\n\r\n**Anything else we need to know?**:\r\nThis behavior was different until a few months ago. Back then, the resolved message appeared only once.\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.7\r\n- Data source type \u0026 version: InfluxDB 1.8.10\r\n- OS Grafana is installed on: Debian Bullseye\r\n- User OS \u0026 Browser: All\r\n- Grafana plugins: None\r\n- Others: None\r\n","labels":["area/alerting","triage/needs-confirmation"]},{"id":74999,"title":"Docker: Official image is based on EOL Ubuntu 20.10","body":"### What happened?\n\nUbuntu kinetic (20.10) is no longer maintained, and even running apt-get update fails on it.\r\n\r\nI couldn't find the source Dockerfile for the official image, but it is based on 20.10.\n\n### What did you expect to happen?\n\nIt should be upgraded to 22.04 ASAP.\n\n### Did this work before?\n\nYes.\n\n### How do we reproduce it?\n\n1.\r\n2.\r\n3.\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.1.1-ubuntu\r\nOS: Docker\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\n_No response_","labels":["type/build-packaging","area/docker","triage/needs-confirmation"]},{"id":69661,"title":"Text Panel: HTML Details tag doesn't show expander","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n  - HTML Details tag is not displayed property by the Text panel visualization. You can see the expander is not displayed:\r\n  \r\n![image](https://github.com/grafana/grafana/assets/10158691/9ef6fbde-000f-4454-b392-96c952b25b71)\r\n\r\n\r\n**What did you expect to happen**:\r\n\r\n  - Here is the same html displayed in [W3Schools example](https://www.w3schools.com/TAGS/tryit.asp?filename=tryhtml5_details):\r\n![image](https://github.com/grafana/grafana/assets/10158691/7198cb55-8509-4a59-b95d-f54e53025be7)\r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Open Grafana and add a text panel to a dashboard.\r\n\r\n**Step 2**:\r\n\r\n- Select the HTML  and paste the follow HTML\r\n```\r\n\u003cdetails\u003e\r\n     \u003csummary\u003eEpcot Center\u003c/summary\u003e\r\n     \u003cp\u003eEpcot is a theme park at Walt Disney World Resort featuring exciting attractions, international pavilions, award-winning \r\n      fireworks and seasonal special events.\u003c/p\u003e\r\n\u003c/details\u003e\r\n```\r\n**Step 3**:\r\n\r\n- Click Apply.\r\n\n\n### \n# What Grafana version are you using?\n\n\nv9.4.12\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nOther\n\n### User's OS?\n\nWindows\n\n### User's Browser?\n\nMicrosoft Edge for Business Version 114.0.1823.37 (Official build) (64-bit)\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["type/bug","area/panel/text"]},{"id":84042,"title":"Dashboards: Visiting /dashboards itself causes \"Page error\"","body":"### What happened?\n\n`/dashboards` DashboardListPage returns error: \"Page error\", \"An unexpected error happened\", \"InternalError: too much recursion\"\r\n\r\n```\r\nEt@https://example.com/graph/public/build/DashboardListPage.d27b4433a05dc7d252e6.js:15:7222\r\ndiv\r\nb@https://example.com/graph/public/build/3644.93bade7d48e3d75173f7.js:454:100807\r\ndiv\r\ndiv\r\nd@https://example.com/graph/public/build/5017.830b14490d17e9cbdabb.js:357:17354\r\ndiv\r\ndiv\r\ndiv\r\ndiv\r\nfe@https://example.com/graph/public/build/3644.93bade7d48e3d75173f7.js:299:4635\r\nu@https://example.com/graph/public/build/5017.830b14490d17e9cbdabb.js:194:29815\r\ndiv\r\nL@https://example.com/graph/public/build/5017.830b14490d17e9cbdabb.js:357:21098\r\n32538/We\u003c@https://example.com/graph/public/build/DashboardListPage.d27b4433a05dc7d252e6.js:15:13119\r\nSuspense\r\nr@https://example.com/graph/public/build/5017.830b14490d17e9cbdabb.js:194:122062\r\nRu@https://example.com/graph/public/build/5017.830b14490d17e9cbdabb.js:5705:9531\r\nI@https://example.com/graph/public/build/3644.93bade7d48e3d75173f7.js:444:29242\r\ndi@https://example.com/graph/public/build/3644.93bade7d48e3d75173f7.js:435:4481\r\nni@https://example.com/graph/public/build/3644.93bade7d48e3d75173f7.js:435:12022\r\nht@https://example.com/graph/public/build/3644.93bade7d48e3d75173f7.js:444:17401\r\nI@https://example.com/graph/public/build/3644.93bade7d48e3d75173f7.js:444:31410\r\ndiv\r\ndiv\r\nmain\r\ndiv\r\nXf@https://example.com/graph/public/build/5017.830b14490d17e9cbdabb.js:5705:2385\r\ndi@https://example.com/graph/public/build/3644.93bade7d48e3d75173f7.js:435:4481\r\nni@https://example.com/graph/public/build/3644.93bade7d48e3d75173f7.js:435:12022\r\ncr@https://example.com/graph/public/build/3644.93bade7d48e3d75173f7.js:435:11439\r\nHn@https://example.com/graph/public/build/3644.93bade7d48e3d75173f7.js:444:17692\r\nI@https://example.com/graph/public/build/3644.93bade7d48e3d75173f7.js:444:25474\r\ndiv\r\no@https://example.com/graph/public/build/5017.830b14490d17e9cbdabb.js:214:13882\r\nh@https://example.com/graph/public/build/3644.93bade7d48e3d75173f7.js:136:9122\r\nf@https://example.com/graph/public/build/3644.93bade7d48e3d75173f7.js:773:96558\r\nd@https://example.com/graph/public/build/5017.830b14490d17e9cbdabb.js:499:21142\r\nr@https://example.com/graph/public/build/5017.830b14490d17e9cbdabb.js:194:122062\r\ng@https://example.com/graph/public/build/5017.830b14490d17e9cbdabb.js:194:122571\r\nit@https://example.com/graph/public/build/3644.93bade7d48e3d75173f7.js:416:521\r\nmg@https://example.com/graph/public/build/5017.830b14490d17e9cbdabb.js:5716:122\r\n```\n\n### What did you expect to happen?\n\nExpected the list of available dashboards to be displayed\r\n\n\n### Did this work before?\n\nThis worked as of version 10.2.3.  10.3.1 and 10.4.0 both fail.\r\n\n\n### How do we reproduce it?\n\n- Visit grafana 10.4.0 instance at `example.com/graph/`\r\n- The welcome screen correctly renders including the list of recently viewed dashboards\r\n- Click hamburger menu\r\n- Choose \"Dashboards\"\r\n- Page URL changes to`example.com/graph/dashboards`\r\n- Error: \"Page error\", \"An unexpected error happened\"\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.4.0\r\nOS: ArchLinux\r\nBrowser: Firefox\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\n_No response_","labels":["type/bug","area/dashboard","team/grafana-dashboards"]},{"id":63026,"title":"Grafana 9 API not working properly","body":"**What happened**:\r\nAlerts created using the API not showing up in Grafana. Contact points configured through the API not working.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\ncurl to api/alert-notifications posting a new alert notification, no errors reported. That new notification channel won't show up in alerting/notifications but does show up in api/alert-notifications/lookup.\r\n\r\nSame with alerts: curl to api/v1/provisioning/alert-rules posting a new alert rule. Won't show up in alerting/list but it will in api/v1/provisioning/alert-rules/\u003calertUID\u003e and alerts will be sent through email (after manually configuring an alert notification channel).\r\n\r\n**Environment**:\r\n- Grafana version: 9\r\n- User OS \u0026 Browser: Windows, Chrome\r\n","labels":["needs more info","area/backend/api"]},{"id":54887,"title":"Transformations randomly don't work properly","body":"**What happened**:\r\nI am using Stat Panel, with two queries, A and B.\r\nIn transformation tab I use “Binary operation” B / A.\r\nTransformations are randomly not working, showing NaN as value, mostly when I select time period “Last X hours / Last X days”.\r\n\r\n**Anything else we need to know?**:\r\nWhen this occurs, in debug window is visible that there is one empty value in values buffer which are used in Binary operation.\r\n\r\n**Environment**:\r\n- Grafana version: 9.1.1\r\n- Data source type \u0026 version: InfluxDB 1.8.3\r\n- OS Grafana is installed on: Ubuntu 22.04\r\n- User OS \u0026 Browser: Chrome / Win 10\r\n- Grafana plugins:\r\n- Others:\r\n\r\n![image](https://user-images.githubusercontent.com/9357440/189094127-a19cbb30-272c-43f0-ab9e-f0b2e84048b5.png)\r\n\r\n![image](https://user-images.githubusercontent.com/9357440/189094172-cfa0937d-1768-4036-93a0-1650c2e909fd.png)\r\n\r\n![image](https://user-images.githubusercontent.com/9357440/189094195-2dd8545f-c446-4454-acb1-a8f31b937c6a.png)\r\n\r\n","labels":["type/bug","prio/medium","area/transformations"]},{"id":58797,"title":"Private plugin signing fails with grafana docker image","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWe have followed the document with respect to signing a private plugin however getting the below error when running the application\r\n```\r\ngrafana t=2022-11-16T03:53:09+0000 lvl=warn msg=\"Could not find root URL that matches running application URL\" logger=plugins plugin=controlrooms-export-report appUrl=http://localhost:8080/grafana/ rootU\r\nrls=\"[http://localhost:8080/grafana/ http://localhost:8080/]\"                                                                                                                                              \r\ngrafana t=2022-11-16T03:53:09+0000 lvl=warn msg=\"Could not find root URL that matches running application URL\" logger=plugins plugin=controlrooms-status-history appUrl=http://localhost:8080/grafana/ root\r\nUrls=\"[http://localhost:8080/grafana/ http://localhost:8080/]\"                                                                                                                                             \r\ngrafana t=2022-11-16T03:53:09+0000 lvl=warn msg=\"Some plugin scanning errors were found\" logger=plugins errors=\"plugin 'controlrooms-export-report' has an invalid signature, plugin 'plugin-name' has an invalid signature\"\r\n```\r\n\r\nThe signing works if the rootUrl is set to `http://localhost:3000/` while signing as well as in grafana config\r\n\r\n\r\n**What you expected to happen**:\r\nThe signing to work\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n```\r\ndocker run -it -e GF_SERVER_ROOT_URL=http://localhost:3000/grafana -p 127.0.0.1:3000:3000 mygrafana:v8.1.1\r\n```\r\n\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**: k8s\r\n- Grafana version:8.1.1\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on: linux\r\n- User OS \u0026 Browser: linux - chrome\r\n- Grafana plugins: 2 private plugins\r\n- Others:\r\n","labels":["area/plugins","bot/no new info"]},{"id":88960,"title":"Theme: Theme switching not updating without refresh","body":"### What happened?\n\nWhen navigating from a dark-themed dashboard to a light-themed dashboard (or vice versa) using a link with `\u0026theme=light` or `\u0026theme=dark` in the URL, the theme does not update as expected. Instead, the page retains the current theme (either dark or light). The new theme only applies if the link is manually opened. As already said, the theme is specified in the URL, and the link is placed inside a dashboard, for example, in a text panel.\n\n### What did you expect to happen?\n\nI expected the dashboard theme to switch automatically based on the theme parameter in the URL without to manually open the page. It seems that when clicking on a link the page is not fully reloaded, and the theme is disregarded when updating the content, which is why I consider this a bug.\n\n### Did this work before?\n\nI don't know.\n\n### How do we reproduce it?\n\n1. Create two dashboards.\r\n2. In the first, add a link the the second dashboard using '\u0026theme=light' or '\u0026theme=dark', for example, in a text panel.\r\n3. Click the link.\n\n### Is the bug inside a dashboard panel?\n\nYes, but it does not appear to be necessary to provide a specific dashboard to illustrate the issue.\n\n### Environment (with versions)?\n\nGrafana: v10.0.1\r\nOS: Windows 10 and Linux\r\nBrowser: Chrome v127.0.6523.4\r\n\n\n### Grafana platform?\n\nA downloaded binary\n\n### Datasource(s)?\n\nnone","labels":["type/feature-request","needs more info","area/ui/theme","area/dashboard/data-links"]},{"id":86908,"title":"Table column auto width not working any more","body":"### What happened?\r\n\r\nAuto width is not working any more. All columns have equal width.\r\n![grafik](https://github.com/grafana/grafana/assets/5060247/f54ae14a-6a83-484c-8b83-113a001dd04d)\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nMiddle column should be a lot smaller.\r\n\r\n### Did this work before?\r\n\r\n7.2.1\r\n\r\n### How do we reproduce it?\r\n\r\nCreate a table and set width to auto. Add any data to it. The table's columns will all be equal width.\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n```json\r\n{\r\n  \"type\": \"table\",\r\n  \"title\": \"Panel Title\",\r\n  \"gridPos\": {\r\n    \"x\": 0,\r\n    \"y\": 0,\r\n    \"w\": 6,\r\n    \"h\": 7\r\n  },\r\n  \"datasource\": {\r\n    \"uid\": \"grafana\",\r\n    \"type\": \"datasource\"\r\n  },\r\n  \"id\": 1,\r\n  \"targets\": [\r\n    {\r\n      \"queryType\": \"randomWalk\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"refId\": \"A\"\r\n    }\r\n  ],\r\n  \"options\": {\r\n    \"showHeader\": true,\r\n    \"cellHeight\": \"sm\",\r\n    \"footer\": {\r\n      \"show\": false,\r\n      \"reducer\": [\r\n        \"sum\"\r\n      ],\r\n      \"countRows\": false,\r\n      \"fields\": \"\"\r\n    }\r\n  },\r\n  \"transformations\": [\r\n    {\r\n      \"id\": \"calculateField\",\r\n      \"options\": {\r\n        \"mode\": \"reduceRow\",\r\n        \"reduce\": {\r\n          \"reducer\": \"allValues\",\r\n          \"include\": [\r\n            \"time\",\r\n            \"A-series\"\r\n          ]\r\n        }\r\n      }\r\n    }\r\n  ],\r\n  \"fieldConfig\": {\r\n    \"defaults\": {\r\n      \"custom\": {\r\n        \"align\": \"auto\",\r\n        \"cellOptions\": {\r\n          \"type\": \"auto\"\r\n        },\r\n        \"inspect\": false\r\n      },\r\n      \"mappings\": [],\r\n      \"thresholds\": {\r\n        \"mode\": \"absolute\",\r\n        \"steps\": [\r\n          {\r\n            \"value\": null,\r\n            \"color\": \"green\"\r\n          },\r\n          {\r\n            \"value\": 80,\r\n            \"color\": \"red\"\r\n          }\r\n        ]\r\n      },\r\n      \"color\": {\r\n        \"mode\": \"thresholds\"\r\n      }\r\n    },\r\n    \"overrides\": []\r\n  },\r\n  \"maxDataPoints\": null,\r\n  \"pluginVersion\": \"10.4.1\"\r\n}\r\n```\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.4.1\r\n\r\n### Grafana platform?\r\n\r\nKubernetes\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/panel/table"]},{"id":61881,"title":"PanelEdit: Units: `scaledUnits` fn does not handle `undefined` data type","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nA plugin (ImageIt) passes `undefined` to the value formatter. The value formatter function does not handle this value gracefully and leads to an error: `TypeError: Cannot read properties of undefined (reading 'toLocaleString')`\r\n\r\n**What you expected to happen**:\r\n\r\nundefined data should output either an empty string or pass through unchanged and output `undefined`.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nNo need. It's clear from the code that the value of `undefined` leads to a javascript error. Here's the current code crashing at\r\nhttps://github.com/grafana/grafana/blob/4f2d30b1533f3965cc62ed3a23c3d0409a37c475/packages/grafana-data/src/valueFormats/valueFormats.ts#L144\r\n```\r\nexport function scaledUnits(factor: number, extArray: string[], offset = 0): ValueFormatter {\r\n  return (size: number, decimals?: DecimalCount) =\u003e {\r\n    if (size === null) {\r\n      return { text: '' };\r\n    }\r\n\r\n    if (size === Number.NEGATIVE_INFINITY || size === Number.POSITIVE_INFINITY || isNaN(size)) {\r\n      return { text: size.toLocaleString() };\r\n    }\r\n\r\n    const siIndex = size === 0 ? 0 : Math.floor(logb(factor, Math.abs(size)));\r\n    const suffix = extArray[clamp(offset + siIndex, 0, extArray.length - 1)];\r\n\r\n    return {\r\n      text: toFixed(size / factor ** clamp(siIndex, -offset, extArray.length - offset - 1), decimals),\r\n      suffix,\r\n    };\r\n  };\r\n}\r\n```\r\nPass in `undefined` as the value of the parameter `size`. `isNaN(undefined)` is `true`. Go inside the `if` statement. `undefined.toLocaleString()` will crash on line 144.\r\n\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: latest\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on: Ubuntu Linux\r\n- User OS \u0026 Browser: OSX\r\n- Grafana plugins: ImageIt\r\n- Others:\r\n","labels":["type/bug","area/units","area/panel/edit"]},{"id":47734,"title":"Datasource proxy headers broken since version 8.3","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nHTTP Headers are not being passed to the datasource since version 8.3.0\r\n\r\n**What you expected to happen**:\r\nHTTP Headers to be passed to the datasource\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nSetup grafana 8.3.0 or higher behind a reverse proxy that injects some headers (or set dataproxy.send_user_header = true in config). Add a datasource and dump headers. Observe missing headers. Downgrade to 8.2.7 and headers appear again.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.0 =\u003c\r\n- Data source type \u0026 version: Prometheus 2.32.1\r\n- OS Grafana is installed on: Docker\r\n- User OS \u0026 Browser: macOS \u0026 Safari\r\n- Grafana plugins: none\r\n\r\n\r\n\nhttps://github.com/grafana/grafana/issues/47734#tasklist-block-efb3e408-f8db-4b00-bd97-4e26bb10a91d\n","labels":["type/bug","area/plugins","area/backend/plugins","area/backend"]},{"id":66265,"title":"Env provider in ldap.toml is not working","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nEnabled env provider in ldap.toml to replace the plain text password as below:\r\n`bind_password = '$__env{obs_ldap_password}'`.\r\n\r\nIn log file, it complained \"LDAP Result code 1\"\r\n\r\nHowever, login failed. Once I changed back to plaintext, the login passed.\r\n\r\n**What you expected to happen**: Env provider is working.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Save the password in environment variable, in my case, I tried echo $obs_ldap_password=\u003cpassword\u003e and the predefined environment variable in .bash_profile\r\n2. In ldap.toml, turn on env provider as \"bind_password = '$__env{obs_ldap_password}'\"\r\n3. Restart service\r\n4. Try to login\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.7\r\n- Data source type \u0026 version: N/A\r\n- OS Grafana is installed on: RHEL 8.7\r\n- User OS \u0026 Browser: Browser\r\n- Grafana plugins: N/A\r\n- Others:\r\n","labels":["area/auth/ldap","triage/needs-confirmation"]},{"id":77544,"title":"System Resources: High CPU/Memory usage after 10.2.0 upgrade","body":"### What happened?\n\nI upgraded my cluster from `10.1.5` to `10.2.0` a few hours ago. Right after the upgrade, the CPU and Memory usage spiked and have been the same ever since.\r\n\r\n![Snap-20231102-110632@2x](https://github.com/grafana/grafana/assets/103454930/250145f0-8be4-4a1f-9b99-a84a8583de6a)\r\n\n\n### What did you expect to happen?\n\nI expected it to remain stable as earlier.\n\n### Did this work before?\n\nYes, earlier, it was working fine.\n\n### How do we reproduce it?\n\n1. Note CPU and Memory usage on `10.1.5`.\r\n2. Upgrade to `10.2.0`.\r\n3. Check CPU and Memory usage again.\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.2.0\r\nOS: MacOS\r\nBrowser: Chrome/Chromium\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nPrometheus","labels":["needs more info","area/panel/timeseries"]},{"id":51611,"title":"Inconsistent timeFilter resolution between ordinary and alert queries","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\n`__timeFilter` macro yields different timestamp resolution when used in ordinary (panel) and alert queries for PostgreSQL data source.\r\n\r\n```\r\nWHERE\r\n  $__timeFilter(ts)\r\n```\r\n\r\nThe above WHERE clause generates the following result for a panel query (notice millisecond resolution):\r\n\r\n```\r\nWHERE ts BETWEEN '2022-06-30T00:43:03.995Z' AND '2022-06-30T06:43:03.995Z'\r\n```\r\n\r\nwhile for an alert query it produces nanosecond resolution timestamps:\r\n```\r\nWHERE ts BETWEEN '2022-06-30T06:34:38.08965998Z' AND '2022-06-30T06:44:38.08965998Z'\r\n```\r\n\r\n**What you expected to happen**:\r\n\r\nBoth types of queries should use one or another resolution.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n1. Configure a PostgreSQL data source.\r\n2. Create panel and alert rule with the `__timeFilter` macro used in WHERE clause.\r\n3. Check generated queries.\r\n\r\n**Anything else we need to know?**:\r\n\r\nIt's possible to produce consistent timestamps via `__unixEpochFrom` and `__unixEpochTo` macros in combination with BETWEEN and manual epoch to timestamp conversions. Yet, it would be nice to see consistent behavior for the `__timeFilter` macro.\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.2, Docker\r\n- Data source type \u0026 version: built-in PostgreSQL data source\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser: Ubuntu 20.04 x64, Chrome 103.0.5060.53 (Official Build) (64-bit)\r\n- Grafana plugins: none\r\n- Others:\r\n","labels":["type/bug","needs more info","area/alerting","datasource/Postgres"]},{"id":58804,"title":"[InfluxDB] Updating from 8.5.4 to 9.0 and then 9.2.4 causes Data Source to be changed to default Grafana/Random Walk in some panels without user's input.","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: After updating Grafana from 8.5.4 to 9.0 and then 9.2.4, some of our dashboards and panels Data Source was changed to default Grafana with Random walk, filling them up with garbage data.\r\n\r\n**What you expected to happen**: Above one not happening at all?\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: Update from 8.5.4 to 9.0, then to 9.2.4\r\n\r\n**Anything else we need to know?**: It seem like the problem occurs only when certain panel uses InfluxDB Data Source - neither Postgres nor Elasticsearch were affected. I had to perform direct DB restore in order to revert breaking changes.\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.4\r\n- Data source type \u0026 version: Original -InfluxDB, current one (switched without my knowledge) - Grafana\r\n- OS Grafana is installed on: Ubuntu 20.04\r\n- User OS \u0026 Browser: N/A\r\n- Grafana plugins: N/A\r\n- Others: N/A\r\n","labels":["area/dashboard/import","area/datasource","triage/needs-confirmation"]},{"id":64089,"title":"Poor visibility into feature flags","body":"**What is the chore?**: Better document and display how to adjust feature flags, especially when running via docker.\r\n\r\n**Is there anything else we need to know?**: I'm trying to enable the new widget UI and top nav via docker and I'm not having any luck. I've tried multiple variations of these environment variables (how do the names translate to env names? what values do I set them to? is there anywhere in the UI to see the value of these flags?)\r\n\r\n```\r\ndocker run -d -p 3001:3000 --name=home-grafana2 -v grafana-storage:/var/lib/grafana -e NEWPANELCHROMEUI=true -e NEW_PANEL_CHROME_UI=true -e topnav=true -e TOPNAV=true -e topNavCommandPalette=true -e TOPNAVCOMMANDPALETTE=true -e TOP_NAV_COMMAND_PALETTE=true grafana/grafana\r\n```\r\n","labels":["area/docker","bot/no new info","area/configuration"]},{"id":74297,"title":"Transformations: Rename by regex has the same description as the reduce transform","body":"### What happened?\n\n![image](https://github.com/grafana/grafana/assets/5334156/58fe9162-21e6-4458-a3ad-db6c53021037)\r\nthe desc is same as Reduce transferm\n\n### What did you expect to happen?\n\nthe desc issue\n\n### Did this work before?\n\nyes\n\n### How do we reproduce it?\n\nopen transform panel\n\n### Is the bug inside a dashboard panel?\n\nno\n\n### Environment (with versions)?\n\nGrafana:\r\nOS:\r\nBrowser:\r\n\n\n### Grafana platform?\n\nOther\n\n### Datasource(s)?\n\n_No response_","labels":["type/bug","area/transformations"]},{"id":48934,"title":"Alerting: After migration contact points and notifications lost AND alerts sending to `example@email.com`","body":"**What happened**:\r\nThe entire configuration of Contact Points and Notification Policies was reset/deleted. This has happened three times over the last few months. \r\n\r\n**What you expected to happen**:\r\nI expected this not to be deleted unless I choose to do so. And until fixed, I am prevented from\r\nputting in the desired set of notification policies, since they may disappear any time. \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nI have not yet found a way to reproduce, there seem to be no pattern about it. I am still working\r\nthrough logs.\r\n\r\n**Anything else we need to know?**:\r\nSee below extract from custom.ini\r\nI have tried to follow [this ](https://grafana.com/docs/grafana/latest/alerting/unified-alerting/opt-in/) description, but so far, I see no misconfiguration.\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.4 OSS, .zip out of the box / sqlite\r\n- Data source type \u0026 version: Prometheus \r\n- OS Grafana is installed on: Windows Server 2019\r\n- User OS \u0026 Browser: Windows 10\r\n- Grafana plugins: N/A\r\n- Others:\r\n\r\n\r\nExtracts from custom.ini (please let me know if you need anything else that may apply/be relevant):\r\n\r\n#################################### Unified Alerting ####################\r\n[unified_alerting]\r\nenabled = true\r\ndisabled_orgs =\r\nadmin_config_poll_interval = 60s\r\nalertmanager_config_poll_interval = 60s\r\nha_listen_address = \"0.0.0.0:9094\"\r\nha_advertise_address = \"\"\r\nha_peers = \"\"\r\nha_peer_timeout = 15s\r\nha_gossip_interval = 200ms\r\nha_push_pull_interval = 60s\r\nexecute_alerts = true\r\nevaluation_timeout = 30s\r\nmax_attempts = 3\r\nmin_interval = 10s\r\n#################################### Alerting ############################\r\n[alerting]\r\nenabled = false\r\nexecute_alerts = true\r\nerror_or_timeout = alerting\r\nnodata_or_nullvalues = no_data\r\nconcurrent_render_limit = 5\r\nevaluation_timeout_seconds = 30\r\nnotification_timeout_seconds = 30\r\nmax_attempts = 3\r\nmin_interval_seconds = 1\r\nmax_annotation_age =\r\nmax_annotations_to_keep =\r\n\r\n#################################### Annotations #########################\r\n\r\nGrateful if anyone can point me in a direction, and apologies up front if this has already been addressed somewhere.\r\n","labels":["type/bug","area/alerting"]},{"id":80223,"title":"Ha-test-unified Alerting: Unsupported config option for services.db: 'platform'","body":"### What happened?\n\nha-test-unified-alerting setup did come up\n\n### What did you expect to happen?\n\nI expected the docker-compose up to bring up all the containers\n\n### Did this work before?\n\nNA\n\n### How do we reproduce it?\n\n1. Clone main branch\r\n2. Create docker image from make build-docker-full\r\n3. Run docker-compose up -d from `grafana/devenv/docker/ha-test-unified-alerting`\r\nThe logs of grafana1_1 gives this error\r\n\r\n```\r\ngrafana1_1     | logger=settings t=2024-01-09T14:35:41.366759927Z level=info msg=\"Path Plugins\" path=/var/lib/grafana/plugins\r\ngrafana1_1     | logger=settings t=2024-01-09T14:35:41.366764678Z level=info msg=\"Path Provisioning\" path=/etc/grafana/provisioning\r\ngrafana1_1     | logger=settings t=2024-01-09T14:35:41.366769416Z level=info msg=\"App mode production\"\r\ngrafana1_1     | logger=sqlstore t=2024-01-09T14:35:41.367277595Z level=info msg=\"Connecting to DB\" dbtype=mysql\r\ngrafana1_1     | logger=migrator t=2024-01-09T14:35:41.3718039Z level=info msg=\"Starting DB migrations\"\r\ngrafana1_1     | logger=migrator t=2024-01-09T14:35:41.391715125Z level=info msg=\"migrations completed\" performed=0 skipped=517 duration=1.072415ms\r\ngrafana1_1     | logger=secrets t=2024-01-09T14:35:41.398913731Z level=info msg=\"Envelope encryption state\" enabled=true currentprovider=secretKey.v1\r\ngrafana1_1     | logger=local.finder t=2024-01-09T14:35:41.457209882Z level=warn msg=\"Skipping finding plugins as directory does not exist\" path=/usr/share/grafana/plugins-bundled\r\ngrafana1_1     | logger=query_data t=2024-01-09T14:35:41.460194686Z level=info msg=\"Query Service initialization\"\r\ngrafana1_1     | logger=live.push_http t=2024-01-09T14:35:41.462316244Z level=info msg=\"Live Push Gateway initialization\"\r\ngrafana1_1     | logger=ngalert.multiorg.alertmanager component=clustering t=2024-01-09T14:35:56.87756291Z level=info msg=\"setting advertise address explicitly\" addr=172.21.0.6 port=9094\r\ngrafana1_1     | Error: ✗ failed to initialize alerting because multiorg alertmanager manager failed to warm up: context deadline exceeded\r\ngrafana1_1     | logger=ngalert.multiorg.alertmanager component=clustering t=2024-01-09T14:36:20.893608833Z level=info msg=\"Waiting for gossip to settle...\" interval=2s\r\n```\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.2.1\r\nOS: Ubuntu\r\nBrowser:\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\n_No response_","labels":["area/alerting","triage/needs-confirmation"]},{"id":71529,"title":"Alerting: Alerts invisible after legacy migration after previous opt-out","body":"### What happened?\n\nWhen we upgraded to Grafana 9.x, our existing legacy alerts were migrated to the new alerting. AFAIR this was successful and I could see the alerts in the Grafana UI. However, we soon [rolled back](https://grafana.com/docs/grafana/v9.5/alerting/migrating-alerts/roll-back/) as described in the documentation and continued to use the legacy alerting. This also worked fine until now. Now we are ready to migrate to the unified alerting. So I configured Grafana as described for [opt-in](https://grafana.com/docs/grafana/v9.5/alerting/migrating-alerts/opt-in/) and started it again.\r\n\r\nThe problem is that I now cannot see any alert rules in the Grafana UI. The page `/alerting/list` just shows an empty list. Those panels that had an alert configured are now shown as having no alert.\r\n\r\nContact points and notification policies are shown.\r\n\r\nInterestingly, despite no alert rule at all shown in UI, at least some of the rules are still active, because I do get notifications. The link behind \"View alert\" in the notification leads me to a page that shows \"Rule not found\":\r\n![image](https://github.com/grafana/grafana/assets/2545335/dd864301-83b0-407f-9ef2-f14ec762a767)\r\n\r\nOn startup, Grafana logs the following messages (both on the first start after the opt-in and on further startups):\r\n```\r\nlogger=settings t=2023-07-13T10:28:05.348074374+02:00 level=warn msg=\"\\\"sentry\\\" frontend logging provider is deprecated and will be removed in the next major version. Use \\\"grafana\\\" provider instead.\"\r\nlogger=ngalert t=2023-07-13T10:28:06.586750451+02:00 level=warn msg=\"Unexpected number of rows updating alert configuration history\" rows=0 org=1 hash=not-yet-calculated\r\nlogger=modules t=2023-07-13T10:28:07.811053743+02:00 level=warn msg=\"No modules registered...\"\r\n```\r\n\r\nIt seems to me that maybe there are some left-overs from the first migration in the database or so and that because of this the current migration is not performed? I expected to see log messages regarding the migration after the opt-in, but there were none. Can I somehow clean up the database such that the migration is performed (again)?\n\n### What did you expect to happen?\n\nI expect all my alert rules to be migrated and shown in the UI.\n\n### Did this work before?\n\nThis is the first time I try the migration after the previous rollback.\n\n### How do we reproduce it?\n\n1. Upgrade triggering migration\r\n2. Rollback\r\n3. Opt-in to migration\r\n\r\nRight now I can repeat the attempted opt-in migration as often as I wish as I have a backup from the Grafana state before the opt-in. So if there is anything I can provide to assist with this, I would be glad to do so. I do not have anything from the time of the first migration and the rollback, though.\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 9.5.6\r\nOS: Ubuntu 22.04\r\nBrowser: Firefox 115.0.2\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\n_No response_","labels":["type/bug","area/alerting","area/backend/db/migration","kata:alerting-ease-of-use"]},{"id":61885,"title":"Alerting: Provisioning API should validate deleteRules directive","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI have a Grafana lab enviroment where I'm playing around with Grafana Provisioning.\r\nI noted that if I create a YAML containing deleteRules declared with an orgId but without any uid, it allows me to modify or delete provisioned alert rules belongin to that orgId. \r\nIf I reload Grafana all rules are restored again.\r\n\r\n**What you expected to happen**:\r\nProvisioned rules should not be editable/erasable\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\ncreate a YAML file at ./provisioning/alert with the following lines: \r\n\r\n```\r\napiVersion: 1\r\ndeleteRules:\r\n  - orgId: 1\r\n#    uid: xxxxxxx\r\n```\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.2\r\n- Data source type \u0026 version: Prometheus \r\n- OS Grafana is installed on: Ubuntu 22.04\r\n- User OS \u0026 Browser: Brave 1.47.171 - Windows 10\r\n- Grafana plugins: default config\r\n- Others:\r\n","labels":["area/alerting","area/provisioning","stale"]},{"id":78885,"title":"Return org picker's searching functionality","body":"\u003c!-- Please only use this template for submitting feature requests --\u003e\r\n\r\n**Why is this needed**:\r\n\r\nOur use-case has hundreds of organizations in a self-hosted instance of Grafana. An administrator trying to add a user to an org is an incredibly tedious process since the org list is unsorted and extremely long. \r\n\r\n**What would you like to be added**:\r\n\r\nWe recently upgraded from v6 to v10 and v6 had this org picker with search enabled. I would like to resurrect this functionality. Seems like an easy fix since it will all be frontend-based.\r\n\r\n**Who is this feature for?**\r\n\r\nA grafana instance with multiple organizations that are managed by humans.","labels":["type/feature-request","area/admin/user","area/frontend"]},{"id":73698,"title":"Alert List Issue - Alert State Filter does not work. Shows only data on one panel","body":"### What happened?\r\n\r\nTarget is to create 3 panels. (Firing/Problem, Pending, Normal) Alerts. Filtered via alert state filter. Only one panel shows the data, which is the one who is edited. When refreshed, only Problem Alerts are showing. \r\n\r\nHere is the JSON Model.\r\n\r\n```\r\n{\r\n  \"annotations\": {\r\n    \"list\": [\r\n      {\r\n        \"builtIn\": 1,\r\n        \"datasource\": {\r\n          \"type\": \"grafana\",\r\n          \"uid\": \"-- Grafana --\"\r\n        },\r\n        \"enable\": true,\r\n        \"hide\": true,\r\n        \"iconColor\": \"rgba(0, 211, 255, 1)\",\r\n        \"name\": \"Annotations \u0026 Alerts\",\r\n        \"target\": {\r\n          \"limit\": 100,\r\n          \"matchAny\": false,\r\n          \"tags\": [],\r\n          \"type\": \"dashboard\"\r\n        },\r\n        \"type\": \"dashboard\"\r\n      }\r\n    ]\r\n  },\r\n  \"description\": \"Alerts Overview\",\r\n  \"editable\": true,\r\n  \"fiscalYearStartMonth\": 0,\r\n  \"graphTooltip\": 0,\r\n  \"id\": 89,\r\n  \"links\": [],\r\n  \"liveNow\": false,\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"influxdb\",\r\n        \"uid\": \"\"\r\n      },\r\n      \"description\": \"Problem Alerts\",\r\n      \"gridPos\": {\r\n        \"h\": 24,\r\n        \"w\": 8,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 1,\r\n      \"options\": {\r\n        \"alertInstanceLabelFilter\": \"\",\r\n        \"alertName\": \"\",\r\n        \"dashboardAlerts\": false,\r\n        \"datasource\": \"-- Grafana --\",\r\n        \"groupBy\": [],\r\n        \"groupMode\": \"default\",\r\n        \"maxItems\": 20,\r\n        \"sortOrder\": 1,\r\n        \"stateFilter\": {\r\n          \"error\": true,\r\n          \"firing\": true,\r\n          \"noData\": true,\r\n          \"normal\": false,\r\n          \"pending\": false\r\n        },\r\n        \"viewMode\": \"list\"\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"influxdb\",\r\n            \"uid\": \"\"\r\n          },\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Problems\",\r\n      \"type\": \"alertlist\"\r\n    },\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"influxdb\",\r\n        \"uid\": \"\"\r\n      },\r\n      \"description\": \"Pending Alerts\",\r\n      \"gridPos\": {\r\n        \"h\": 24,\r\n        \"w\": 8,\r\n        \"x\": 8,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"alertInstanceLabelFilter\": \"\",\r\n        \"alertName\": \"\",\r\n        \"dashboardAlerts\": false,\r\n        \"datasource\": \"-- Grafana --\",\r\n        \"groupBy\": [],\r\n        \"groupMode\": \"default\",\r\n        \"maxItems\": 20,\r\n        \"sortOrder\": 1,\r\n        \"stateFilter\": {\r\n          \"error\": false,\r\n          \"firing\": false,\r\n          \"noData\": false,\r\n          \"normal\": false,\r\n          \"pending\": true\r\n        },\r\n        \"viewMode\": \"list\"\r\n      },\r\n      \"title\": \"Pending\",\r\n      \"type\": \"alertlist\"\r\n    },\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"influxdb\",\r\n        \"uid\": \"\"\r\n      },\r\n      \"description\": \"No Alerts\",\r\n      \"gridPos\": {\r\n        \"h\": 24,\r\n        \"w\": 8,\r\n        \"x\": 16,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 3,\r\n      \"options\": {\r\n        \"alertInstanceLabelFilter\": \"\",\r\n        \"alertName\": \"\",\r\n        \"dashboardAlerts\": false,\r\n        \"datasource\": \"-- Grafana --\",\r\n        \"groupBy\": [],\r\n        \"groupMode\": \"default\",\r\n        \"maxItems\": 20,\r\n        \"sortOrder\": 1,\r\n        \"stateFilter\": {\r\n          \"error\": false,\r\n          \"firing\": false,\r\n          \"noData\": false,\r\n          \"normal\": true,\r\n          \"pending\": false\r\n        },\r\n        \"viewMode\": \"list\"\r\n      },\r\n      \"title\": \"Normal\",\r\n      \"type\": \"alertlist\"\r\n    }\r\n  ],\r\n  \"refresh\": \"5s\",\r\n  \"schemaVersion\": 38,\r\n  \"style\": \"dark\",\r\n  \"tags\": [],\r\n  \"templating\": {\r\n    \"list\": []\r\n  },\r\n  \"time\": {\r\n    \"from\": \"now-6h\",\r\n    \"to\": \"now\"\r\n  },\r\n  \"timepicker\": {\r\n    \"hidden\": false,\r\n    \"refresh_intervals\": []\r\n  },\r\n  \"timezone\": \"browser\",\r\n  \"title\": \"Alerts Overview\",\r\n  \"uid\": \"\",\r\n  \"version\": 3,\r\n  \"weekStart\": \"\"\r\n}\r\n```\r\n\r\n**_Note: Purposely filtered uid._**\r\n\r\n### What did you expect to happen?\r\n\r\nAlerts will show in all 3 panels.\r\n\r\n### Did this work before?\r\n\r\nFirst dashboard in this use case. Reference in this documentation https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/alert-list/\r\n\r\n### How do we reproduce it?\r\n\r\n1. Add visualization. 3 alert lists\r\n2. Filter each panel by (Problem, Pending, Normal) status\r\n\r\n**Observation: Only Problem Panel is showing. Editing Normal/Pending panel shows the data, but removes the data in problem panel. After refreshing only problem panel shows.** \r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: Grafana v10.0.1 \r\nOS: macOS\r\nBrowser: Google Chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nKubernetes\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/alerting","area/panel/alertlist","triage/needs-confirmation"]},{"id":64782,"title":"File Provisioned Notification Policy Rigidity","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI'm using the [grafana helm chart](https://github.com/grafana/helm-charts/tree/main/charts/grafana) to set up grafana, and overriding it to create some alerts, contact points and notification policies. Everything works fine. However, once Grafana comes up, I can still create new alerts via the UI and add new contact points other than the provisioned one, but can't add any routes at all to the notification policies _(The \"+Add Policy\" button is missing)_\r\n\r\n#### (Notification Policy Page, completely locked out)\r\n\u003cimg width=\"1379\" alt=\"Screenshot 2023-03-15 at 4 32 50 AM\" src=\"https://user-images.githubusercontent.com/408863/225161076-819ce1c3-ef4a-4c70-a64d-ec671939b3ee.png\"\u003e\r\n\r\n#### (Other Alert pages allow new record creation)\r\n\u003cimg width=\"1322\" alt=\"Screenshot 2023-03-15 at 4 33 39 AM\" src=\"https://user-images.githubusercontent.com/408863/225161216-3f4245b3-45f7-4dcf-aa7b-e591eaa0a3d1.png\"\u003e\r\n\u003cimg width=\"1324\" alt=\"Screenshot 2023-03-15 at 4 34 08 AM\" src=\"https://user-images.githubusercontent.com/408863/225161274-a327a58d-73c4-4ae1-9fa9-083c598d70e4.png\"\u003e\r\n\r\n**What you expected to happen**:\r\nJust like Contact Points and Alerts, the behaviour for Notification Policy should be _\"User **cannot** edit Provisioned Policy, but **Can** create new ones\"_\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nThe config file I'm using is:\r\n\r\n```\r\n    alerting: \r\n      rules.yaml:\r\n        apiVersion: 1\r\n        groups:\r\n          - orgId: 1\r\n            name: 'my_rule_group'\r\n            folder: my_first_folder\r\n            interval: 60s\r\n            rules:\r\n              - uid: my_id_1\r\n                title: my_first_rule\r\n                ...\r\n      contactpoints.yaml:\r\n        apiVersion: 1\r\n        contactPoints:\r\n          - orgId: 1\r\n            name: 'cp_1'\r\n            receivers:\r\n              - uid: cp_1\r\n                type: email\r\n                ...\r\n      notificationpolicies.yaml:\r\n        apiVersion: 1\r\n        policies:\r\n          - orgId: 1\r\n            receiver: 'cp_1'\r\n            routes:\r\n              - receiver: 'cp_1'\r\n                object_matchers:\r\n                  - - 'type'\r\n                    - '='\r\n                    - 'xyz'\r\n                group_by:\r\n                - grafana_folder\r\n                - alertname\r\n                continue: true\r\n```\r\n\r\n**Anything else we need to know?**:\r\n\r\nAm I missing something in this setup @JohnnyQQQQ ? This issue may be a dupe of [this issue](https://github.com/grafana/grafana/issues/55073) but I'm not sure if that was tf provisioned or file-provisioned.\r\n\r\n**Environment**:\r\n- Grafana version: v9.4.3 (cf0a135595)\r\n- Data source type \u0026 version: Should not matter, but VictoriaMetrics\r\n- OS Grafana is installed on: Linux\r\n- User OS \u0026 Browser: OSX, Firefox\r\n- Grafana plugins: -\r\n- Others:\r\n","labels":["area/alerting/notifications","area/provisioning","stale","triage/needs-confirmation"]},{"id":71018,"title":"Public dashboard :  No data","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\nI created a simple dashboard that works perfectly when authenticated, but when I use the public share, the visualizations show \"no data\", although I can see the HTTP queries that return correct data.\r\n\r\nThe data source is prometheus that scrath json data with json_exporter.\r\n\r\n**What did you expect to happen**:\r\n\r\n  - Public dashboard should display data.\r\n\r\n\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n1. Create a dashboard that use prometheus data\r\n2. Create a public share\r\n3. Open the public link \r\n4. Visualizations show \"no data\"\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\n10.0.1\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\n\r\n### Grafana Platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### User's OS?\r\n\r\nDebian 11.7\r\n\r\n### User's Browser?\r\n\r\nFirefox / Chrome\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\nPrometheus + json_exporter\r\n\r\n### Anything else to add?\r\n| Key | Value |\r\n|--|--|\r\n| Panel | table @ 10.0.1 |\r\n| Grafana | 10.0.1 (5a30620b85) // Open Source |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"custom\": {\r\n            \"align\": \"auto\",\r\n            \"cellOptions\": {\r\n              \"type\": \"auto\"\r\n            },\r\n            \"inspect\": false\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              }\r\n            ]\r\n          },\r\n          \"color\": {\r\n            \"mode\": \"thresholds\"\r\n          }\r\n        },\r\n        \"overrides\": [\r\n          {\r\n            \"matcher\": {\r\n              \"id\": \"byName\",\r\n              \"options\": \"version\"\r\n            },\r\n            \"properties\": [\r\n              {\r\n                \"id\": \"custom.cellOptions\",\r\n                \"value\": {\r\n                  \"type\": \"color-text\"\r\n                }\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"showHeader\": true,\r\n        \"cellHeight\": \"sm\",\r\n        \"footer\": {\r\n          \"show\": false,\r\n          \"reducer\": [\r\n            \"sum\"\r\n          ],\r\n          \"countRows\": false,\r\n          \"fields\": \"\"\r\n        }\r\n      },\r\n      \"pluginVersion\": \"10.0.1\",\r\n      \"targets\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"grafana\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"snapshot\",\r\n          \"snapshot\": [\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"meta\": {\r\n                  \"type\": \"numeric-multi\",\r\n                  \"typeVersion\": [\r\n                    0,\r\n                    1\r\n                  ],\r\n                  \"custom\": {\r\n                    \"resultType\": \"vector\"\r\n                  },\r\n                  \"executedQueryString\": \"Expr: environnement_version_data{project=\\\"project1\\\"}\\nStep: 15s\",\r\n                  \"preferredVisualisationType\": \"rawPrometheus\",\r\n                  \"transformations\": [\r\n                    \"filterFieldsByName\",\r\n                    \"organize\",\r\n                    \"sortBy\"\r\n                  ]\r\n                },\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"Time\",\r\n                    \"type\": \"time\",\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"__name__\",\r\n                    \"config\": {\r\n                      \"filterable\": true\r\n                    },\r\n                    \"type\": \"string\"\r\n                  },\r\n                  {\r\n                    \"name\": \"app\",\r\n                    \"config\": {\r\n                      \"filterable\": true\r\n                    },\r\n                    \"type\": \"string\"\r\n                  },\r\n                  {\r\n                    \"name\": \"build_date\",\r\n                    \"config\": {\r\n                      \"filterable\": true\r\n                    },\r\n                    \"type\": \"string\"\r\n                  },\r\n                  {\r\n                    \"name\": \"deploy_date\",\r\n                    \"config\": {\r\n                      \"filterable\": true\r\n                    },\r\n                    \"type\": \"string\"\r\n                  },\r\n                  {\r\n                    \"name\": \"env\",\r\n                    \"config\": {\r\n                      \"filterable\": true\r\n                    },\r\n                    \"type\": \"string\"\r\n                  },\r\n                  {\r\n                    \"name\": \"gitlab_job_name\",\r\n                    \"config\": {\r\n                      \"filterable\": true\r\n                    },\r\n                    \"type\": \"string\"\r\n                  },\r\n                  {\r\n                    \"name\": \"instance\",\r\n                    \"config\": {\r\n                      \"filterable\": true\r\n                    },\r\n                    \"type\": \"string\"\r\n                  },\r\n                  {\r\n                    \"name\": \"job\",\r\n                    \"config\": {\r\n                      \"filterable\": true\r\n                    },\r\n                    \"type\": \"string\"\r\n                  },\r\n                  {\r\n                    \"name\": \"machine\",\r\n                    \"config\": {\r\n                      \"filterable\": true\r\n                    },\r\n                    \"type\": \"string\"\r\n                  },\r\n                  {\r\n                    \"name\": \"project\",\r\n                    \"config\": {\r\n                      \"filterable\": true\r\n                    },\r\n                    \"type\": \"string\"\r\n                  },\r\n                  {\r\n                    \"name\": \"version\",\r\n                    \"config\": {\r\n                      \"filterable\": true\r\n                    },\r\n                    \"type\": \"string\"\r\n                  },\r\n                  {\r\n                    \"name\": \"Value\",\r\n                    \"type\": \"number\",\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    1688563609579,\r\n                    1688563609579,\r\n                    1688563609579,\r\n                    1688563609579,\r\n                    1688563609579\r\n                  ],\r\n                  [\r\n                    \"jbrdnabxajkcm_kscchci_siay\",\r\n                    \"jbrdnabxajkcm_kscchci_siay\",\r\n                    \"jbrdnabxajkcm_kscchci_siay\",\r\n                    \"jbrdnabxajkcm_kscchci_siay\",\r\n                    \"jbrdnabxajkcm_kscchci_siay\"\r\n                  ],\r\n                  [\r\n                    \"Gmiupj1\",\r\n                    \"Gmiupj1\",\r\n                    \"Gmiupj1\",\r\n                    \"Gmiupj1\",\r\n                    \"Gmiupj1\"\r\n                  ],\r\n                  [\r\n                    \"2023-07-03 13:06:16 UTC\",\r\n                    \"2023-07-03 13:06:16 UTC\",\r\n                    \"2023-07-03 13:06:16 UTC\",\r\n                    \"2023-07-05 08:00:36 UTC\",\r\n                    \"2023-07-05 13:12:18 UTC\"\r\n                  ],\r\n                  [\r\n                    \"2023-07-03 15:25:00 CEST\",\r\n                    \"2023-07-04 15:08:58 CEST\",\r\n                    \"2023-07-04 17:58:48 CEST\",\r\n                    \"2023-07-05 13:00:09 CEST\",\r\n                    \"2023-07-05 15:18:40 CEST\"\r\n                  ],\r\n                  [\r\n                    \"eousfqpnoalbv\",\r\n                    \"noklmoxtde\",\r\n                    \"mmfusxlrp\",\r\n                    \"fyjgjeramkg\",\r\n                    \"qrgdmxn_mvjym_kpjaxyy\"\r\n                  ],\r\n                  [\r\n                    \"wciipahd_fnbhmxx\",\r\n                    \"wciipahd_fnbhmxx\",\r\n                    \"wciipahd_fnbhmxx\",\r\n                    \"wciipahd_fnbhmxx\",\r\n                    \"wciipahd_fnbhmxx\"\r\n                  ],\r\n                  [\r\n                    \"htjnj://vkxzelmmpgkgh.ganlnxq.rbslto.kpsi.gt/enkpoxd.dhri\",\r\n                    \"uvfgw://lbzkc.oysclmcnfy.zrixlja.vxfqpp.hqum.ms/mtcasnv.hspt\",\r\n                    \"hyfaj://sgh:1J88UmeP1R3gWtz4@zxrmshmhd.ryohcih.iuyrwr.ptji.yw/eosqfdo.nlsg\",\r\n                    \"llphq://xxl:1J88UycP1R3vWzt4@lmwcblrozjd.lcdjyqe.gjvbsn.zsif.yb/txkggom.pzhi\",\r\n                    \"tjczp://dgyzpry-uys.gve.wndlhaiip.vek/dxgttzg.vgkk\"\r\n                  ],\r\n                  [\r\n                    \"Jpyd Ehjtiukv\",\r\n                    \"Jpyd Ehjtiukv\",\r\n                    \"Jpyd Ehjtiukv\",\r\n                    \"Jpyd Ehjtiukv\",\r\n                    \"Jpyd Ehjtiukv\"\r\n                  ],\r\n                  [\r\n                    \"VM-02-55-02-005-dgt\",\r\n                    \"VM-01-55-02-102-raq\",\r\n                    \"VM-05-55-02-001-ebq\",\r\n                    \"VM-03-55-02-001-zus\",\r\n                    \"VM-07-55-02-001-edi\"\r\n                  ],\r\n                  [\r\n                    \"lkqjncw-r9\",\r\n                    \"lkqjncw-r9\",\r\n                    \"lkqjncw-r9\",\r\n                    \"lkqjncw-r9\",\r\n                    \"lkqjncw-r9\"\r\n                  ],\r\n                  [\r\n                    \"2.82.1.0\",\r\n                    \"2.82.1.0\",\r\n                    \"2.82.1.0\",\r\n                    \"hryrdrms\",\r\n                    \"mmijtyu\"\r\n                  ],\r\n                  [\r\n                    1,\r\n                    1,\r\n                    1,\r\n                    1,\r\n                    1\r\n                  ]\r\n                ]\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      \"title\": \"Reproduced with embedded data\",\r\n      \"transformations\": [\r\n        {\r\n          \"id\": \"concatenate\",\r\n          \"options\": {\r\n            \"frameNameLabel\": \"frame\",\r\n            \"frameNameMode\": \"drop\"\r\n          }\r\n        },\r\n        {\r\n          \"id\": \"filterFieldsByName\",\r\n          \"options\": {\r\n            \"include\": {\r\n              \"names\": [\r\n                \"build_date\",\r\n                \"deploy_date\",\r\n                \"env\",\r\n                \"machine\",\r\n                \"version\"\r\n              ]\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"id\": \"organize\",\r\n          \"options\": {\r\n            \"excludeByName\": {},\r\n            \"indexByName\": {\r\n              \"build_date\": 0,\r\n              \"deploy_date\": 4,\r\n              \"env\": 2,\r\n              \"machine\": 5,\r\n              \"project\": 1,\r\n              \"version\": 3\r\n            },\r\n            \"renameByName\": {\r\n              \"build_date\": \"Build Package on\",\r\n              \"deploy_date\": \"Deployed on\",\r\n              \"env\": \"Env\",\r\n              \"machine\": \"VM\",\r\n              \"version\": \"Version\"\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"id\": \"sortBy\",\r\n          \"options\": {\r\n            \"fields\": {},\r\n            \"sort\": [\r\n              {\r\n                \"field\": \"Env\"\r\n              }\r\n            ]\r\n          }\r\n        }\r\n      ],\r\n      \"type\": \"table\"\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003etable @ 10.0.1\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003eA[prometheus]\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eTransform\u003c/th\u003e\\n      \u003ctd\u003econcatenate, filterFieldsByName, organize, sortBy\u003c/td\u003e\\n  \u003c/tr\u003e\\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003e 1 frames, 13 fields, 5 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e10.0.1 (5a30620b85) // Open Source\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"title\": \"Original Panel JSON\",\r\n      \"type\": \"text\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 7\r\n      },\r\n      \"options\": {\r\n        \"content\": \"{\\n  \\\"datasource\\\": {\\n    \\\"type\\\": \\\"prometheus\\\",\\n    \\\"uid\\\": \\\"d448077d-c17a-4999-a4cf-f6b4aed70159\\\"\\n  },\\n  \\\"fieldConfig\\\": {\\n    \\\"defaults\\\": {\\n      \\\"custom\\\": {\\n        \\\"align\\\": \\\"auto\\\",\\n        \\\"cellOptions\\\": {\\n          \\\"type\\\": \\\"auto\\\"\\n        },\\n        \\\"inspect\\\": false\\n      },\\n      \\\"mappings\\\": [],\\n      \\\"thresholds\\\": {\\n        \\\"mode\\\": \\\"absolute\\\",\\n        \\\"steps\\\": [\\n          {\\n            \\\"color\\\": \\\"green\\\",\\n            \\\"value\\\": null\\n          }\\n        ]\\n      },\\n      \\\"color\\\": {\\n        \\\"mode\\\": \\\"thresholds\\\"\\n      }\\n    },\\n    \\\"overrides\\\": [\\n      {\\n        \\\"matcher\\\": {\\n          \\\"id\\\": \\\"byName\\\",\\n          \\\"options\\\": \\\"version\\\"\\n        },\\n        \\\"properties\\\": [\\n          {\\n            \\\"id\\\": \\\"custom.cellOptions\\\",\\n            \\\"value\\\": {\\n              \\\"type\\\": \\\"color-text\\\"\\n            }\\n          }\\n        ]\\n      }\\n    ]\\n  },\\n  \\\"gridPos\\\": {\\n    \\\"h\\\": 8,\\n    \\\"w\\\": 24,\\n    \\\"x\\\": 0,\\n    \\\"y\\\": 3\\n  },\\n  \\\"id\\\": 10,\\n  \\\"options\\\": {\\n    \\\"showHeader\\\": true,\\n    \\\"cellHeight\\\": \\\"sm\\\",\\n    \\\"footer\\\": {\\n      \\\"show\\\": false,\\n      \\\"reducer\\\": [\\n        \\\"sum\\\"\\n      ],\\n      \\\"countRows\\\": false,\\n      \\\"fields\\\": \\\"\\\"\\n    }\\n  },\\n  \\\"pluginVersion\\\": \\\"10.0.1\\\",\\n  \\\"targets\\\": [\\n    {\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"prometheus\\\",\\n        \\\"uid\\\": \\\"d448077d-c17a-4999-a4cf-f6b4aed70159\\\"\\n      },\\n      \\\"exemplar\\\": false,\\n      \\\"expr\\\": \\\"environnement_version_data{project=\\\\\\\"project1\\\\\\\"}\\\",\\n      \\\"format\\\": \\\"table\\\",\\n      \\\"instant\\\": true,\\n      \\\"interval\\\": \\\"\\\",\\n      \\\"legendFormat\\\": \\\"\\\",\\n      \\\"refId\\\": \\\"A\\\"\\n    }\\n  ],\\n  \\\"title\\\": \\\"project1 (none-prod)\\\",\\n  \\\"transformations\\\": [\\n    {\\n      \\\"id\\\": \\\"concatenate\\\",\\n      \\\"options\\\": {\\n        \\\"frameNameLabel\\\": \\\"frame\\\",\\n        \\\"frameNameMode\\\": \\\"drop\\\"\\n      }\\n    },\\n    {\\n      \\\"id\\\": \\\"filterFieldsByName\\\",\\n      \\\"options\\\": {\\n        \\\"include\\\": {\\n          \\\"names\\\": [\\n            \\\"build_date\\\",\\n            \\\"deploy_date\\\",\\n            \\\"env\\\",\\n            \\\"machine\\\",\\n            \\\"version\\\"\\n          ]\\n        }\\n      }\\n    },\\n    {\\n      \\\"id\\\": \\\"organize\\\",\\n      \\\"options\\\": {\\n        \\\"excludeByName\\\": {},\\n        \\\"indexByName\\\": {\\n          \\\"build_date\\\": 0,\\n          \\\"deploy_date\\\": 4,\\n          \\\"env\\\": 2,\\n          \\\"machine\\\": 5,\\n          \\\"project\\\": 1,\\n          \\\"version\\\": 3\\n        },\\n        \\\"renameByName\\\": {\\n          \\\"build_date\\\": \\\"Build Package on\\\",\\n          \\\"deploy_date\\\": \\\"Deployed on\\\",\\n          \\\"env\\\": \\\"Env\\\",\\n          \\\"machine\\\": \\\"VM\\\",\\n          \\\"version\\\": \\\"Version\\\"\\n        }\\n      }\\n    },\\n    {\\n      \\\"id\\\": \\\"sortBy\\\",\\n      \\\"options\\\": {\\n        \\\"fields\\\": {},\\n        \\\"sort\\\": [\\n          {\\n            \\\"field\\\": \\\"Env\\\"\\n          }\\n        ]\\n      }\\n    }\\n  ],\\n  \\\"type\\\": \\\"table\\\"\\n}\",\r\n        \"mode\": \"code\",\r\n        \"code\": {\r\n          \"language\": \"json\",\r\n          \"showLineNumbers\": true,\r\n          \"showMiniMap\": true\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above (after transformations)\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"id\": 100,\r\n      \"title\": \"Data (before transformations)\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 24,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": false,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: project1 (none-prod) // 2023-07-05 15:27:59\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-table\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"2023-07-05T07:27:59.564Z\",\r\n    \"to\": \"2023-07-05T13:27:59.564Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\r\n_No response_","labels":["type/bug","area/dashboard","area/public-dashboards","triage/needs-confirmation","team/grafana-dashboards"]},{"id":54719,"title":"Value bar is showing wrong load","body":"I have found that after Grafana update from 7.5.15 to 8.3.6 my dashboard is showing a wrong picture of disk utility load.\r\n![Screenshot 2022-09-05 at 18 08 39](https://user-images.githubusercontent.com/93782091/188478608-ab924a05-9aff-4623-8098-6ca09cd88d8b.png)\r\n Here is one value that is red but according to the percentage, it must not. On Grafana's version 7.5.15 everything was correct.\r\nDid anyone had this issue and what is the fix ?","labels":["needs more info","area/panel/barchart"]},{"id":78122,"title":"Alerting: [plugin.downstreamError] failed to query data","body":"### What happened?\r\n\r\nAfter the upgrade to Grafana v10.0.3 we periodically get issues with alerting.\r\nMostly they are of following types:\r\n\r\n```\r\n[plugin.downstreamError] failed to query data: invalid character '\u003c' \r\n\r\n[plugin.downstreamError] failed to query data: Post \\\"https://kibana-nonprod.common/_msearch?max_concurrent_shard_requests=256\\\": EOF\" \r\n\r\n[plugin.downstreamError] failed to query data: Post \\\"https://kibana-nonprod.common/_msearch?max_concurrent_shard_requests=256\\\": context deadline exceeded\" \r\n\r\n[plugin.downstreamError] failed to query data: Post \\\"https://kibana-nonprod.common/_msearch?max_concurrent_shard_requests=256\\\": net/http: request canceled (Client.Timeout exceeded while awaiting headers)\" duration=30.001080015s\r\n```\r\n\r\nFor example:\r\n\r\n```\r\nlogger=ngalert.scheduler rule_uid=e54efe71-c316-48ef-a53a-6656eff26854 org_id=1 version=24 fingerprint=c7da47139ef661da attempt=0 now=2023-11-08T13:30:00+01:00 rule_uid=e54efe71-c316-48ef-a53a-6656eff26854 org_id=1 t=2023-11-08T13:30:27.215031223+01:00 level=**error msg=\"Failed to evaluate rule\" error=\"[plugin.downstreamError] failed to query data: invalid character '\u003c' looking for beginning of value**\" duration=22.89593443s\r\n\r\nlogger=ngalert.scheduler rule_uid=d0a55f5e-f9e8-4e01-8978-4a94ad211621 org_id=1 version=24 fingerprint=ae3103f6f6d23e2c attempt=0 now=2023-11-08T12:53:00+01:00 rule_uid=d0a55f5e-f9e8-4e01-8978-4a94ad211621 org_id=1 t=2023-11-08T12:53:00.835045709+01:00 level=error msg=\"Failed to evaluate rule\" **error=\"[plugin.downstreamError] failed to query data: Post \\\"https://kibana-nonprod.common/_msearch?max_concurrent_shard_requests=256\\\": EOF\"** duration=1.014832ms\r\n```\r\n\r\nApparently the problem appeared after the migration , and there were no infrastructure changes, neither changes on ElasticSearch datasource side that could be causing these issues.\r\n\r\nHere is an example of alert configuration:\r\n![image](https://github.com/grafana/grafana/assets/85614462/58f01ac7-f42c-47fc-9b60-02d83ce11bec)\r\n\r\n\r\nPlease assist in finding the reason.\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nAlerts to work as before the migration to Grafana v.10.0.3\r\n\r\n### Did this work before?\r\n\r\nYes, with Grafana v.8/9\r\n\r\n### How do we reproduce it?\r\n\r\nProvided details in ticket description\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: v.10.0.3\r\nOS:\r\nBrowser:\r\n\r\n\r\n### Grafana platform?\r\n\r\nNone\r\n\r\n### Datasource(s)?\r\n\r\nElasticSearch","labels":["needs more info","area/alerting","datasource/Elasticsearch","triage/needs-confirmation"]},{"id":67698,"title":"Dashboards: Opening dashboards in new tab from new search text box on top of page not working properly if sub path is configured","body":"### \n# What went wrong?\n\n\n**What happened**:\r\nwhen i click on items that listed in search box, dashboard comes without problem. but when open item link in new tab (ctrl + click) 404 page loads. i am using grafana sup path server.root_url=http://localhost:3000/g and server.serve_from_sub_path=true \r\n  - \r\n\r\n**What did you expect to happen**:\r\ndashboard load in new tab when using sup path\r\n  - \r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Open Grafana and search dashboard in text box on top of page\r\n\r\n**Step 2**:\r\n\r\n- ctrl + click any dashboard\r\n\r\n**Step 3**:\r\n\r\n- note that sub path activated\r\n\n\n### \n# What Grafana version are you using?\n\n\nGrafana v9.5.1 (bc353e4b2d)\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nNone\n\n### User's OS?\n\n_No response_\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["type/bug","area/search","area/frontend"]},{"id":81547,"title":"RangeError: Maximum call stack size exceeded ","body":"### What happened?\n\nAfter updating grafana to 10.2.3 from 10.0.9 , dashboard list page is not getting loading . It is crashing with below error :\r\nRangeError: Maximum call stack size exceeded.\r\n\r\nIt is also working fine in 10.1.6\r\n\r\nWe are using helm to deploy in EKS Kubernetes 1.28 \r\nHelm version : 7.2.1 \n\n### What did you expect to happen?\n\nDashboards page is not loading . It should display the list of all the dashboards . \n\n### Did this work before?\n\nYes .. it is working in 10.0.9 and 10.1.6\n\n### How do we reproduce it?\n\n1. Deploy the latest version.\r\n2.\r\n3.\r\n\n\n### Is the bug inside a dashboard panel?\n\nNo\n\n### Environment (with versions)?\n\nGrafana: 10.2.6 and above\r\nOS:\r\nBrowser:\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\n_No response_","labels":["area/dashboard","bot/no new info","triage/needs-confirmation","team/grafana-dashboards"]},{"id":54244,"title":"JWT: allow using Authorization header and Bearer token","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nWhen setting the JWT header name to `Authorization` header with a `Bearer` prefix, the token is rejected as an API Key failure.\r\n\r\n**What you expected to happen**:\r\n\r\nI would expect it to realise that it is not an API request (by path) and instead try JWT authentication.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nConfigure JWT with `header_name` of `Authorization` and make a normally valid JWT request with a `Bearer` token.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: main\r\n- Data source type \u0026 version: N/A\r\n- OS Grafana is installed on: Dev Environment\r\n- User OS \u0026 Browser: MacOS \u0026 curl\r\n- Grafana plugins: N/A\r\n- Others:\r\n","labels":["area/auth","proposal: open"]},{"id":53727,"title":"Annotation breaks on adjusting time range","body":"![grafana-issue](https://user-images.githubusercontent.com/7956429/184615585-55c7799d-1f5d-46bc-88d7-b6766332d5dd.gif)\r\n\r\n**What happened**:\r\nAnnotation breaks when increasing the time range to a larger window\r\n\r\n**What you expected to happen**:\r\nAnnotation should still remain the same regardless of the time range \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Use Prometheus as datasource, and add the metrics\r\n2. Use this query \r\n`ansible_annotation unless (ansible_annotation offset 1m) `\r\n\r\n**Anything else we need to know?**:\r\nIf you increase the offset to a larger window then it will work with a larger the time range but breaks on a more larger time frame. An example is 1m is good for 3 hour time range, 15m for 12 hour time range, and so on which isn't supposed to be since querying the data works as expected as seen in the gif.\r\n\r\n**Environment**:\r\n- Grafana version: v9.03\r\n- Data source type \u0026 version: Prometheus 2.36.1\r\n- OS Grafana is installed on: Debian 10\r\n- User OS \u0026 Browser: Debian 11 / Firefox 103.0.2 and Chrome 103.0.5\r\n","labels":["type/duplicate","area/annotations"]},{"id":78401,"title":"Visualization: Alerts list panel does not refresh","body":"### What happened?\n\nAlerts list panel filtering for Grafana alerts do not show new alerts on dashboard refresh. To see new alerts the whole page needs to be refreshed.\n\n### What did you expect to happen?\n\nNew alerts to appear on dashboard rfresh.\n\n### Did this work before?\n\nIssue also observed on grafana 9\n\n### How do we reproduce it?\n\n1. Create alerts panel showing some or no alerts.\r\n2. Enable dashboard refresh on any interval.\r\n3. Trigger a Grafana alert.\r\n4. After confirming that new alert isn't shown on dashboard, refresh entire page to confirm alert shows up after refresh.\r\n\n\n### Is the bug inside a dashboard panel?\n\nAlerts list panel does not have the get help option.\n\n### Environment (with versions)?\n\nGrafana: 10.0.2 commit b2bbe10fbc\r\nOS: Debian 11 bullseye\r\nBrowser: Brave, Version 1.59.124 Chromium: 118.0.5993.117 (Official Build) (64-bit)\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\n_No response_","labels":["area/panel/alertlist","bot/no new info"]},{"id":63161,"title":"PostgreSQL: dataset selection is not available for postgresql datasource","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nThe dataset dropdown list is not available in PostgreSQL datasource query editor even though it's mentioned in [documentation](https://grafana.com/docs/grafana/latest/datasources/postgres/#dataset-and-table-selection):\r\n\r\n\u003e In the dataset dropdown, choose the PostgreSQL database to query. The dropdown is be populated with the databases that the user has access to. When the dataset is selected, the table dropdown is populated with the tables that are available.`\r\n\r\n![CleanShot 2023-02-08 at 17 21 16@2x](https://user-images.githubusercontent.com/100722179/217690665-598d4729-bcbb-458b-a53c-7b94a3aaa4b9.png)\r\n\r\nI can confirm that the user I'm using in datasource settings has access to multiple databases. \r\n\r\n**What you expected to happen**:\r\n\r\nIdeally I should be able to switch between different postgresql databases by selecting different datasets to avoid creating multiple datasources (i.e. one datasource for each database).\r\n\r\n**Anything else we need to know?**:\r\n\r\nLooks like it might be purposefully hidden in `public/app/plugins/datasource/postgres/QueryEditor.tsx` with no override:\r\n\r\n`postgres/QueryEditor.tsx:const queryHeaderProps = { isDatasetSelectorHidden: true };`\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.1\r\n- Data source type \u0026 version: PostgreSQL\r\n- OS Grafana is installed on: Linux\r\n- User OS \u0026 Browser: macOS 13.2 / Safari 16.3\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/docs","help wanted","datasource/Postgres","good first issue"]},{"id":84689,"title":"Adding Colored Background Changes the Text Font","body":"### What happened?\n\nAdding a colored background override to a column changed its font style to bold. Making the font bold makes sense when a background color is applied, but when the background is transparent, text style should be normal. In the examples below I use the red background color to highlight rows with status that is not \"OK\". When there are multiple columns present, the status column being bold disorients the user.\r\n\r\nWith Colored Background\r\n![image](https://github.com/grafana/grafana/assets/107574310/030e999e-30a9-4618-b9f4-fad056876537)\r\n\r\nWithout Colored Background\r\n![image](https://github.com/grafana/grafana/assets/107574310/0cc919ad-66b2-4aad-81d5-c1fcc0c64ad4)\r\n\n\n### What did you expect to happen?\n\nFont style to remain the same.\n\n### Did this work before?\n\nYes. The font style used to stay the same.\n\n### How do we reproduce it?\n\n1. Create a dashboard and add a table visualization.\r\n2. Change the base threshold to transparent and delete other values.\r\n3. Add a field override to a column and change the cell type to colored background.\r\n\n\n### Is the bug inside a dashboard panel?\n\nYes. Table panel.\n\n### Environment (with versions)?\n\nGrafana: v10.4.0 (03f502a94d)\r\nOS: Debian Server, Windows Client\r\nBrowser: Chrome 122\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\nMicrosoft SQL Server","labels":["type/bug","area/dashboard","area/panel/table","area/dataviz"]},{"id":51682,"title":"failed to migrate alert 1106: folder with id 319 not found","body":"**What happened**:\r\n\r\nTrying to upgrade from `8.5.4` to `9.0.2` and the migration fails due to a lot of \r\n\r\n```\r\nJul 04 02:31:01 grafana grafana-server[9980]: logger=sqlstore t=2022-07-04T02:31:01.296956668Z level=info msg=\"Connecting to DB\" dbtype=mysql\r\nJul 04 02:31:01 grafana grafana-server[9980]: logger=migrator t=2022-07-04T02:31:01.314262014Z level=info msg=\"Starting DB migrations\"\r\nJul 04 02:31:01 grafana grafana-server[9980]: logger=migrator t=2022-07-04T02:31:01.324209826Z level=info msg=\"Executing migration\" id=\"clear migration entry \\\"remove unified alerting data\\\"\"\r\nJul 04 02:31:01 grafana grafana-server[9980]: logger=migrator t=2022-07-04T02:31:01.328936398Z level=info msg=\"Executing migration\" id=\"move dashboard alerts to unified alerting\"\r\nJul 04 02:31:01 grafana grafana-server[9980]: logger=migrator t=2022-07-04T02:31:01.753003786Z level=info msg=\"alerts found to migrate\" alerts=2831\r\nJul 04 02:31:02 grafana grafana-server[9980]: logger=migrator t=2022-07-04T02:31:02.038920017Z level=error msg=\"Executing migration failed\" id=\"move dashboard alerts to unified alerting\" error=\"failed to migrate alert 1106: folder with id 319 not found\"\r\nJul 04 02:31:02 grafana grafana-server[9980]: logger=migrator t=2022-07-04T02:31:02.039067634Z level=error msg=\"Exec failed\" error=\"failed to migrate alert 1106: folder with id 319 not found\" sql=\"code migration\"\r\nJul 04 02:31:02 grafana grafana-server[9980]: Failed to start grafana. error: migration failed (id = move dashboard alerts to unified alerting): failed to migrate alert 1106: folder with id 319 not found\r\nJul 04 02:31:02 grafana grafana-server[9980]: migration failed (id = move dashboard alerts to unified alerting): failed to migrate alert 1106: folder with id 319 not found\r\n```\r\nI thought it is okay to remove the alert from the database table, but the same problem persists with all the other alerts. I checked the path and it exist and permissions are correct. What is folder id `319` and how can I make sure I checked the right place?\r\n\r\nThanks,\r\nbert\r\n","labels":["effort/small","area/alerting","prio/medium","bot/no new info"]},{"id":57580,"title":"Request failure when request body is too large","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWhen the requested json is too large it causes long blocking and eventually the request fails. If the api is called through curl command, the response is 400 bad request data.This phenomenon occurs when importing dashboards and querying monitoring data through the dashboard\r\n\r\n**What you expected to happen**:\r\n1、Successfully import the dashboard\r\n2、Successfully view monitoring indicators through the dashboard\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nDeploy prometheus, blackbox-exporter, node-exporter, alertmanager, grafana via containers, start and configure data sources, import dashboards by json files\r\n\r\n**Anything else we need to know?**:\r\nI'm deploying a monitoring system for a new project, the previous deployments worked fine, but the new one failed\r\n\r\n**Environment**:\r\n- Grafana version:\r\n- v9.2.1\r\n\r\n- Data source type \u0026 version:\r\n- prometheus v2.33.4 go1.17.7\r\n\r\n- OS Grafana is installed on:\r\n- linux/amd64\r\n\r\n- User OS \u0026 Browser:\r\n- Centos7.6\u0026Google Chrome\r\n\r\n- Grafana plugins:\r\n- Others:\r\n![p1](https://user-images.githubusercontent.com/53945665/197670330-69c06f0d-aab5-41a3-98ed-a9eebf5fa612.png)\r\n![p2](https://user-images.githubusercontent.com/53945665/197670351-ec9abb70-e3ef-44c5-80d9-caf6939c3536.png)\r\n","labels":["area/dashboard","area/backend","area/dashboard/import","bot/no new info"]},{"id":47332,"title":"Displayed values change based on browser window width","body":"**What happened**:\r\nSome values change based on browser window width.\r\n\r\n**What you expected to happen**:\r\nAll values stay the same regardless of browser window width. \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nI've copied some partially redacted panel JSON below:\r\n```\r\n{\r\n  \"datasource\": \"Example\",\r\n  \"fieldConfig\": {\r\n    \"defaults\": {\r\n      \"thresholds\": {\r\n        \"mode\": \"absolute\",\r\n        \"steps\": [\r\n          {\r\n            \"color\": \"green\",\r\n            \"value\": null\r\n          },\r\n          {\r\n            \"color\": \"red\",\r\n            \"value\": 80\r\n          }\r\n        ]\r\n      },\r\n      \"mappings\": [],\r\n      \"color\": {\r\n        \"mode\": \"thresholds\"\r\n      }\r\n    },\r\n    \"overrides\": []\r\n  },\r\n  \"gridPos\": {\r\n    \"h\": 7,\r\n    \"w\": 12,\r\n    \"x\": 0,\r\n    \"y\": 0\r\n  },\r\n  \"id\": 4,\r\n  \"links\": [],\r\n  \"options\": {\r\n    \"reduceOptions\": {\r\n      \"values\": false,\r\n      \"calcs\": [\r\n        \"max\"\r\n      ],\r\n      \"fields\": \"\"\r\n    },\r\n    \"orientation\": \"auto\",\r\n    \"text\": {},\r\n    \"textMode\": \"auto\",\r\n    \"colorMode\": \"value\",\r\n    \"graphMode\": \"area\",\r\n    \"justifyMode\": \"auto\"\r\n  },\r\n  \"pluginVersion\": \"7.5.10\",\r\n  \"targets\": [\r\n    {\r\n      \"alias\": \"Example\",\r\n      \"groupBy\": [\r\n        {\r\n          \"params\": [\r\n            \"$__interval\"\r\n          ],\r\n          \"type\": \"time\"\r\n        },\r\n        {\r\n          \"params\": [\r\n            \"0\"\r\n          ],\r\n          \"type\": \"fill\"\r\n        }\r\n      ],\r\n      \"measurement\": \"/^$service$/\",\r\n      \"orderByTime\": \"ASC\",\r\n      \"policy\": \"default\",\r\n      \"refId\": \"E\",\r\n      \"resultFormat\": \"time_series\",\r\n      \"select\": [\r\n        [\r\n          {\r\n            \"params\": [\r\n              \"\u003cmy_param\u003e\"\r\n            ],\r\n            \"type\": \"field\"\r\n          },\r\n          {\r\n            \"params\": [],\r\n            \"type\": \"sum\"\r\n          }\r\n        ]\r\n      ],\r\n      \"tags\": [\r\n        {\r\n          \"key\": \"env\",\r\n          \"operator\": \"=\",\r\n          \"value\": \"\u003cmy_env\u003e\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"timeFrom\": null,\r\n  \"timeShift\": null,\r\n  \"title\": \"Example 1\",\r\n  \"type\": \"stat\"\r\n}\r\n```\r\n\r\nOnce you've got data coming into that panel (big numbers will be easier to distinguish), fill one entire monitor with that browser window, refresh the dashboard (top right), and copy down that number.\r\n![image](https://user-images.githubusercontent.com/70540353/161780650-b34dada1-5b47-46d0-8a5b-2bf833b4bf9a.png)\r\nfrom query inspector:\r\n![image](https://user-images.githubusercontent.com/70540353/161783102-2376104c-5de4-490a-8a69-1c62a84b7d31.png)\r\n\r\nThen, shrink the window (say, by snapping the window to half of that monitor), and refresh the dashboard again.\r\n![image](https://user-images.githubusercontent.com/70540353/161780971-2d380808-8c07-4603-9088-9ead9ebd7c43.png)\r\nfrom query inspector:\r\n![image](https://user-images.githubusercontent.com/70540353/161782835-0475c98f-91ff-419f-a72c-ea1565481f2f.png)\r\n\r\n\r\n**Anything else we need to know?**:\r\nI've heard of this happening on Windows and in other browsers as well, so I suspect it is not browser-dependent. Also, when I give half-a-monitor to Chrome and the other half to Safari, they show the same number on that panel.\r\n\r\nThis is also not DPI or monitor dependent, as moving a browser window from a 4k monitor to a 1080p monitor (without resizing) results in the same value.\r\n\r\n**Environment**:\r\n- Grafana version: Grafana v7.5.10\r\n- Data source type \u0026 version: InfluxDB (built-in)\r\n- OS Grafana is installed on: CentOS 7\r\n- User OS \u0026 Browser:\r\nMacOS Big Sur: 11.6\r\nChrome Version 99.0.4844.84 (Official Build) (x86_64), and\r\nSafari Version 15.0 (16612.1.29.41.4, 16612)\r\n","labels":["needs more info","area/panel/stat"]},{"id":68678,"title":"Generic OAuth: Tries to access $API_URL/emails and fails if HTML is returned","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\nGeneric OAuth2 with GitLab as backend for OIDC fails with:\r\n```json\r\n{\r\n  \"error\":\"invalid character '\u003c' looking for beginning of value\",\r\n  \"level\":\"error\",\r\n  \"logger\":\"oauth.generic_oauth\",\r\n  \"msg\":\"Error decoding email addresses response\"\r\n}\r\n```\r\n\r\nIt did not request scope \"email\" by mistake, so that information was missing.\r\n\r\nTo validate the user, Grafana tries to access:\r\n- $TOKEN_URL (works),\r\n- $API_URL (aka userinfo, works, but does not return an email field) \r\n- $API_URL/emails (redirects to the sign in page and then it tries to parse html)\r\n\r\nThe complete HTML is dumped into the log as well.\r\n\r\n**What did you expect to happen**:\r\n\r\nLogin in works. It does not break if email is missing.\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Open Grafana and do OAuth\r\n\r\n**Step 2**:\r\n\r\n- Wait for the redirect, it will juust say: `login.OAuthLogin(get info from generic_oauth)`\r\n\n\n### \n# What Grafana version are you using?\n\n\nv9.5.2, aka docker.io/grafana/grafana-oss@sha256:2aafd24a138277142a86b6ed43b7537e1ec8226478f5240c459e9330a3461cdb\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\n_No response_\n\n### Grafana Platform?\n\nDocker\n\n### User's OS?\n\nDebian 12\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["area/auth/oauth","triage/needs-confirmation"]},{"id":47098,"title":"[State Timeline] Absence of data not represented when color scheme is from threshold ","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nWhen using the the state timeline panel and _from thresholds_ color scheme absence of data is represented by the base color rather than no color (i.e. horizontal bar should stop). My use case is to use state timeline to visualize some ratio and I definitely want to distinguish absence of something from 0. \r\n\r\nAssuming your are using Grafana 8.3.4, absence of data is properly represented when using other color scheme (but doesn't work with later releases see https://github.com/grafana/grafana/issues/46805 and all parents issues).\r\n\r\n**What you expected to happen**:\r\n\r\nSee above. \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nhttps://user-images.githubusercontent.com/1764725/161001860-6c0e9496-8923-4074-89cb-f04b4fa35a9f.mp4\r\n\r\n**Anything else we need to know?**:\r\n\r\nWhile I understand this is a beta panel, state timeline seems to have many issues and would benefit from some more QA.\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.4 (cannot use later version because of https://github.com/grafana/grafana/issues/46805 which is still not fixed in any subsequent release)\r\n- Data source type \u0026 version: Prometheus\r\n- User OS \u0026 Browser: Firefox\r\n","labels":["needs more info","area/value-mapping","area/panel/state-timeline"]},{"id":64913,"title":"Grafana 9.3.8 upgrade to 9.4.x issue with empty fields in a table","body":"Hello,\r\nI have this table in Grafana that I’ve been using for a couple of years now. The data is pulled by Telegraf into InfluxDB (1.8) and shown in Grafana like below. We are using v9.3.8 (Docker). If we upgrade to 9.4.x then the lines in the table that have empty cells are now completely removed. For example in the total of 4 lines below highlighted will no longer be present as they have no value under ‘Maint Voltage’. Grafana 9.4.x only wants to show lines in a table that have values it seems, if one value is missing the entire line is removed from the table.\r\n\r\nForum post:\r\nhttps://community.grafana.com/t/grafana-9-3-8-upgrade-to-9-4-x-issue-with-empty-fields-in-a-table/83859\r\n\r\nImage of table\r\nhttps://i.imgur.com/R1OSxPp.png\r\n\r\nAny ideas what could be doing this or is it a bug or new expected feature?","labels":["datasource/InfluxDB","area/panel/table","area/docker","triage/needs-confirmation"]},{"id":66511,"title":"Datasource variables are no longer implicit","body":"**What happened**:\r\n\r\nI recently updated my Grafana instance from 9.0.2 to 9.4.7. When I did this, my queries no longer worked if the database wasn't explicitly specified in the query. Previously, the query would succeed by referencing the datasource variable and the database name would be inferred. This no longer happens and I must specify that the variable be used in the query by using `$Database.`.\r\n\r\n**What you expected to happen**:\r\n\r\nMy existing dashboards would work correctly upon updating, or this breaking change would be more clearly communicated in the docs. I searched \"What's New\" for every version beyond 9.0 and did not see this.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nCreate a query that depends on a data source variable to specify the database and do not put it in the query. The query will fail.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**: RHEL 8\r\n- Grafana version: 9.0.2 -\u003e 9.4.7\r\n- Data source type \u0026 version: MySQL\r\n- OS Grafana is installed on: RHEL8\r\n- User OS \u0026 Browser: Firefox Windows 10\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/dashboard/templating","needs more info"]},{"id":63187,"title":"Image rendering failed : duplicate dashboard uid","body":"**What happened**:\r\nWe have several image rendering failed on alerting in logs :\r\n```\r\nlogger=ngalert t=2023-02-09T13:39:18.504783417+01:00 level=warn msg=\"Failed to take an image\" dashboard=bsFnDY27k panel=51 error=\"failed to take screenshot: failed to send request to remote rendering service: Get \\\"http://XXXX:8081/render?deviceScaleFactor=1.000000\u0026domain=YYYY\u0026encoding=\u0026height=500\u0026renderKey=nX9vHd73LDmTRnzbgs5jIZW1BkPYAcHC\u0026timeout=10\u0026timezone=\u0026url=http%3A%2F%2FYYYY%3A3000%2Fd-solo%2FbsFnDY27k%2Ftest-bandwidth-controller%3ForgId%3D4454%26panelId%3D51%26render%3D1\u0026width=1000\\\": context deadline exceeded\"\r\n```\r\n\r\nWe can see in the log that it is trying to create an image of :\r\npanel : 51\r\ndashboard : bsFnDY27k \r\norgId : 4454\r\n\r\n\r\nAfter checking there is indeed no panel 51 on this dashboard.\r\nBut there is also no alert rule configured on org 4454.\r\n```\r\nselect * from alert_rule where org_id = 4454;\r\nEmpty set (0.00 sec)\r\n```\r\n\r\nIf I try to search the alert rule using the dashboard uid and the panel, I found the alert rule but on another organization \r\n```\r\nselect id, org_id, dashboard_uid, panel_id from alert_rule where dashboard_uid = 'bsFnDY27k' and panel_id = 51;\r\n+-----+--------+---------------+----------+\r\n| id  | org_id | dashboard_uid | panel_id |\r\n+-----+--------+---------------+----------+\r\n| 344 |    731 | bsFnDY27k     |       51 |\r\n+-----+--------+---------------+----------+\r\n```\r\n\r\nSo I have an alert rule configured for org : 731, dashboard : bsFnDY27k and panel : 51\r\nBut it tries to take a screenshot of org : 4454, dashboard: bsFnDY27k and panel : 51\r\n\r\n\r\nNote that I have multiple dashboards with the same uid : bsFnDY27k \r\n```\r\nselect org_id, uid from dashboard where uid = 'bsFnDY27k';\r\n+--------+-----------+\r\n| org_id | uid       |\r\n+--------+-----------+\r\n|    731 | bsFnDY27k |\r\n|   4454 | bsFnDY27k |\r\n+--------+-----------+\r\n```\r\n\r\n\r\n\r\n**What you expected to happen**:\r\nGrafana should not lost track of the organization.\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.10\r\n- OS Grafana is installed on: RHEL8\r\n- Others: remote image renderer v 3.6.3\r\n","labels":["type/bug","area/alerting","area/image-rendering"]},{"id":84724,"title":"Table: \"Organize fields by name\" transformation order rearranges after reloads","body":"### What happened?\r\n\r\nI have a dashboard that contains rows each with a table per application. The tables uses a InfluxDB connection to get data and the result is re-ordered by using transformation (\"organize fields by name\") to get the wished order.\r\nWhen opening the transformation tab and pressing the browser-reload the order changes which causes in a table with a wrong order if the columns.\r\n\u003cimg width=\"635\" alt=\"image\" src=\"https://github.com/grafana/grafana/assets/41045137/e5a7a4dd-5d40-4ea6-8852-5c3dc5baa964\"\u003e\r\nThe bahaviour changes also within the rows \u0026 table visualization - means, first app with a row  and a table shows the wrong order and the second app with a row and a table shows the right one.\r\n\r\n### What did you expect to happen?\r\n\r\nI expect, that the defined order in the transformation tab remains the same for all rows after every reload.\r\n\r\n### Did this work before?\r\n\r\nNever experienced the behaviour before.\r\n\r\n### How do we reproduce it?\r\n\r\n1. Dashboard with a table per app in a row (row option)\r\n2. changing the order by using a transformation\r\n3.pressing the reload of the browser \r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.3.3\r\nOS: Linux\r\nBrowser: chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### Datasource(s)?\r\n\r\nInfluxDB","labels":["area/transformations","triage/needs-confirmation"]},{"id":79867,"title":"Alerting: Performance issues with Alert list controls","body":"### What happened?\n\nWhen I open the Alert list control and check the browser network, I find that I will access \"/app/rules/grafana/app/v1/rules? Subtype=Cortex\". This link will access all the alarm rule content, currently 18.51KB, but if you create many rules and load all the rules, there will be performance issues.\n\n### What did you expect to happen?\n\nCan the Alert list control avoid loading all alarm rules?\n\n### Did this work before?\n\nI'm not sure, I haven't used the Alert list control before.\n\n### How do we reproduce it?\n\n1. Create a dashboard and add an Alert list control;\r\n2. Open the dashboard, browser - network, and view \"/app/rules/grafana/app/v1/rules? Subtype=Cortex\" resource.\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana:10.3\r\nOS:macos\r\nBrowser:safari\r\n\n\n### Grafana platform?\n\nA downloaded binary\n\n### Datasource(s)?\n\n_No response_","labels":["needs more info","area/alerting"]},{"id":69462,"title":"Plugin Install: app_tls_skip_verify_insecure is ignored at Grafana startup","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\n  - Grafana container exits with an error code when GF_INSTALL_PLUGINS, GF_PLUGIN_URL, GF_PLUGINS_APP_TLS_SKIP_VERIFY_INSECURE are set\r\n  - Error: tls: failed to verify certificate: x509: certificate signed by unknown authority\r\n\r\n**What did you expect to happen**:\r\n  - TLS should be ignored when app_tls_skip_verify_insecure is set to true\r\n  - Grafana installs the plugin zip file stored in the GF_INSTALL_URL\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\n- Set  GF_PLUGIN_URL to s3 bucket location\r\n- GF_INSTALL_PLUGINS to \"grafana-athena-datasource\"\r\n- GF_PLUGINS_APP_TLS_SKIP_VERIFY_INSECURE to \"true\"\r\n\r\n**Step 2**:\r\n\r\n- Redeploy helm chart\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\nv9.5.2\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\r\n\r\n### Grafana Platform?\r\n\r\nKubernetes\r\n\r\n### User's OS?\r\n\r\nAlpine Linux\r\n\r\n### User's Browser?\r\n\r\n_No response_\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\ngrafana-athena-datasource\r\n\r\n### Anything else to add?\r\n\r\n\r\nI am running in Air-gap environment.","labels":["needs more info","area/docker"]},{"id":79987,"title":"grafana alerting Groups: not possible to search by label.","body":"### What happened?\n\nI tried to filter alerts on grafana alerting under groups. like the info button states, I assume I'm able to search for alerts with a specific label.\r\n![image](https://github.com/grafana/grafana/assets/109516706/421ba6a1-9c72-418d-ad53-d33827390b4d)\r\nstrangly enough this does not do anything. I'm using an alertmanager instance.\r\n\n\n### What did you expect to happen?\n\nI excpect to be able to search on a certain label.\n\n### Did this work before?\n\nnever tested it before.\n\n### How do we reproduce it?\n\n1. go to grafana\r\n2. add an alertmanager with alerts\r\n3. try to search for alerts with a specific label.\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.2.2\r\nOS: windows server 2022\r\nBrowser: google chrome 118\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nalertmanager","labels":["type/bug","area/alerting","area/frontend"]},{"id":61699,"title":"Grafana service is running but Grafana UI console is down.","body":"I can see the grafana service as running but in logs i see this error below\r\n\r\nlogger=ngalert t=2023-01-18T15:09:04.451970433Z level=error msg=\"failed to fetch alert rule namespace\" err=\"folder not found\" uid=aDAiOei4k org=8 namespace_uid=HHAiO6iVz\r\nlogger=ngalert t=2023-01-18T15:09:04.452937934Z level=error msg=\"failed to fetch alert rule namespace\" err=\"folder not found\" uid=aDAiOei4k org=8 namespace_uid=HHAiO6iVz\r\nlogger=ngalert t=2023-01-18T15:09:04.453236271Z level=error msg=\"failed to fetch alert rule namespace\" err=\"folder not found\" uid=aDAiOei4k org=8 namespace_uid=HHAiO6iVz\r\nlogger=ngalert uid=aDAiOei4k org=8 t=2023-01-18T15:09:04.45331902Z level=error msg=\"evaluation failed after all retries\" err=\"folder not found\"\r\nlogger=ngalert uid=ESAid6m4z org=5 version=2 attempt=0 now=2023-01-18T15:09:00Z t=2023-01-18T15:09:04.586320655Z level=error msg=\"failed to evaluate alert rule\" results=\"[{Instance: State:Error Error:failed to execute conditions: failed to execute query : metric request error: \\\"AccessDenied: User: arn:aws:sts::855289730729:assumed-role/gehc-prod-noc-role/i-0871c5b0a81b39ffb is not authorized to perform: sts:AssumeRole on resource: arn:aws:iam::674009120756:role/gehc-noc\\\\n\\\\tstatus code: 403, request id: 8550d304-c0c6-4642-b9a1-3ad1980e080c\\\" EvaluatedAt:2023-01-18 15:09:00 +0000 UTC EvaluationDuration:4.586312283s EvaluationString: Values:map[]}]\" duration=7.092424ms\r\n\r\nARN role which it refer to account 674009120756 is already suspended but still its trying to connect to this account.\r\n\r\n","labels":["area/alerting","area/backend","bot/no new info"]},{"id":64079,"title":"Slack notifications are repeated in Mattermost","body":"**What happened**:\r\nWhen using the Slack integration of Grafana Alerting in Mattermost, alerts are repeated according to the group interval, as Grafana incorrectly assumes that the notification was not sent successfully. Issue exists since upgrading Grafana from an older version to v9.4.2.\r\n```\r\nlogger=ngalert.notifier.slack t=2023-03-02T19:45:11.745411891Z level=error msg=\"Failed to unmarshal response\" body=ok err=\"invalid character 'o' looking for beginning of value\"\r\nlogger=ngalert.notifier.slack t=2023-03-02T19:45:11.745663447Z level=error msg=\"Failed to send Slack message\" err=\"failed to unmarshal response: invalid character 'o' looking for beginning of value\"\r\nlogger=alertmanager org=1 t=2023-03-02T19:45:11.745821515Z level=error component=alertmanager orgID=1 component=dispatcher msg=\"Notify for alerts failed\" num_alerts=2 err=\"Slack/slack[1]: notify retry canceled due to unrecoverable error after 1 attempts: failed to send Slack message: failed to unmarshal response: invalid character 'o' looking for beginning of value\"\r\n```\r\nThe following screenshot shows the error for a test notification:\r\n![Screenshot 2023-03-02 at 20 32 35](https://user-images.githubusercontent.com/29522608/222562642-fcd20dd6-1e0f-4fb4-9de3-75f3a8f9e7a7.jpg)\r\n\r\n**Environment**:\r\n- Grafana version: v9.4.2\r\n- Mattermost version: v7.8.0","labels":["type/bug","area/alerting","area/alerting/notifications"]},{"id":69257,"title":"SMTP: 535 Error for password with Special Characters","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n  - When configured SMTP with the Email Server, User name and password with Speacial characters @, $, !, getting 535 Authentication failed message. Tried to enclose the password in double quotes which not helped.\r\n\r\n**What did you expect to happen**:\r\n\r\n  - SMTP Should be enabled and authenticated\r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Edit Grafana SMTP settings and deploy the grafana.\r\n\r\n**Step 2**:\r\n\r\n- Go to Contact points\r\n\r\n**Step 3**:\r\n\r\n- Add a email address and try to send the email.\r\n\n\n### \n# What Grafana version are you using?\n\n\nv 9.2.4 (64017e8ca6)\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nDocker\n\n### User's OS?\n\n_No response_\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["area/mailing","triage/needs-confirmation"]},{"id":60861,"title":"Limit Transform shows the oldest rows by default ","body":"**What happened**:\r\nUsing the Limit transform, the new data are deleted while the old ones are kept. In this way this transformation is is not usable (or at least I cannot imagine a real situazione where old data are needed rather that the new ones)\r\n\r\n**What you expected to happen**:\r\nThat just the N new data are kept, while the old ones are deleted. The best thing could be to insert a new control that allow to decide which data to keep: new or old \r\n\r\n**Environment**:\r\n- Grafana version: 9.3.2\r\n- Data source type \u0026 version: mqtt\r\n- OS Grafana is installed on: qindows 11\r\n- User OS \u0026 Browser: Chrome\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/feature-request","prio/low","needs investigation","area/transformations"]},{"id":48751,"title":"ValueMapping by Regex: improve handling of newlines","body":"**What happened**:\r\nWhen you set up regex replace:\r\n![image](https://user-images.githubusercontent.com/43816134/166898442-c9827e97-f518-47be-8e20-0f577e914f5c.png)\r\n\r\nNot all rows are replaced:\r\n![image](https://user-images.githubusercontent.com/43816134/166898781-bf195fc5-cfc6-4153-9a2f-a7b9a80617b2.png)\r\n\r\n**What you expected to happen**:\r\nRegex does not fail on some rows: (e.g. 3rd row - manually rewrited)\r\n![image](https://user-images.githubusercontent.com/43816134/166899124-52228972-0359-484b-9b61-c67e473b45a2.png)\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n- make Table Visualization Overrides - regex replace\r\n- check that **\\n** is present in some background data for which regex replace fails\r\n\r\n**Anything else we need to know?**:\r\nIf **\\n** is in background data, regex replace fails:\r\n![image](https://user-images.githubusercontent.com/43816134/166900003-d3ee7cce-f71e-4b73-b63a-d6948b2f7168.png)\r\n\r\nIf **\\\\\\n** is in background data, regex replace works:\r\n![image](https://user-images.githubusercontent.com/43816134/166903459-406e3cc8-283f-42f2-bb9c-21434cf61c0e.png)\r\n\r\n**Environment**:\r\n- Grafana version: Grafana v8.3.5 (a53fcac7b1) and Grafana v8.5.0 (6134e3cf35)\r\n- Data source type \u0026 version: Elasticsearch 7.17.0\r\n- OS Grafana is installed on: Kubernetes - official Grafana docker image\r\n- User OS \u0026 Browser: Microsoft Windows [Version 10.0.19042.1645] \u0026 Microsoft Edge Version 101.0.1210.32 (Official build) (64-bit)\r\n- Grafana plugins: -\r\n- Others: -\r\n","labels":["type/feature-request","area/value-mapping"]},{"id":76795,"title":"Grafana can not be restarted if there're any provisioning alert rules","body":"### What happened?\n\nSo, in Grafana it's possible to add alert rules from [provisioning files](https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/).\r\nThis is a great feature that can help us to use GitOps approach.\r\nHowever, it turned out that when you're trying to restart Grafana, you're getting an error and Grafana cannot start.\r\nThis makes this whole idea of using provisioning files for alerts not usable.\r\nThe error seems to be the same as in https://github.com/grafana/grafana/issues/75877\r\n```\r\nlogger=provisioning.alerting t=2023-10-19T08:14:47.234827703Z level=info msg=\"starting to provision alerting\"\r\nError: ✗ alert rules: failed to create new rule versions: UNIQUE constraint failed: alert_rule_version.rule_org_id, alert_rule_version.rule_uid, alert_rule_version.version\r\n```\n\n### What did you expect to happen?\n\nGrafana restarts without errors.\n\n### Did this work before?\n\nNope.\n\n### How do we reproduce it?\n\n1. Add a file with an alert [using provisioning](https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/file-provisioning/#provision-alert-rules)\r\n2. Start Grafana\r\n3. Alert will be added and Grafana will start without errors\r\n4. Restart Grafana\r\n5. Grafana will not be able to start\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: v10.0.3\r\nOS: ubuntu 22.04\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\n_No response_","labels":["needs more info","area/provisioning"]},{"id":59293,"title":"[Dashboard - Settings ] Dashboards: Cannot change folder and save. No changes detected.","body":"**What happened**:\r\nEdited an existing dashboard in no folder (General) and set it to an existing folder, saving is not possible as UI detects no changes.\r\n\r\n**What you expected to happen**:\r\nSaving dashboard into desired folder\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n- Open existing dashboard which is in no folder (General)\r\n- Set an existing folder through Dashboard Settings -\u003e General -\u003e Folder\r\n- Click in \"Save dashboard\" button or go back to dashboard main view and use icon (same effect)\r\n- Find saving is unavailable (msg: No changes to save).\r\n\r\n\r\n**Environment**:\r\n- Grafana version: Grafana 9.2.1-cab7049\r\n- User OS \u0026 Browser: macOS, Google Chrome\r\n","labels":["type/bug","area/dashboard","team/grafana-dashboards","prio/future"]},{"id":77798,"title":"Table Panel: Column resizing doesn't disable text selection in Safari and can hang page","body":"### What happened?\n\nI tried to change the column width on the table for a few columns the page seems to stop responding to mouse clicks and need to be reloaded to use it again.  I have checked a few other tables and get the same issue .I found the issue with Grafana 10 version only.In Grafana version 9 this issue does not exists.\n\n### What did you expect to happen?\n\nColumn resize should happen correctly without any page issue\n\n### Did this work before?\n\nYes,In Grafana version 9 this issue does not exists.\n\n### How do we reproduce it?\n\n1.Install grafana latest version (any version above 10)\r\n2.Create one sample table\r\n3.Try to change the column width for some cloumns\r\n4.Page stop responding and need to reload again to use it again\r\n\n\n### Is the bug inside a dashboard panel?\n\nYes,It is Table panel\n\n### Environment (with versions)?\n\nGrafana: Version 10 and above\r\nOS: macOS\r\nBrowser: Safari,Chrome\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\nNo","labels":["area/panel/table","triage/needs-confirmation"]},{"id":44408,"title":"no color of Node graph with mysql","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nnode graph with mysql is not work.\r\n\u003cimg width=\"1084\" alt=\"스크린샷 2022-01-25 오후 3 01 22\" src=\"https://user-images.githubusercontent.com/45954551/150920465-e578791a-afce-4308-b532-80f53dbd98c9.png\"\u003e\r\n\u003cimg width=\"350\" alt=\"스크린샷 2022-01-25 오후 3 00 57\" src=\"https://user-images.githubusercontent.com/45954551/150920471-f6f546c9-9312-45c1-b2c9-9a507b67991e.png\"\u003e\r\n\r\n**What you expected to happen**:\r\n2 of arc are drawn different colors.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nAccording to screenshots.\r\n\r\n**Anything else we need to know?**:\r\nNone\r\n\r\n**Environment**:\r\n- Grafana version: 8.2.3\r\n- Data source type \u0026 version: mysql\r\n- OS Grafana is installed on: ubuntu\r\n- User OS \u0026 Browser: chrome MAC OS\r\n- Grafana plugins: None\r\n- Others: None\r\n","labels":["needs more info","area/datasource/frontend","bot/no new info","area/panel/node-graph"]},{"id":58496,"title":"Garbled characters when typing Metrics.","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n![grafanabug](https://user-images.githubusercontent.com/53630996/200719904-8cc3eb1b-3801-4c05-888b-b7d711b1d67e.gif)\r\n\r\n**What happened**: Garbled characters when typing Metrics. Seems a Character set problem. Not sure it whether a grafana bug or my environment issue.\r\nJust Metrics textbox, every thing good with other functions.\r\nI can't write/edit, but when I wrote promQL in vscode and paste in Metrics textbox, it works fine.\r\n\r\n\r\n**What you expected to happen**: No Garbled characters.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: Garbled characters when typing Metrics. But everything all right with other functions.\r\n\r\n**Anything else we need to know?**: \r\n\r\n**Environment**:\r\n  OS: windows 10\r\n  Browser:Chrome 107.0.5304.88\r\n\r\n- Grafana version:   v7.3.6 (ea06633c34)\r\n- Data source type \u0026 version: Prometheus with promQL \r\n- OS Grafana is installed on: Windows 10\r\n- User OS \u0026 Browser: Chrome 107.0.5304.88\r\n- Grafana plugins: no plugins \r\n- Others:\r\n","labels":["datasource/Prometheus","area/frontend"]},{"id":50895,"title":"8.5.5 to 9.0.0 - Broken Dashboard (Query Error: 500 Internal Server Error) with Expression Operation","body":"**What happened**:\r\nUpgraded from 8.5.5 to 9.0.0.\r\n\r\n**What you expected to happen**:\r\nAll dashboards to load as expected.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nDashboard with custom expression in panel causes a Query Error: 500 Internal Server Error.\r\n\r\n**Anything else we need to know?**:\r\nIt would be good to know how to properly downgrade from 9.0.0 back to 8.5.5 until this issue is resolved.  When I tried to downgrade to 8.5.5 using `sudo dpkg -i grafana_8.5.5_armhf.deb grafana` would not load after.\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.0\r\n- Data source type \u0026 version: InfluxDB v1.8.10 (git: 1.8 688e697c51fd)\r\n- OS Grafana is installed on: RaspberryPi Buster\r\n- User OS \u0026 Browser: Windows 10 / Firefox\r\n- Grafana plugins: None.\r\n- Others:\r\n![grafana_error_20220615](https://user-images.githubusercontent.com/52629807/173875989-5a480bc8-93f3-4abe-93a0-1a4d7c3e9828.png)\r\n\r\n","labels":["area/expressions"]},{"id":51271,"title":"Error rendering dashboard after upgrading to Grafana 9","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nThe following error message is displayed when navigating to Grafana home page:\r\n\r\nTypeError: Object(o.getColorForTheme) is not a function. (In 'Object(o.getColorForTheme)(l,i)', 'Object(o.getColorForTheme)' is an instance of Object)\r\n\r\nt@\r\nWithTheme(undefined)\r\n\r\n**What you expected to happen**:\r\n\r\nDashboard to be displayed.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nError started after upgrading to Grafana 9.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.1\r\n- Data source type \u0026 version: \r\n- OS Grafana is installed on: Raspbian Linux 10\r\n- User OS \u0026 Browser: Mac OS 12.4, Safari\r\n- Grafana plugins: DK.\r\n- Others:\r\n","labels":["needs more info","area/plugins"]},{"id":69885,"title":"Contact Point: View notification health","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n  - Contact Point does not show the health column after Grafana upgrade from 8.5.x to 9.2.7.\r\n\r\n**What did you expect to happen**:\r\n\r\n  - It should show the column as Grafana v9 release.\r\n\n\n### \n# How do we reproduce it?\n\n\n\r\n- Upgrading Grafana 8.5 --\u003e 9.2.7\r\n\r\n\n\n### \n# What Grafana version are you using?\n\n\nv9.2.7\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nKubernetes\n\n### User's OS?\n\n_No response_\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["area/alerting","needs investigation"]},{"id":64966,"title":"\"Show Context\" doesn't show surrounding lines when multiple lines have the same timestamp","body":"**What happened**:\r\nWe're using Loki to aggregrate logs for our Jenkins builds which are scraped by FluentBit. It's not uncommon for multiple lines to have the same timestamp to the millisecond (which is the precision they are included in Jenkins logs) e.g. stack traces. \r\n\r\nWhen viewing these logs in the Explore mode in Grafana, it seems that intended order of the lines are preserved.  For example, I created a Jenkins job that wrote 100 lines to a file (prefixed with a random number to show the Explore mode wasn't just sorting them) and ran `cat` on the file. When querying the logs in Grafana, they appear in the order I would expect:\r\n\r\n![image](https://user-images.githubusercontent.com/12222103/225940957-de716b2b-84c7-4a8c-a540-86228d035fbf.png)\r\n\r\nHowever, if I filter for a specific line e.g. `|= \"This is line 20\"` and then click \"Show context\", the surrounding lines are not the same as what is displayed when not filtering.\r\n\r\n![image](https://user-images.githubusercontent.com/12222103/225941376-d4f23bf2-da0a-4ef2-b1e3-0957a2f2dee6.png)\r\n\r\n**What you expected to happen**:\r\n\"Show context\" should show the same surrounding lines as when the log is not filtered.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nFilter on a line that has the same timestamp as other lines and click \"Show Context\"\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.3\r\n- Data source type \u0026 version: Loki 2.6.1\r\n- OS Grafana is installed on: Official Docker image\r\n- User OS \u0026 Browser: macOS 12.6 \u0026 Firefox 111.0\r\n- Grafana plugins: None\r\n- Others:\r\n","labels":["area/docker","datasource/Loki","triage/needs-confirmation"]},{"id":52930,"title":"Panel with Datasource \"-- Dashboard --\" in repeated row is hard linked to first row data","body":"**Setup**: I have a dashboard with 2 Graph Panels in a row. The row will be repeated for my variable $volume. The second panel in the row has a datasource \"-- Dashboard --\" using results from first panel.\r\n\r\n**What happened**: In all rows the second panel is displaying the data from the first panel in row 1. The first panel in each row shows correct data. When filtering the dashboard to show only one row the second panel always shows the correct data.\r\n\r\n**What you expected to happen**: When having multiple rows the second panel should always display the data of the first panel of the same row.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: \r\n\r\n- Create a new dashboard with variable $row with values 1, 2, and 3 and \"Multi-value\" and \"All\" Options\r\n- Create a row repeated by $row\r\n- Create a panel \"Panel1\" in the row with with a PostgreSQL  as database with query  \"SELECT  $__time(current_timestamp  - interval '10m'), $row::int as row\", Display as \"Bars\"\r\n- Create a second panel in the same row with Datasource = \"-- Dashboard --\" and Panel1 as result-source.\r\n- Both panels with display the same data\r\n- When selecting \"All\" for parameter \"row\" then the Panel1 will show a different value for each row but Panel2 will display value \"1\" for all three rows.\r\n\r\n_Panel with \"all\" Rows_:\r\n![grafik](https://user-images.githubusercontent.com/63095974/181485851-b5d7d244-0539-4b29-8a0f-daa2539f5d9d.png)\r\n\r\n_Panel with only Row 2_:\r\n![grafik](https://user-images.githubusercontent.com/63095974/181486159-309e0ee0-bbf7-4b84-90c6-4b0817f5f8f5.png)\r\n\r\n_Source Code_:\r\n[Panel_json.txt](https://github.com/grafana/grafana/files/9208325/Panel_json.txt)\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: v.7.5.11\r\n- Data source type \u0026 version: PostgreSQL\r\n- OS Grafana is installed on: docker container\r\n\r\n- User OS \u0026 Browser: Windows 11/ Firefox 103.0\r\n- Grafana plugins: Only Core Plugins\r\n- Others:\r\n","labels":["type/feature-request","area/dashboard","area/templating/repeating","team/grafana-dashboards"]},{"id":78094,"title":"Time Series panel: Time format override does not work","body":"### What happened?\n\nI want to reformat time format on xaxis by using override. It does not work for time series panel. It works for bar panerl.\r\n![image](https://github.com/grafana/grafana/assets/92076711/5237cae1-83df-4158-abd3-57235376dae1)\r\n\n\n### What did you expect to happen?\n\nThe time format to show \"MM-DD\" (Month num - Day num)\n\n### Did this work before?\n\nNever worked\n\n### How do we reproduce it?\n\n1. See sceenshot\r\n2.\r\n3.\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: Grafana v10.1.0 (838218ba20)\r\nEnterprise version\r\n\r\n\n\n### Grafana platform?\n\nOther\n\n### Datasource(s)?\n\n_No response_","labels":["type/bug","area/panel/timeseries","kind/enhancement","triage/needs-confirmation"]},{"id":73256,"title":"explore: many gf-show-context.svg request","body":"### What happened?\n\nquery loki log will generate many `/public/img/icons/custom/gf-show-context.svg` request\r\n![image](https://github.com/grafana/grafana/assets/1570732/cc48c03e-0e39-4560-9af8-55c1ff7d9ecd)\r\n\r\n\r\n\r\n\n\n### What did you expect to happen?\n\nthere should 1  gf-show-context.svg request\n\n### Did this work before?\n\nin grafana 9.4\r\nther is no problem\n\n### How do we reproduce it?\n\njust use grafana query loki log\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.0.3\r\nLoki: 2.8.3\r\nOS: ubuntu 22.04\r\nBrowser: chrome\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\n_No response_","labels":["needs more info","area/explore","datasource/Loki","triage/needs-confirmation"]},{"id":49515,"title":"range annotations no longer works","body":"**What happened**:\r\nIn the past, Grafana graphs used to combine continues annotations into a range annotation now it is shown as individual annotations:\r\n![image](https://user-images.githubusercontent.com/2118079/170075628-5b5f6e65-73f3-4c2e-b2f3-28523e7afc62.png)\r\n\r\n**What you expected to happen**:\r\nIt should have looked like:\r\n![image](https://user-images.githubusercontent.com/2118079/170075681-ba44a5ad-4579-478d-a405-c73e600e6b4e.png)\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nadd an annotation that happens continuesly\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.4\r\n- Data source type \u0026 version: prometheus\r\n- OS Grafana is installed on: docker\r\n- User OS \u0026 Browser: chrome on linux\r\n- Grafana plugins: NA\r\n- Others:\r\n","labels":["type/bug","area/annotations","area/panel/timeseries"]},{"id":88381,"title":"Variables : Bug to bring the tree labels in variables, it is not working correlation between variables","body":"### What happened?\n\nWhen I have more than one variable, the api does not correlate the variables that should be brought\r\n\r\nIn exemplo I call the API:\r\n\r\n/resources/api/v1/label/instance/values?match%5B%5D=%7Bapplication%3D%22processor-main%22%7D\u0026start=1716896968\u0026end=1716900568\r\n\r\nbut the answer brings me without any filter\n\n### What did you expect to happen?\n\nWhen I selected a Cluster variable, it brought me the instances correlated to the respective cluster\n\n### Did this work before?\n\nYes, in version v10.4.3 thats problem doesn't happen.\n\n### How do we reproduce it?\n\n1. Create two variables one dependent on the other, in the grafana 11.0.0 version, they will not work as they should\n\n### Is the bug inside a dashboard panel?\n\nNo.\n\n### Environment (with versions)?\n\nGrafana: 11.0.0\r\nOS: Windows 11\r\nBrowser: Chrome\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nprom/prometheus:v2.17.2","labels":["area/dashboard/templating","triage/needs-confirmation"]},{"id":46870,"title":"grafana's log pannel displays 'Data is missing a string field' when no data found in loki query","body":"**Steps to reproduce**:\r\ncreate a logs panel and query loki for non-existing data\r\n**Actual Result**:\r\n\u003cimg width=\"1610\" alt=\"Screen Shot 2022-03-23 at 10 09 16\" src=\"https://user-images.githubusercontent.com/4352719/159658937-030454d7-7a9c-4583-9a87-6ac525aa3735.png\"\u003e\r\n\r\n\r\n\r\n**Expected Result**\r\nempty panel or more descriptive message\r\n\r\n\r\n**Environment**:\r\n- Grafana version: v8.4.2\r\n- Data source type \u0026 version: Loki 2.3.0\r\n- User OS \u0026 Browser: \r\n- Others:\r\n","labels":["needs more info","datasource/Loki","area/panel/logs"]},{"id":63184,"title":"Issues with Oauth login (GitHub Enterprise)","body":"**What happened**:\r\nIm currently trying to enable oauth login for grafana https://ops.dp.app.corpintra.net/grafana but it does not work.\r\nHeres my configuration:\r\n\r\nauth.github:\r\nenabled: true\r\nallow_sign_up: true\r\nclient_id: 0fdf5c35d8526383c251\r\nclient_secret: xxx\r\nscopes: user:email,read:org\r\nauth_url: https://git.i.mercedes-benz.com/login/oauth/authorize\r\ntoken_url: https://git.i.mercedes-benz.com/login/oauth/access_token\r\napi_url: https://git.i.mercedes-benz.com/api/v3/users\r\nteam_ids: 4370\r\n\r\nAnd the error message is:\r\n```\r\nlogger=context userId=0 orgId=0 uname= t=2023-02-09T09:58:03.604512408Z level=error msg=\"login.OAuthLogin(get info from github)\" error=\"error unmarshalling user info: json: cannot unmarshal array into Go value of type struct { Id int \"json:\\\"id\\\"\"; Login string \"json:\\\"login\\\"\"; Email string \"json:\\\"email\\\"\"; Name string \"json:\\\"name\\\"\" }\"\r\nlogger=context userId=0 orgId=0 uname= t=2023-02-09T09:58:03.604983445Z level=error msg=\"Request Completed\" method=GET path=/login/github status=500 remote_addr=192.168.0.201 time_ms=265 duration=265.920832ms size=1365 referer=https://git.i.mercedes-benz.com/ handler=/login/:name\r\n```\r\n\r\n**What you expected to happen**:\r\nThe oauth login should work.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nI guess that the issue can be reproduced with github enterprise.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: v9.2.5\r\n- Data source type \u0026 version: Prometheus\r\n- OS Grafana is installed on: K8s\r\n- User OS \u0026 Browser: it does not matter\r\n- Grafana plugins: N/A\r\n- Others:\r\n","labels":["area/auth/oauth","triage/needs-confirmation"]},{"id":68237,"title":"MSSQL Datasource not working with Public Dashboards","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\nI have a dashboard using MSSQL Datasource to render some charts.\r\nThe dashboards works perfectly.\r\nWhen I share it publicly with a link, no data is showing up and an error is raised with \"Internal Server Error\". \r\n\r\nThe grafana logs:\r\n\r\n```\r\nlogger=publicdashboards.service t=2023-05-10T14:50:35.425490743Z level=error msg=\"Error querying datasources for public dashboard\" error=\"data source not found\" datasources=[mssql]\r\n\r\nlogger=context userId=1 orgId=1 uname=admin t=2023-05-10T14:50:35.425618937Z level=error msg= error=\"unexpected error type [*errors.errorString]: data source not found\" remote_addr=[redacted] traceID=\r\n\r\nlogger=context userId=1 orgId=1 uname=admin t=2023-05-10T14:50:35.42571335Z level=error msg=\"Request Completed\" method=POST path=/api/public/dashboards/[redacted]/panels/5/query status=500 remote_addr=[redacted] time_ms=403 duration=403.946117ms size=48 referer=\"https://[redacted]/public-dashboards/[redacted]?orgId=1\u0026refresh=5m\" handler=/api/public/dashboards/:accessToken/panels/:panelId/query\r\n```\r\n\r\n**What did you expect to happen**:\r\n\r\nThe dashboard should work when shared publicly.\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\n- Provision a MSSQL Server datasource using config file.\r\n\r\n**Step 2**:\r\n\r\n- Create a dashboard and insert a chart using the MSSQL datasource.\r\n\r\n**Step 3**:\r\n\r\n- Share the dashboard publicly. You should see Internal Server Error.\r\n\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\nv9.5.1 (bc353e4b2d)\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\n_No response_\r\n\r\n### Grafana Platform?\r\n\r\nKubernetes\r\n\r\n### User's OS?\r\n\r\nMacOS Big Sur\r\n\r\n### User's Browser?\r\n\r\nGoogle Chrome\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\nMicrosoft SQL Server\r\n\r\n### Anything else to add?\r\n\r\nBoth datasource and dashboards are actually provisioned.\r\nWe tested by creating it manually and we face the same issue.","labels":["needs more info","area/public-dashboards"]},{"id":54931,"title":"grafana/ui – Panel Plugin: Not able to `enablePagination` for Table component","body":"**What happened**:\r\nI'm currently trying to create a `Panel Plugin` that creates a `@grafana/ui` Table with Pagination. I am following the Table Docs in [Grafana Labs storybook](https://developers.grafana.com/ui/latest/index.html?path=/story/buttons-pagination--with-pages) and do not see any table pagination displayed when I set `enablePagination={true}`\r\n\r\n**What you expected to happen**:\r\nI am expecting a pagination component to display under my Panel Plugin `Table` component\r\n![image](https://user-images.githubusercontent.com/42260999/189193940-b36bc0d6-4c2c-43ce-945f-055db4eb5223.png)\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nUsing Grafana's data source plugin example `Random Walk` as a data source _(see screenshot)_ set `enablePagination={true}` using `grafana/ui`'s Table component plugin.\r\n\r\nPanel Plugin Code snippet below\r\n```javascript\r\nimport React from 'react';\r\nimport { PanelProps } from '@grafana/data';\r\nimport { SimpleOptions } from 'types';\r\nimport { Table } from '@grafana/ui';\r\n\r\ninterface Props extends PanelProps\u003cSimpleOptions\u003e {}\r\n\r\nexport const SimplePanel: React.FC\u003cProps\u003e = ({ options, data, width, height }) =\u003e {\r\n  const dataSource = data.series[0];\r\n\r\n  return (\r\n    \u003cdiv\u003e\r\n      \u003cTable data={dataSource} width={width} height={height} columnMinWidth={150} enablePagination={true} /\u003e\r\n    \u003c/div\u003e\r\n  );\r\n};\r\n```\r\nPlugin Directory\r\n![CleanShot 2022-09-08 at 14 20 10](https://user-images.githubusercontent.com/42260999/189196929-df33d842-b7b1-4cf6-90bd-d999979947af.png)\r\n\r\n**Environment**:\r\n- Grafana version: `@grafana/ui v9.1.3`\r\n- Data source type \u0026 version: Grafana's Example `Random Walk` Data Source\r\n- OS Grafana is installed on: `MacOS Monterey v12.5`\r\n- User OS \u0026 Browser: `MacOS Monterey v12.5` \u0026 `Chrome v104.0.5112.101`\r\n\r\n**Community Post**\r\nhttps://community.grafana.com/t/adding-pagination-to-table-plugin/71969\r\n","labels":["area/panel/table","bot/no new info"]},{"id":47661,"title":"stat panel: metrics with no value should use decimals for consistent appearance","body":"If you look at the panels below, some are set to 0% while others are 0.000%. The decimal field is set to 3 so I expect all 0 value panels to show as 0.000 %. Could this be done? This is a stat panel with a repeat variable. I've highlighted it in the 2nd image.\r\n\u003cimg width=\"2509\" alt=\"image\" src=\"https://user-images.githubusercontent.com/9159205/163038576-90a82793-8dc4-4820-bc0a-760e79458d1f.png\"\u003e\r\n\u003cimg width=\"609\" alt=\"image\" src=\"https://user-images.githubusercontent.com/9159205/163038901-c8ce129b-4f28-4bf7-baff-e449732df74a.png\"\u003e\r\n","labels":["type/bug","help wanted","area/panel/stat","good first issue"]},{"id":69848,"title":"Alerting: Manual Alert Rule Update not working","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\nAfter creating a new alert rule via Provisioning API (Grafana v9.5.3) I'm no longer unable to manually save the alert rule within Grafana Web UI. The \"X-Disable-Provenance\" header is set while creating the alert rule.\r\n\r\nFollowing error occurs in the UI:\r\n\r\n\u003e Failed to save rule: failed to update rule group: request affects resources created via provisioning API: alert rule group [{orgID: 0, namespaceUID: xxx-xxxx, groupName: xxx}]\r\n\r\n\r\n**What did you expect to happen**:\r\n\r\nI expect that the alert rule can be saved successfully.\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\n- Create an alert rule by using the Provisioning API and set X-Disable-Provenance as header.\r\n\r\n**Step 2**:\r\n\r\n- Go to Grafana Alerting section, edit the newly created alert and try to change a setting. In my case \"Configure no data and error handling\" \u003e\u003e \"Alert state if no data or all values are null\" \u003e\u003e set to \"OK\"\r\n\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\nGrafana: 9.5.3\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\r\n\r\n### Grafana Platform?\r\n\r\nA downloaded binary\r\n\r\n### User's OS?\r\n\r\nRedHat\r\n\r\n### User's Browser?\r\n\r\nMicrosoft Edge Version 111.0.1661.41 (64-Bit)\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\nyes, Elasticsearch\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["type/bug","area/alerting","area/provisioning","area/frontend"]},{"id":63543,"title":"Inappropriate HTTP response code for some requests","body":"**What happened**:\r\nWe have seen many cases that grafana returned inappropriate status code to our clients.\r\nCases listed below:\r\n| url  | error msg | current status code |\r\n|:-----|:----------| :-----------------|\r\n| **/api/v1/eval**| Failed to evaluate queries and expressions: failed to execute query D: no handler found for query type '' | 500 |\r\n| **/api/v1/eval**| Failed to evaluate queries and expressions: input data must be a wide series but got type not (input refid) '' | 500 |\r\n| **/api/folders**| invalid API key | 500 |\r\n| api/prometheus/.../api/v1/rules| unexpected content type from upstream. expected JSON, got text/html | 500 |\r\n| **/api/dashboards/db| data source not found | 500 |\r\n\r\n**What you expected to happen**:\r\nBased on the error messages, it appears that all the failed requests were caused by client errors. Therefore, we should anticipate the appropriate status code to be returned, rather than a generic 500 Internal Server Error.e.g. 4##;\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.2.2\r\n- Data source type \u0026 version: promethues\r\n- OS Grafana is installed on: Linux\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n\r\n\r\n\r\n```[tasklist]\r\n### Issue Tracking\r\n- [ ] https://github.com/grafana/grafana/issues/65828\r\n- [ ] https://github.com/grafana/grafana/issues/65830\r\n- [ ] https://github.com/grafana/grafana/issues/65831\r\n- [ ] https://github.com/grafana/grafana/issues/67195\r\n- [ ] https://github.com/grafana/grafana/issues/68168\r\n```\r\n","labels":["prio/high","area/backend/api"]},{"id":45605,"title":"Grafana Docker 8.4.0 error permission issue","body":"Something is wrong with docker version 8.4.0 regarding permission.\r\n\r\nFailed to start grafana. error: section \"tracing.opentelemetry.jaeger\" does not exist\r\nsection \"tracing.opentelemetry.jaeger\" does not exist\r\nGF_PATHS_CONFIG='/etc/grafana/grafana.ini' is not readable.\r\nGF_PATHS_DATA='/var/lib/grafana' is not writable.\r\nGF_PATHS_HOME='/usr/share/grafana' is not readable.\r\n\r\nI cannot even open the bash on docker because the container is half-dead. Reverting to 8.3.6 solves the issue.","labels":["type/bug","area/docker","area/configuration"]},{"id":60601,"title":"Annotation without tag or text field set from query doesn't display in 9.3.1","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nAfter upgrading to 9.3.1 from 9.2.0, query-based annotations from Postgres datasource (or any other datasource from what we can tell--also attempted with JSON API) don't appear to work, meaning the annotation didn't show up on the graph.  In this case, these are annotations based on a single timestamp result from query _with no tag or text fields set_. \r\n\r\n**What you expected to happen**:\r\nBased on previous versions' behavior, If an query annotation is created with a timestamp in the range of the dashboard, with or without a tag or text field set, a dotted line should appear on the graph at that timestamp.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nCreate a new dashboard with a timeseries panel with the random walk datasource.  Add query annotation using Postgres (or any other datasource) that returns only one timestamp within the time range of the dashboard, without a tag or text field.  This can easily be done with a Postgres query like this:\r\n\r\n`SELECT NOW()::timestamptz AS \"time\"` or create a json datasource or other datasource that returns a timestamp for \"now\" and set dashboard end time to \"now+1h\".\r\n\r\nAnnotation vertical line does not appear in 9.3.1.  This will work in 9.2.0 and previous versions.  We have used this for quite some time to create \"now\" lines on graphs.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.1\r\n- Data source type \u0026 version:  Postgres 5.0.0, JSON API 1.3.1\r\n- OS Grafana is installed on: Linux Docker\r\n- User OS \u0026 Browser: Edge 110.0.1556.0, Chrome 108.0.5359.125\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/annotations","bot/no new info","triage/needs-confirmation"]},{"id":80756,"title":"Content Security Policy not set","body":"### What happened?\n\nEven configured in grafana.ini the CSP policy, that is not working.\r\nTried with minimal setting either, no luck.\r\n\r\ncontent_security_policy = true\r\ncontent_security_policy_template = \"\"\"script-src 'self';style-src 'self';img-src 'self';connect-src 'self';\"\"\"\r\n\r\nService restarted after any changes on ini file.\r\nAfter verified with curl -sD, but CSP not in headers:\r\nHTTP/1.1 200 OK\r\nCache-Control: no-store\r\nContent-Type: text/html; charset=UTF-8\r\nX-Content-Type-Options: nosniff\r\nX-Frame-Options: deny\r\nX-Xss-Protection: 1; mode=block\r\nDate: Wed, 17 Jan 2024 17:48:07 GMT\r\nTransfer-Encoding: chunked\r\n\r\n\u003c!doctype html\u003e\r\n...\n\n### What did you expect to happen?\n\nI expect that CSP will appear at headers.\n\n### Did this work before?\n\nNo, it not worked before\n\n### How do we reproduce it?\n\n1. Use version 10.0.3 or 10.2.0\r\n2. Set grafana.ini :\r\ncontent_security_policy = true\r\ncontent_security_policy_template = \"\"\"script-src 'self';style-src 'self';img-src 'self';connect-src 'self';\"\"\"\r\n3. Check with curl the headers\r\n\n\n### Is the bug inside a dashboard panel?\n\nNo\n\n### Environment (with versions)?\n\nGrafana: 10.0.3 (DEV) or 10.2.0 (PROD)\r\nOS: Ubuntu (for 10.0.3) or RHEL (for the 10.2.0)\r\nBrowser: Firefox, but curl from any bash\r\n\n\n### Grafana platform?\n\nA downloaded binary\n\n### Datasource(s)?\n\n_No response_","labels":["area/security","area/backend/security","area/configuration","triage/needs-confirmation"]},{"id":48313,"title":"viewers without permission to explore still can use /api/ds/query, isn't it a security problem?","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nExplore page has permission restriction which by default refuse viewer to explore the data arbitrarily. But the /api/ds/query almost has the same function as explore page. Viewers can use this api to get and calculate any data they interested. So why this api does not need authorization?\r\n**What you expected to happen**:\r\n/api/ds/query should have same permission restriction as explore page.\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nkeep [viewers_can_edit option] as false, post /api/ds/query anonymously, you can successfully query the data.\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.7\r\n- Data source type \u0026 version: prometheus_2.28\r\n- OS Grafana is installed on: centos7\r\n- User OS \u0026 Browser: chrome\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["needs more info","area/backend/api","needs investigation"]},{"id":71568,"title":"row count is wrong","body":"### What happened?\n\nwhen we apply a filter inside the panel, the count of rows continues counting all items outside the filter\n\n### What did you expect to happen?\n\nwhen applying a filter within the panel, the Rows should only show the count of the amount with the filter\n\n### Did this work before?\n\nno\n\n### How do we reproduce it?\n\n1.apply filter inside the panel\r\n2. the rows must count the quantity of the items again\r\n3.rows display the correct values\n\n### Is the bug inside a dashboard panel?\n\nall panels\n\n### Environment (with versions)?\n\nGrafana:9.5\r\nOS:Enterprise \r\nBrowser: chrome\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\n_No response_","labels":["area/panel/table","triage/needs-confirmation"]},{"id":84468,"title":"[OSS] some Hyperlinks not correct/working with root_url behind HAproxy (path)","body":"### What happened?\n\n\r\nVersion: 10.4.0 (OSS)\r\n\r\nHaving grafana behind HAPROXY, setup like mantioned here: [Configure HAProxy](https://grafana.com/tutorials/run-grafana-behind-a-proxy/) chapter: Configure HAProxy\r\n\r\nAlso acording i set the grafana.ini with the `root_url` that contain a sub path\r\n\r\n```ini\r\nroot_url = http://fqn.local/grafana\r\n```\r\n\r\nSome hyperlink that are not correct mapped with the path.\r\n\n\n### What did you expect to happen?\n\nhyperlinks should work acording the root_url\n\n### Did this work before?\n\ndont know\n\n### How do we reproduce it?\n\n\r\n- Home -\u003e Alerting -\u003e Alert rules -\u003e Edit rule -\u003e Preview routing -\u003e See Details -\u003e `See details`\r\n\r\n    ERROR --\u003e http://fqn.local/alerting/notifications/receivers/2/edit?alertmanager=grafana\r\n    should be: --\u003e http://fqn.local/grafana/alerting/notifications/receivers/2/edit?alertmanager=grafana\r\n\r\n- Home -\u003e Alerting -\u003e Contact points -\u003e `[name cp] is used by 1 notification policy`\r\n\r\n    ERROR --\u003e http://fqn.local/grafana/grafana/alerting/routes?contactPoint=1\r\n    should be: --\u003e http://fqn.local/grafana/alerting/routes?contactPoint=1\r\n\r\n    --\u003e what is showing: Page not found (404)\r\n    \r\n     --\u003e Click on `home`\r\n\r\n    ERROR --\u003e http://fqn.local/\r\n    should be: --\u003e http://fqn.local/grafana\r\n      \r\n- Home -\u003e Alerting -\u003e Notification policies -\u003e Delivered to `[name cp]`\r\n\r\n    ERROR --\u003e http://fqn.local/grafana/grafana/alerting/notifications/receivers/2/edit?alertmanager=grafana\r\n\r\n\r\n\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana:\r\nOS:\r\nBrowser:\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\n_No response_","labels":["type/bug","area/alerting","needs investigation","area/frontend","triage/needs-confirmation"]},{"id":63056,"title":"Dashboard not loading on iOS/OSX safari","body":"**What happened**:\r\nI've received some feedback from users of my website that a few weeks ago (somewhere in December) dashboards stopped loading on iOS devices.\r\nSometimes whole page doesn't load, other times there is a long `Fetching` status which ends by `Grafana has failed to load its application files` error.\r\nAs far as I know, this issue occurs on iPhones and iPads on Safari and Google Chrome browsers. On macOS it works fine.\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nUnfortunately, I do not have iPhone or iPad so I cannot provide more details by myself. However, my Grafana instance is publicly available: https://stacjameteommz.pl. You should be able to test that by yourself on some iOS device.\r\nGrafana is hosted behind reverse proxy on the server.\r\n\r\n**Anything else we need to know?**:\r\nMy public website is based on Grafana 7.5.4, however, I've noticed the same issue with online iOS test devices on my test environment which is hosted on the newest Grafana 9.4.0-beta1.\r\n\r\n**Environment**:\r\n- Grafana version: 7.5.4 - 9.4.0-beta1\r\n- Data source type \u0026 version:  InfluxDB1 (InfluxQL) on Grafana 7.5.4, InfluxDB2 (Flux) on Grafana 9.4.0-beta1\r\n- OS Grafana is installed on: Debian\r\n- User OS \u0026 Browser: iOS; Safari and Google Chrome. Unfortunately I don't know exact system \u0026 browser versions\r\n- Grafana plugins: `D3 Gauge v0.0.8`, `Influx Admin v0.0.5`, `Radar Graph v1.4.4`, `WindRose v.0.7.0`, `CompareQueries v1.0.0`\r\n- Others: -\r\n","labels":["type/bug","area/backend","needs investigation"]},{"id":74964,"title":"Datalink not working for multiple values in the table","body":"### What happened?\n\n![image](https://github.com/grafana/grafana/assets/94020521/299e74c7-c57e-40d9-8419-15790d4ec867)\r\n\n\n### What did you expect to happen?\n\nOn Click of the link in the container column instead of passing it as a multiple value it is passing as a single value with comma separated. \n\n### Did this work before?\n\nNever tried before\n\n### How do we reproduce it?\n\n1. Create a table with a column containing comma separated values\r\n2. create a data on it or any other column and on click of that link set those commas separated values as a filter (multi select)\r\n\r\n\n\n### Is the bug inside a dashboard panel?\n\nIn a data link within the panel\n\n### Environment (with versions)?\n\nGrafana:\r\nOS:\r\nBrowser:\r\n\n\n### Grafana platform?\n\nI use Grafana Cloud\n\n### Datasource(s)?\n\n_No response_","labels":["type/feature-request","area/panel/table","area/dashboard/data-links"]},{"id":61984,"title":"PublicDashboards: tables with outer join show no data","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI have a public dashboard that has a table that has 2 queries with outer join inside. When seeing it on Grafana directly, it works okay. On this dashboard, it shows 3 panels: first is just a time series with `up` metric from node_exporter, second is the same but as a table, third is a table of 2 metrics: `up` and `count without(cpu, mode) (node_cpu_seconds_total{mode=\"idle\"})`, with a table join like this:\r\n\u003cimg width=\"265\" alt=\"изображение\" src=\"https://user-images.githubusercontent.com/83376337/214279967-2d575009-811e-4860-863f-02a828952ad9.png\"\u003e\r\nThe table itself in Grafana works:\r\n\u003cimg width=\"1729\" alt=\"изображение\" src=\"https://user-images.githubusercontent.com/83376337/214279692-c72634ec-762f-4d0a-94b5-fa485b8e7c6f.png\"\u003e\r\nBut when I make this dashboard public, this panel having a join shows no data:\r\n\u003cimg width=\"1792\" alt=\"изображение\" src=\"https://user-images.githubusercontent.com/83376337/214280176-30a6a0b7-8aa5-4f2e-befe-358ed1df5b2e.png\"\u003e\r\n\r\n\r\n**What you expected to happen**:\r\nTable should be displayed properly\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n- Create a new dashboard\r\n- Create a new table there with two queries and a join\r\n- Enable public access to this dashboard\r\n- See `no data` instead of table data when viewing this dashboard\r\n\r\n**Anything else we need to know?**:\r\nSounds like a frontend issue, as the API returns the data correctly, there are 2 rows in response (I don't know how Grafana API works internally but sounds sane):\r\n\u003cimg width=\"544\" alt=\"image\" src=\"https://user-images.githubusercontent.com/83376337/214312367-313462b6-5b6b-4720-8cb8-d0d09b267498.png\"\u003e\r\n\r\n\r\n**Environment**:\r\n- Grafana version: v9.2.3 (UPD: updated to 9.3.2, bug is still present)\r\n- Data source type \u0026 version: Prometheus `prometheus, version 2.33.5`\r\n- OS Grafana is installed on: Ubuntu\r\n- User OS \u0026 Browser: Mac OS, Fireox\r\n- Grafana plugins: -\r\n- Others:\r\n","labels":["area/public-dashboards","triage/needs-confirmation"]},{"id":59783,"title":"Influxdb datasource added using configmap  shows  error \"reading InfluxDB. Status Code: 401\" with Kubernetes version 1.24.x","body":"What happened:\r\nAfter updating from k8s version 1.23.x to v 1.24.x ,  the Influxdb datasource which is added using configmap shows error \" reading InfluxDB. Status Code: 401\" .  \r\n\r\nStrange enough, the same datasource configuration added manually  on Grafana dashboard using admin role works fine and does NOT show any such error . The Influxdb datasource with configmap works fine with K8s version 1.23.x.\r\n\r\nHow to reproduce it (as minimally and precisely as possible):\r\nAdd a Influxdb datasource using configmap in the K8s version 1.24.x.  \r\n\r\n Configmap to add Influxdb datasource\r\n\r\n```\r\napiVersion: v1\r\nkind: ConfigMap\r\nmetadata:\r\nxxxxxx\r\ndata:\r\n  datasource_influx.yaml: |-\r\n    apiVersion: 1\r\n    datasources:\r\n    - name: InfluxDB\r\n      type: influxdb\r\n      access: proxy\r\n      database: dcs\r\n      url: http://monitoring-influxdb:8086\r\n      basicAuth: true\r\n      basicAuthUser: admin\r\n      user: admin\r\n      secureJsonData:\r\n        password: ${admin-user-password}\r\n        basicAuthPassword: ${admin-user-password}\r\n```\r\nAnything else we need to know?:\r\nDowngrading K8s to v 1.23.x (from 1.24.x) resolved this issue.\r\n\r\n**Environment**:\r\n- Grafana version: 9.1.7\r\n- Data source type \u0026 version: Influxdb \r\n- OS Grafana is installed on: Ubuntu\r\n- User OS \u0026 Browser: Chrome\r\n- K8s version : 1.24.x\r\n- Infludb version: v2.4.0\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/33157847/205594806-bb59a82b-0d6f-48d4-9eba-1965fc31c93e.png)\r\n","labels":["area/backend/config","bot/no new info"]},{"id":57556,"title":"\"unsupported protocol version\" error in MySQL datasource after upgrading from 9.1.7 to 9.2","body":"While trying to add data sources. I am getting db query error: tls: server selected unsupported protocol version 302. After upgrading only I started getting this error\r\n\r\nMy MySQL server has tls_version | TLSv1.1, TLSv1.2\r\n\r\nCurrent Mysql version is mysql  Ver 14.14 Distrib 5.7.21, for Linux (x86_64)\r\n\r\n\r\n**After Upgrade my connection to Mysql is failing**:\r\n\r\n**Current Datasource was supposed to work with the latest version(9.2.0)**:\r\n\r\n**Upgrade from 9.1.7 to 9.2**:\r\n\r\n**Using Basic Mysql environment?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.0\r\n- Data source type \u0026 version: Mysql\r\n- OS Grafana is installed on:  Fedora\r\n- User OS \u0026 Browser: Windows \u0026 chrome\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["needs more info","datasource/MySQL","area/backend","area/datasource/backend"]},{"id":86956,"title":"In the timeseries, I see wrong date when I hover over the values","body":"### What happened?\n\nEvery grouping in grafana is showing left edge value instead of actual grouping, for 2024-04 its showing 2024-03-31 19:00:00, and the same goes to every other month.\r\nHere is the query I am using\r\nSELECT\r\n  STR_TO_DATE(created_at, '%Y-%m')  as time,manufacturer as metric,\r\n  sum(uuid_count)\r\nFROM (\r\n  SELECT\r\n    created_at,manufacturer,\r\n    COUNT(uuid) AS uuid_count\r\n  FROM\r\n    storages_v2\r\n  WHERE\r\n    $__timeFilter(created_at) AND\r\n    deleted_at IS NULL\r\n  GROUP BY 1,2\r\n  ORDER BY 1\r\n) AS subquery group by 1,2;\r\n\r\n\n\n### What did you expect to happen?\n\n\r\n![Screenshot 2024-04-25 173107](https://github.com/grafana/grafana/assets/167444202/605cdd9c-cf79-4f23-8fea-d3a7c9a26600)\r\n To show the actual date instead of previous day date\n\n### Did this work before?\n\nI am a new user\n\n### How do we reproduce it?\n\n1.\r\n2.\r\n3.\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana:\r\nOS:\r\nBrowser:\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["needs more info","area/panel/timeseries","area/tooltip"]},{"id":56764,"title":"The folder user can't create silence (Grafana 9.17)","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nUser can not make silence mode.\r\n(User with global viewer \u0026 folder editor permission can create dashboard and alerts)\r\nOnly the current admin able to silence about all of alerts.\r\n\r\n**What you expected to happen**:\r\nUser should be able to silence the alerts they created.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Users create alerts in folders with access.\r\n2. Go to silences of Alerting menu\r\n3. There is no button to create silence\r\n\r\n**Anything else we need to know?**:\r\nI was using the grafana 8 version. The version was able to pause and start alarms.\r\nI am testing the grafana 9 version to upgrade.\r\n\r\n**Environment**:\r\n- Grafana version: 9.17\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on: linux \u0026 window\r\n- User OS \u0026 Browser: chrome\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/alerting","bot/no new info"]},{"id":46857,"title":"Grafana 8 Alerting: Some read-only APIs require an API key with the \"Editor\" Role","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nWhile trying to download data about alert rules from Grafana, I was attempting to access the [Grafana 8 Alerting API](https://editor.swagger.io/?url=https://raw.githubusercontent.com/grafana/grafana/main/pkg/services/ngalert/api/tooling/post.json). I found that several of the GET endpoints returned a `\"permission denied\"` error while I was using an API Key configured with the \"Viewer\" Role:\r\n\r\n```json\r\n{\r\n    \"message\": \"permission denied\"\r\n}\r\n```\r\n\r\nCreating an API key with the \"Editor\" Role allowed me to access these endpoints just fine. One endpoint where I encountered this issue was GET `/api/alertmanager/grafana/config/api/v1/alerts`, but I believe there are more.\r\n\r\n**What you expected to happen**:\r\n\r\nAny GET endpoints should return results for any API Key configured with the \"Viewer\" role.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n1. Create an API Key with the Viewer role.\r\n2. Use that API Key to make a GET request to `/api/alertmanager/grafana/config/api/v1/alerts`\r\n\r\n**Environment**:\r\n- Grafana version: v8.4.3\r\n","labels":["needs more info","area/alerting","bot/no new info"]},{"id":75063,"title":"Burp Scan Reports : Strict Transport Security not enforced","body":"### What happened?\r\n\r\nUsed ingress and enabled `strict_transport_security` feature in security section of `grafana.ini` to use Grafana in HTTPS mode. Confirmed with the response headers after installation that HSTS(`strict_transport_security`) is enabled. Performed the Burp Scan for Grafana and could still find the issue \"Strict Transport Security not enforced\" in the reports for few links that redirects to .js scripts as well as robots.txt in public/build folder .\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nThe issue related to Strict Transport Security not enforced shouldn't be raised in the Scan reports.\r\n\r\n\r\n### Did this work before?\r\n\r\nHad the same issue earlier too\r\n\r\n\r\n### How do we reproduce it?\r\n\r\n1. Install Grafana in HTTPS mode .\r\n2. Enable strict_transport_security feature in .Values.grafana_ini.security section\r\n3. Perform the Burp Scan\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana:\r\nOS:\r\nBrowser:\r\n\r\n\r\n### Grafana platform?\r\n\r\nKubernetes\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/backend/security","area/backend/config","area/backend"]},{"id":62541,"title":"When my query uses expression and the time filter contains 0 to 8 hours of the day,  there is no data for this period","body":"**What happened**:\r\n![image](https://user-images.githubusercontent.com/31183726/215700727-cd2d297c-586f-49ce-8071-fb50b19adcef.png)\r\n![image](https://user-images.githubusercontent.com/31183726/215701110-df959106-2076-4401-b16a-596c9ab77385.png)\r\nPlease see the picture above.When I use the expression, as long as my time range includes 0 to 8 hours of the day, the data for this period is lost.\r\n\r\n![image](https://user-images.githubusercontent.com/31183726/215701209-0b94abb1-aff2-4a04-a58c-c50bf0369a3a.png)\r\nHowever, if the start time is before 0:00, the display is normal.\r\n\r\n**What you expected to happen**:\r\nI can confirm that the data is available in the selected time range and that the calculations are all available, so a completed graph should be displayed.If I don't use expression, I can see that the graph is normal.\r\n![image](https://user-images.githubusercontent.com/31183726/215701716-1225f168-9ce4-4a8e-8212-588be24deed0.png)\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nUnder certain query conditions, if the expression is used, it will cause this phenomenon.\r\nFor example\r\n![image](https://user-images.githubusercontent.com/31183726/215702183-096b14e4-f050-4706-af57-5c849e237e63.png)\r\nIf I modify the query criteria, the graphic is as follows\r\n![image](https://user-images.githubusercontent.com/31183726/215702386-2e578dff-72a8-48a4-92c1-61f981542dd0.png)\r\n![image](https://user-images.githubusercontent.com/31183726/215702835-bcfb7dc6-f67a-4e8d-ae2a-61b41441c0f1.png)\r\nAfter my test, if I use Average, Max, Min, Extended Stats, and Percentiles as query conditions in Metric, they all appear for the situation\r\n\r\n**Anything else we need to know?**:\r\nWhen the time range is 2023-01-24 22:00:00 to 2023-01-26 00:00:00, you can see in the following graph that there is data at 2023-01-25 02:00:00\r\n![image](https://user-images.githubusercontent.com/31183726/215703742-82b628f2-7afa-4922-b1da-9391791d0bfa.png)\r\n\r\nBut when I change the time range to 2023-01-25 00:00:00 to 2023-01-26 00:00:00, I can see that when the time point is also at 2023-01-25 02:00:00, there is no data\r\n![image](https://user-images.githubusercontent.com/31183726/215704814-5f4b8e4c-9a20-4068-a6d1-973e32e625be.png)\r\n\r\nThe problem looks similar to this one([#16765](https://github.com/grafana/grafana/issues/16765)), But I can confirm that the query time was processed correctly and is not related to the time zone.\r\n![image](https://user-images.githubusercontent.com/31183726/215707730-0cf32ae9-bd68-4458-b386-4884df373438.png)\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.8\r\n- Data source type \u0026 version: OpenSearch 2.0.5\r\n- OS Grafana is installed on: \r\n- User OS \u0026 Browser: Chrome\r\n- Grafana plugins: \r\n- Others:\r\n","labels":["needs more info","area/expressions","triage/needs-confirmation"]},{"id":47491,"title":"Table view has scrollbar in the middle","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nFrom version 8.4.5 there is a scrollbar in the middle of the table. Version 8.4.4 does not show this.\r\n![image878](https://user-images.githubusercontent.com/44026484/162398105-e0183825-874d-4209-be60-63cdc4b2363f.png)\r\n\r\n\r\n\r\n**What you expected to happen**:\r\nThat the scrollbar wouldn't appear in the middle of the table. All the cells after the scrollbar can not be seen anymore\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nView a table with data with the latest Grafana version (8.4.5)\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.5\r\n- Data source type \u0026 version: Postgres 12\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser: Firefox \u0026 Chrome\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["needs more info","area/panel/table","bot/no new info"]},{"id":73901,"title":"Geomap: Initial View not saving layer selection correctly ","body":"### What happened?\n\nWhen selecting the 'Fit to data' view as the initial view, selecting the marker layer from the list of three I have defined  (route, markers, map), saving, applying and then returning to edit mode the layer defaults to the last layer listed in the 'Map layers' section rather than my choice. \r\n\r\nMy marker layer is a single lat/long for the current position that I want to default to as the initial view but no matter what selection I choose the panel always defaults to the viewing the whole route layer as well rather.\r\n\r\n\n\n### What did you expect to happen?\n\nMy marker layer selection to be saved and correctly displayed, centred in the panel\n\n### Did this work before?\n\nNo\n\n### How do we reproduce it?\n\n1. Add multiple map layers (route, markers, map)\r\n2. Set Map view to be\r\n- View - 'Fit to data'\r\n- Data - 'Layer'\r\n- Layer - 'My Marker Layer'\r\n3. Save and apply\r\n4. Return to edit mode and check saved initial view 'Layer' selection\r\n\n\n### Is the bug inside a dashboard panel?\n\n| Key | Value |\r\n|--|--|\r\n| Panel | geomap @ 10.1.0 |\r\n| Grafana | 10.1.0 (ff85ec33c5) // Open Source |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"custom\": {\r\n            \"hideFrom\": {\r\n              \"tooltip\": false,\r\n              \"viz\": false,\r\n              \"legend\": false\r\n            }\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          },\r\n          \"color\": {\r\n            \"mode\": \"thresholds\"\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"view\": {\r\n          \"allLayers\": false,\r\n          \"id\": \"fit\",\r\n          \"lat\": -10,\r\n          \"lon\": -140,\r\n          \"zoom\": 15,\r\n          \"lastOnly\": false,\r\n          \"layer\": \"Current Position\",\r\n          \"padding\": 5,\r\n          \"shared\": false\r\n        },\r\n        \"controls\": {\r\n          \"showZoom\": true,\r\n          \"mouseWheelZoom\": true,\r\n          \"showAttribution\": true,\r\n          \"showScale\": true,\r\n          \"showMeasure\": true,\r\n          \"showDebug\": false\r\n        },\r\n        \"tooltip\": {\r\n          \"mode\": \"details\"\r\n        },\r\n        \"basemap\": {\r\n          \"config\": {},\r\n          \"name\": \"Layer 0\",\r\n          \"opacity\": 0,\r\n          \"tooltip\": true,\r\n          \"type\": \"osm-standard\"\r\n        },\r\n        \"layers\": [\r\n          {\r\n            \"config\": {},\r\n            \"name\": \"Map\",\r\n            \"opacity\": 1,\r\n            \"tooltip\": true,\r\n            \"type\": \"osm-standard\"\r\n          },\r\n          {\r\n            \"config\": {\r\n              \"showLegend\": true,\r\n              \"style\": {\r\n                \"color\": {\r\n                  \"fixed\": \"dark-red\"\r\n                },\r\n                \"opacity\": 1,\r\n                \"rotation\": {\r\n                  \"fixed\": 0,\r\n                  \"max\": 360,\r\n                  \"min\": -360,\r\n                  \"mode\": \"mod\"\r\n                },\r\n                \"size\": {\r\n                  \"fixed\": 10,\r\n                  \"max\": 15,\r\n                  \"min\": 2\r\n                },\r\n                \"symbol\": {\r\n                  \"fixed\": \"img/icons/marker/triangle.svg\",\r\n                  \"mode\": \"fixed\"\r\n                },\r\n                \"text\": {\r\n                  \"field\": \"\",\r\n                  \"fixed\": \"Balloon\",\r\n                  \"mode\": \"fixed\"\r\n                },\r\n                \"textConfig\": {\r\n                  \"fontSize\": 12,\r\n                  \"offsetX\": 0,\r\n                  \"offsetY\": 10,\r\n                  \"textAlign\": \"center\",\r\n                  \"textBaseline\": \"top\"\r\n                }\r\n              }\r\n            },\r\n            \"filterData\": {\r\n              \"id\": \"byRefId\",\r\n              \"options\": \"B\"\r\n            },\r\n            \"location\": {\r\n              \"latitude\": \"Lat\",\r\n              \"longitude\": \"Long\",\r\n              \"mode\": \"coords\"\r\n            },\r\n            \"name\": \"Current Position\",\r\n            \"tooltip\": true,\r\n            \"type\": \"markers\"\r\n          },\r\n          {\r\n            \"config\": {\r\n              \"arrow\": -1,\r\n              \"style\": {\r\n                \"color\": {\r\n                  \"fixed\": \"blue\"\r\n                },\r\n                \"lineWidth\": 2,\r\n                \"opacity\": 0.7,\r\n                \"rotation\": {\r\n                  \"fixed\": 0,\r\n                  \"max\": 360,\r\n                  \"min\": -360,\r\n                  \"mode\": \"mod\"\r\n                },\r\n                \"size\": {\r\n                  \"field\": \"Lat\",\r\n                  \"fixed\": 5,\r\n                  \"max\": 5,\r\n                  \"min\": 5\r\n                },\r\n                \"symbol\": {\r\n                  \"fixed\": \"img/icons/marker/circle.svg\",\r\n                  \"mode\": \"fixed\"\r\n                },\r\n                \"text\": {\r\n                  \"field\": \"Lat\",\r\n                  \"fixed\": \"\",\r\n                  \"mode\": \"fixed\"\r\n                },\r\n                \"textConfig\": {\r\n                  \"fontSize\": 50,\r\n                  \"offsetX\": 0,\r\n                  \"offsetY\": 0,\r\n                  \"textAlign\": \"center\",\r\n                  \"textBaseline\": \"middle\"\r\n                }\r\n              }\r\n            },\r\n            \"filterData\": {\r\n              \"id\": \"byRefId\",\r\n              \"options\": \"A\"\r\n            },\r\n            \"location\": {\r\n              \"latitude\": \"Lat\",\r\n              \"longitude\": \"Long\",\r\n              \"mode\": \"coords\"\r\n            },\r\n            \"name\": \"Route\",\r\n            \"opacity\": 1,\r\n            \"tooltip\": true,\r\n            \"type\": \"route\"\r\n          }\r\n        ]\r\n      },\r\n      \"pluginVersion\": \"10.1.0\",\r\n      \"targets\": [\r\n       //removed \r\n      ],\r\n      \"title\": \"Reproduced with embedded data\",\r\n      \"type\": \"geomap\"\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003egeomap @ 10.1.0\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003eA[mysql], B[mysql]\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003e 2 frames, 6 fields, 75 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e10.1.0 (ff85ec33c5) // Open Source\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"title\": \"Original Panel JSON\",\r\n      \"type\": \"text\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 7\r\n      },\r\n      \"options\": {\r\n        \"content\": \"{\\n  \\\"datasource\\\": {\\n    \\\"type\\\": \\\"mysql\\\",\\n    \\\"uid\\\": \\\"NDIRzff4z\\\"\\n  },\\n  \\\"fieldConfig\\\": {\\n    \\\"defaults\\\": {\\n      \\\"custom\\\": {\\n        \\\"hideFrom\\\": {\\n          \\\"tooltip\\\": false,\\n          \\\"viz\\\": false,\\n          \\\"legend\\\": false\\n        }\\n      },\\n      \\\"mappings\\\": [],\\n      \\\"thresholds\\\": {\\n        \\\"mode\\\": \\\"absolute\\\",\\n        \\\"steps\\\": [\\n          {\\n            \\\"color\\\": \\\"green\\\",\\n            \\\"value\\\": null\\n          },\\n          {\\n            \\\"color\\\": \\\"red\\\",\\n            \\\"value\\\": 80\\n          }\\n        ]\\n      },\\n      \\\"color\\\": {\\n        \\\"mode\\\": \\\"thresholds\\\"\\n      }\\n    },\\n    \\\"overrides\\\": []\\n  },\\n  \\\"gridPos\\\": {\\n    \\\"h\\\": 16,\\n    \\\"w\\\": 16,\\n    \\\"x\\\": 0,\\n    \\\"y\\\": 0\\n  },\\n  \\\"id\\\": 1,\\n  \\\"options\\\": {\\n    \\\"view\\\": {\\n      \\\"allLayers\\\": false,\\n      \\\"id\\\": \\\"fit\\\",\\n      \\\"lat\\\": -10,\\n      \\\"lon\\\": -140,\\n      \\\"zoom\\\": 15,\\n      \\\"lastOnly\\\": false,\\n      \\\"layer\\\": \\\"Current Position\\\",\\n      \\\"padding\\\": 5,\\n      \\\"shared\\\": false\\n    },\\n    \\\"controls\\\": {\\n      \\\"showZoom\\\": true,\\n      \\\"mouseWheelZoom\\\": true,\\n      \\\"showAttribution\\\": true,\\n      \\\"showScale\\\": true,\\n      \\\"showMeasure\\\": true,\\n      \\\"showDebug\\\": false\\n    },\\n    \\\"tooltip\\\": {\\n      \\\"mode\\\": \\\"details\\\"\\n    },\\n    \\\"basemap\\\": {\\n      \\\"config\\\": {},\\n      \\\"name\\\": \\\"Layer 0\\\",\\n      \\\"opacity\\\": 0,\\n      \\\"tooltip\\\": true,\\n      \\\"type\\\": \\\"osm-standard\\\"\\n    },\\n    \\\"layers\\\": [\\n      {\\n        \\\"config\\\": {},\\n        \\\"name\\\": \\\"Map\\\",\\n        \\\"opacity\\\": 1,\\n        \\\"tooltip\\\": true,\\n        \\\"type\\\": \\\"osm-standard\\\"\\n      },\\n      {\\n        \\\"config\\\": {\\n          \\\"showLegend\\\": true,\\n          \\\"style\\\": {\\n            \\\"color\\\": {\\n              \\\"fixed\\\": \\\"dark-red\\\"\\n            },\\n            \\\"opacity\\\": 1,\\n            \\\"rotation\\\": {\\n              \\\"fixed\\\": 0,\\n              \\\"max\\\": 360,\\n              \\\"min\\\": -360,\\n              \\\"mode\\\": \\\"mod\\\"\\n            },\\n            \\\"size\\\": {\\n              \\\"fixed\\\": 10,\\n              \\\"max\\\": 15,\\n              \\\"min\\\": 2\\n            },\\n            \\\"symbol\\\": {\\n              \\\"fixed\\\": \\\"img/icons/marker/triangle.svg\\\",\\n              \\\"mode\\\": \\\"fixed\\\"\\n            },\\n            \\\"text\\\": {\\n              \\\"field\\\": \\\"\\\",\\n              \\\"fixed\\\": \\\"Balloon\\\",\\n              \\\"mode\\\": \\\"fixed\\\"\\n            },\\n            \\\"textConfig\\\": {\\n              \\\"fontSize\\\": 12,\\n              \\\"offsetX\\\": 0,\\n              \\\"offsetY\\\": 10,\\n              \\\"textAlign\\\": \\\"center\\\",\\n              \\\"textBaseline\\\": \\\"top\\\"\\n            }\\n          }\\n        },\\n        \\\"filterData\\\": {\\n          \\\"id\\\": \\\"byRefId\\\",\\n          \\\"options\\\": \\\"B\\\"\\n        },\\n        \\\"location\\\": {\\n          \\\"latitude\\\": \\\"Lat\\\",\\n          \\\"longitude\\\": \\\"Long\\\",\\n          \\\"mode\\\": \\\"coords\\\"\\n        },\\n        \\\"name\\\": \\\"Current Position\\\",\\n        \\\"tooltip\\\": true,\\n        \\\"type\\\": \\\"markers\\\"\\n      },\\n      {\\n        \\\"config\\\": {\\n          \\\"arrow\\\": -1,\\n          \\\"style\\\": {\\n            \\\"color\\\": {\\n              \\\"fixed\\\": \\\"blue\\\"\\n            },\\n            \\\"lineWidth\\\": 2,\\n            \\\"opacity\\\": 0.7,\\n            \\\"rotation\\\": {\\n              \\\"fixed\\\": 0,\\n              \\\"max\\\": 360,\\n              \\\"min\\\": -360,\\n              \\\"mode\\\": \\\"mod\\\"\\n            },\\n            \\\"size\\\": {\\n              \\\"field\\\": \\\"Lat\\\",\\n              \\\"fixed\\\": 5,\\n              \\\"max\\\": 5,\\n              \\\"min\\\": 5\\n            },\\n            \\\"symbol\\\": {\\n              \\\"fixed\\\": \\\"img/icons/marker/circle.svg\\\",\\n              \\\"mode\\\": \\\"fixed\\\"\\n            },\\n            \\\"text\\\": {\\n              \\\"field\\\": \\\"Lat\\\",\\n              \\\"fixed\\\": \\\"\\\",\\n              \\\"mode\\\": \\\"fixed\\\"\\n            },\\n            \\\"textConfig\\\": {\\n              \\\"fontSize\\\": 50,\\n              \\\"offsetX\\\": 0,\\n              \\\"offsetY\\\": 0,\\n              \\\"textAlign\\\": \\\"center\\\",\\n              \\\"textBaseline\\\": \\\"middle\\\"\\n            }\\n          }\\n        },\\n        \\\"filterData\\\": {\\n          \\\"id\\\": \\\"byRefId\\\",\\n          \\\"options\\\": \\\"A\\\"\\n        },\\n        \\\"location\\\": {\\n          \\\"latitude\\\": \\\"Lat\\\",\\n          \\\"longitude\\\": \\\"Long\\\",\\n          \\\"mode\\\": \\\"coords\\\"\\n        },\\n        \\\"name\\\": \\\"Route\\\",\\n        \\\"opacity\\\": 1,\\n        \\\"tooltip\\\": true,\\n        \\\"type\\\": \\\"route\\\"\\n      }\\n    ]\\n  },\\n  \\\"pluginVersion\\\": \\\"10.1.0\\\",\\n  \\\"targets\\\": [\\n    {\\n      \\\"dataset\\\": \\\"dafs_sensational\\\",\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"mysql\\\",\\n        \\\"uid\\\": \\\"NDIRzff4z\\\"\\n      },\\n      \\\"editorMode\\\": \\\"code\\\",\\n      \\\"format\\\": \\\"table\\\",\\n      \\\"rawQuery\\\": true,\\n      \\\"rawSql\\\": \\\"SELECT\\\\n  rx_time as 'time',\\\\n  ST_LATITUDE(p_location) AS 'Lat',\\\\n  ST_LONGITUDE(p_location) AS 'Long'\\\\nFROM\\\\n  dafs_sensational.browan_tint100\\\\nwhere\\\\n  ST_LATITUDE(p_location) != 0\\\\n  and ST_LONGITUDE(p_location) != 0 and\\\\n   $__timeFilter(rx_time) \\\\norder by\\\\n  rx_time desc;\\\",\\n      \\\"refId\\\": \\\"A\\\",\\n      \\\"sql\\\": {\\n        \\\"columns\\\": [\\n          {\\n            \\\"parameters\\\": [],\\n            \\\"type\\\": \\\"function\\\"\\n          }\\n        ],\\n        \\\"groupBy\\\": [\\n          {\\n            \\\"property\\\": {\\n              \\\"type\\\": \\\"string\\\"\\n            },\\n            \\\"type\\\": \\\"groupBy\\\"\\n          }\\n        ],\\n        \\\"limit\\\": 50\\n      }\\n    },\\n    {\\n      \\\"dataset\\\": \\\"dafs_sensational\\\",\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"mysql\\\",\\n        \\\"uid\\\": \\\"NDIRzff4z\\\"\\n      },\\n      \\\"editorMode\\\": \\\"code\\\",\\n      \\\"format\\\": \\\"table\\\",\\n      \\\"hide\\\": false,\\n      \\\"rawQuery\\\": true,\\n      \\\"rawSql\\\": \\\"SELECT\\\\n  rx_time as 'time',\\\\n  ST_LATITUDE(p_location) AS 'Lat',\\\\n  ST_LONGITUDE(p_location) AS 'Long'\\\\nFROM\\\\n  dafs_sensational.browan_tint100\\\\nwhere\\\\n  ST_LATITUDE(p_location) != 0\\\\n  and ST_LONGITUDE(p_location) != 0 \\\\norder by\\\\n  rx_time desc\\\\nLimit 1\\\",\\n      \\\"refId\\\": \\\"B\\\",\\n      \\\"sql\\\": {\\n        \\\"columns\\\": [\\n          {\\n            \\\"parameters\\\": [],\\n            \\\"type\\\": \\\"function\\\"\\n          }\\n        ],\\n        \\\"groupBy\\\": [\\n          {\\n            \\\"property\\\": {\\n              \\\"type\\\": \\\"string\\\"\\n            },\\n            \\\"type\\\": \\\"groupBy\\\"\\n          }\\n        ],\\n        \\\"limit\\\": 50\\n      }\\n    }\\n  ],\\n  \\\"title\\\": \\\"Balloon Tracking\\\",\\n  \\\"type\\\": \\\"geomap\\\"\\n}\",\r\n        \"mode\": \"code\",\r\n        \"code\": {\r\n          \"language\": \"json\",\r\n          \"showLineNumbers\": true,\r\n          \"showMiniMap\": true\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: Balloon Tracking // 2023-08-28 10:26:27\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-geomap\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"2023-08-28T06:26:27.039Z\",\r\n    \"to\": \"2023-08-28T09:26:27.039Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\n\n### Environment (with versions)?\n\nGrafana: 10.1.0\r\nOS: Fedora 38\r\nBrowser: Chrome 116\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\nMySQL","labels":["type/bug","area/panel/geomap"]},{"id":72308,"title":"Long Alert repeat interval(multiple weeks) realerts ever 5 days","body":"### What happened?\n\nWhen I create an alert with a very high repeat interval(multiple weeks), I am getting realerts every 5 days.\r\n\r\nThis is very similar to the alertmanager defaults described in this issue: (the default data.retention is 5 days)\r\nhttps://github.com/prometheus/alertmanager/issues/2934\r\n\r\nIn alertmanager this value can be increased using a command flag you can add when you run it. I am not able to find any options in Grafana to change this value.\n\n### What did you expect to happen?\n\nAlerts to repeat at the interval set, and not sooner. \n\n### Did this work before?\n\nNo\n\n### How do we reproduce it?\n\n1. Create an alert that will be matched with a notification with a repeat interval greater than 5 days\r\n2. Alert will repeat at 5 days.\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana version v9.5.1 (bc353e4b2d)\r\n\r\n\n\n### Grafana platform?\n\nA downloaded binary\n\n### Datasource(s)?\n\n_No response_","labels":["type/bug","area/alerting","needs investigation"]},{"id":53725,"title":"Panel Description box does not expand to fit markdown table","body":"**What happened**:\r\nPanel Descriptions support Markdown formatting. Making a table that is too wide for the panel does not adjust it's size to fit the content.\r\nThe Table section spreads outside the tooltip and can be difficult to read.\r\n\r\n**What you expected to happen**:\r\n\r\n- a) The panel should expand in width to contain its content if there is enough space.\r\n\r\n- b) If there is not enough space (Browser Windows size or whatever) or a reasonable max width is reached, switch to having a scroll bar (or otherwise handle the large table).\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n- Edit any panel, e.g. https://play.grafana.org/d/3SWXxreWk/grafana-dashboard?orgId=1\u0026editPanel=4\r\n\r\n- Add Description text containing table markdown code, e.g.:\r\n```\r\n| Correct | Horse | Staple | Butter | Mint | Bus | Bread | Elephant| Extremity| Problematic | Incomplete|\r\n| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |\r\n| |\r\n|Lorem Ipsum |Lorem Ipsum |Lorem Ipsum |Lorem Ipsum |Lorem Ipsum |Lorem Ipsum |Lorem Ipsum |Lorem Ipsum |Lorem Ipsum |Lorem Ipsum |Lorem Ipsum |\r\n```\r\n\r\n- Result\r\n![image](https://user-images.githubusercontent.com/111264449/184594746-ff1500c2-1c03-4f07-8c83-1277499e94f0.png)\r\nHere the table escapes the description box. (Firefox)\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/111264449/184596338-c6fbf0bc-8cda-4143-86f7-cbd04d597a0e.png)\r\nHere a panel on the right side of the dashboard has the description cut off. (Firefox)\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/111264449/184597165-45012646-131e-457f-8229-3537881371a8.png)\r\nHere is the same issue duplicated in Chrome.\r\n\r\n\r\n**Anything else we need to know?**:\r\nThis issue is similar to [Issue #29239](https://github.com/grafana/grafana/issues/29239) which has been fixed.\r\n\r\n**Environment**:\r\n- Grafana version: `Grafana v9.0.7 (eed942a50)`\r\n- Data source type \u0026 version: \r\n- OS Grafana is installed on: \r\n- User OS \u0026 Browser: Windows 10 21H1, Firefox 103.0.2 (64-bit), Chrome Version 104.0.5112.81 (Official Build) (64-bit)\r\n\r\n- Grafana plugins: \r\n- Others: \r\n","labels":["type/bug","help wanted","beginner friendly","area/panel/edit","good first issue"]},{"id":46730,"title":"Grafana 8.4.3 after upgrade, query datasource issue","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nAfter migrating from 7.5.3 to 8.4.3 we have a strange behavior with the data source.\r\nWe are using a variable Data source, named datasource, of type Prometheus.\r\nIf you edit a panel that contains this variable you see that the value is the name of the data source instead of being the variable.\r\n\r\nWhen a query of the panel is modified and saved the value of the data source is changed and stored permanently.\r\nMeaning that after applying the change when the variable value change in the dashboard we are still seeing the wrong graph.\r\n\r\n**What you expected to happen**:\r\nThe query datasource should match ${datasource} variable in the query tab since it's the behavior prior edition of the query.\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nEdit a panel, edit a query save it, change the value of ${datasource}. If you edit again the panel, you'll see that the datasource of the query took the value of ${datasource} when it was saved. \r\nIf you change ${datasource} value, it doesn't change anymore. Example in the video attached.\r\n\r\n**Anything else we need to know?**:\r\nWe upgraded Grafana from 7.5.3.\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.3\r\n- Data source type \u0026 version: Prometheus core\r\n- OS Grafana is installed on: Linux Ubuntu 18.04.2 LTS\r\n- User OS \u0026 Browser: Linux Firefox\r\n- Grafana plugins:\r\n\r\n- Others:\r\n\r\n![Grafanaissue](https://user-images.githubusercontent.com/79837141/158999159-9545c2b2-d934-48b9-bddf-a1cd017abbcc.gif)\r\n","labels":["type/duplicate","area/panel/graph"]},{"id":60823,"title":"Service graph panel Prometheus query invalid after enabling tempoApmTable","body":"**What happened**:\r\n\r\nEnabling the feature flag `tempoApmTable` breaks filtering the Tempo service graph panel on dashboards.\r\n\r\nThis is the PromQL query before and after enabling this feature. This might also be caused by the version difference, I haven't tested these in isolation.\r\n\r\nBefore (v9.2.2):\r\n\r\n```\r\nrate(traces_service_graph_request_server_seconds_sum{client=~\\\".*\\\",server=~\\\".*\\\",connection_type=~\\\".*\\\"}[$__range])\r\n```\r\n\r\nAfter (v9.3.1, note the filters):\r\n\r\n```\r\ntopk(5, sum(rate(traces_spanmetrics_calls_total{service=\"${client\"},span_kind=\"SPAN_KIND_SERVER\"}[$__range])) by (span_name))\r\n```\r\n\r\n**What you expected to happen**:\r\n\r\nThe query should be valid, i.e.\r\n\r\n```\r\ntopk(5, sum(rate(traces_spanmetrics_calls_total{service=\".*\",span_kind=\"SPAN_KIND_SERVER\"}[$__range])) by (span_name))\r\n```\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n1. Run the latest version of Grafana \r\n2. Enable the `tempoApmTable` feature toggle\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: v9.3.1\r\n- Data source type \u0026 version: Tempo, latest","labels":["prio/high","datasource/Tempo"]},{"id":85704,"title":"Dashboards: Template query variables break when results are empty.","body":"### What happened?\n\nSometimes the result of the templating query is `null` which may be a valid condition.\r\nThis should be allowed without notifying 'Templating error: Failed to fetch , Failed to update'\n\n### What did you expect to happen?\n\nWhen loading the dashbord, if the query produces null resultset, the Error Notification is shown\n\n### Did this work before?\n\nYes. Earlier the 'Templating error Notification' was not shown for NULL resultset.\r\nRather it was shown only where the query results 'Failed to fetch' which is the correct behaviour.\n\n### How do we reproduce it?\n\n1.Load a dashboard with Templating query variables.\r\n2.When result of query is 'NULL' or no rows, the Error Notifcation shows up\r\n\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana:10.4.0\r\nOS:Linux\r\nBrowser:Chrome\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\n_No response_","labels":["area/dashboard/templating","needs more info"]},{"id":65380,"title":"Grafana sends expired id token in X-Id-Token header to datasource when using \"Forward OAuth Identity\"","body":"**What happened**:\r\nI'm using Grafana v9.4.7 with auth.azuread \u0026 accessTokenExpirationCheck\r\n\r\n``` ini\r\n[auth.azuread]\r\nscopes = openid email profile offline_access\r\nenabled = true\r\nauto_login = true\r\n...\r\n\r\n[feature_toggles]\r\nenable = accessTokenExpirationCheck\r\n```\r\n\r\nWhen authenticating towards a Promethues datasource with \"Forward OAuth Identity\" active and using the token in the X-Id-Token header on the prometheus side for auth it works for 1h (token lifetime). Then starts failing due to expired token. The ID Token is not refreshed after sign in to Grafana.\r\n\r\n![image](https://user-images.githubusercontent.com/984074/227982168-2356f9ca-546d-42c4-acd8-10e7657bc44a.png)\r\n\r\nI can work around it by setting `auth.login_maximum_lifetime_duration` \u003c 1h and let auth.azuread.auto_login log me in again every hour. This is a bit annoying to get thrown out of Grafana regularly thou, even if the auto_login works.\r\n\r\n**What you expected to happen**:\r\nI expect Grafana to not send expired ID tokens to datasources when \"Forward OAuth Identity\" is used and the accessTokenExpirationCheck feature toggle is active. Instead it should be refreshed and a valid (not expired) ID token should be sent with requests.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nConfigure [auth.azuread], enable accessTokenExpirationCheck and observe tokens in headers received at datasource after 1h.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.7, don't think it has ever worked, tried on 9.4.1 as well.\r\n- Data source type \u0026 version: Prometheus 2.37.x\r\n- OS Grafana is installed on: Running official docker image on amd64 hardware grafana/grafana:9.4.7","labels":["type/bug","area/auth/oauth","team/identity-access","triage/needs-confirmation"]},{"id":84870,"title":"Dashboards: Custom Variables labels don't display when variable mentioned on the url","body":"### What happened?\n\n\r\nwhen creating a dashboard using custom variables the labels do not display correctly (and then disappear) \r\nif reloading the url\r\n\r\nHere is the initial view of the dashboard:\r\n\u003cimg width=\"472\" alt=\"Screenshot 2024-03-20 at 5 00 12 PM\" src=\"https://github.com/grafana/grafana/assets/71188769/abf8de21-581d-4bd6-92c8-2c8957c7ebcd\"\u003e\r\n\r\nnow select \"yes\" from the drop down:\r\n\u003cimg width=\"472\" alt=\"Screenshot 2024-03-20 at 5 00 58 PM\" src=\"https://github.com/grafana/grafana/assets/71188769/03d040ed-58f2-4485-9483-743023502b7b\"\u003e\r\n\r\n\"yes\" (the label) is now displayed in the drop down:\r\n\u003cimg width=\"472\" alt=\"Screenshot 2024-03-20 at 5 00 21 PM\" src=\"https://github.com/grafana/grafana/assets/71188769/957244d0-f36c-4d5b-ae8a-39bbac960bc2\"\u003e\r\n\r\nreload the dashboard url\r\n\r\nnow \"oui\" (the value) is displayed in the drop down.\r\n\u003cimg width=\"472\" alt=\"Screenshot 2024-03-20 at 5 00 30 PM\" src=\"https://github.com/grafana/grafana/assets/71188769/f09356a4-91e1-4094-a8a5-fa89a95ccd21\"\u003e\r\n\r\nif you select the drop down only the \"All\" option is available:\r\n\u003cimg width=\"472\" alt=\"Screenshot 2024-03-20 at 5 00 42 PM\" src=\"https://github.com/grafana/grafana/assets/71188769/63db023a-3a4e-4b95-a9e9-1dfd18d9d14a\"\u003e\r\n\n\n### What did you expect to happen?\n\n\r\nThe drop down at the end of the sequence should contain the expected lables:\r\n\u003cimg width=\"472\" alt=\"Screenshot 2024-03-20 at 5 00 58 PM\" src=\"https://github.com/grafana/grafana/assets/71188769/03d040ed-58f2-4485-9483-743023502b7b\"\u003e\r\n\n\n### Did this work before?\n\nyes, it used to work back in grafana 8\n\n### How do we reproduce it?\n\n1. create a dashboard with this json:\r\n\r\n```\r\n{\r\n  \"__inputs\": [],\r\n  \"__elements\": {},\r\n  \"__requires\": [\r\n    {\r\n      \"type\": \"grafana\",\r\n      \"id\": \"grafana\",\r\n      \"name\": \"Grafana\",\r\n      \"version\": \"10.4.0\"\r\n    }\r\n  ],\r\n  \"annotations\": {\r\n    \"list\": [\r\n      {\r\n        \"builtIn\": 1,\r\n        \"datasource\": {\r\n          \"type\": \"grafana\",\r\n          \"uid\": \"-- Grafana --\"\r\n        },\r\n        \"enable\": true,\r\n        \"hide\": true,\r\n        \"iconColor\": \"rgba(0, 211, 255, 1)\",\r\n        \"name\": \"Annotations \u0026 Alerts\",\r\n        \"type\": \"dashboard\"\r\n      }\r\n    ]\r\n  },\r\n  \"editable\": true,\r\n  \"fiscalYearStartMonth\": 0,\r\n  \"graphTooltip\": 0,\r\n  \"id\": null,\r\n  \"links\": [],\r\n  \"panels\": [],\r\n  \"schemaVersion\": 39,\r\n  \"tags\": [],\r\n  \"templating\": {\r\n    \"list\": [\r\n      {\r\n        \"allValue\": \".*\",\r\n        \"current\": {\r\n          \"selected\": false,\r\n          \"text\": \"All\",\r\n          \"value\": \"$__all\"\r\n        },\r\n        \"description\": \"\",\r\n        \"hide\": 0,\r\n        \"includeAll\": true,\r\n        \"multi\": false,\r\n        \"name\": \"custom\",\r\n        \"options\": [\r\n          {\r\n            \"selected\": true,\r\n            \"text\": \"All\",\r\n            \"value\": \"$__all\"\r\n          },\r\n          {\r\n            \"selected\": false,\r\n            \"text\": \"yes\",\r\n            \"value\": \"oui\"\r\n          },\r\n          {\r\n            \"selected\": false,\r\n            \"text\": \"no\",\r\n            \"value\": \"non\"\r\n          }\r\n        ],\r\n        \"query\": \"yes : oui, no : non\",\r\n        \"queryValue\": \"\",\r\n        \"skipUrlSync\": false,\r\n        \"type\": \"custom\"\r\n      }\r\n    ]\r\n  },\r\n  \"time\": {\r\n    \"from\": \"now-6h\",\r\n    \"to\": \"now\"\r\n  },\r\n  \"timepicker\": {},\r\n  \"timezone\": \"browser\",\r\n  \"title\": \"custom-var-test\",\r\n  \"uid\": \"fdga0pvf4pzi8e\",\r\n  \"version\": 2,\r\n  \"weekStart\": \"\"\r\n}\r\n```\r\n\r\n2. select `yes` from the custom variable drop down\r\n\r\n3. hit reload on the web page\r\n\r\n4. notice how the drop down now shows `oui` (the value not the label)\r\n\r\n5. also notice how the only option available for selection is `All`\n\n### Is the bug inside a dashboard panel?\n\nno\n\n### Environment (with versions)?\n\nGrafana: Grafana v10.4.0 (03f502a94d)\r\nOS: browser running on Mac Ventura 13.6.4 (22G513)\r\nBrowser: Chrome Version 121.0.6167.184 (Official Build) (arm64)\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nnone","labels":["area/dashboard","triage/needs-confirmation","team/grafana-dashboards"]},{"id":84059,"title":"Grafana sends a blank email after each notification","body":"### What happened?\n\nI have a problem with the configuration of email notifications that I can’t fix. I created a notification rule as shown in the screenshots below:\r\n![1](https://github.com/grafana/grafana/assets/162567219/902c41b3-1ea4-4892-9ffa-e7ebb66b00ac)\r\n![2](https://github.com/grafana/grafana/assets/162567219/707b3cc3-7898-4d2d-ab47-3714d9786528)\r\n![3](https://github.com/grafana/grafana/assets/162567219/2d0d62df-2ae3-4a54-9e43-0dadcfbc51e5)\r\nEverything works fine, grafana sends an email with the log:\r\n![4](https://github.com/grafana/grafana/assets/162567219/f11d6af7-f585-4e43-a183-9b732a5bbd99)\r\nHowever, this message is followed by another blank email\r\n![5](https://github.com/grafana/grafana/assets/162567219/0efc3e28-7ac3-491e-b4d8-89ead314c745)\r\nI’ve tried different configurations, silencing, upgraded Grafana to version 10.4.0, created the rule anew but none of these things help.\r\nMaybe one of you has encountered such a problem and can point out to me where I am making a mistake.\r\nGreetings\r\n\r\n\n\n### What did you expect to happen?\n\nDo not send an additional blank email\n\n### Did this work before?\n\nNo\n\n### How do we reproduce it?\n\n1.Create a notification as in the screenshots\r\n2.\r\n3.\r\n\n\n### Is the bug inside a dashboard panel?\n\nNo\n\n### Environment (with versions)?\n\nGrafana: v10.4.0\r\nOS:\r\nBrowser:\r\n\n\n### Grafana platform?\n\nA downloaded binary\n\n### Datasource(s)?\n\n_No response_","labels":["needs more info","area/alerting","triage/needs-confirmation"]},{"id":81457,"title":"Dashboards: Repeated panels are recreated on dashboard refresh","body":"### What happened?\n\nIf panel is repeated by query variable, all repeated panels are unmounted and mounted with the same variable value on dashboard refresh\r\n\r\nRepeated option enabled\r\n\u003cimg width=\"431\" alt=\"Screenshot 2024-01-29 at 13 09 11\" src=\"https://github.com/grafana/grafana/assets/15867703/54b7a95f-5a52-4e4d-a136-adf78652e27e\"\u003e\r\n\r\nPanel code\r\n```\r\nexport const Panel = ({\r\n  id,\r\n}) =\u003e {\r\n  useEffect(() =\u003e {\r\n    console.warn('mount', id);\r\n    return () =\u003e {\r\n      console.warn('unmount', id);\r\n    };\r\n  }, [id]);\r\n\r\n  return \u003cdiv\u003emy panel\u003c/div\u003e\r\n}\r\n```\r\n\r\nConsole output on dashboard refresh\r\n\u003cimg width=\"180\" alt=\"Screenshot 2024-01-29 at 13 07 15\" src=\"https://github.com/grafana/grafana/assets/15867703/04678873-c260-42f2-afef-26fbf6161dab\"\u003e\r\n\n\n### What did you expect to happen?\n\nAll existing repeated panels should be updated instead of recreated.\n\n### Did this work before?\n\nNo info\n\n### How do we reproduce it?\n\n1. Create a query variable\r\n2. Add a panel and repeat it by the created variable\r\n3. Refresh dashboard (by refresh button or set auto refresh interval)\r\n4. Original panel will be updated, repeated panel will be re-created with the same variable value (the issue)\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.1.5\r\nOS: macOS\r\nBrowser: Chrome\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["area/dashboard","team/grafana-dashboards"]},{"id":65620,"title":"Session information not recorded with HTTP basic auth","body":"**What happened**:\r\n\r\nI have Grafana successfully configured to use my webserver's HTTP basic auth for authentication, per the instructions at:\r\n\r\n- https://grafana.com/docs/grafana/latest/setup-grafana/configure-security/configure-authentication/auth-proxy/\r\n\r\nHowever I've noticed that for my users - none of the session information under the server admin section is recorded. For audit purposes - it'd be useful if Grafana could still save this information.\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.8","labels":["area/auth","triage/needs-confirmation"]},{"id":64673,"title":"Tooltip value sorting doesn't work as expected when using mixed data sources","body":"**What happened**:\r\n\r\nI have a panel that has two queries that use mixed data sources including, Azure Monitoring and Prometheus. I extract CPU usage from these two data sources and then try to sort them from the highest CPU usage to the lowest by setting **Tooltip \u003e Values sort order** to **Descending**. Unfortunately, the sorting does work as expected and ignores the metrics from Azure Monitoring.\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/22220356/224660489-4e3af950-97c6-41a9-9bd4-53766167fa4a.png)\r\n![image](https://user-images.githubusercontent.com/22220356/224661205-35fac53a-530f-48cc-bf04-7094f82f01a2.png)\r\n![image](https://user-images.githubusercontent.com/22220356/224661067-43f51d0d-b007-4458-9cad-314a401f47d7.png)\r\n\r\n**What you expected to happen**:\r\n\r\nIncluding all the metrics then try to sort them in Tooltip.\r\n\r\n**Environment**:\r\n- Grafana version: v9.3.6\r\n- Data source type \u0026 version: Azure Monitor + Prometheus\r\n\r\n\r\n","labels":["bot/no new info","area/tooltip"]},{"id":45524,"title":"Overrides dont work when one timeseries is missing","body":"Hi,\r\n\r\nwhen doing queries where all dataseries are available, all is fine...\r\n\r\n![Clipboard01](https://user-images.githubusercontent.com/6953309/154492080-7d164971-504c-433c-b94d-1793d5422413.png)\r\n\r\nBut in the night PV doesn't contain any values...\r\nThis seems to break the overrides\r\n\r\n![Clipboard02](https://user-images.githubusercontent.com/6953309/154492282-356b653e-b78c-4208-ad15-66f242b6bf3b.png)\r\n\r\n**Environment**:\r\n- Grafana version 8.4.0:\r\n- Influx 2.1.1:\r\n- dockered in a dietPi:\r\n- Win10 latest / chrome lastest:\r\n- no Grafana plugins:\r\n\r\nThx,\r\nAlex\r\n","labels":["needs investigation","area/field/overrides","area/panel/timeseries"]},{"id":64886,"title":"High browser RAM usage on 9.4","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: When using the time series panel, and the logarithmic scale, if the min is set to 0, the RAM used by the browser will grow up to 3/4GB (on my end)\r\n\r\n**What you expected to happen**:\r\n\r\nNo RAM growth\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n- Create a new time series panel (works with default datasource)\r\n- Set the `min` in `Standard options` to 0\r\n- Set the `scale` in `Axis` to `logarithmic` \r\n- Watch your ram grow\r\n\r\n**Anything else we need to know?**:\r\n\r\nNo issues on 9.2\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.2\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser: Chromium, Firefox, qutebrowser\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/bug","area/panel/common","area/panel/timeseries"]},{"id":77861,"title":"Loki: Search Capability on RAW log lines (Using variable)","body":"### What happened?\n\nDatasource: Loki\r\nPanel: logs\r\n\r\nI am using loki data source and fetching RAW system logs.\r\nin dashboard I have search bar to search some string/number in RAW logs.\r\n\r\n![image](https://github.com/grafana/grafana/assets/122772369/8d744de6-834d-48bf-a034-3489afffe150)\r\n\r\nI have created a \"search\" variable in the dashboard as a text box. and using this variable in a query like this:\r\n“(?i)$search”\r\n\r\nIn previous Grafana version, it was highlighting the string/number searched in RAW logs, but now it does not.\r\n\r\nWhen I search some number for result code, it does not highlight the text.\r\n![image](https://github.com/grafana/grafana/assets/122772369/407b4625-85ee-4d24-909a-1bb63161e7f8)\r\n\r\nBut instead of using variable in a query, If I directly put the text replacing \"(?i)$search\", it does highlight the text.\r\nExample: {...} | \"5002\" instead of {...} | \"(?i)$search\"\r\n![image](https://github.com/grafana/grafana/assets/122772369/ef86b3ad-037e-498a-94ff-231170fc3cd1)\r\n\r\nIn any of the above method, it should highlight the searched text, this is the only appropriate way to look at some text on the fly.\r\nWithout the text getting highlighted, even after searching for something in bunch of log lines you need to search for the text explicitly. \r\n\r\n\n\n### What did you expect to happen?\n\nIn any of the above method, it should highlight the searched text, this is the only appropriate way to look at some text on the fly.\r\nWithout the text getting highlighted, even after searching for something in bunch of log lines you need to search for the text explicitly. \n\n### Did this work before?\n\nYes, I guess in previous versions\n\n### How do we reproduce it?\n\nMentioned in the \"what happened\"\n\n### Is the bug inside a dashboard panel?\n\nMaybe\n\n### Environment (with versions)?\n\nGrafana: v9.4.3\r\nOS: Linux\r\nBrowser: Chrome\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nLoki","labels":["type/feature-request","area/search","datasource/Loki"]},{"id":44273,"title":"Prometheus: Query editor error when template variable is called 'process' since upgrading to 8.3.3","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: Some of my time series stopped displaying data properly\r\n\r\n**What you expected to happen**: For the time series to display as they did prior to upgrading to 8.3.3\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: I assume using $__rate_interval causes this issue as per comment from Slack. \r\n\r\n**Anything else we need to know?**:\r\n\r\n`TypeError: Cannot read properties of undefined (reading 'LOG')\r\n\r\n    at Lazy\r\n    at Suspense\r\n    at he\r\n    at pe (https://grafana.echo.services/public/build/prometheusPlugin.3bb54bb526c98dcc9eb2.js:57:10001)\r\n    at div\r\n    at div\r\n    at o (https://grafana.echo.services/public/build/6518.3bb54bb526c98dcc9eb2.js:4395:7009)\r\n    at fe (https://grafana.echo.services/public/build/prometheusPlugin.3bb54bb526c98dcc9eb2.js:57:10563)\r\n    at ke (https://grafana.echo.services/public/build/prometheusPlugin.3bb54bb526c98dcc9eb2.js:64:394)\r\n    at Fe (https://grafana.echo.services/public/build/prometheusPlugin.3bb54bb526c98dcc9eb2.js:64:4431)\r\n    at Sl (https://grafana.echo.services/public/build/6518.3bb54bb526c98dcc9eb2.js:2870:458)\r\n    at kl (https://grafana.echo.services/public/build/6518.3bb54bb526c98dcc9eb2.js:2870:1006)\r\n    at div\r\n    at div\r\n    at div\r\n    at https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:584952\r\n    at f (https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:498534)\r\n    at Uo (https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:586323)\r\n    at Ho (https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:586441)\r\n    at c (https://grafana.echo.services/public/build/6518.3bb54bb526c98dcc9eb2.js:4517:962)\r\n    at div\r\n    at C (https://grafana.echo.services/public/build/6518.3bb54bb526c98dcc9eb2.js:6699:544)\r\n    at div\r\n    at https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:588665\r\n    at f (https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:498534)\r\n    at f (https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:496189)\r\n    at oo (https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:571698)\r\n    at t (https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:504957)\r\n    at io (https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:575436)\r\n    at d (https://grafana.echo.services/public/build/487.3bb54bb526c98dcc9eb2.js:82:810)\r\n    at div\r\n    at div\r\n    at div\r\n    at div\r\n    at div\r\n    at t (https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:657031)\r\n    at u (https://grafana.echo.services/public/build/6518.3bb54bb526c98dcc9eb2.js:264:1038)\r\n    at L (https://grafana.echo.services/public/build/3453.3bb54bb526c98dcc9eb2.js:5:388)\r\n    at We (https://grafana.echo.services/public/build/DashboardPage.3bb54bb526c98dcc9eb2.js:167:323)\r\n    at div\r\n    at Fr (https://grafana.echo.services/public/build/6518.3bb54bb526c98dcc9eb2.js:2429:31)\r\n    at div\r\n    at https://grafana.echo.services/public/build/DashboardPage.3bb54bb526c98dcc9eb2.js:177:1639\r\n    at div\r\n    at div\r\n    at t (https://grafana.echo.services/public/build/DashboardPage.3bb54bb526c98dcc9eb2.js:426:3233)\r\n    at div\r\n    at t (https://grafana.echo.services/public/build/DashboardPage.3bb54bb526c98dcc9eb2.js:426:5184)\r\n    at div\r\n    at t (https://grafana.echo.services/public/build/DashboardPage.3bb54bb526c98dcc9eb2.js:426:3233)\r\n    at div\r\n    at t (https://grafana.echo.services/public/build/DashboardPage.3bb54bb526c98dcc9eb2.js:426:5184)\r\n    at _r (https://grafana.echo.services/public/build/DashboardPage.3bb54bb526c98dcc9eb2.js:426:10798)\r\n    at div\r\n    at div\r\n    at ia (https://grafana.echo.services/public/build/DashboardPage.3bb54bb526c98dcc9eb2.js:486:6049)\r\n    at v (https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:971571)\r\n    at div\r\n    at Mi (https://grafana.echo.services/public/build/DashboardPage.3bb54bb526c98dcc9eb2.js:574:3581)\r\n    at DashboardPage\r\n    at v (https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:971571)\r\n    at n (https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:942013)\r\n    at ce (https://grafana.echo.services/public/build/6518.3bb54bb526c98dcc9eb2.js:4326:193)\r\n    at t (https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:989569)\r\n    at t (https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:991590)\r\n    at main\r\n    at t (https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:986187)\r\n    at div\r\n    at qs (https://grafana.echo.services/public/build/6518.3bb54bb526c98dcc9eb2.js:2158:1022)\r\n    at d (https://grafana.echo.services/public/build/6518.3bb54bb526c98dcc9eb2.js:4771:26210)\r\n    at Sl (https://grafana.echo.services/public/build/6518.3bb54bb526c98dcc9eb2.js:2870:458)\r\n    at kl (https://grafana.echo.services/public/build/6518.3bb54bb526c98dcc9eb2.js:2870:1006)\r\n    at l (https://grafana.echo.services/public/build/5105.3bb54bb526c98dcc9eb2.js:2:969089)\r\n    at $e (https://grafana.echo.services/public/build/6518.3bb54bb526c98dcc9eb2.js:4339:436)`\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.3 then upgraded to 8.3.4 but same error\r\n- Data source type \u0026 version: Prometheus 2.32.1/Thanos 0.24.0\r\n- OS Grafana is installed on: Ubuntu\r\n- User OS \u0026 Browser: Windows 10 Edge\r\n- Grafana plugins: CSV, Image Renderer, Google Sheets\r\n- Others:\r\n![image](https://user-images.githubusercontent.com/2940588/150351708-1607e108-2944-4ca9-8ef4-aaae6d4b55ae.png)\r\n","labels":["type/bug","datasource/Prometheus","needs investigation","area/query-editor"]},{"id":61239,"title":"Variable not working within transform rename","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI am trying to do a transform rename on a field and replace it with a name from my dashboard variables, but it's not working. It's using my variable as plain text instead of using it as a variable\r\n\r\n**What you expected to happen**:\r\nI would expect for it to use the value from the variable that I'm specifying\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate a variable with a value in it. Then try to do a field rename transform and set it to that variable\r\n\r\n**Anything else we need to know?**:\r\n\r\nHere's a screenshot of what I'm doing:\r\n\r\n\u003cimg width=\"645\" alt=\"image\" src=\"https://user-images.githubusercontent.com/5418178/211604802-f49793d6-2f07-4faf-b6f9-724f5e9a7e8e.png\"\u003e\r\n\r\nYou can see at the top that it is using the variable name as text instead of actually getting the value of the variable. Am I missing something or is this a bug?\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.1\r\n- OS Grafana is installed on: Windows Server 2022\r\n- User OS \u0026 Browser: Windows 11 \u0026 Microsoft Edge\r\n","labels":["area/dashboard/templating","datasource/Postgres","needs investigation","area/transformations"]},{"id":57098,"title":"Nested Notification Policy Expected Behavior","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nNested notification policy triggering as expected but alert email not being sent to the parent notification policy contact point.\r\n\r\n![notification-policy-tree](https://user-images.githubusercontent.com/20999846/196688485-a6f7c4b3-cc41-4e8f-b20c-7eb5afcb6eb1.jpg)\r\n\r\n\r\n**What you expected to happen**:\r\nI was expecting that the alert email would be sent to both the parent notification policy contact point and the nested policy contact point (based on what I understood from the documentation).\r\n\r\nI had posted a [question in the community](https://community.grafana.com/t/nested-notification-policy-contact-point/74137) last week but failed to get a response, hence the attempt here.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: v9.1.5\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/docs","area/alerting","area/alerting/notifications"]},{"id":44893,"title":"XY Chart not working with influxdb data across two queries?","body":"Hi! Been using XYChart a bit more and I have problems using data from two different queries. ( I need different queries as they are from different influx measurements.) It seems XYChart does not at the moment correctly place them on different axis. If they are formatted as time series I get a display but the Y field seems to have the wrong data as it seems to plot the X-axis data:\r\n![image](https://user-images.githubusercontent.com/12225528/152507347-8de59a2d-1b8c-4480-b4bc-d9c90a0242c9.png)\r\nI use explicit mode as XY seems to only handle data from one query.\r\nI have also tried formatting the query results \"as table\", but this works even worse as the X axis seems to plot the timestamp rather than what I have set in the X-axis box which is \"Wind Speed\" [Correction, actually it works as table just like timeseries if I at some point select the same variable on the two graphs, but then it acts just the same, it plots the same data on both axis and it doesnt do anything if I choose different data. However I'll let the image stand here as that shows the error where it uncommanded sets the x-axis to timestamp data-it might help understanding the issue. I guess it's because it's the first column in the returned data]\r\n![image](https://user-images.githubusercontent.com/12225528/152508516-ccebb94f-763e-43c5-a638-7934217fb7e5.png)\r\nLike so\r\n\r\n\r\n**Environment**:\r\n- Grafana version:8.3.3\r\n- Data source type \u0026 version:influxdb 1.7.10\r\n- OS Grafana is installed on:Win10\r\n- User OS \u0026 Browser:Chrome\r\n- Grafana plugins:XYChart\r\n- Others:\r\n","labels":["needs more info","area/panel/xychart"]},{"id":61203,"title":"Concurrent tagged annotation creations can fail due to duplicate entry errors in mysql ","body":"**What happened**:\r\n We use tagged annotations to record Kubernetes events, which get stored in the mysql database. \r\n\r\nE.g. we might create 2 annotations concurrently (since there is no bulk creation endpoint).\r\n - `kube_deployment`: `foo`, `kube_pod`: `one` \r\n - `kube_deployment`: `foo`, `kube_pod`: `two` \r\n\r\nThe first annotation gets created, and the second annotation creation fails with `{\"error\":\"Error 1062: Duplicate entry 'kube_deployment-foo' for key 'UQE_tag_key_value'\",\"logger\":\"context\",\"lvl\":\"eror\",\"msg\":\"Failed to save annotation\",\"remote_addr\":\"...\",\"t\":\"...\"}`\r\n\r\nGeneral query logging on mysql db ordered by descending event_time reveals a concurrency bug. In essence, it looks like each thread is doing the following without the use of transactions: check if the tag exists, if not, create one. The last INSERT statement causes the error.\r\n\r\n\u003e event_time\tuser_host\tthread_id\tserver_id\tcommand_type\targument \r\nMon Jan 09 2023 23:53:01 GMT+1100 \tgrafana[grafana] @ []\t143\tx\tExecute\tINSERT INTO `tag` (`key`,`value`) VALUES ('kube_deployment', 'foo')\r\nMon Jan 09 2023 23:53:01 GMT+1100 \tgrafana[grafana] @ []\t144\tx\tExecute\tINSERT INTO `tag` (`key`,`value`) VALUES ('kube_deployment', 'foo')\r\nMon Jan 09 2023 23:53:01 GMT+1100 \tgrafana[grafana] @ []\t143\tx\tExecute\tSELECT `id`, `key`, `value` FROM `tag` WHERE (`key`='kube_deployment' AND `value`='foo') LIMIT 1\r\nMon Jan 09 2023 23:53:01 GMT+1100 \tgrafana[grafana] @ []\t144\tx\tExecute\tSELECT `id`, `key`, `value` FROM `tag` WHERE (`key`='kube_deployment' AND `value`='foo') LIMIT 1\r\n\r\n**What you expected to happen**:\r\n\r\nSuccessful creation of both annotations.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.x\r\n- DB version: mysql 5.7 \r\n\r\n","labels":["type/bug","type/feature-request","area/annotations"]},{"id":45700,"title":"Hovering over \"Cycle view mode\" makes scrollbar appear","body":"**What happened**:\r\n\r\nI hovered with my mouse over the \"Cycle view mode\" button in the dashboard view and a scrollbar appeared together with the hover-text. (Screencast attached.)\r\n\r\n**What you expected to happen**:\r\n\r\nThe hover-text should be clamped to the right screen border and not generate a scrollbar.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nHover over the \"Cycle view mode\" button in any dashboard view.\r\n\r\n**Anything else we need to know?**:\r\n\r\nThis might cause some annoying layout shift with certain dashboards or on different screen sizes.\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.1\r\n- User OS \u0026 Browser: Fedora 35 / Google Chrome 98\r\n\r\nhttps://user-images.githubusercontent.com/24257556/155022077-164217ed-2fd7-41d4-84a0-40db410c2972.mp4","labels":["needs investigation","area/ux","stale"]},{"id":64073,"title":"Transformation Group by not working after upgrade 9.4.2","body":"**Environment**:\r\n- Grafana version: 9.4.2\r\n- Data source type \u0026 version: influxQL\r\n- OS Grafana is installed on: 1.3.2023\r\n- User OS \u0026 Browser: Chrome Versión 110.0.5481.178 (Build oficial) (64 bits) \u0026 Windows 11\r\n- Grafana plugins: Stat\r\n\r\nafter upgrading grafana_9.3.8 to grafana_9.4.2 I got the error below.\r\n\r\n\u003cimg width=\"668\" alt=\"image\" src=\"https://user-images.githubusercontent.com/57649178/222546064-2d674450-f90c-4935-b750-a64b099f3c35.png\"\u003e\r\n\r\nlooks like Group by is not working\r\n\r\n\u003cimg width=\"687\" alt=\"image\" src=\"https://user-images.githubusercontent.com/57649178/222546218-ed2eea8a-16d9-4d39-8f60-a0d2fc5347b9.png\"\u003e\r\n\r\nAlso I got this\r\n\r\n\u003cimg width=\"455\" alt=\"image\" src=\"https://user-images.githubusercontent.com/57649178/222546420-0181890c-c9c5-427b-bf02-350270260381.png\"\u003e\r\n\r\n\u003cimg width=\"677\" alt=\"image\" src=\"https://user-images.githubusercontent.com/57649178/222546554-b2cef131-eae0-4dd8-9517-2b7e0650883f.png\"\u003e\r\n\r\n\u003cimg width=\"706\" alt=\"image\" src=\"https://user-images.githubusercontent.com/57649178/222546644-716aa59b-63e3-408d-b24c-9aaadd0f49ae.png\"\u003e\r\n\r\n","labels":["datasource/InfluxDB","needs more info","prio/medium","area/transformations","triage/needs-confirmation","effort/medium"]},{"id":53752,"title":"Unable to delete Library Panel - Grafana Cloud","body":"\r\n**What happened**: I tried to delete a library panel. Instead I got the message \"Failed to delete library element\"\r\n![image](https://user-images.githubusercontent.com/56303146/184695536-eb0d834f-b475-407c-905f-63d594b0b84f.png)\r\nI've closed my browser instance and reloaded and the issue persists. I've tried on different panels. No panel will delete.\r\n\r\n**What you expected to happen**:  The panel to successfully delete.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: Try to delete a panel on Grafana Cloud.\r\n\r\n**Anything else we need to know?**: No\r\n\r\n**Environment**:\r\n- Grafana version: Grafana Cloud\r\n- Data source type \u0026 version: N/A\r\n- OS Grafana is installed on: Grafana Cloud\r\n- User OS \u0026 Browser: Windows 11 \u0026 Chrome\r\n- Grafana plugins: None\r\n- Others:\r\n","labels":["needs more info","area/frontend/library-panels"]},{"id":50280,"title":"Grafana cannot start when Plugin not found","body":"**What happened**:\r\nAfter a kubernetes cluster reboot that was triggered by deploying security patches to our nodes the grafana pod was not starting anymore. The only information we had was one suspicious log entry saying:\r\n\"Error: ✗ Plugin not found (Grafana v8.3.5 linux-amd64)\"\r\nThe situation was solved by removing the requried plugins from the helm chart one by one until identifying the one that caused the issue.\r\n\r\n**What you expected to happen**:\r\nWe would expect grafana to start successfully and log an error specifiying the \"plugin not found\" error including the plugin that caused this error.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nSpecify a grafana plugin in the helm chart to be loaded on startup from the internet, which is not available.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: Grafana v8.3.5 linux-amd64\r\n- Data source type \u0026 version:  n/a\r\n- OS Grafana is installed on: kube-prometheus-stack on Kubernetes 1.21\r\n- User OS \u0026 Browser: n/a\r\n- Grafana plugins: azure-datasource\r\n- Others:\r\n","labels":["type/duplicate","area/plugins"]},{"id":64021,"title":"Table filter funnels not clickable when panel title is empty","body":"\r\n**What happened**:\r\nI enabled column filtering from the table panel settings, left the panel title empty as not needed for GUI design. The filter funnel icons show but cannot be clicked.\r\n\r\n**What you expected to happen**:\r\nI should be presented with a drop-down menu to filter the chosen table column.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nEnable column filtering on the table panel and then try click on the funnel icon at the top row of a column, Nothing happens.\r\n\r\n**Anything else we need to know?**:\r\nWhen I populate the panel title, the column filtering works. Seems it has be filled out otherwise the the panel title HTML element sits over the top row so you cannot sort or filter columns. Same outcome with using Edge web browser.\r\n\r\n**Environment**:\r\n- Grafana version: v9.3.4\r\n- Data source type \u0026 version: MySQL (Bundled with Grafana)\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser: Windows 10 and Google Chrome version 110.0.5481.177\r\n- Grafana plugins: MySQL\r\n","labels":["type/bug","area/panel/table"]},{"id":47297,"title":" Threshold colors not loading properly","body":"**What happened**:\r\nThe Bargraph is set up for mysql Table, Threshold color is setup. The color are working properly at the time of dashboard loading and once any  variable changes at dashboard top and bar graph values are changed the threshold colors are not working properly.\r\nThe dashboard is setup to reload every 5s. also tried with overide property, same issue exist.\r\n\r\nThe threshold color setup like this base red,\u003e70 yellow,\u003e90 Green\r\nGraph at time of loading of dashboard\r\n![s1](https://user-images.githubusercontent.com/42416179/161692552-18fb63ab-5568-427d-b656-a34c4a53d427.PNG)\r\n\r\nGraph showing incorrect threshold colors when variables and values are changed\r\n![s2](https://user-images.githubusercontent.com/42416179/161692623-08aa2108-4b10-414e-8f6c-10cc54d80dc9.PNG)\r\n\r\n\r\n**What you expected to happen**:\r\nThe threshold color needs to be changed when the values of the graph changes in the dynamic dashboards\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.5\r\n- Data source type \u0026 version: MySQL 8.0.28\r\n- OS Grafana is installed on: Windows\r\n- User OS \u0026 Browser: Chrome\r\n- Grafana plugins: Mysql\r\n","labels":["needs more info","area/panel/barchart"]},{"id":76292,"title":"Panel: Zero year timepicker causes timeseries plugin to crash","body":"### What happened?\n\nNew Dashboard\r\nSet date picker to \r\n    \"from\": \"0000-01-01T00:00:00.000Z\",\r\n    \"to\": \"0000-01-01T00:01:00.000Z\"\r\n\r\nAdding new visualization hangs browser and eventually displays, \"Error in plugin\" in the upper left red plot box.\n\n### What did you expect to happen?\n\nExpected new visualization to render correctly.\n\n### Did this work before?\n\nNo\n\n### How do we reproduce it?\n\n1. Create new dashboard\r\n2. Set timepicker \"from\": \"0000-01-01T00:00:00.000Z\", \"to\": \"0000-01-01T00:01:00.000Z\"\r\n3. Attempt to add a panel \r\n\n\n### Is the bug inside a dashboard panel?\n\n| Key | Value |\r\n|--|--|\r\n| Panel | timeseries @ 9.2.3 (ec9c2ed029) |\r\n| Grafana | 9.2.3 (ec9c2ed029) // Open Source |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"id\": 2,\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"type\": \"timeseries\",\r\n      \"title\": \"Reproduced with embedded data\",\r\n      \"options\": {\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        },\r\n        \"legend\": {\r\n          \"showLegend\": true,\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"calcs\": []\r\n        }\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"custom\": {\r\n            \"drawStyle\": \"line\",\r\n            \"lineInterpolation\": \"linear\",\r\n            \"barAlignment\": 0,\r\n            \"lineWidth\": 1,\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"spanNulls\": false,\r\n            \"showPoints\": \"auto\",\r\n            \"pointSize\": 5,\r\n            \"stacking\": {\r\n              \"mode\": \"none\",\r\n              \"group\": \"A\"\r\n            },\r\n            \"axisPlacement\": \"auto\",\r\n            \"axisLabel\": \"\",\r\n            \"axisColorMode\": \"text\",\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"axisCenteredZero\": false,\r\n            \"hideFrom\": {\r\n              \"tooltip\": false,\r\n              \"viz\": false,\r\n              \"legend\": false\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"value\": null,\r\n                \"color\": \"green\"\r\n              },\r\n              {\r\n                \"value\": 80,\r\n                \"color\": \"red\"\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"description\": \"\",\r\n      \"targets\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"grafana\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"snapshot\",\r\n          \"snapshot\": [\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"time\",\r\n                    \"type\": \"time\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"time.Time\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"config\": {\r\n                      \"interval\": 2000\r\n                    }\r\n                  },\r\n                  {\r\n                    \"name\": \"A-series\",\r\n                    \"type\": \"number\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"float64\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"labels\": {},\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    -6826965622871,\r\n                    -6826965620871,\r\n                    -6826965618871\r\n                  ],\r\n                  [\r\n                    43.933525422999246,\r\n                    44.134429046570176,\r\n                    43.94396649041487\r\n                  ]\r\n                ]\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003etimeseries @ 9.2.3 (ec9c2ed029)\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003e\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003e 1 frames, 2 fields, 1800 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e9.2.3 (ec9c2ed029) // Open Source\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"title\": \"Original Panel JSON\",\r\n      \"type\": \"text\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 7\r\n      },\r\n      \"options\": {\r\n        \"content\": \"{\\n  \\\"id\\\": 2,\\n  \\\"gridPos\\\": {\\n    \\\"x\\\": 0,\\n    \\\"y\\\": 0,\\n    \\\"w\\\": 12,\\n    \\\"h\\\": 9\\n  },\\n  \\\"type\\\": \\\"timeseries\\\",\\n  \\\"title\\\": \\\"Panel Title\\\",\\n  \\\"options\\\": {\\n    \\\"tooltip\\\": {\\n      \\\"mode\\\": \\\"single\\\",\\n      \\\"sort\\\": \\\"none\\\"\\n    },\\n    \\\"legend\\\": {\\n      \\\"showLegend\\\": true,\\n      \\\"displayMode\\\": \\\"list\\\",\\n      \\\"placement\\\": \\\"bottom\\\",\\n      \\\"calcs\\\": []\\n    }\\n  },\\n  \\\"fieldConfig\\\": {\\n    \\\"defaults\\\": {\\n      \\\"custom\\\": {\\n        \\\"drawStyle\\\": \\\"line\\\",\\n        \\\"lineInterpolation\\\": \\\"linear\\\",\\n        \\\"barAlignment\\\": 0,\\n        \\\"lineWidth\\\": 1,\\n        \\\"fillOpacity\\\": 0,\\n        \\\"gradientMode\\\": \\\"none\\\",\\n        \\\"spanNulls\\\": false,\\n        \\\"showPoints\\\": \\\"auto\\\",\\n        \\\"pointSize\\\": 5,\\n        \\\"stacking\\\": {\\n          \\\"mode\\\": \\\"none\\\",\\n          \\\"group\\\": \\\"A\\\"\\n        },\\n        \\\"axisPlacement\\\": \\\"auto\\\",\\n        \\\"axisLabel\\\": \\\"\\\",\\n        \\\"axisColorMode\\\": \\\"text\\\",\\n        \\\"scaleDistribution\\\": {\\n          \\\"type\\\": \\\"linear\\\"\\n        },\\n        \\\"axisCenteredZero\\\": false,\\n        \\\"hideFrom\\\": {\\n          \\\"tooltip\\\": false,\\n          \\\"viz\\\": false,\\n          \\\"legend\\\": false\\n        },\\n        \\\"thresholdsStyle\\\": {\\n          \\\"mode\\\": \\\"off\\\"\\n        }\\n      },\\n      \\\"color\\\": {\\n        \\\"mode\\\": \\\"palette-classic\\\"\\n      },\\n      \\\"mappings\\\": [],\\n      \\\"thresholds\\\": {\\n        \\\"mode\\\": \\\"absolute\\\",\\n        \\\"steps\\\": [\\n          {\\n            \\\"value\\\": null,\\n            \\\"color\\\": \\\"green\\\"\\n          },\\n          {\\n            \\\"value\\\": 80,\\n            \\\"color\\\": \\\"red\\\"\\n          }\\n        ]\\n      }\\n    },\\n    \\\"overrides\\\": []\\n  },\\n  \\\"datasource\\\": {\\n    \\\"uid\\\": \\\"grafana\\\",\\n    \\\"type\\\": \\\"datasource\\\"\\n  },\\n  \\\"description\\\": \\\"\\\"\\n}\",\r\n        \"mode\": \"code\",\r\n        \"code\": {\r\n          \"language\": \"json\",\r\n          \"showLineNumbers\": true,\r\n          \"showMiniMap\": true\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: Panel Title // 2023-10-10 11:58:16\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-timeseries\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"0000-01-01T04:56:02.000Z\",\r\n    \"to\": \"0000-01-01T05:56:02.000Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\n\n### Environment (with versions)?\n\nGrafana: 10.1.4, 9.2.3\r\nOS: Ubuntu 20\r\nBrowser: Firefox\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["type/bug","area/panel/timeseries","timepicker"]},{"id":80374,"title":"slack actions (buttons) is supported?","body":"**Why is this needed**:\r\n\r\nFor comfort\r\n\r\n![image](https://github.com/grafana/grafana/assets/862272/306c031d-014e-4116-8189-783ad6b5eb39)\r\n\r\n**What would you like to be added**:\r\n\r\nactions settings for grafana alertmanager like mimir alertmanager\r\n\r\n\u003cimg width=\"639\" alt=\"image\" src=\"https://github.com/grafana/grafana/assets/862272/ddc27a7d-452f-42a7-9301-1687b9a8808e\"\u003e","labels":["area/alerting","area/alerting/notifications","good first issue"]},{"id":63904,"title":"Query editor is missing for Prometheus datasource","body":"I´ve wait since end of january for a fix of this problem:\r\nhttps://github.com/grafana/grafana/issues/62414 \r\ntoday I installed 9.4.1 and there is no fix.\r\nsame problem: query editor is missing.\r\nDo I have to create all my dashboards again from zero ?\r\n:-( \r\n\r\n**How to reproduce it**\r\n\r\n1. Import the following dashboard\r\n[Elektro 1-1677653074995.json.txt](https://github.com/grafana/grafana/files/10857860/Elektro.1-1677653074995.json.txt)\r\n2. Try to edit the chart\r\n3. The editor doesn't appear\r\n\r\n![Captura de pantalla 2023-03-01 a las 17 02 08](https://user-images.githubusercontent.com/5699976/222194431-26429824-76b1-4fad-ad0a-4de57f2e4962.png)\r\n","labels":["type/bug","needs investigation","area/query-editor"]},{"id":89261,"title":"Plugins not visible from dashboard","body":"### What happened?\n\nPlugins are not visuble or searchable from the dashboard itself, From the logs the errora are:\r\nmsg=\"Failed to get plugins\" error=\"BasicAuth content is invalid.\"\r\nmsg=\"Failed to get provisioned plugins\" error=\"BasicAuth content is invalid.\"\n\n### What did you expect to happen?\n\nBe able to browse new adn installed plugins\n\n### Did this work before?\n\nPrevious 11\n\n### How do we reproduce it?\n\n1. Have basic auth enabled\r\n2. Update grafana to 11 version\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 11\r\nOS: Debian GNU/Linux 12 (bookworm)\r\nBrowser: Mozilla Firefox\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\n_No response_","labels":["area/plugins","stale","bot/no new info","area/plugins-catalog"]},{"id":60683,"title":"Grafana Prometheus/Cortex Datasource Doesn't Use the Right Logo","body":"**What happened**:\r\n\r\nMy datasource is configured as:\r\n\r\n```\r\napiVersion: 1\r\ndatasources:\r\n- access: proxy\r\n  isDefault: true\r\n  jsonData:\r\n    httpMethod: GET\r\n    prometheusType: Cortex\r\n    prometheusVersion: 1.14.0\r\n  name: Cortex\r\n  type: prometheus\r\n  typeLogoUrl: public/app/plugins/datasource/prometheus/img/cortex_logo.svg\r\n  typeName: cortex\r\n  url: http://cortex-nginx/prometheus\r\n```\r\n\r\nHowever, in the GUI and API it overrides my datasource settings to be:\r\n```\r\n id: 1\r\n  uid: P6693426190CB2316\r\n  orgId: 1\r\n  name: Cortex\r\n  type: prometheus\r\n  typeName: Prometheus\r\n  typeLogoUrl: public/app/plugins/datasource/prometheus/img/prometheus_logo.svg\r\n  access: proxy\r\n  url: http://cortex-nginx/prometheus\r\n  user: ''\r\n  database: ''\r\n  basicAuth: false\r\n  isDefault: true\r\n  jsonData:\r\n    httpMethod: GET\r\n    prometheusType: Cortex\r\n    prometheusVersion: 1.14.0\r\n  readOnly: true\r\n```\r\n\r\n**What you expected to happen**:\r\nI expect to see a pretty Cortex logo instead of Prometheus.\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nUse the same datasource settings as above.\r\n\r\n**Environment**:\r\n- Grafana version: [v9.3.1 (89b365f8b1)](https://github.com/grafana/grafana/blob/main/CHANGELOG.md)\r\n- Data source type \u0026 version: Cortex 1.14\r\n- OS Grafana is installed on: Docker Image grafana/grafana:9.3.1\r\n- User OS \u0026 Browser: All\r\n- Grafana plugins: Prometheus Datasource\r\n- Others:\r\n","labels":["prio/low","datasource/Prometheus","area/datasource","stale","good first issue"]},{"id":67316,"title":"Upgrade from 9.3.1 to 9.3.11, 9.4.9, or 9.5.1 fails on updating alert configuration and/or secret migration","body":"## What happened:\r\nIn trying to bump the grafana version from 9.3.1 to 9.3.11, 9.4.9, or 9.5.1, secret migration issues appear\r\n\r\n## Environment:\r\n- Grafana version: 9.3.1\r\n- OS Grafana is installed on: focal docker container\r\n\r\nWhen attempting to upgrade to 9.5.1, I got the following log `logger=ngalert t=2023-04-26T17:31:01.693020413Z level=warn msg=\"Unexpected number of rows updating alert configuration history\" rows=0 org=1 hash=not-yet-calculated`\r\n\r\nAttempting to upgrade to 9.4.9 or 9.3.11, I'm seeing `migrations completed\" performed=0 skipped=464 duration=760.3µs` and grafana appears to crash immediately after `starting MultiOrg Alertmanager`, and attempt to come back up but fails with `Server lock for secret migration already exists`, \r\n```\r\nlogger=settings t=2023-04-20T17:33:31.648725608Z level=info msg=\"Starting Grafana\" version=9.3.11 commit=f9548d33f8 branch=HEAD compiled=2023-03-16T23:16:52Z\r\nlogger=settings t=2023-04-20T17:33:31.648969125Z level=info msg=\"Config loaded from\" file=/usr/share/grafana/conf/defaults.ini\r\nlogger=settings t=2023-04-20T17:33:31.648989404Z level=info msg=\"Config loaded from\" file=/usr/share/grafana/conf/custom.ini\r\nlogger=settings t=2023-04-20T17:33:31.649002016Z level=info msg=\"Config overridden from command line\" arg=\"default.paths.data=/var/lib/grafana\"\r\nlogger=settings t=2023-04-20T17:33:31.649028961Z level=info msg=\"Config overridden from command line\" arg=\"default.paths.logs=/var/log/grafana\"\r\nlogger=settings t=2023-04-20T17:33:31.649042806Z level=info msg=\"Config overridden from command line\" arg=\"default.paths.plugins=/var/lib/grafana/plugins\"\r\nlogger=settings t=2023-04-20T17:33:31.649057692Z level=info msg=\"Config overridden from Environment variable\" var=\"GF_SERVER_ROOT_URL=http://localhost:3000\"\r\nlogger=settings t=2023-04-20T17:33:31.649070067Z level=info msg=\"Config overridden from Environment variable\" var=\"GF_DATABASE_TYPE=mysql\"\r\nlogger=settings t=2023-04-20T17:33:31.649084517Z level=info msg=\"Config overridden from Environment variable\" var=\"GF_DATABASE_HOST=mysqlhost1:3306\"\r\nlogger=settings t=2023-04-20T17:33:31.649106276Z level=info msg=\"Config overridden from Environment variable\" var=\"GF_DATABASE_USER=jenga\"\r\nlogger=settings t=2023-04-20T17:33:31.649131802Z level=info msg=\"Config overridden from Environment variable\" var=\"GF_DATABASE_PASSWORD=*********\"\r\nlogger=settings t=2023-04-20T17:33:31.649145485Z level=info msg=\"Path Home\" path=/usr/share/grafana\r\nlogger=settings t=2023-04-20T17:33:31.649157602Z level=info msg=\"Path Data\" path=/var/lib/grafana\r\nlogger=settings t=2023-04-20T17:33:31.649177191Z level=info msg=\"Path Logs\" path=/var/log/grafana\r\nlogger=settings t=2023-04-20T17:33:31.649200155Z level=info msg=\"Path Plugins\" path=/grafana/plugins\r\nlogger=settings t=2023-04-20T17:33:31.649224435Z level=info msg=\"Path Provisioning\" path=/grafana/dockers/grafana/provisioning/\r\nlogger=settings t=2023-04-20T17:33:31.649286965Z level=info msg=\"App mode production\"\r\nlogger=sqlstore t=2023-04-20T17:33:31.649408736Z level=info msg=\"Connecting to DB\" dbtype=mysql\r\nlogger=migrator t=2023-04-20T17:33:31.675061307Z level=info msg=\"Starting DB migrations\"\r\nlogger=migrator t=2023-04-20T17:33:31.683121179Z level=info msg=\"migrations completed\" performed=0 skipped=464 duration=760.3µs\r\nlogger=plugin.loader t=2023-04-20T17:33:31.85492733Z level=info msg=\"Plugin registered\" pluginID=input\r\nlogger=plugin.loader t=2023-04-20T17:33:33.852229977Z level=info msg=\"Plugin registered\" pluginID=grafana-piechart-panel\r\nlogger=plugin.loader t=2023-04-20T17:33:33.852339107Z level=info msg=\"Plugin registered\" pluginID=grafana-simple-json-datasource\r\nlogger=plugin.loader t=2023-04-20T17:33:33.852373633Z level=info msg=\"Plugin registered\" pluginID=alexanderzobnin-zabbix-datasource\r\nlogger=plugin.alexanderzobnin-zabbix-datasource t=2023-04-20T17:33:33.860334118Z level=info msg=Profiler enabled=false\r\nlogger=plugin.alexanderzobnin-zabbix-datasource t=2023-04-20T17:33:33.86205971Z level=warn msg=\"Plugin process is running with elevated privileges. This is not recommended\"\r\nlogger=plugin.loader t=2023-04-20T17:33:33.862096542Z level=info msg=\"Plugin registered\" pluginID=alexanderzobnin-zabbix-triggers-panel\r\nlogger=plugin.loader t=2023-04-20T17:33:33.86211229Z level=info msg=\"Plugin registered\" pluginID=marcusolsson-json-datasource\r\nlogger=plugin.loader t=2023-04-20T17:33:33.862125056Z level=info msg=\"Plugin registered\" pluginID=alexanderzobnin-zabbix-app\r\nlogger=plugin.loader t=2023-04-20T17:33:33.862137241Z level=info msg=\"Plugin registered\" pluginID=blackmirror1-singlestat-math-panel\r\nlogger=plugin.loader t=2023-04-20T17:33:33.862151549Z level=info msg=\"Plugin registered\" pluginID=boazreicher-sierraplot-panel\r\nlogger=plugin.loader t=2023-04-20T17:33:33.862164116Z level=info msg=\"Plugin registered\" pluginID=flant-statusmap-panel\r\nlogger=secrets t=2023-04-20T17:33:33.862589671Z level=info msg=\"Envelope encryption state\" enabled=true currentprovider=secretKey.v1\r\nlogger=query_data t=2023-04-20T17:33:33.865077331Z level=info msg=\"Query Service initialization\"\r\nlogger=live.push_http t=2023-04-20T17:33:33.868190477Z level=info msg=\"Live Push Gateway initialization\"\r\nlogger=infra.usagestats.collector t=2023-04-20T17:33:34.474727565Z level=info msg=\"registering usage stat providers\" usageStatsProvidersLen=2\r\nlogger=server t=2023-04-20T17:33:34.474918457Z level=info msg=\"Writing PID file\" path=/highland/grafana/tmp/pids/server.pid pid=124\r\nlogger=provisioning.alerting t=2023-04-20T17:33:43.690347737Z level=warn msg=\"file has invalid suffix 'README' (.yaml,.yml,.json accepted), skipping\"\r\nlogger=provisioning.alerting t=2023-04-20T17:33:43.691062039Z level=info msg=\"starting to provision alerting\"\r\nlogger=provisioning.alerting t=2023-04-20T17:33:43.691090635Z level=info msg=\"finished to provision alerting\"\r\nlogger=ngalert.state.manager t=2023-04-20T17:33:43.691494596Z level=info msg=\"Warming state cache for startup\"\r\nlogger=grafanaStorageLogger t=2023-04-20T17:33:43.691836497Z level=info msg=\"storage starting\"\r\nlogger=secret.migration t=2023-04-20T17:33:43.693569288Z level=error msg=\"Server lock for secret migration already exists\"\r\nlogger=http.server t=2023-04-20T17:33:43.693766389Z level=info msg=\"HTTP Server Listen\" address=[::]:3000 protocol=http subUrl= socket=\r\nlogger=ngalert.state.manager t=2023-04-20T17:33:43.696980899Z level=info msg=\"State cache has been initialized\" states=0 duration=5.481082ms\r\nlogger=ticker t=2023-04-20T17:33:43.69705647Z level=info msg=starting first_tick=2023-04-20T17:33:50Z\r\nlogger=ngalert.multiorg.alertmanager t=2023-04-20T17:33:43.69709042Z level=info msg=\"starting MultiOrg Alertmanager\"\r\nmysql: [Warning] Using a password on the command line interface can be insecure.\r\nmysql: [Warning] Using a password on the command line interface can be insecure.\r\nGrafana server is running with elevated privileges. This is not recommended\r\n```\r\nand then I see grafana attempt to start again, but fail because the above with Server lock for secret migration already exists and the pervious 0.0.0.0:3000 is already in use.\r\n```\r\nlogger=settings t=2023-04-20T17:33:45.073958312Z level=info msg=\"Starting Grafana\" version=9.3.11 commit=f9548d33f8 branch=HEAD compiled=2023-03-16T23:16:52Z\r\n\r\nlogger=secret.migration t=2023-04-20T17:33:57.691036258Z level=error msg=\"Server lock for secret migration already exists\"\r\nlogger=server t=2023-04-20T17:33:57.692481377Z level=error msg=\"Stopped background service\" service=*api.HTTPServer reason=\"failed to open listener on address 0.0.0.0:3000: listen tcp 0.0.0.0:3000: bind: address already in use\"\r\nI'm happy to grab more information or to start another issue tread if this is considered too different.\r\n```\r\n","labels":["type/bug","needs more info","area/alerting","area/backend"]},{"id":68652,"title":"Alerting: Alerts evaluated 3 times and sending 3 notifications","body":"### \n# What went wrong?\n\n\nWhen creating an alert in unified alerting it is evaluated 3 times. When the alert is firing 3 messages will be send too. \r\nI cannot figure out why. I can only see in state history that everything is evaluated 3 times. \r\nAlso tried different datasource but got the same result\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- create an alert \r\n![image](https://github.com/grafana/grafana/assets/6533478/9b8c2015-4ee5-48d5-8f78-01a4ab8494f4)\r\n\r\n**Step 2**:\r\n\r\n- wait for alert firing\r\n\r\n**Step 3**:\r\n\r\n- click on \"show state history\". everything is repeated 3 times, also 3 messages were send.\r\n![image](https://github.com/grafana/grafana/assets/6533478/82273b46-ad61-46d0-8089-e9e500b765e4)\r\n\r\n\n\n### \n# What Grafana version are you using?\n\n\nGrafana v9.4.7 (Amazon managed)\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nOther\n\n### User's OS?\n\nUbuntu 22.04\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["needs more info","area/alerting"]},{"id":64603,"title":"Grafana 9.3.6-\u003e9.4.3 upgrade fails to provision dashboards with _ in their folder name","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: Tried to upgrade Grafana from 9.3.6 to 9.4.3 but it failed due to the following error message:\r\n\r\n```\r\nError: ✗ *provisioning.ProvisioningServiceImpl run error: Failed to provision dashboards: failed to provision config foo_bar: Error 1062: Duplicate entry '1-0-foo_bar for key 'UQE_dashboard_org_id_folder_id_title'\r\n```\r\n\r\nSome investigation suggests that the provisioning fails when there is an underscore in the folder title. Thus `foo_bar` does not work, while `foo-bar` does.\r\n\r\n**What you expected to happen**:\r\n\r\nI expect this to keep working as before and continue allowing underscores in provisioning folder names.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nProvision a folder with an underscore in the name\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.3\r\n- Data source type \u0026 version: n/a\r\n- OS Grafana is installed on: Linux\r\n- User OS \u0026 Browser: n/a\r\n- Grafana plugins: n/a\r\n- Others: n/a\r\n","labels":["area/dashboard","area/provisioning","triage/needs-confirmation"]},{"id":65799,"title":"Table footer shifts calculation when hiding other columns","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nThe table footer calculation is not aligned with the correct column when a column is hidden\r\n\r\n**What you expected to happen**:\r\nThat the calculations are done for the selected columns\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nYou can reproduce it easily with two random walks and joining by field:\r\n\r\n![image](https://user-images.githubusercontent.com/34571684/229486750-efa5ca58-98ca-4853-98f5-fc393f660237.png)\r\n\r\nHere you see all the columns and the summation is done only for B-series. Now if I hide the time column:\r\n![image](https://user-images.githubusercontent.com/34571684/229486822-b5208532-a861-4326-87b0-6fef144c66f1.png)\r\n\r\nYou can see that the calculation is now done for A-series (while the selected column for the calculation remained unchaged)\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.3\r\n- Datasource: tested with postgresql and randomwalk \r\n","labels":["needs more info","area/panel/table"]},{"id":71019,"title":"Grafana: Geomap plugin doesn't show correct geolocation information","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\n  - Geomap plugin shows wrong geolocation information on the map.\r\n\r\n**What did you expect to happen**:\r\n\r\n  - It is supposed that Grafana points to the correct geolocation. Regardless of the coordinates provided Grafana always points to the same wrong location. As seen attached, coordinates data fields are populated with (34.0544,-118.2441) which should point to the USA but it mistakenly points to South African location.\r\n \r\n![image](https://github.com/grafana/grafana/assets/121641642/c4d38b57-6054-4410-adb0-c48e510ee8a1)\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\n9.5.5\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\nhttps://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/geomap/#location\r\n\r\n### Grafana Platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### User's OS?\r\n\r\nUbuntu 22.04\r\n\r\n### User's Browser?\r\n\r\nMicrosoft Edge Version 114.0.1823.67\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\nElasticsearch 7.10.2\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["bot/no new info","area/panel/geomap"]},{"id":50849,"title":"Annotations are broken","body":"**What happened**:\r\nOver the past few releases the annotations state keep deteriorate (see also #49515)\r\n\r\nAnnotations are an important tool, that used to (mostly) work. Since the move to 8.x and the move to the time-series panels they are broken.\r\n**What you expected to happen**:\r\nTo make it clear I showed on the graph the Prometheus function of the annotations.\r\nWhat should have happend that for each point in the graph there would be an annotation.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nHere are two examples, same graph, both does not work as they should but in a different way:\r\n\r\nversion 8.5.2\r\n![image](https://user-images.githubusercontent.com/2118079/173780344-8d9dfdcf-8551-420c-892e-7ebe2301cc1e.png)\r\n\r\nVersion 9.0.0\r\n![image](https://user-images.githubusercontent.com/2118079/173779120-62eecd55-fc21-418c-8642-09cbe07e7d88.png)\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.x and up\r\n- Data source type \u0026 version: prometheus\r\n- OS Grafana is installed on: docker\r\n- User OS \u0026 Browser: chrome\r\n- Grafana plugins: NA\r\n- Others:\r\n","labels":["area/annotations","prio/medium","datasource/Prometheus"]},{"id":47662,"title":"The \"No Value\" box does not override the \"No Data\" output","body":"**What happened**:\r\nA customer asked me how to override what a panel says when there is no data. Usually it says \"No Data\" but I found a box in the panel config called \"No Value\" that sounded like it was for overriding the \"No Data\" output. I was told that was the correct box but I've never been able to get it to work and the customer was not able to get it to work either. \r\n\r\nIt's possible that it's dependent on how you achieve a \"No Data\" scenario. I tried by changing the name of the metric to one that doesn't exist. That gave me \"No Data\" immediately but it was never overwritten by the \"No Value\" field.\r\n\r\nCustomers words - \"I tried editing the “No Value” box with integer, string value and string variable in the panel for Pie Chart Visualization. Also tried with the value mapping options which is next to the “No Value” but still no luck in replacing the no data option.\"\r\n\r\n**What you expected to happen**:\r\nI would expect that whatever I type into \"No Value\" would show instead of \"No Data\" in a \"No Data\" scenario.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Choose a Prometheus data source\r\n2. Find a metric that exists and graph it so you know you're in a good state\r\n3. Add \"fake\" to the end of the metric name so you get a \"No Data\" output\r\n4. Set the \"No Value\" field in the panel options section to something other than blank\r\n5. I still see \"No Data\" instead of whatever I set the \"No Value\" field to\r\n\r\n**Anything else we need to know?**:\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.5\r\n- Data source type \u0026 version: Prometheus\r\n- OS Grafana is installed on: official Docker image\r\n- User OS \u0026 Browser: Chrome on Ubuntu\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["needs investigation","area/panel/data"]},{"id":64328,"title":"Explore: Support for built-in variables like $__user.email in Loki Query","body":"Related: \r\n[Issue](https://github.com/grafana/grafana/issues/13523)\r\n[Discussion](https://community.grafana.com/t/help-with-global-variable-user-login/81672/10?u=joannamarquez)\r\n\r\n**What is the chore?**:\r\nCurrently, the following built in variables are available for use in loki queries:\r\n\r\n```\r\n$__dashboard\r\n$__from and $__to\r\n$__interval\r\n$__interval_ms\r\n$__org\r\n$__user \r\n$__user.id\r\n$__range\r\n```\r\n\r\nRequesting to expose $__user.email and $__user.login.\r\n\r\nI have added email logs to grafana loki and I am trying to create a dashboard that only displays the current user's email logs.\r\nmy query looks like this: \r\n\r\n```\r\n{job=\"my-email-logs\"} | json | Recipient=`${__user.email}`\r\n```\r\n\r\n","labels":["type/tech","prio/medium","area/explore"]},{"id":72096,"title":"Alerting: SMTP emails are not working with AWS SES","body":"### What happened?\n\nWe have the setup working previously and suddenly it stopped to work.\r\nWe are using AWS SES for sending emails.\r\n\r\nWe notice this when we were testing the upgrade to 10.0.1, but they were failing previously and we won't notice.\r\nWe have treid 9.0.5, 9.5.6, 10.0.1 and 10.0.2. The same error appears:\r\n\r\n```\r\n2023-07-21T12:27:49.630+02:00 | logger=ngalert.notifier.email t=2023-07-21T10:27:49.62998238Z level=error msg=\"Missing receiver\"\r\n2023-07-21T12:27:49.630+02:00 | logger=ngalert.notifier.email t=2023-07-21T10:27:49.63000889Z level=error msg=\"Missing group labels\"\r\n```\r\n\r\nDoing the same test locally:\r\n\r\n```\r\nERROR[07-21|10:22:14] Missing receiver                         logger=ngalert.notifier.email notifierUID=\r\nERROR[07-21|10:22:14] Missing group labels                     logger=ngalert.notifier.email notifierUID=\r\n```\r\n\r\n\r\nSetting log level to debug does not show anything else related to that.\r\n\r\nIn the UI, the popup appears as correct email sent.\r\n\r\nWe have this settings related to SMTP:\r\n\r\n```\r\nGF_SMTP_ENABLED=true\r\nGF_SMTP_FROM_ADDRESS=email@domain.com\r\nGF_SMTP_FROM_NAME=Grafana\r\nGF_SMTP_HOST=email-smtp.eu-west-1.amazonaws.com:587\r\nGF_SMTP_SKIP_VERIFY=false\r\nGF_SMTP_STARTTLS_POLICY=MandatoryStartTLS\r\nGF_SMTP_USER=\"AAAAAA\"\r\nGF_SMTP_PASSWORD=\"BBBBBBB\"\r\n```\n\n### What did you expect to happen?\n\nThe email should be sent.\n\n### Did this work before?\n\nYes. Was working on the same version that now is not (9.0.5 in our case).\n\n### How do we reproduce it?\n\n1. Enable SMTP in grafana using AWS SES\r\n2. Create a contact point\r\n3. Try to send a test email\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana:\r\nOS:\r\nBrowser:\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["area/alerting/notifications","area/configuration","triage/needs-confirmation"]},{"id":88679,"title":"Alerting: preview affected alerts on silence creation page","body":"### What happened?\n\n\"Affected alert instances\" is empty when you create silence from scratch and add some labels\n\n### What did you expect to happen?\n\nLabel filter application and list of affected instances\n\n### Did this work before?\n\nNot sure\n\n### How do we reproduce it?\n\n1. Create some firing alert\r\n2. Alerting -\u003e Silence -\u003e Create silence – Affected alert instances are empty\r\n3. Add some label matchers – Affected alert instances are empty\r\n4. Save silence \u0026 reopen -\u003e Affected alert instances are not empty\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\n_No response_\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["area/alerting","triage/needs-confirmation"]},{"id":46408,"title":"Time Series: different values/timestamps in table view and graph view","body":"**What happened**:\r\nTurn on/off table view on time series - show values with different timestamps. Table view with values and timestamps as in the MySQL database and graph view with one hour offset.\r\n\r\nTable view: latest value at 13:51:02 = 7.30\r\n![image](https://user-images.githubusercontent.com/52625423/157666291-4d848754-d4ff-473b-9b33-9f75c545706f.png)\r\n\r\nGraph view: latest value at 13:51:04 = -1.5 (actual value from one hour ago at 12:51:02)\r\n![image](https://user-images.githubusercontent.com/52625423/157666703-c6c07a2b-b67d-483e-8b6e-c9734111f422.png)\r\n\r\n**What you expected to happen**:\r\nWith the same time stamp, the graph and the table should contain the same values\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n- add MySQL Datasource with +00:00 timezone\r\n- create new panel of type time series\r\n- add a basic query\r\n- switch between table and graph view\r\n\r\n**Anything else we need to know?**:\r\nChanging the time zone does not affect this behavior\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.3\r\n- Data source type \u0026 version: MySQL / MariaDB 10.3.31\r\n- OS Grafana is installed on: Raspbian 10 Buster (Debian Linux)\r\n- User OS \u0026 Browser: Windows 10 x64, Opera\r\n- Grafana plugins: none\r\n","labels":["area/panel/table","area/panel/timeseries"]},{"id":44248,"title":"TimeSeries - Cannot open tooltip on maximum value of a very short graph","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nIn small graphs without an heading title, you cannot check the value of the highest value\r\n\r\n**What you expected to happen**:\r\nA tooltip to appear showing the value\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate a short \"Time Series\" graph, try to check the value of a point that has the highest value possible\r\n\r\n**Anything else we need to know?**:\r\nMy graph (it shows a boolean value)\r\n![image](https://user-images.githubusercontent.com/22529815/150304723-2f64dd21-706c-4a5e-9441-d354102fddab.png)\r\n\r\nMouse just below the value:\r\n![image](https://user-images.githubusercontent.com/22529815/150304866-0713cbb6-bcb6-4c00-9051-7586d8d557f0.png)\r\n\r\nIf I put the mouse just a little higher, it activates the options header:\r\n![image](https://user-images.githubusercontent.com/22529815/150305008-159719f3-4ade-4944-b4a7-a25331a6f6c3.png)\r\n\r\n\r\n\r\n**Environment**:\r\n- Grafana version: v8.3.4\r\n- Data source type \u0026 version: InfluxDB 1.8.10\r\n- OS Grafana is installed on: Ubuntu 20.04\r\n- User OS \u0026 Browser: Windows 10 - Firefox\r\n- Grafana plugins: Time Series\r\n","labels":["area/panel/timeseries"]},{"id":77142,"title":"Live: Streaming panels temporarily go blank during dashboard refresh","body":"### What happened?\r\n\r\nWhen utilizing streaming from Redis data sources, the related panels temporarily goes blank each time the dashboard refreshes. This is in contrast to panels without streaming enabled, which seamlessly update only with new data, maintaining data visualization during refreshes.\r\n\r\nhttps://github.com/grafana/grafana/assets/148908345/8e20514a-48d0-4551-a8d3-0d2bdc6fc25f\r\n\r\n### What did you expect to happen?\r\n\r\nMy expectation is that when a dashboard refresh occurs, either manually initiated via the 'Refresh Dashboard' button or automatically according to the set refresh interval, the streaming connections and associated panels remain unaffected. Rather than going blank or experiencing any disruption in streaming interval, they should continue to display and update data seamlessly. This continuity will ensure a user-friendly experience, minimizing disruptions in streaming data visibility regardless of dashboard refresh actions.\r\n\r\n### Did this work before?\r\n\r\nNo\r\n\r\n### How do we reproduce it?\r\n\r\n1. Configure Redis as a data source.\r\n2. Create new dashboard.\r\n3. Add visualization of any type.\r\n4. Select Redis as a data source.\r\n5. Choose, e.g. Type: Command-line-interface (CLI), Command: EVAL \"return redis.call('TIME')[1]\" 0, Steaming: Enabled, \"Run\".\r\n6. Apply.\r\n7. Save dashboard.\r\n8. Click \"Refresh Dashboard\".\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana Enterprise: \r\n10.2.0, \r\n10.1.5\r\n\r\nBrowsers:\r\nChrome Version 118.0.5993.118 (Official Build) (32-bit), \r\nEdge for Business Version 118.0.2088.76 (Official build) (64-bit)\r\nFirefox 119.0 (64-bit)\r\n\r\n### Grafana platform?\r\n\r\nAmazon ECS (Docker)\r\nWindows 10 Enterprise 64-bit 22H2 19045.3570 (Local)\r\n\r\n### Datasource(s)?\r\n\r\nredis-datasource","labels":["area/dashboard","needs more info","triage/needs-confirmation","area/dashboards/panel"]},{"id":47875,"title":"Minified Redux error #9 when returning from editing old table panel","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nWhen I exit the edit view of an (old) table panel, I see this error:\r\n\r\n```\r\nError: Minified Redux error #9; visit https://redux.js.org/Errors?code=9 for the full message or use the non-minified dev environment for full errors. \r\n```\r\n\r\n**What you expected to happen**:\r\n\r\nGrafana should return to showing the complete dashboard\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n\u003cdetails\u003e\r\n\u003csummary\u003ePanel JSON\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"id\": 2,\r\n  \"gridPos\": {\r\n    \"h\": 16,\r\n    \"w\": 24,\r\n    \"x\": 0,\r\n    \"y\": 5\r\n  },\r\n  \"type\": \"table-old\",\r\n  \"title\": \"Log\",\r\n  \"datasource\": {\r\n    \"uid\": \"dap-influxdb-avalon\",\r\n    \"type\": \"influxdb\"\r\n  },\r\n  \"links\": [],\r\n  \"columns\": [],\r\n  \"fontSize\": \"90%\",\r\n  \"pageSize\": 200,\r\n  \"scroll\": true,\r\n  \"showHeader\": true,\r\n  \"sort\": {\r\n    \"col\": 0,\r\n    \"desc\": true\r\n  },\r\n  \"styles\": [\r\n    {\r\n      \"alias\": \"Time\",\r\n      \"dateFormat\": \"YYYY-MM-DD HH:mm:ss\",\r\n      \"pattern\": \"Time\",\r\n      \"type\": \"date\",\r\n      \"align\": \"auto\"\r\n    },\r\n    {\r\n      \"alias\": \"\",\r\n      \"colorMode\": null,\r\n      \"colors\": [\r\n        \"rgba(245, 54, 54, 0.9)\",\r\n        \"rgba(237, 129, 40, 0.89)\",\r\n        \"rgba(50, 172, 45, 0.97)\"\r\n      ],\r\n      \"dateFormat\": \"YYYY-MM-DD HH:mm:ss\",\r\n      \"decimals\": 2,\r\n      \"link\": true,\r\n      \"linkTargetBlank\": true,\r\n      \"linkTooltip\": \"Nginx Dashboard - RequestID ${__cell}\",\r\n      \"linkUrl\": \"/d/dapnginxdetails-/nginx-request-details?var-RequestID=${__cell}\",\r\n      \"mappingType\": 1,\r\n      \"pattern\": \"request_id\",\r\n      \"thresholds\": [],\r\n      \"type\": \"string\",\r\n      \"unit\": \"short\",\r\n      \"align\": \"auto\"\r\n    },\r\n    {\r\n      \"alias\": \"\",\r\n      \"colorMode\": \"cell\",\r\n      \"colors\": [\r\n        \"#73BF69\",\r\n        \"rgba(237, 129, 40, 0.89)\",\r\n        \"rgba(245, 54, 54, 0.9)\"\r\n      ],\r\n      \"dateFormat\": \"YYYY-MM-DD HH:mm:ss\",\r\n      \"decimals\": 0,\r\n      \"mappingType\": 1,\r\n      \"pattern\": \"level\",\r\n      \"thresholds\": [\r\n        \"300\",\r\n        \"400\"\r\n      ],\r\n      \"type\": \"number\",\r\n      \"unit\": \"none\",\r\n      \"align\": \"auto\"\r\n    }\r\n  ],\r\n  \"targets\": [\r\n    {\r\n      \"alias\": \"$col\",\r\n      \"groupBy\": [],\r\n      \"measurement\": \"php_log\",\r\n      \"orderByTime\": \"ASC\",\r\n      \"policy\": \"3m\",\r\n      \"query\": \"SELECT \\\"hostname\\\", \\\"call\\\", \\\"request_id\\\", \\\"level\\\", \\\"level_name\\\", \\\"message\\\" FROM \\\"3m\\\".\\\"php_log\\\" WHERE (\\\"environment\\\" =~ /^$Environment$/) AND $timeFilter\",\r\n      \"rawQuery\": true,\r\n      \"refId\": \"A\",\r\n      \"resultFormat\": \"time_series\",\r\n      \"select\": [\r\n        [\r\n          {\r\n            \"params\": [\r\n              \"level_name\"\r\n            ],\r\n            \"type\": \"field\"\r\n          }\r\n        ],\r\n        [\r\n          {\r\n            \"params\": [\r\n              \"message\"\r\n            ],\r\n            \"type\": \"field\"\r\n          }\r\n        ]\r\n      ],\r\n      \"tags\": []\r\n    }\r\n  ],\r\n  \"timeFrom\": null,\r\n  \"timeShift\": null,\r\n  \"transform\": \"timeseries_to_columns\"\r\n}\r\n```\r\n\r\n\u003c/details\u003e\r\n\r\n[Log-data-as-seriestocolumns-2022-04-19 13 04 12.csv](https://github.com/grafana/grafana/files/8512365/Log-data-as-seriestocolumns-2022-04-19.13.04.12.csv)\r\n\r\nProblem does not happen when there is no data for the panel to display.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.6\r\n- Data source type \u0026 version: InfluxDB 5.0.0\r\n- OS Grafana is installed on: CentOS 7\r\n- User OS \u0026 Browser: Slackware Linux - Firefox 98.0.2\r\n- Grafana plugins: -\r\n- Others: -\r\n","labels":["type/bug","area/panel/table","prio/unscheduled"]},{"id":72392,"title":"Alerting: when specifying template message for an email contact point, the panel's screenshot is no longer sent in the email's body.","body":"### What happened?\r\n\r\nWhen sending an alert to a contact point via email, no image is sent in the email body if I'm using a template message. However, the Panel's screenshot is sent if I'm not modifying the  \"Message\" textbox in the contact point.\r\n\r\nExample 1:\r\nWhen sending an alert to a contact point via email, if the \"Message\" textbox is kept empty the panel's screenshot is sent, embedded in the email body. However, it includes just the last 1 hour of data, even though I'm specifying \"last seven days\" in the alert editor.\r\nMessage textbox:\r\n![image](https://github.com/grafana/grafana/assets/100410429/5e575971-044f-429f-8628-34a711b89981)\r\nGenerated E-mail:\r\n![image](https://github.com/grafana/grafana/assets/100410429/12c68c78-f03d-4fc2-af2b-7dbb752b31bb)\r\n\r\nExample 2:\r\nWhen specifying a template message in the \"Message\" textbox, the message is correctly rendered, but the image is no longer sent in the email's body (even looking at the source HTML code of the email, no img is imported other than the Grafana logo)\r\n\r\nMessage textbox:\r\n![image](https://github.com/grafana/grafana/assets/100410429/dd982c43-e109-4114-83c3-e0b7500b77ce)\r\nGenerated E-mail:\r\n![image](https://github.com/grafana/grafana/assets/100410429/cfd41906-cade-4dca-9474-dcb7dda1d426)\r\n\r\nI don't believe there's any problem with my configuration, since the image is sent when I'm not specifying any template message (I have configured GF_UNIFIED_ALERTING_SCREENSHOT_CAPTURE=true).\r\nI already looked at the documentation, and it is not specified how to include images in template messages.\r\n\r\n### What did you expect to happen?\r\n\r\nA screenshot of the panel is sent with the alert in the email's body, wheter or not a template message is specified for an email contact point.\r\n\r\n### Did this work before?\r\n\r\nI'm now updating our grafana stack to the new unified alerting, with the legacy alerting it was easy to generate the correct alert message and send the panel's screenshot.\r\n\r\n### How do we reproduce it?\r\n\r\n1. Run Grafana version 9.5.6.\r\n2. Generate an alert linked to a panel in a dashboard.\r\n3. Generate a contact point (email) and write a template message.\r\n4. Verify that no image is embedded to the email's body.\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nNo, the bug is related to unified alerting.\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: Docker image with grafana/grafana: 9.5.6 and grafana/grafana-image-renderer 3.6.0, running with Kubernetes\r\nOS: Docker on Linux\r\nBrowser: Chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nKubernetes\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["type/bug","area/alerting","stale"]},{"id":61656,"title":"Login failed  - Error while trying to authenticate user v9.2.5 (042e4d216b) . LDAP authentication.","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\n**What you expected to happen**:\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version:\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["needs more info","area/auth/ldap"]},{"id":83795,"title":"Alerting: external alertmanager false resolve messages","body":"### What happened?\n\nI 'm trying to provide free customization of Alert queries inside Grafana, but I prefer to use prometheus alertmanager for message delivery. \r\nI have found that a typical setup  sends one message, which after a few minutes is declared resolved inside prometheus alertmanager.  Of course, this is not correct. Notification should only be sent when these conditions actually occur.\r\nIndeed, in the alertmanager web interface I see the alert for a short time\r\n\n\n### What did you expect to happen?\n\nSend one alert message when fail.  Then send another resolve message, if query conditions are ok.\n\n### Did this work before?\n\nDoesn't know\n\n### How do we reproduce it?\n\n1. setup grafana with prometheus and alertmanager\r\n2. setup message routing inside alertmanager \r\n3. add Alert Query and select contact point\r\n4. wait for fire message\r\n5. wait some time for **FALSE** resolve message\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.3.3\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\nLoki","labels":["area/alerting","triage/needs-confirmation"]},{"id":70612,"title":"Annotations: Google Cloud Metrics annotation title and text not displayed","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n  -  When adding a dashboard annotation using the Google Cloud Metrics datasource, the \"Title\" and \"Text\" fields are not rendered (see screenshot). This behavior is present in versions 9.5.3, 10.0.0, and 10.0.1.\r\n\r\n![Screenshot 2023-06-23 at 11 25 47](https://github.com/grafana/grafana/assets/1294226/9b3f3db4-531b-4478-98c8-f2d4b8deda86)\r\n\r\n\r\n**What did you expect to happen**:\r\n\r\n  - Title and text should be rendered for the annotation\r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Add a GCM-backed annotation to a dashboard\r\n\r\n**Step 2**:\r\n\r\n- Attempt to add a title or text to the annotation using the provided fields.\r\n\r\n**Step 3**:\r\n\r\n- The annotations do not include the values from the title or text field.\r\n\n\n### \n# What Grafana version are you using?\n\n\nv9.5.3, v10.0.0, v10.0.1\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nDocker\n\n### User's OS?\n\nmacOS Ventura 13.4\n\n### User's Browser?\n\nGoogle Chrome 114.0.5735.133\n\n### Is this a Regression?\n\nYes\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["effort/small","area/annotations","datasource/GoogleCloudMonitoring"]},{"id":47397,"title":"[State Timeline] Selecting only one table wrongly displays states ","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nAt least from Grafana 8.4.4, when selecting only one table from an InfluxDB source, the State Timeline plugin won't display all values. \r\n![Screenshot of the bug](https://user-images.githubusercontent.com/38870691/161984702-eec5a150-afab-4d5d-8b93-aecae101dbc9.png)\r\nThe states will have wrong ending time and will have big overlaps.\r\n![First state overlapping the next states](https://user-images.githubusercontent.com/38870691/161987936-01ba63b4-8773-47ba-b2ae-76d1d5449cc0.png)\r\n![Second state starting before the end of the last state](https://user-images.githubusercontent.com/38870691/161987809-faaf3241-e6af-4525-a8b7-fe993a8e29ef.png)\r\n\r\nThis bug only appears when we select one table, adding another one gives the expected result.\r\n![Expected Result](https://user-images.githubusercontent.com/38870691/161984005-2f8c092a-da1e-4965-a1b5-f5b810a19b3a.png)\r\nThe table view gives the expected result.\r\n![Table View](https://user-images.githubusercontent.com/38870691/161985121-4c8ef240-0b68-41aa-9151-6c970718a79a.png)\r\n\r\n**How to reproduce it**:\r\nThe minimal Query for my data : \r\n```\r\nRawSeries = from(bucket: \"main\")\r\n  |\u003e range(start: v.timeRangeStart)\r\n  |\u003e filter(fn: (r) =\u003e \r\n      r.resource == \"dell-compute-2\" or \r\n      r.resource == \"dell-compute-1\")\r\n  |\u003e map(fn: (r) =\u003e ({resource:r.resource, _time:r._time, _value:r.user}))\r\n  |\u003e yield()\r\n```\r\n\r\n**Anything else we need to know?**:\r\n\"Merge equal consecutive values\" does not affect the result.\r\n\"Value Mapping\", \"Thresholds\" and \"Color Scheme\" do not affect the result. \r\nToggling \"Showing Values\" to \"Always\" will show more states, but not all of them\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.5 (also tested on 8.4.4)\r\n- Data source type \u0026 version: influxbDB 2.0.9\r\n- OS Grafana is installed on: Debian 10\r\n- User OS \u0026 Browser: Tested on Firefox 91.0.7 (esr) \u0026 Chromium 90.0.4430.212\r\n- Grafana plugins: None\r\n","labels":["needs more info","area/panel/state-timeline"]},{"id":57342,"title":"Provisioning AlertManager: Missing config option for \"Receive Grafana Alerts\"","body":"**What happened**: I updated to Grafana 9.2 and the setting for \"Receive Grafana Alerts\" moved from \"additional altermanagers\" to being configured on the AlertManager Datasource.\r\n\r\n\u003cimg width=\"1049\" alt=\"image\" src=\"https://user-images.githubusercontent.com/6848427/196917146-ac664149-8c8c-426d-b72e-a64230a6ffd3.png\"\u003e\r\n\r\n**What you expected to happen**: As our AlertManager Datasources are provisioned, their config can't be changed in the UI. Therefore I expected there to be a documented value for the `jsonData` of the provisioning file.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Try to provision an Alertmanager datasource that is set to \"Receive Grafana Alerts\"\r\n\r\n**Anything else we need to know?**: The following setting is what I want to set to true.\r\n\r\n\u003cimg width=\"658\" alt=\"image\" src=\"https://user-images.githubusercontent.com/6848427/196917578-ae2aaca0-a127-459f-a237-b9fd30a828a1.png\"\u003e\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.0\r\n- Data source type \u0026 version: AlertManager 5.0.0 (built-in)\r\n- OS Grafana is installed on: Ubuntu on AKS\r\n- User OS \u0026 Browser: Chrome\r\n- Grafana plugins: only built-in\r\n- Others:\r\n\r\n\r\n\nhttps://github.com/grafana/grafana/issues/57342#tasklist-block-5619aa2e-5371-4f6f-a223-9337fab717a4\n","labels":["type/bug","type/docs","area/alerting","area/backend"]},{"id":44383,"title":"Undocumented dashboards/import API Call","body":"I'm not sure if this qualifies as a bug or feature request but...\r\n\r\nThe API used by the frontend to import a dashboard is /api/dashboards/import which seems to be the only one that supports importing library panels.  The documented API for doing so /api/dashboard/db/ does not support library panels. \r\n\r\nIt would be nice if we could get either the dashboard/db to support the library panels OR document /import as a valid endpoint to use.\r\n\r\nEither approach is fine as long as it's documented accordingly.\r\n\r\n\r\n\r\n","labels":["type/docs","help wanted","area/backend/api","migrate/status-icebox"]},{"id":80046,"title":"Alerting: Alerts Migrated using API that leverage panel variables do not Migrate the selected variable values","body":"### What happened?\n\nSome users created Alerts in an old instance of Grafana using the Azure Monitor plugin.  They selected the resource using variables such as $subscriptionId, $resourceGroup, and $resource.  When they created the alert from this panel, the resource (the variable values) that they selected at that point in time were used in the alert.\r\n\r\nNow, I migrate the Alerts pulling the json from the API endpoint /api/v1/provisioning/alert-rules.  And I send this json to the new instance using the same API endpoint /api/v1/provisioning/alert-rules.  The alert rule is created as expected, however, the values that were selected for those variables are no longer linked.  The dashboard \u0026 panel that the Alert rule was based on is already migrated and in place with the same Uid and panel Id.\r\n\r\nThe resulting Alert rule results in an error and cannot function because it does not know the variable values to use.\n\n### What did you expect to happen?\n\nThe old selected values for the variables should have been included in the json and should have been applied to the new Alert rule when it was provisioned.\n\n### Did this work before?\n\nThe Alert worked as expected with the selected variable values when it was initially created.\n\n### How do we reproduce it?\n\n1.\r\n2.\r\n3.\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana:\r\nOS:\r\nBrowser:\r\n\n\n### Grafana platform?\n\nI use Grafana Cloud\n\n### Datasource(s)?\n\nAzure Monitor 1.0.0","labels":["area/alerting","triage/needs-confirmation"]},{"id":46719,"title":"Tool Tip Data Label is different from Legend","body":"**What happened**:\r\nLegends name are correct, however, series names are difference.\r\nLegends is `pressure ***A`. but Tool tip is `pressure {id=\"***A\",name=\"****\"}`.\r\n`id` which I set is tag on influxDB LineProtocol.\r\nI remember Tool tip of previous version 8.3.x is same as Legends (`pressure ***A`).\r\n![image](https://user-images.githubusercontent.com/44219065/158953692-74e0fbb5-ec6c-48ff-a13b-ab313542b173.png)\r\n\r\n**What you expected to happen**:\r\nI used time series panel.\r\nWhen Series are 3 or more, It could duplicate.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nPlease see above.\r\nAnd, query is here.\r\n```\r\nfrom(bucket: \"my_bucket\")\r\n  |\u003e range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n  |\u003e filter(fn: (r) =\u003e r[\"_measurement\"] == \"my_measurement\")\r\n  |\u003e filter(fn: (r) =\u003e r[\"_field\"] == \"pressure\")\r\n  |\u003e aggregateWindow(every: v.windowPeriod, fn: last, createEmpty: false)\r\n  |\u003e yield(name: \"last\")\r\n```\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.4\r\n- Data source type \u0026 version: influxDB 2.1.1\r\n- OS Grafana is installed on: ubuntu 20.04\r\n- User OS \u0026 Browser: windows 10 \u0026 chrome 99.0.4844.74（Official Build）64bit / Firefox 98.0.1 64bit\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["needs investigation","stale","area/panel/timeseries","area/tooltip"]},{"id":47587,"title":"Data Source Plugin Fetch is not returning stream","body":"**What happened**:\r\nI am building a datasource plugin that should fetch from a streaming endpoint that returns results as nd-jsonstream. \r\n\r\nThe call returns an rx-js Observable which should process the results as a stream via pipe; however, the results short circuit any streaming and it's fetching all the results as a single result.\r\n```\r\n        getBackendSrv()\r\n          .fetch\u003cany\u003e({\r\n            url: `${this.url}/query`,\r\n            method: \"POST\",\r\n            headers: {\r\n              \"Access-Control-Allow-Origin\": \"*\",\r\n              Accept: \"application/x-ndjson\",\r\n            },\r\n            data: {\r\n            },\r\n          })\r\n          .pipe(\r\n            map((resp: any) =\u003e {\r\n              const reader = ndjsonStream(resp.data).getReader();\r\n              let read: any;\r\n              reader.read().then(\r\n                (read = (result: any) =\u003e {\r\n                  if (result.done) {\r\n                    return;\r\n                  }\r\n                  reader.read().then(read);\r\n                })\r\n              );\r\n              return;\r\n            })\r\n          )\r\n```\r\n\r\n```\r\nresponse\r\n\"{\\\"item\\\":{\\\"isAggregateQuery\\\":false,\\\"columns\\\":[]},\\\"queryId\\\":\\\"znEfjkXDE3XYhNwVn2e5gGQ\\\",\\\"status\\\":\\\"processing\\\",\\\"itemType\\\":\\\"metadata\\\"}\r\n{\\\"item\\\":{\\\"id\\\":\\\"2711447046973064575\\\",\\\"schema\\\":\\\"aws_cloudtrail\\\",\\\"timestamp\\\":1602102154000,\\\"data\\\":{}},\\\"queryId\\\":\\\"znEfjkXDE3XYhNwVn2e5gGQ\\\",\\\"status\\\":\\\"processing\\\",\\\"itemType\\\":\\\"record\\\"}\r\n{\\\"item\\\":{\\\"id\\\":\\\"7141534161798723355\\\",\\\"schema\\\":\\\"aws_cloudtrail\\\",\\\"timestamp\\\":1602102154000,\\\"data\\\":{}},\\\"queryId\\\":\\\"znEfjkXDE3XYhNwVn2e5gGQ\\\",\\\"status\\\":\\\"processing\\\",\\\"itemType\\\":\\\"record\\\"}\r\n{\\\"item\\\":{\\\"id\\\":\\\"4783144213480576720\\\",\\\"schema\\\":\\\"aws_cloudtrail\\\",\\\"timestamp\\\":1602102153000,\\\"data\\\":{}},\\\"queryId\\\":\\\"znEfjkXDE3XYhNwVn2e5gGQ\\\",\\\"status\\\":\\\"processing\\\",\\\"itemType\\\":\\\"record\\\"}\r\n{\\\"item\\\":{\\\"id\\\":\\\"10059140975309186284\\\",\\\"schema\\\":\\\"aws_cloudtrail\\\",\\\"timestamp\\\":1602102152000,\\\"data\\\":{}},\\\"queryId\\\":\\\"znEfjkXDE3XYhNwVn2e5gGQ\\\",\\\"status\\\":\\\"processing\\\",\\\"itemType\\\":\\\"record\\\"}\r\n{\\\"item\\\":{\\\"id\\\":\\\"15215104293767086553\\\",\\\"schema\\\":\\\"aws_cloudtrail\\\",\\\"timestamp\\\":1602102151000,\\\"data\\\":{}},\\\"queryId\\\":\\\"znEfjkXDE3XYhNwVn2e5gGQ\\\",\\\"status\\\":\\\"processing\\\",…\"\r\n\r\n```\r\n\r\n**What you expected to happen**:\r\n```\r\nresponse \r\n{\\\"item\\\":{\\\"isAggregateQuery\\\":false,\\\"columns\\\":[]},\\\"queryId\\\":\\\"znEfjkXDE3XYhNwVn2e5gGQ\\\",\\\"status\\\":\\\"processing\\\",\\\"itemType\\\":\\\"metadata\\\"}\r\n```\r\nEach item should be processed individually inside the Observable pipe.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nMake a fetch call with `getBackendSrv.fetch().pipe(...)` on a streaming endpoint and the results are not processed as a stream but rather as a monolith. \r\n\r\n**Anything else we need to know?**:\r\nIt seems that the documentation for using fetch on a streaming endpoint is actually meant for polling: https://grafana.com/docs/grafana/latest/developers/plugins/build-a-streaming-data-source-plugin/\r\n\r\n**Environment**:\r\n- Grafana version: 8.0.0\r\n- Data source type \u0026 version: Datasource Plugin \u0026 8.4.4\r\n- OS Grafana is installed on: Mac\r\n- User OS \u0026 Browser: Mac v 10.15.4 \u0026\u0026 Firefox\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/plugins","area/datasource/proxy","needs investigation"]},{"id":72447,"title":"Alerting email notification templates are not wide enough and the \"Grouped by\" title is confusing when empty","body":"### What happened?\n\nThe width of the text zone of the email template looks to be fixed to 600px which is quite small on modern desktop standard and cause unwanted line return\r\n\r\nFurthermore when you disable the \"Group by\" on the \"Notification policie\" the folder icon and the \"Grouped by\" title are still present in the email\r\n\n\n### What did you expect to happen?\n\nThe width of the text zone should not be fixed and allow to text \u003e 600px\r\nThe \"Grouped by\" title should be removed if the \"Group by\" option is disable\r\n\n\n### Did this work before?\n\nno\n\n### How do we reproduce it?\n\nSend a email notification with a large text and no grouping\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 9.5.7\r\nOS: Docker\r\nBrowser: Edge \u0026 Chrome + Outlook 365\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\n_No response_","labels":["area/alerting","area/frontend"]},{"id":63205,"title":"Alert rules page: \"RangeError: The start of an interval cannot be after its end\" when expanding folders","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: Grafana might crash on the Alert rules page (/alerting/list) when expanding the rule folders, with the following error: \"RangeError: The start of an interval cannot be after its end\".\r\n\r\n**What you expected to happen**: Expanding a folder should not crash the app\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: This is easily reproducible if Grafana runs on a remote instance.\r\nI noticed it happens if your browser (system) time is behind the instance's time. When Grafana tries to calculate for how long a given alert has been in a given state (e.g.\"For: 1m\"), if the browser time is behind the rule's time (which I guess comes from the Grafana server, which is remote and ahead of us), then date-fns will throw a RangeError.\r\nThis should be an actual time difference, not a timezone difference. \r\nThe easiest way is to set the local time behind some minutes and create a rule that gets triggered. By going to the `/alerting/list` page, Grafana will crash.\r\n\r\n**Anything else we need to know?**:\r\nFile where it happens is RuleState.tsx, when `intervalToAbbreviatedDurationString` is called. But this function is called in other places, so this problem can occur elsewhere.\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.5\r\n- OS Grafana is installed on: CentOS\r\n- User OS \u0026 Browser: MacOS, Chrome\r\n","labels":["type/bug","area/alerting","area/frontend"]},{"id":58482,"title":"Geomap: Support template variable interpolation in XYZ tile layer URL","body":"Variables are ignored when used within the URL Template field in the Geomap visualization. \r\n\r\n![xyz-tile](https://user-images.githubusercontent.com/9807045/200676566-e5fd0498-e57c-4c0e-8d66-4c2de3332531.png)\r\n\r\nWhen using a variable in the form \"${varname}\", the exact text of this variable appears in the URL requests for maptiles for the visualization. We are unaware of any escaping that could be used to potentially evaluate the variable instead of passing the variable string literally.\r\n\r\nWe expected the variable to be evaluated and used as part of the URL expression. Instead, the string \"${varname}\" is URL encoded and made part of the maptile request.\r\n\r\nTo reproduce this error, create a Geomap visualization using the XYZ basemap option as shown in the attached image. Then insert any variable on your dashboard into the URL.  Using a web debugger, trace the network requests and you will be able to see that the variable is not evaluated and that the variable name (not the variable value) is simply URL encoded in the request.\r\n\r\n**Environment**:\r\n- Grafana version: 9.2\r\n- Grafana plugins: Geomap (9.2.3-997144b7)\r\n\r\n","labels":["type/feature-request","add to changelog","area/panel/geomap"]},{"id":61511,"title":"Dashboard API creation errors on Grafana@9.3.1","body":"**What happened**:\r\nCreate dashboard using Dashboard API POST `/api/dashboards/db` is returning 500 Internal Server Error with a body:\r\n```\r\n{\r\n    \"message\": \"Failed to save dashboard\",\r\n    \"traceID\": \"\"\r\n}\r\n```\r\n\r\n**What you expected to happen**:\r\nSuccessful creation of the dashboard with dashboard JSON on response.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nUsing `https://{admin}:{password}@grafana_url.com/api/dashboards/db` POST throws this error.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.1 on Helm chart v6.48.0\r\n- Data source type \u0026 version: Loki and Prometheus\r\n","labels":["area/backend/api","datasource/Prometheus"]},{"id":60551,"title":"runtime error: invalid memory address or nil pointer dereference","body":"**What happened**:\r\nuse grafana-plugin-sdk-go ，in dashboard some panel return panic： runtime error: invalid memory address or nil pointer dereference\r\nand have a error message：logger=context userId=1 orgId=1 uname=admin t=2022-12-20T14:24:52.0443557+08:00 level=error msg=\"Internal server error\" error=\"[plugin.downstreamError] failed to query data: Failed to query data: rpc error: code = Unavailable desc = error reading from server: EOF\" remote_addr=172.17.0.1 traceID=\r\n\r\n**What you expected to happen**:\r\n\r\n work fine\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nno\r\n\r\n**Anything else we need to know?**:\r\nno\r\n\r\n**Environment**: \r\n\r\n- Grafana version: 9.3.1\r\n\r\n- Data source type \u0026 version:\r\n\r\nThe company's self-developed data source\r\n\r\n- OS Grafana is installed on: grafana/grafana:main-ubuntu in windows docker\r\n\r\n- User OS \u0026 Browser:chrome\r\n\r\n- Grafana plugins: no\r\n\r\n- Others: no\r\n","labels":["area/backend/plugins"]},{"id":61297,"title":"XY Chart: problems with tooltip","body":"Dear grafana community,\r\n\r\ngrafana is no longer able to display all values of the query in the tooltip compared to v9.1.6. Previously, additional queried columns were displayed in the tooltip. With 9.3.2, only the x and y values are displayed, but no additional query values.\r\n\r\nSee [this screenshot](https://i.ibb.co/LJKz03F/comparison-grafana.png), performed with the same data but the different Grafana versions.\r\n\r\nAm I missing something here or is there a new workaround for the current version?\r\n\r\nThank you","labels":["type/duplicate","needs investigation","area/panel/xychart","area/tooltip"]},{"id":70130,"title":"Alerting: Different delivery time for different integrations","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n In my Grafana configuration, I have a contact point with 3 integrations: \r\n- Teams\r\n- Google Chat\r\n- A custom webhook to launch a recording system\r\n\r\nI've experienced that notifications are sent to the integrations at different time:\r\n\r\n![Screenshot from 2023-06-15 10-52-36](https://github.com/grafana/grafana/assets/67068/7f714a77-6809-40cd-810c-424a8c5b9578)\r\n\r\nThe time display isn't the issue here, but I'm getting these notifications with a huge delay between them\r\n\r\n**What did you expect to happen**:\r\n\r\nI was expecting that the notifications would be sent at the same time. For my application,  5-second delay would be ok.    \r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Provision a contact point with valid webhooks:\r\n\r\n```yml\r\n  - orgId: 1\r\n    name:  PANDA_FERRUM_PANDIA\r\n    receivers:\r\n      - name: PANDA Teams\r\n        type: teams\r\n        uid: panda-3\r\n        isDefault: false\r\n        settings:\r\n          url: XXXX\r\n          title: |\r\n            {{ template \"notification.title\" . }}\r\n          message: |\r\n            {{ template \"notification.body\" . }}\r\n        disableResolveMessage: true\r\n\r\n      - uid: ferrum-2\r\n        type: googlechat\r\n        isDefault: true\r\n        name: Ferrum Panda Live\r\n        disableResolveMessage: true\r\n        settings:\r\n          url: YYYY\r\n          title: |\r\n            {{ template \"notification.title\" . }}\r\n          message: |\r\n            {{ template \"notification.body\" . }}\r\n\r\n      - name: PANDIA Webhook\r\n        type: webhook\r\n        uid: pandia-1\r\n        isDefault: false\r\n        settings:\r\n          url: http://192.168.14.110/trigger\r\n        disableResolveMessage: true\r\n```\r\n\r\n**Step 2**:\r\n\r\n- Provision notification policies:\r\n\r\n```yaml\r\n# config file version\r\napiVersion: 1\r\n\r\n# List of notification policies\r\npolicies:\r\n  # \u003cint\u003e organization ID, default = 1\r\n  - orgId: 1\r\n    name: All for PANDA\r\n    receiver: PANDA\r\n    group_by:\r\n      - ...\r\n\r\n    routes:\r\n      - matchers:\r\n          - grafana_folder = Customer\r\n        receiver: PANDA_FERRUM_PANDIA\r\n```\r\n\r\n**Step 3**:\r\n\r\n- Create an alert in the `Customer` folder\r\n\r\n** Step 4**:\r\n\r\n-  Fire the alert\r\n\n\n### \n# What Grafana version are you using?\n\n\nv9.4.7\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nDocker\n\n### User's OS?\n\nUbuntu 20.04\n\n### User's Browser?\n\nVersion 114.0.5735.106 (Official Build) snap (64-bit)\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\nInfluxDB\n\n### Anything else to add?\n\n\n_No response_","labels":["needs more info","area/alerting/notifications"]},{"id":68167,"title":"Alerting: Telegram contact point options","body":"\u003c!--\r\nPlease use this template to create your chore issue. You can use this template if you spot an out-of-date README, discover a misspelling, or happen upon a deeply nested 7-layer for-loop that could be better handled another way. Please use this template for your non-bug related fixes/updates/refactors.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What is the chore?**:\r\nSeveral [parameters](https://core.telegram.org/bots/api#sendmessage) for the Telegram API's `sendMessage` method are unable to be configured in Grafana when using Telegram as a contact point for alerts. Useful ones to be able to configure would be `disable_web_page_preview` and `protect_content`.","labels":["area/alerting","area/alerting/notifications","good first issue"]},{"id":58728,"title":"Timeseries panels hang in timeAxisSplits infinite loop with certain TZ settings ","body":"**What happened**:\r\n\r\nI am in Bangkok, the rest of the team is in Shanghai. Default time zone is set to Asia/Shanghai. If I set my user time zone to Asia/Shanghai, timeseries panels hang in `while (1)` loop in `timeAxisSplits` method of `uplot.esm.js`. If I switch to \"browser time zone\", it works.\r\n\r\n**What you expected to happen**:\r\n\r\nNo hanging.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nWhile in TZ A, set Grafana to TZ B, and set user TZ to B.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.4\r\n- Data source type \u0026 version: Postgres\r\n- OS Grafana is installed on: Debian\r\n- User OS \u0026 Browser: Arch + Chrome 107\r\n","labels":["needs more info","area/dashboard/timezone","area/panel/timeseries"]},{"id":63605,"title":"no MQTT data received even the MQTT data source is connected","body":"I am able to subscribe the MQTT data through mosquitto_sub but Grafana didn't display any data. Grafana 9.2.0 do not have this issue.\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.6\r\n- Data source type \u0026 version: MQTT\r\n- OS Grafana is installed on: Ubuntu 20.04\r\n\r\n","labels":["bot/no new info","area/live"]},{"id":59552,"title":"Grouped columns in bar chart are not colored correctly based on thresholds","body":"**What happened**:\r\n\r\nI'm using multiple queries in a panel that result in data in columns (min, avg, max) and rows (resource):\r\n\r\n![image](https://user-images.githubusercontent.com/8142186/204798108-cddf160e-3d99-46ef-abc9-5cdfd8978755.png)\r\n\r\nUsing the new bar chart visualization and enabling color schema \"From thresholds (by value)\" leads to the following result\r\n\r\n![image](https://user-images.githubusercontent.com/8142186/204798153-4ea76946-1067-4a93-ab20-d2fe8a8e00f1.png)\r\n\r\n**What you expected to happen**:\r\n\r\nEach bar should be colored based on its own value, but as the example shows only the values of the last row (resource: requests.memory) of the data are considered: All the 'max' bars are colored yellow which should only be the case for the rightmost bar (which is the only one between 0.4 and 0.5).\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n- configure queries that create data in columns and rows\r\n- choose bar chart\r\n- configure thresholds\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.0\r\n- Data source type \u0026 version: Bar chart 5.0.0\r\n- OS Grafana is installed on: Ubuntu 22.04\r\n- User OS \u0026 Browser: Ubuntu 22.04 / Firefox 107.0\r\n- Grafana plugins: -\r\n- Others: -\r\n","labels":["stale","area/panel/edit"]},{"id":73866,"title":"10.1.0 Login fails: cannot remove last organization admin","body":"### What happened?\r\n\r\nAfter upgrading to 10.1.0 I receive following error:\r\n\r\n\u003e Login failed\r\n\u003e cannot remove last organization admin\r\n\r\nThe following environment variable is set:\r\n\r\n```\r\nGF_AUTH_GENERIC_OAUTH_SKIP_ORG_ROLE_SYNC      = \"true\"\r\nGF_AUTH_OAUTH_ALLOW_INSECURE_EMAIL_LOOKUP     = \"true\"\r\n```\r\n\r\nUpon login it is trying to downgrade my role from Admin to Viewer, then the error happens.\r\nMy expectation of the settings above is to not sync the roles and leave me as Admin, as my generic oauth does not have a role-mapping configuration yet.\r\n\r\n### What did you expect to happen?\r\n\r\nLogin should work\r\n\r\n### Did this work before?\r\n\r\nYes\r\n\r\n### How do we reproduce it?\r\n\r\n1. Upgrade to 10.1.0\r\n2. Login\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nNo\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.1.0\r\nOS: Docker\r\nBrowser: Edge\r\n\r\n\r\n### Grafana platform?\r\n\r\nDocker\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/auth/oauth","area/docker","area/configuration","triage/needs-confirmation"]},{"id":47486,"title":"Timezone inconsistencies with relative time filters","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: WHen using relative time filters at the day level (eg, ```Now/d```) different data is shown depending on the timezone of the user's browser even though a specific timezone is specified for the dashboard.\r\n\r\n**What you expected to happen**:\r\nThe same data should be shown regardless of the browser's timezone.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nSet a relative time filter on your dashboard that includes the day filter. eg 'now/d+15h'\r\n![image](https://user-images.githubusercontent.com/23325075/162377827-effe4ec7-6968-4ee6-a0ea-8006c90c6deb.png)\r\n\r\nThis is the output when the browser timezone is ACST (GMT+9.5)\r\n![image](https://user-images.githubusercontent.com/23325075/162377966-18b8308c-e274-4fd4-b3fb-6934e1f82367.png)\r\n\r\nUse the Chrome developer tools to change the browsers timezone. Dev Tools \u003e 3 Dot Menu \u003e More Tools \u003e Sensors \u003e Location \u003e Select alternate location. Eg, London\r\n![image](https://user-images.githubusercontent.com/23325075/162371402-21274d40-1279-4f8a-858c-26158b6d026c.png)\r\n\r\nRefresh the Grafana dashboard and one of the visualisations shows 'No data'. This is the output when the browser timezone is set to London (GMT+1).\r\n![image](https://user-images.githubusercontent.com/23325075/162378427-05d55078-f6a0-4653-a9b1-aca7b5bb9c91.png)\r\n\r\n\r\n**Anything else we need to know?**:\r\nThis is the JSON data for the 'Temperature' visualisation shown in my screen captures when the browser timezone is ACST (GMT+9.5).\r\n\r\nNote: This was too large for the character limit so I removed the 2nd data series from the JSON.\r\n\r\n```\r\n{\r\n  \"state\": \"Done\",\r\n  \"series\": [\r\n    {\r\n      \"name\": \"Farm\",\r\n      \"refId\": \"A\",\r\n      \"meta\": {\r\n        \"executedQueryString\": \"SELECT last(\\\"temperature\\\")  / 10 FROM \\\"SNMP_tme\\\" WHERE (\\\"temperature\\\" \u003c 1000) AND time \u003e= 1649395800000ms and time \u003c= 1649485799999ms GROUP BY time(2m), \\\"devicename\\\" fill(null)\"\r\n      },\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"Time\",\r\n          \"type\": \"time\",\r\n          \"config\": {\r\n            \"unit\": \"celsius\",\r\n            \"thresholds\": {\r\n              \"mode\": \"absolute\",\r\n              \"steps\": [\r\n                {\r\n                  \"color\": \"green\",\r\n                  \"value\": null\r\n                },\r\n                {\r\n                  \"color\": \"red\",\r\n                  \"value\": 350\r\n                }\r\n              ]\r\n            },\r\n            \"color\": {\r\n              \"mode\": \"thresholds\"\r\n            }\r\n          },\r\n          \"values\": [\r\n            1649395800000,\r\n            1649395920000,\r\n            1649396040000,\r\n            1649396160000,\r\n            1649396280000,\r\n            1649396400000,\r\n            1649396520000,\r\n            1649396640000,\r\n            1649396760000,\r\n            1649396880000,\r\n            1649397000000,\r\n            1649397120000,\r\n            1649397240000,\r\n            1649397360000,\r\n            1649397480000,\r\n            1649397600000,\r\n            1649397720000,\r\n            1649397840000,\r\n            1649397960000,\r\n            1649398080000,\r\n            1649398200000,\r\n            1649398320000,\r\n            1649398440000,\r\n            1649398560000,\r\n            1649398680000,\r\n            1649398800000,\r\n            1649398920000,\r\n            1649399040000,\r\n            1649399160000,\r\n            1649399280000,\r\n            1649399400000,\r\n            1649399520000,\r\n            1649399640000,\r\n            1649399760000,\r\n            1649399880000,\r\n            1649400000000,\r\n            1649400120000,\r\n            1649400240000,\r\n            1649400360000,\r\n            1649400480000,\r\n            1649400600000,\r\n            1649400720000,\r\n            1649400840000,\r\n            1649400960000,\r\n            1649401080000,\r\n            1649401200000,\r\n            1649401320000,\r\n            1649401440000,\r\n            1649401560000,\r\n            1649401680000,\r\n            1649401800000,\r\n            1649401920000,\r\n            1649402040000,\r\n            1649402160000,\r\n            1649402280000,\r\n            1649402400000,\r\n            1649402520000,\r\n            1649402640000,\r\n            1649402760000,\r\n            1649402880000,\r\n            1649403000000,\r\n            1649403120000,\r\n            1649403240000,\r\n            1649403360000,\r\n            1649403480000,\r\n            1649403600000,\r\n            1649403720000,\r\n            1649403840000,\r\n            1649403960000,\r\n            1649404080000,\r\n            1649404200000,\r\n            1649404320000,\r\n            1649404440000,\r\n            1649404560000,\r\n            1649404680000,\r\n            1649404800000,\r\n            1649404920000,\r\n            1649405040000,\r\n            1649405160000,\r\n            1649405280000,\r\n            1649405400000,\r\n            1649405520000,\r\n            1649405640000,\r\n            1649405760000,\r\n            1649405880000,\r\n            1649406000000,\r\n            1649406120000,\r\n            1649406240000,\r\n            1649406360000,\r\n            1649406480000,\r\n            1649406600000,\r\n            1649406720000,\r\n            1649406840000,\r\n            1649406960000,\r\n            1649407080000,\r\n            1649407200000,\r\n            1649407320000,\r\n            1649407440000,\r\n            1649407560000,\r\n            1649407680000,\r\n            1649407800000,\r\n            1649407920000,\r\n            1649408040000,\r\n            1649408160000,\r\n            1649408280000,\r\n            1649408400000,\r\n            1649408520000,\r\n            1649408640000,\r\n            1649408760000,\r\n            1649408880000,\r\n            1649409000000,\r\n            1649409120000,\r\n            1649409240000,\r\n            1649409360000,\r\n            1649409480000,\r\n            1649409600000,\r\n            1649409720000,\r\n            1649409840000,\r\n            1649409960000,\r\n            1649410080000,\r\n            1649410200000,\r\n            1649410320000,\r\n            1649410440000,\r\n            1649410560000,\r\n            1649410680000,\r\n            1649410800000,\r\n            1649410920000,\r\n            1649411040000,\r\n            1649411160000,\r\n            1649411280000,\r\n            1649411400000,\r\n            1649411520000,\r\n            1649411640000,\r\n            1649411760000,\r\n            1649411880000,\r\n            1649412000000,\r\n            1649412120000,\r\n            1649412240000,\r\n            1649412360000,\r\n            1649412480000,\r\n            1649412600000,\r\n            1649412720000,\r\n            1649412840000,\r\n            1649412960000,\r\n            1649413080000,\r\n            1649413200000,\r\n            1649413320000,\r\n            1649413440000,\r\n            1649413560000,\r\n            1649413680000,\r\n            1649413800000,\r\n            1649413920000,\r\n            1649414040000,\r\n            1649414160000,\r\n            1649414280000,\r\n            1649414400000,\r\n            1649414520000,\r\n            1649414640000,\r\n            1649414760000,\r\n            1649414880000,\r\n            1649415000000,\r\n            1649415120000,\r\n            1649415240000,\r\n            1649415360000,\r\n            1649415480000,\r\n            1649415600000,\r\n            1649415720000,\r\n            1649415840000,\r\n            1649415960000,\r\n            1649416080000,\r\n            1649416200000,\r\n            1649416320000,\r\n            1649416440000,\r\n            1649416560000,\r\n            1649416680000,\r\n            1649416800000,\r\n            1649416920000,\r\n            1649417040000,\r\n            1649417160000,\r\n            1649417280000,\r\n            1649417400000,\r\n            1649417520000,\r\n            1649417640000,\r\n            1649417760000,\r\n            1649417880000,\r\n            1649418000000,\r\n            1649418120000,\r\n            1649418240000,\r\n            1649418360000,\r\n            1649418480000,\r\n            1649418600000,\r\n            1649418720000,\r\n            1649418840000,\r\n            1649418960000,\r\n            1649419080000,\r\n            1649419200000,\r\n            1649419320000,\r\n            1649419440000,\r\n            1649419560000,\r\n            1649419680000,\r\n            1649419800000,\r\n            1649419920000,\r\n            1649420040000,\r\n            1649420160000,\r\n            1649420280000,\r\n            1649420400000,\r\n            1649420520000,\r\n            1649420640000,\r\n            1649420760000,\r\n            1649420880000,\r\n            1649421000000,\r\n            1649421120000,\r\n            1649421240000,\r\n            1649421360000,\r\n            1649421480000,\r\n            1649421600000,\r\n            1649421720000,\r\n            1649421840000,\r\n            1649421960000,\r\n            1649422080000,\r\n            1649422200000,\r\n            1649422320000,\r\n            1649422440000,\r\n            1649422560000,\r\n            1649422680000,\r\n            1649422800000,\r\n            1649422920000,\r\n            1649423040000,\r\n            1649423160000,\r\n            1649423280000,\r\n            1649423400000,\r\n            1649423520000,\r\n            1649423640000,\r\n            1649423760000,\r\n            1649423880000,\r\n            1649424000000,\r\n            1649424120000,\r\n            1649424240000,\r\n            1649424360000,\r\n            1649424480000,\r\n            1649424600000,\r\n            1649424720000,\r\n            1649424840000,\r\n            1649424960000,\r\n            1649425080000,\r\n            1649425200000,\r\n            1649425320000,\r\n            1649425440000,\r\n            1649425560000,\r\n            1649425680000,\r\n            1649425800000,\r\n            1649425920000,\r\n            1649426040000,\r\n            1649426160000,\r\n            1649426280000,\r\n            1649426400000,\r\n            1649426520000,\r\n            1649426640000,\r\n            1649426760000,\r\n            1649426880000,\r\n            1649427000000,\r\n            1649427120000,\r\n            1649427240000,\r\n            1649427360000,\r\n            1649427480000,\r\n            1649427600000,\r\n            1649427720000,\r\n            1649427840000,\r\n            1649427960000,\r\n            1649428080000,\r\n            1649428200000,\r\n            1649428320000,\r\n            1649428440000,\r\n            1649428560000,\r\n            1649428680000,\r\n            1649428800000,\r\n            1649428920000,\r\n            1649429040000,\r\n            1649429160000,\r\n            1649429280000,\r\n            1649429400000,\r\n            1649429520000,\r\n            1649429640000,\r\n            1649429760000,\r\n            1649429880000,\r\n            1649430000000,\r\n            1649430120000,\r\n            1649430240000,\r\n            1649430360000,\r\n            1649430480000,\r\n            1649430600000,\r\n            1649430720000,\r\n            1649430840000,\r\n            1649430960000,\r\n            1649431080000,\r\n            1649431200000,\r\n            1649431320000,\r\n            1649431440000,\r\n            1649431560000,\r\n            1649431680000,\r\n            1649431800000,\r\n            1649431920000,\r\n            1649432040000,\r\n            1649432160000,\r\n            1649432280000,\r\n            1649432400000,\r\n            1649432520000,\r\n            1649432640000,\r\n            1649432760000,\r\n            1649432880000,\r\n            1649433000000,\r\n            1649433120000,\r\n            1649433240000,\r\n            1649433360000,\r\n            1649433480000,\r\n            1649433600000,\r\n            1649433720000,\r\n            1649433840000,\r\n            1649433960000,\r\n            1649434080000,\r\n            1649434200000,\r\n            1649434320000,\r\n            1649434440000,\r\n            1649434560000,\r\n            1649434680000,\r\n            1649434800000,\r\n            1649434920000,\r\n            1649435040000,\r\n            1649435160000,\r\n            1649435280000,\r\n            1649435400000,\r\n            1649435520000,\r\n            1649435640000,\r\n            1649435760000,\r\n            1649435880000,\r\n            1649436000000,\r\n            1649436120000,\r\n            1649436240000,\r\n            1649436360000,\r\n            1649436480000,\r\n            1649436600000,\r\n            1649436720000,\r\n            1649436840000,\r\n            1649436960000,\r\n            1649437080000,\r\n            1649437200000,\r\n            1649437320000,\r\n            1649437440000,\r\n            1649437560000,\r\n            1649437680000,\r\n            1649437800000,\r\n            1649437920000,\r\n            1649438040000,\r\n            1649438160000,\r\n            1649438280000,\r\n            1649438400000,\r\n            1649438520000,\r\n            1649438640000,\r\n            1649438760000,\r\n            1649438880000,\r\n            1649439000000,\r\n            1649439120000,\r\n            1649439240000,\r\n            1649439360000,\r\n            1649439480000,\r\n            1649439600000,\r\n            1649439720000,\r\n            1649439840000,\r\n            1649439960000,\r\n            1649440080000,\r\n            1649440200000,\r\n            1649440320000,\r\n            1649440440000,\r\n            1649440560000,\r\n            1649440680000,\r\n            1649440800000,\r\n            1649440920000,\r\n            1649441040000,\r\n            1649441160000,\r\n            1649441280000,\r\n            1649441400000,\r\n            1649441520000,\r\n            1649441640000,\r\n            1649441760000,\r\n            1649441880000,\r\n            1649442000000,\r\n            1649442120000,\r\n            1649442240000,\r\n            1649442360000,\r\n            1649442480000,\r\n            1649442600000,\r\n            1649442720000,\r\n            1649442840000,\r\n            1649442960000,\r\n            1649443080000,\r\n            1649443200000,\r\n            1649443320000,\r\n            1649443440000,\r\n            1649443560000,\r\n            1649443680000,\r\n            1649443800000,\r\n            1649443920000,\r\n            1649444040000,\r\n            1649444160000,\r\n            1649444280000,\r\n            1649444400000,\r\n            1649444520000,\r\n            1649444640000,\r\n            1649444760000,\r\n            1649444880000,\r\n            1649445000000,\r\n            1649445120000,\r\n            1649445240000,\r\n            1649445360000,\r\n            1649445480000,\r\n            1649445600000,\r\n            1649445720000,\r\n            1649445840000,\r\n            1649445960000,\r\n            1649446080000,\r\n            1649446200000,\r\n            1649446320000,\r\n            1649446440000,\r\n            1649446560000,\r\n            1649446680000,\r\n            1649446800000,\r\n            1649446920000,\r\n            1649447040000,\r\n            1649447160000,\r\n            1649447280000,\r\n            1649447400000,\r\n            1649447520000,\r\n            1649447640000,\r\n            1649447760000,\r\n            1649447880000,\r\n            1649448000000,\r\n            1649448120000,\r\n            1649448240000,\r\n            1649448360000,\r\n            1649448480000,\r\n            1649448600000,\r\n            1649448720000,\r\n            1649448840000,\r\n            1649448960000,\r\n            1649449080000,\r\n            1649449200000,\r\n            1649449320000,\r\n            1649449440000,\r\n            1649449560000,\r\n            1649449680000,\r\n            1649449800000,\r\n            1649449920000,\r\n            1649450040000,\r\n            1649450160000,\r\n            1649450280000,\r\n            1649450400000,\r\n            1649450520000,\r\n            1649450640000,\r\n            1649450760000,\r\n            1649450880000,\r\n            1649451000000,\r\n            1649451120000,\r\n            1649451240000,\r\n            1649451360000,\r\n            1649451480000,\r\n            1649451600000,\r\n            1649451720000,\r\n            1649451840000,\r\n            1649451960000,\r\n            1649452080000,\r\n            1649452200000,\r\n            1649452320000,\r\n            1649452440000,\r\n            1649452560000,\r\n            1649452680000,\r\n            1649452800000,\r\n            1649452920000,\r\n            1649453040000,\r\n            1649453160000,\r\n            1649453280000,\r\n            1649453400000,\r\n            1649453520000,\r\n            1649453640000,\r\n            1649453760000,\r\n            1649453880000,\r\n            1649454000000,\r\n            1649454120000,\r\n            1649454240000,\r\n            1649454360000,\r\n            1649454480000,\r\n            1649454600000,\r\n            1649454720000,\r\n            1649454840000,\r\n            1649454960000,\r\n            1649455080000,\r\n            1649455200000,\r\n            1649455320000,\r\n            1649455440000,\r\n            1649455560000,\r\n            1649455680000,\r\n            1649455800000,\r\n            1649455920000,\r\n            1649456040000,\r\n            1649456160000,\r\n            1649456280000,\r\n            1649456400000,\r\n            1649456520000,\r\n            1649456640000,\r\n            1649456760000,\r\n            1649456880000,\r\n            1649457000000,\r\n            1649457120000,\r\n            1649457240000,\r\n            1649457360000,\r\n            1649457480000,\r\n            1649457600000,\r\n            1649457720000,\r\n            1649457840000,\r\n            1649457960000,\r\n            1649458080000,\r\n            1649458200000,\r\n            1649458320000,\r\n            1649458440000,\r\n            1649458560000,\r\n            1649458680000,\r\n            1649458800000,\r\n            1649458920000,\r\n            1649459040000,\r\n            1649459160000,\r\n            1649459280000,\r\n            1649459400000,\r\n            1649459520000,\r\n            1649459640000,\r\n            1649459760000,\r\n            1649459880000,\r\n            1649460000000,\r\n            1649460120000,\r\n            1649460240000,\r\n            1649460360000,\r\n            1649460480000,\r\n            1649460600000,\r\n            1649460720000,\r\n            1649460840000,\r\n            1649460960000,\r\n            1649461080000,\r\n            1649461200000,\r\n            1649461320000,\r\n            1649461440000,\r\n            1649461560000,\r\n            1649461680000,\r\n            1649461800000,\r\n            1649461920000,\r\n            1649462040000,\r\n            1649462160000,\r\n            1649462280000,\r\n            1649462400000,\r\n            1649462520000,\r\n            1649462640000,\r\n            1649462760000,\r\n            1649462880000,\r\n            1649463000000,\r\n            1649463120000,\r\n            1649463240000,\r\n            1649463360000,\r\n            1649463480000,\r\n            1649463600000,\r\n            1649463720000,\r\n            1649463840000,\r\n            1649463960000,\r\n            1649464080000,\r\n            1649464200000,\r\n            1649464320000,\r\n            1649464440000,\r\n            1649464560000,\r\n            1649464680000,\r\n            1649464800000,\r\n            1649464920000,\r\n            1649465040000,\r\n            1649465160000,\r\n            1649465280000,\r\n            1649465400000,\r\n            1649465520000,\r\n            1649465640000,\r\n            1649465760000,\r\n            1649465880000,\r\n            1649466000000,\r\n            1649466120000,\r\n            1649466240000,\r\n            1649466360000,\r\n            1649466480000,\r\n            1649466600000,\r\n            1649466720000,\r\n            1649466840000,\r\n            1649466960000,\r\n            1649467080000,\r\n            1649467200000,\r\n            1649467320000,\r\n            1649467440000,\r\n            1649467560000,\r\n            1649467680000,\r\n            1649467800000,\r\n            1649467920000,\r\n            1649468040000,\r\n            1649468160000,\r\n            1649468280000,\r\n            1649468400000,\r\n            1649468520000,\r\n            1649468640000,\r\n            1649468760000,\r\n            1649468880000,\r\n            1649469000000,\r\n            1649469120000,\r\n            1649469240000,\r\n            1649469360000,\r\n            1649469480000,\r\n            1649469600000,\r\n            1649469720000,\r\n            1649469840000,\r\n            1649469960000,\r\n            1649470080000,\r\n            1649470200000,\r\n            1649470320000,\r\n            1649470440000,\r\n            1649470560000,\r\n            1649470680000,\r\n            1649470800000,\r\n            1649470920000,\r\n            1649471040000,\r\n            1649471160000,\r\n            1649471280000,\r\n            1649471400000,\r\n            1649471520000,\r\n            1649471640000,\r\n            1649471760000,\r\n            1649471880000,\r\n            1649472000000,\r\n            1649472120000,\r\n            1649472240000,\r\n            1649472360000,\r\n            1649472480000,\r\n            1649472600000,\r\n            1649472720000,\r\n            1649472840000,\r\n            1649472960000,\r\n            1649473080000,\r\n            1649473200000,\r\n            1649473320000,\r\n            1649473440000,\r\n            1649473560000,\r\n            1649473680000,\r\n            1649473800000,\r\n            1649473920000,\r\n            1649474040000,\r\n            1649474160000,\r\n            1649474280000,\r\n            1649474400000,\r\n            1649474520000,\r\n            1649474640000,\r\n            1649474760000,\r\n            1649474880000,\r\n            1649475000000,\r\n            1649475120000,\r\n            1649475240000,\r\n            1649475360000,\r\n            1649475480000,\r\n            1649475600000,\r\n            1649475720000,\r\n            1649475840000,\r\n            1649475960000,\r\n            1649476080000,\r\n            1649476200000,\r\n            1649476320000,\r\n            1649476440000,\r\n            1649476560000,\r\n            1649476680000,\r\n            1649476800000,\r\n            1649476920000,\r\n            1649477040000,\r\n            1649477160000,\r\n            1649477280000,\r\n            1649477400000,\r\n            1649477520000,\r\n            1649477640000,\r\n            1649477760000,\r\n            1649477880000,\r\n            1649478000000,\r\n            1649478120000,\r\n            1649478240000,\r\n            1649478360000,\r\n            1649478480000,\r\n            1649478600000,\r\n            1649478720000,\r\n            1649478840000,\r\n            1649478960000,\r\n            1649479080000,\r\n            1649479200000,\r\n            1649479320000,\r\n            1649479440000,\r\n            1649479560000,\r\n            1649479680000,\r\n            1649479800000,\r\n            1649479920000,\r\n            1649480040000,\r\n            1649480160000,\r\n            1649480280000,\r\n            1649480400000,\r\n            1649480520000,\r\n            1649480640000,\r\n            1649480760000,\r\n            1649480880000,\r\n            1649481000000,\r\n            1649481120000,\r\n            1649481240000,\r\n            1649481360000,\r\n            1649481480000,\r\n            1649481600000,\r\n            1649481720000,\r\n            1649481840000,\r\n            1649481960000,\r\n            1649482080000,\r\n            1649482200000,\r\n            1649482320000,\r\n            1649482440000,\r\n            1649482560000,\r\n            1649482680000,\r\n            1649482800000,\r\n            1649482920000,\r\n            1649483040000,\r\n            1649483160000,\r\n            1649483280000,\r\n            1649483400000,\r\n            1649483520000,\r\n            1649483640000,\r\n            1649483760000,\r\n            1649483880000,\r\n            1649484000000,\r\n            1649484120000,\r\n            1649484240000,\r\n            1649484360000,\r\n            1649484480000,\r\n            1649484600000,\r\n            1649484720000,\r\n            1649484840000,\r\n            1649484960000,\r\n            1649485080000,\r\n            1649485200000,\r\n            1649485320000,\r\n            1649485440000,\r\n            1649485560000,\r\n            1649485680000\r\n          ],\r\n          \"state\": {\r\n            \"scopedVars\": {\r\n              \"__series\": {\r\n                \"text\": \"Series\",\r\n                \"value\": {\r\n                  \"name\": \"Farm\"\r\n                }\r\n              },\r\n              \"__field\": {\r\n                \"text\": \"Field\",\r\n                \"value\": {}\r\n              }\r\n            },\r\n            \"seriesIndex\": 0\r\n          }\r\n        },\r\n        {\r\n          \"name\": \"Value\",\r\n          \"type\": \"number\",\r\n          \"config\": {\r\n            \"displayNameFromDS\": \"Farm\",\r\n            \"unit\": \"celsius\",\r\n            \"mappings\": [],\r\n            \"thresholds\": {\r\n              \"mode\": \"absolute\",\r\n              \"steps\": [\r\n                {\r\n                  \"color\": \"green\",\r\n                  \"value\": null\r\n                },\r\n                {\r\n                  \"color\": \"red\",\r\n                  \"value\": 350\r\n                }\r\n              ]\r\n            },\r\n            \"color\": {\r\n              \"mode\": \"thresholds\"\r\n            }\r\n          },\r\n          \"values\": [\r\n            30.2,\r\n            30.6,\r\n            31.1,\r\n            31.2,\r\n            31.4,\r\n            31.6,\r\n            31.8,\r\n            31.9,\r\n            32.2,\r\n            32.3,\r\n            32.3,\r\n            32,\r\n            31.9,\r\n            32,\r\n            32.3,\r\n            31.8,\r\n            31.5,\r\n            31.1,\r\n            30.8,\r\n            30.6,\r\n            30.4,\r\n            30.1,\r\n            30,\r\n            30.1,\r\n            29.8,\r\n            29.6,\r\n            29.3,\r\n            29.1,\r\n            28.8,\r\n            28.6,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null,\r\n            null\r\n          ],\r\n          \"labels\": {\r\n            \"devicename\": \"Farm\"\r\n          },\r\n          \"state\": {\r\n            \"calcs\": {\r\n              \"sum\": 926.4,\r\n              \"max\": 32.3,\r\n              \"min\": 28.6,\r\n              \"logmin\": 28.6,\r\n              \"mean\": 30.88,\r\n              \"last\": null,\r\n              \"first\": 30.2,\r\n              \"lastNotNull\": 28.6,\r\n              \"firstNotNull\": 30.2,\r\n              \"count\": 750,\r\n              \"nonNullCount\": 30,\r\n              \"allIsNull\": false,\r\n              \"allIsZero\": false,\r\n              \"range\": 3.6999999999999957,\r\n              \"diff\": -1.5999999999999979,\r\n              \"delta\": 64.5,\r\n              \"step\": -0.49999999999999645,\r\n              \"diffperc\": -0.052980132450331056,\r\n              \"previousDeltaUp\": false\r\n            },\r\n            \"scopedVars\": {\r\n              \"__series\": {\r\n                \"text\": \"Series\",\r\n                \"value\": {\r\n                  \"name\": \"Farm\"\r\n                }\r\n              },\r\n              \"__field\": {\r\n                \"text\": \"Field\",\r\n                \"value\": {}\r\n              }\r\n            },\r\n            \"seriesIndex\": 0,\r\n            \"range\": {\r\n              \"min\": 20.7,\r\n              \"max\": 32.3,\r\n              \"delta\": 11.599999999999998\r\n            }\r\n          }\r\n        }\r\n      ],\r\n      \"length\": 750\r\n    }\r\n  ],\r\n  \"annotations\": [],\r\n  \"request\": {\r\n    \"app\": \"dashboard\",\r\n    \"requestId\": \"Q101\",\r\n    \"timezone\": \"Australia/Adelaide\",\r\n    \"panelId\": 31,\r\n    \"dashboardId\": 58,\r\n    \"range\": {\r\n      \"from\": \"2022-04-08T05:30:00.000Z\",\r\n      \"to\": \"2022-04-09T06:29:59.999Z\",\r\n      \"raw\": {\r\n        \"from\": \"now/d+15h\",\r\n        \"to\": \"now/d+16h\"\r\n      }\r\n    },\r\n    \"timeInfo\": \"\",\r\n    \"interval\": \"2m\",\r\n    \"intervalMs\": 120000,\r\n    \"targets\": [\r\n      {\r\n        \"alias\": \"$tag_devicename\",\r\n        \"groupBy\": [\r\n          {\r\n            \"params\": [\r\n              \"$__interval\"\r\n            ],\r\n            \"type\": \"time\"\r\n          },\r\n          {\r\n            \"params\": [\r\n              \"devicename\"\r\n            ],\r\n            \"type\": \"tag\"\r\n          },\r\n          {\r\n            \"params\": [\r\n              \"null\"\r\n            ],\r\n            \"type\": \"fill\"\r\n          }\r\n        ],\r\n        \"measurement\": \"SNMP_tme\",\r\n        \"orderByTime\": \"ASC\",\r\n        \"policy\": \"default\",\r\n        \"refId\": \"A\",\r\n        \"resultFormat\": \"time_series\",\r\n        \"select\": [\r\n          [\r\n            {\r\n              \"params\": [\r\n                \"temperature\"\r\n              ],\r\n              \"type\": \"field\"\r\n            },\r\n            {\r\n              \"params\": [],\r\n              \"type\": \"last\"\r\n            },\r\n            {\r\n              \"params\": [\r\n                \" / 10\"\r\n              ],\r\n              \"type\": \"math\"\r\n            }\r\n          ]\r\n        ],\r\n        \"tags\": [\r\n          {\r\n            \"key\": \"temperature\",\r\n            \"operator\": \"\u003c\",\r\n            \"value\": \"1000\"\r\n          }\r\n        ],\r\n        \"datasource\": {\r\n          \"type\": \"influxdb\",\r\n          \"uid\": \"000000001\"\r\n        }\r\n      }\r\n    ],\r\n    \"maxDataPoints\": 622,\r\n    \"scopedVars\": {\r\n      \"__interval\": {\r\n        \"text\": \"2m\",\r\n        \"value\": \"2m\"\r\n      },\r\n      \"__interval_ms\": {\r\n        \"text\": \"120000\",\r\n        \"value\": 120000\r\n      },\r\n      \"interval\": {\r\n        \"text\": \"2m\",\r\n        \"value\": \"2m\"\r\n      },\r\n      \"timeFilter\": {\r\n        \"value\": \"time \u003e= 1649395800000ms and time \u003c= 1649485799999ms\"\r\n      }\r\n    },\r\n    \"startTime\": 1649399361864,\r\n    \"rangeRaw\": {\r\n      \"from\": \"now/d+15h\",\r\n      \"to\": \"now/d+16h\"\r\n    },\r\n    \"endTime\": 1649399361912\r\n  },\r\n  \"timeRange\": {\r\n    \"from\": \"2022-04-08T05:30:00.000Z\",\r\n    \"to\": \"2022-04-09T06:29:59.999Z\",\r\n    \"raw\": {\r\n      \"from\": \"now/d+15h\",\r\n      \"to\": \"now/d+16h\"\r\n    }\r\n  },\r\n  \"timings\": {\r\n    \"dataProcessingTime\": 0.09999990463256836\r\n  },\r\n  \"structureRev\": 2\r\n}\r\n```\r\n\r\nThis is the JSON data for the 'Temperature' visualisation when the browser timezone is set to London (GMT+1).\r\n\r\nI can immediately see an item of concern with this. The time currently while I write this issue is ```2022-04-08T06:37:00.000Z```. The from time range that is listed below is ```2022-04-08T14:00:00.000Z``` which is several hours in the future.\r\n```\r\n{\r\n  \"state\": \"Done\",\r\n  \"series\": [],\r\n  \"annotations\": [],\r\n  \"request\": {\r\n    \"app\": \"dashboard\",\r\n    \"requestId\": \"Q101\",\r\n    \"timezone\": \"Australia/Adelaide\",\r\n    \"panelId\": 31,\r\n    \"dashboardId\": 58,\r\n    \"range\": {\r\n      \"from\": \"2022-04-08T14:00:00.000Z\",\r\n      \"to\": \"2022-04-09T14:59:59.999Z\",\r\n      \"raw\": {\r\n        \"from\": \"now/d+15h\",\r\n        \"to\": \"now/d+16h\"\r\n      }\r\n    },\r\n    \"timeInfo\": \"\",\r\n    \"interval\": \"2m\",\r\n    \"intervalMs\": 120000,\r\n    \"targets\": [\r\n      {\r\n        \"alias\": \"$tag_devicename\",\r\n        \"groupBy\": [\r\n          {\r\n            \"params\": [\r\n              \"$__interval\"\r\n            ],\r\n            \"type\": \"time\"\r\n          },\r\n          {\r\n            \"params\": [\r\n              \"devicename\"\r\n            ],\r\n            \"type\": \"tag\"\r\n          },\r\n          {\r\n            \"params\": [\r\n              \"null\"\r\n            ],\r\n            \"type\": \"fill\"\r\n          }\r\n        ],\r\n        \"measurement\": \"SNMP_tme\",\r\n        \"orderByTime\": \"ASC\",\r\n        \"policy\": \"default\",\r\n        \"refId\": \"A\",\r\n        \"resultFormat\": \"time_series\",\r\n        \"select\": [\r\n          [\r\n            {\r\n              \"params\": [\r\n                \"temperature\"\r\n              ],\r\n              \"type\": \"field\"\r\n            },\r\n            {\r\n              \"params\": [],\r\n              \"type\": \"last\"\r\n            },\r\n            {\r\n              \"params\": [\r\n                \" / 10\"\r\n              ],\r\n              \"type\": \"math\"\r\n            }\r\n          ]\r\n        ],\r\n        \"tags\": [\r\n          {\r\n            \"key\": \"temperature\",\r\n            \"operator\": \"\u003c\",\r\n            \"value\": \"1000\"\r\n          }\r\n        ],\r\n        \"datasource\": {\r\n          \"type\": \"influxdb\",\r\n          \"uid\": \"000000001\"\r\n        }\r\n      }\r\n    ],\r\n    \"maxDataPoints\": 622,\r\n    \"scopedVars\": {\r\n      \"__interval\": {\r\n        \"text\": \"2m\",\r\n        \"value\": \"2m\"\r\n      },\r\n      \"__interval_ms\": {\r\n        \"text\": \"120000\",\r\n        \"value\": 120000\r\n      },\r\n      \"interval\": {\r\n        \"text\": \"2m\",\r\n        \"value\": \"2m\"\r\n      },\r\n      \"timeFilter\": {\r\n        \"value\": \"time \u003e= 1649426400000ms and time \u003c= 1649516399999ms\"\r\n      }\r\n    },\r\n    \"startTime\": 1649399794224,\r\n    \"rangeRaw\": {\r\n      \"from\": \"now/d+15h\",\r\n      \"to\": \"now/d+16h\"\r\n    },\r\n    \"endTime\": 1649399794304\r\n  },\r\n  \"timeRange\": {\r\n    \"from\": \"2022-04-08T14:00:00.000Z\",\r\n    \"to\": \"2022-04-09T14:59:59.999Z\",\r\n    \"raw\": {\r\n      \"from\": \"now/d+15h\",\r\n      \"to\": \"now/d+16h\"\r\n    }\r\n  },\r\n  \"timings\": {\r\n    \"dataProcessingTime\": 0\r\n  },\r\n  \"structureRev\": 1\r\n}\r\n```\r\n\r\nThe dashboard JSON is:\r\n```\r\n{\r\n  \"annotations\": {\r\n    \"list\": [\r\n      {\r\n        \"builtIn\": 1,\r\n        \"datasource\": \"-- Grafana --\",\r\n        \"enable\": true,\r\n        \"hide\": true,\r\n        \"iconColor\": \"rgba(0, 211, 255, 1)\",\r\n        \"name\": \"Annotations \u0026 Alerts\",\r\n        \"target\": {\r\n          \"limit\": 100,\r\n          \"matchAny\": false,\r\n          \"tags\": [],\r\n          \"type\": \"dashboard\"\r\n        },\r\n        \"type\": \"dashboard\"\r\n      }\r\n    ]\r\n  },\r\n  \"editable\": true,\r\n  \"fiscalYearStartMonth\": 0,\r\n  \"graphTooltip\": 0,\r\n  \"id\": 58,\r\n  \"links\": [],\r\n  \"liveNow\": false,\r\n  \"panels\": [\r\n    {\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"mappings\": [\r\n            {\r\n              \"options\": {\r\n                \"0\": {\r\n                  \"text\": \"OK\"\r\n                }\r\n              },\r\n              \"type\": \"value\"\r\n            },\r\n            {\r\n              \"options\": {\r\n                \"from\": 1,\r\n                \"result\": {\r\n                  \"text\": \"ERROR\"\r\n                },\r\n                \"to\": 9999999\r\n              },\r\n              \"type\": \"range\"\r\n            }\r\n          ],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 1\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 4,\r\n        \"w\": 11,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"hideTimeOverride\": true,\r\n      \"id\": 34,\r\n      \"interval\": \"1m\",\r\n      \"options\": {\r\n        \"colorMode\": \"value\",\r\n        \"graphMode\": \"none\",\r\n        \"justifyMode\": \"center\",\r\n        \"orientation\": \"auto\",\r\n        \"reduceOptions\": {\r\n          \"calcs\": [\r\n            \"lastNotNull\"\r\n          ],\r\n          \"fields\": \"\",\r\n          \"values\": false\r\n        },\r\n        \"textMode\": \"auto\"\r\n      },\r\n      \"pluginVersion\": \"8.4.4\",\r\n      \"targets\": [\r\n        {\r\n          \"alias\": \"$tag_server\",\r\n          \"datasource\": {\r\n            \"type\": \"influxdb\",\r\n            \"uid\": \"000000001\"\r\n          },\r\n          \"groupBy\": [\r\n            {\r\n              \"params\": [\r\n                \"$__interval\"\r\n              ],\r\n              \"type\": \"time\"\r\n            },\r\n            {\r\n              \"params\": [\r\n                \"server\"\r\n              ],\r\n              \"type\": \"tag\"\r\n            },\r\n            {\r\n              \"params\": [\r\n                \"null\"\r\n              ],\r\n              \"type\": \"fill\"\r\n            }\r\n          ],\r\n          \"measurement\": \"dns_query\",\r\n          \"orderByTime\": \"ASC\",\r\n          \"policy\": \"default\",\r\n          \"refId\": \"A\",\r\n          \"resultFormat\": \"time_series\",\r\n          \"select\": [\r\n            [\r\n              {\r\n                \"params\": [\r\n                  \"result_code\"\r\n                ],\r\n                \"type\": \"field\"\r\n              },\r\n              {\r\n                \"params\": [],\r\n                \"type\": \"last\"\r\n              }\r\n            ]\r\n          ],\r\n          \"tags\": [\r\n            {\r\n              \"condition\": \"AND\",\r\n              \"key\": \"server\",\r\n              \"operator\": \"=\",\r\n              \"value\": \"8.8.8.8\"\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      \"timeFrom\": \"2m\",\r\n      \"title\": \"DNS Resolution\",\r\n      \"type\": \"stat\"\r\n    },\r\n    {\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 350\r\n              }\r\n            ]\r\n          },\r\n          \"unit\": \"celsius\"\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 4,\r\n        \"w\": 11,\r\n        \"x\": 11,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 31,\r\n      \"interval\": \"1m\",\r\n      \"options\": {\r\n        \"colorMode\": \"value\",\r\n        \"graphMode\": \"area\",\r\n        \"justifyMode\": \"center\",\r\n        \"orientation\": \"auto\",\r\n        \"reduceOptions\": {\r\n          \"calcs\": [\r\n            \"lastNotNull\"\r\n          ],\r\n          \"fields\": \"\",\r\n          \"values\": false\r\n        },\r\n        \"textMode\": \"auto\"\r\n      },\r\n      \"pluginVersion\": \"8.4.4\",\r\n      \"targets\": [\r\n        {\r\n          \"alias\": \"$tag_devicename\",\r\n          \"groupBy\": [\r\n            {\r\n              \"params\": [\r\n                \"$__interval\"\r\n              ],\r\n              \"type\": \"time\"\r\n            },\r\n            {\r\n              \"params\": [\r\n                \"devicename\"\r\n              ],\r\n              \"type\": \"tag\"\r\n            },\r\n            {\r\n              \"params\": [\r\n                \"null\"\r\n              ],\r\n              \"type\": \"fill\"\r\n            }\r\n          ],\r\n          \"measurement\": \"SNMP_tme\",\r\n          \"orderByTime\": \"ASC\",\r\n          \"policy\": \"default\",\r\n          \"refId\": \"A\",\r\n          \"resultFormat\": \"time_series\",\r\n          \"select\": [\r\n            [\r\n              {\r\n                \"params\": [\r\n                  \"temperature\"\r\n                ],\r\n                \"type\": \"field\"\r\n              },\r\n              {\r\n                \"params\": [],\r\n                \"type\": \"last\"\r\n              },\r\n              {\r\n                \"params\": [\r\n                  \" / 10\"\r\n                ],\r\n                \"type\": \"math\"\r\n              }\r\n            ]\r\n          ],\r\n          \"tags\": [\r\n            {\r\n              \"key\": \"temperature\",\r\n              \"operator\": \"\u003c\",\r\n              \"value\": \"1000\"\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      \"title\": \"Temperatures\",\r\n      \"type\": \"stat\"\r\n    }\r\n  ],\r\n  \"refresh\": \"\",\r\n  \"schemaVersion\": 35,\r\n  \"style\": \"dark\",\r\n  \"tags\": [],\r\n  \"templating\": {\r\n    \"list\": []\r\n  },\r\n  \"time\": {\r\n    \"from\": \"now/d+15h\",\r\n    \"to\": \"now/d+16h\"\r\n  },\r\n  \"timepicker\": {},\r\n  \"timezone\": \"Australia/Adelaide\",\r\n  \"title\": \"Overview Copy\",\r\n  \"uid\": \"zTKmx4Unk\",\r\n  \"version\": 4,\r\n  \"weekStart\": \"\"\r\n}\r\n```\r\n\r\nYou would notice from the screen captures the the DNS visualisation does not appear to be affected by this. The only difference that I can tell is that the DNS visualisation has relative time set and the temperature visualisation does not.\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.4\r\n- Data source type \u0026 version: InfluxDB 1.8.10\r\n- OS Grafana is installed on: Windows Server 2016\r\n- User OS \u0026 Browser: Windows 10 - Chrome v99\r\n- Grafana plugins: None\r\n- Others:\r\n","labels":["type/bug","area/dashboard/timezone"]},{"id":44418,"title":"Variable ${__series.name} not working as expected in Grafana 8.3.x Time Series panel data links","body":"**What happened**:\r\nIn any data link on a time series panel the variable ${__series.name} is resolved to \"Series (A)\".\r\n\r\n**What you expected to happen**:\r\n${__series.name} should be set to the same value that's displayed in the legend.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n- Create a Time Series panel.\r\n- Fetch data from a MySQL query returning three columns: time (UNIX timestamp), series (string), value (integer). \r\n- Create a data link to any other panel using ${__series.name} as a query parameter.\r\n\r\n\r\n**Anything else we need to know?**:\r\n- I'm aware that it somewhat works by creating multiple queries, with the \"value\" column renamed to the series name, but\r\n   - that's highly inefficient to implement with a database backend.\r\n   - not really suitable if the series names aren't static.\r\n   - still not working as expected, as the value is resolved as \"Series (\u003cvaluecolumnname\u003e)\", which can't be used as input for the next panel without previous manual processing.\r\n- It was working fine with Grafana 7.4 with the exact same setup.\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.2 / 8.3.4\r\n- Data source type \u0026 version: MariaDB\r\n- OS Grafana is installed on: Windows Server 2019 Standard\r\n- User OS \u0026 Browser: Windows Server 2019 Standard, Chrome / Edge \r\n- Grafana plugins: N/A\r\n- Others: N/A\r\n","labels":["area/dashboard/templating","needs more info","type/works-as-intended","datasource/MySQL","area/dashboard/data-links","area/panel/timeseries"]},{"id":48923,"title":"TimeSeries problem with bar 8.5.2 (narrow bar)","body":"**What happened**:\r\nThe bar are narrow\r\n![image](https://user-images.githubusercontent.com/73607094/168000882-a1c09d3a-6ed5-4259-9fd0-4b62835fbe1c.png)\r\n**What you expected to happen**:\r\ncorrect this issue\r\n\r\n**Anything else we need to know?**:\r\nIn the version 8.4.4 everything was okay\r\n**Environment**:\r\n- Grafana version: 8.5.2\r\n- Data source type \u0026 version: MSSQL\r\n- OS Grafana is installed on: Ubuntu 20.04.4 LTS\r\n- User OS \u0026 Browser: Chrome\r\n- Grafana plugins: TimeSeries\r\n- Others: N/A\r\n","labels":["type/bug","stale","area/panel/timeseries"]},{"id":70680,"title":"Units: mOhm missing","body":"### \n# What went wrong?\n\n\n**What happened (Scenario 1)**:\r\n\r\n  - I have values with unit mOhm.\r\n\r\n**What did you expect to happen (Scenario 1)**:\r\n\r\n  - mOhm is not a option in the unit selector\r\n\r\n**What happened (Scenario 2)**:\r\n\r\n  - I have values with unit mOhm and divided them by 1000\r\n  - I selected Ohm as unit\r\n\r\n**What did you expect to happen (Scenario 2)**:\r\n\r\n  - I expected 5 mOhm as shown value, not 0.005 Ohm\n\n### \n# How do we reproduce it?\n\n\n1. Open Grafana and create a new dashboard and add a new panel\r\n2. Use a time series panel\r\n3. open the unit options\n\n### \n# What Grafana version are you using?\n\n\nv9.1.6\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\n_No response_\n\n### Grafana Platform?\n\nDocker\n\n### User's OS?\n\n_No response_\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\nInfluxDB\n\n### Anything else to add?\n\n\n_No response_","labels":["area/units","triage/needs-confirmation","area/dataviz"]},{"id":70683,"title":"Thresholds in override with repeating panels not working","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n  - I have a dashboard Custom variable.\r\n  - I have a query in a panel which is using the dashboard variable\r\n  - The panel is repeating by the dashboard variable\r\n  - The panel have threshold overrides, which are based on the query results, which are grouped by a variable which contains the dashboard variable\r\n  - The thresholds are not shown (except for the first panel)\r\n\r\n**What did you expect to happen**:\r\n\r\n  - The thresholds of the respective override (which depends on the query result which depends on the dashboard variable) should be shown.\n\n### \n# How do we reproduce it?\n\n\nRequirements:\r\n\r\n- Available (InfluxDB) datasource with different tags / names\r\n\r\nSteps: \r\n\r\n1. Open Grafana\r\n2. Create a new dashboard \r\n3. Create a dashboard variable (Custom)\r\n4. Add the values which contains the tags / names in the data\r\n5. Add a new panel\r\n6. Query the data, grouped by the tag / name which contains the values of the dashboard variable\r\n7. Set threshold overrides to each series.\r\n8. Enable the panel repeating by the dashboard variable\n\n### \n# What Grafana version are you using?\n\n\nv8.3.4\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\n_No response_\n\n### Grafana Platform?\n\nA downloaded binary\n\n### User's OS?\n\nWindows Server\n\n### User's Browser?\n\nFirefox\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\nInfluxDB\n\n### Anything else to add?\n\n\n_No response_","labels":["datasource/InfluxDB","area/field/overrides","triage/needs-confirmation","team/grafana-dashboards"]},{"id":59766,"title":"Stat panel incorrectly measures text causing it to clip","body":"**What happened**:\r\nAuto-Fontsize doesn't work properly. The text is cut off.\r\n\u003cimg width=\"316\" alt=\"image\" src=\"https://user-images.githubusercontent.com/117441229/205441351-e5cf6c13-c790-44f1-8758-a8dbb8bf2903.png\"\u003e\r\n\r\n\r\n**What you expected to happen**:\r\nText resize proberly\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nHere is the JSON from my Stat-Panel.\r\nHere I just went for a \"Select 'blabla'\" request to SQL for demo-purpose.\r\n```\r\n{\r\n      \"datasource\": {\r\n        \"type\": \"mssql\",\r\n        \"uid\": \"6IyHxWQ7z\"\r\n      },\r\n      \"description\": \"\",\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"thresholds\"\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 2,\r\n        \"w\": 4,\r\n        \"x\": 0,\r\n        \"y\": 9\r\n      },\r\n      \"id\": 103,\r\n      \"options\": {\r\n        \"colorMode\": \"background\",\r\n        \"graphMode\": \"none\",\r\n        \"justifyMode\": \"auto\",\r\n        \"orientation\": \"horizontal\",\r\n        \"reduceOptions\": {\r\n          \"calcs\": [\r\n            \"last\"\r\n          ],\r\n          \"fields\": \"/^Value$/\",\r\n          \"values\": true\r\n        },\r\n        \"text\": {},\r\n        \"textMode\": \"value\"\r\n      },\r\n      \"pluginVersion\": \"9.2.7\",\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"mssql\",\r\n            \"uid\": \"6IyHxWQ7z\"\r\n          },\r\n          \"editorMode\": \"code\",\r\n          \"format\": \"table\",\r\n          \"rawQuery\": true,\r\n          \"rawSql\": \"SELECT 'Ausreichend Batterie'\",\r\n          \"refId\": \"A\",\r\n          \"sql\": {\r\n            \"columns\": [\r\n              {\r\n                \"parameters\": [],\r\n                \"type\": \"function\"\r\n              }\r\n            ],\r\n            \"groupBy\": [\r\n              {\r\n                \"property\": {\r\n                  \"type\": \"string\"\r\n                },\r\n                \"type\": \"groupBy\"\r\n              }\r\n            ],\r\n            \"limit\": 50\r\n          }\r\n        }\r\n      ],\r\n      \"transformations\": [],\r\n      \"type\": \"stat\"\r\n    },\r\n```\r\nYou may need to play with the size of the resolution (2582px*800px in my case)\r\n\r\n**Anything else we need to know?**:\r\nWhen I disable the \"Font-Weight\" in the css-settings on the \"elements\"-tab in the \"resizing\" is working the intended way.\r\n\u003cimg width=\"188\" alt=\"image\" src=\"https://user-images.githubusercontent.com/117441229/205441674-c8068d03-088d-4fae-8b98-fb9389a4c4f8.png\"\u003e\r\n\u003cimg width=\"479\" alt=\"image\" src=\"https://user-images.githubusercontent.com/117441229/205443059-da3cfcf6-16ee-43d1-b804-30975a7db061.png\"\u003e\r\n\r\n\r\n**Environment**:\r\n- Grafana version: v 9.2.7\r\n- Data source type \u0026 version: irrelevant\r\n- OS Grafana is installed on: Linux\r\n- User OS \u0026 Browser: All (Opera, Chrome, Edge, ...)\r\n- Grafana plugins: irrelevant\r\n- Others: -\r\n","labels":["needs investigation","area/panel/text","area/panel/stat"]},{"id":82030,"title":"Dashboards: Grouping to Matrix broken tooltip","body":"### What happened?\n\nWhen using the Group to Matrix transformation, after loading data the tooltip wrongfully displays the name of the Cell Value field. A momentary workaround exists - but refreshing the panel brings it back to the old behavior as described below.\n\n### What did you expect to happen?\n\nI expect the tooltip to dynamically show the column header\n\n### Did this work before?\n\nHaven't tested previous versions\n\n### How do we reproduce it?\n\n1. Create panel with a tempo data source and query is for a list of spans\r\n2. Add a Group to Matrix transformation, select Trace Name as row, Duration as the cell value and the application name field as column (app, service, etc.)\r\n3. Observe that the tooltip shows the name of the cell value field\r\n4. Delete the column field from the transformation configuration\r\n5. Re-add the column field (the same field selected previously)\r\n6. Observe that the desired behavior now takes place\r\n7. Refresh the panel to break it again\r\n\r\nhttps://github.com/grafana/grafana/assets/83203533/759bcc71-00e1-4ea5-a526-1999c4bd0a89\r\n\r\n\n\n### Is the bug inside a dashboard panel?\n\n| Key | Value |\r\n|--|--|\r\n| Panel | barchart @ 10.4.0-65875 |\r\n| Grafana | 10.4.0-65875 (b758b91e84eabd3c829bc9228180c50f56d8279f) // Cloud Advanced |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"libraryPanel\": {\r\n        \"id\": 33,\r\n        \"orgId\": 1,\r\n        \"folderId\": 354,\r\n        \"folderUid\": \"f97e3d74-aa45-4203-baa3-33575ac51a5b\",\r\n        \"uid\": \"cdc0990czbe9se\",\r\n        \"name\": \"Resource Latency Distribution\",\r\n        \"kind\": 1,\r\n        \"type\": \"barchart\",\r\n        \"description\": \"\",\r\n        \"model\": {\r\n          \"datasource\": {\r\n            \"type\": \"tempo\",\r\n            \"uid\": \"f911a872-dd04-4976-af95-d7585abddde5\"\r\n          },\r\n          \"description\": \"\",\r\n          \"fieldConfig\": {\r\n            \"defaults\": {\r\n              \"color\": {\r\n                \"mode\": \"palette-classic\"\r\n              },\r\n              \"custom\": {\r\n                \"axisBorderShow\": false,\r\n                \"axisCenteredZero\": false,\r\n                \"axisColorMode\": \"text\",\r\n                \"axisGridShow\": false,\r\n                \"axisLabel\": \"\",\r\n                \"axisPlacement\": \"left\",\r\n                \"fillOpacity\": 80,\r\n                \"gradientMode\": \"none\",\r\n                \"hideFrom\": {\r\n                  \"legend\": false,\r\n                  \"tooltip\": false,\r\n                  \"viz\": false\r\n                },\r\n                \"lineWidth\": 1,\r\n                \"scaleDistribution\": {\r\n                  \"type\": \"linear\"\r\n                },\r\n                \"thresholdsStyle\": {\r\n                  \"mode\": \"off\"\r\n                }\r\n              },\r\n              \"mappings\": [],\r\n              \"thresholds\": {\r\n                \"mode\": \"absolute\",\r\n                \"steps\": [\r\n                  {\r\n                    \"color\": \"green\",\r\n                    \"value\": null\r\n                  },\r\n                  {\r\n                    \"color\": \"red\",\r\n                    \"value\": 80\r\n                  }\r\n                ]\r\n              },\r\n              \"unitScale\": true\r\n            },\r\n            \"overrides\": []\r\n          },\r\n          \"gridPos\": {\r\n            \"h\": 18,\r\n            \"w\": 24,\r\n            \"x\": 0,\r\n            \"y\": 46\r\n          },\r\n          \"id\": 15,\r\n          \"options\": {\r\n            \"barRadius\": 0,\r\n            \"barWidth\": 0.97,\r\n            \"fullHighlight\": false,\r\n            \"groupWidth\": 0.7,\r\n            \"legend\": {\r\n              \"calcs\": [],\r\n              \"displayMode\": \"list\",\r\n              \"placement\": \"bottom\",\r\n              \"showLegend\": false\r\n            },\r\n            \"orientation\": \"horizontal\",\r\n            \"showValue\": \"never\",\r\n            \"stacking\": \"percent\",\r\n            \"tooltip\": {\r\n              \"mode\": \"single\",\r\n              \"sort\": \"none\"\r\n            },\r\n            \"xTickLabelRotation\": 0,\r\n            \"xTickLabelSpacing\": 100\r\n          },\r\n          \"pluginVersion\": \"10.4.0-65875\",\r\n          \"targets\": [\r\n            {\r\n              \"datasource\": {\r\n                \"type\": \"tempo\",\r\n                \"uid\": \"f911a872-dd04-4976-af95-d7585abddde5\"\r\n              },\r\n              \"limit\": 50,\r\n              \"query\": \"{resource.stage=\\\"${stage}\\\" \u0026\u0026 resource.envId=\\\"${envId}\\\" \u0026\u0026 resource.service=\\\"${service}\\\" \u0026\u0026 resource.app=~\\\"${app:regex}\\\"} \u003e\u003e {.http.method!=\\\"\\\"} | by(span.name) | select(.app, .service.name)\",\r\n              \"queryType\": \"traceql\",\r\n              \"refId\": \"A\",\r\n              \"spss\": 200,\r\n              \"tableType\": \"spans\"\r\n            }\r\n          ],\r\n          \"title\": \"Resource Latency Distribution\",\r\n          \"transformations\": [\r\n            {\r\n              \"id\": \"groupingToMatrix\",\r\n              \"options\": {\r\n                \"columnField\": \"service.name\",\r\n                \"emptyValue\": \"null\",\r\n                \"rowField\": \"Trace Name\",\r\n                \"valueField\": \"Duration\"\r\n              }\r\n            }\r\n          ],\r\n          \"type\": \"barchart\"\r\n        },\r\n        \"version\": 8,\r\n        \"meta\": {\r\n          \"folderName\": \"Foundation\",\r\n          \"folderUid\": \"f97e3d74-aa45-4203-baa3-33575ac51a5b\",\r\n          \"connectedDashboards\": 1,\r\n          \"created\": \"2024-02-06T21:35:24Z\",\r\n          \"updated\": \"2024-02-06T23:05:59.68550132Z\",\r\n          \"createdBy\": {\r\n            \"avatarUrl\": \"/avatar/34a7efc37cbf13c4b0025f5aec3dc287\",\r\n            \"id\": 2,\r\n            \"name\": \"avital.tamir@lemonade.com\"\r\n          },\r\n          \"updatedBy\": {\r\n            \"avatarUrl\": \"/avatar/34a7efc37cbf13c4b0025f5aec3dc287\",\r\n            \"id\": 2,\r\n            \"name\": \"avital.tamir@lemonade.com\"\r\n          }\r\n        }\r\n      },\r\n      \"title\": \"Reproduced with embedded data\",\r\n      \"targets\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"grafana\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"snapshot\",\r\n          \"snapshot\": [\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"traces\",\r\n                \"meta\": {\r\n                  \"preferredVisualisationType\": \"table\"\r\n                },\r\n                \"name\": \"Spans\",\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"tglhzIpHxlnko\",\r\n                    \"type\": \"string\",\r\n                    \"config\": {\r\n                      \"custom\": {\r\n                        \"hidden\": true\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"name\": \"kjoliSkcdbnf\",\r\n                    \"type\": \"string\",\r\n                    \"config\": {\r\n                      \"displayNameFromDS\": \"Trace Service\",\r\n                      \"custom\": {\r\n                        \"width\": 200\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"name\": \"jxgxnNvrc\",\r\n                    \"type\": \"string\",\r\n                    \"config\": {\r\n                      \"displayNameFromDS\": \"Trace Name\",\r\n                      \"custom\": {\r\n                        \"width\": 200\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"name\": \"axybID\",\r\n                    \"type\": \"string\",\r\n                    \"config\": {\r\n                      \"unit\": \"string\",\r\n                      \"displayNameFromDS\": \"Span ID\",\r\n                      \"custom\": {\r\n                        \"width\": 200\r\n                      },\r\n                      \"links\": [\r\n                        {\r\n                          \"title\": \"Span: ${__value.raw}\",\r\n                          \"url\": \"\",\r\n                          \"internal\": {\r\n                            \"datasourceUid\": \"f911a872-dd04-4976-af95-d7585abddde5\",\r\n                            \"datasourceName\": \"Traces\",\r\n                            \"query\": {\r\n                              \"query\": \"${__data.fields.traceIdHidden}\",\r\n                              \"queryType\": \"traceql\"\r\n                            },\r\n                            \"panelsState\": {\r\n                              \"trace\": {\r\n                                \"spanId\": \"${__value.raw}\"\r\n                              }\r\n                            }\r\n                          }\r\n                        }\r\n                      ]\r\n                    }\r\n                  },\r\n                  {\r\n                    \"name\": \"time\",\r\n                    \"type\": \"time\",\r\n                    \"config\": {\r\n                      \"displayNameFromDS\": \"Start time\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"name\": \"name\",\r\n                    \"type\": \"string\",\r\n                    \"config\": {\r\n                      \"displayNameFromDS\": \"Name\",\r\n                      \"custom\": {\r\n                        \"hidden\": true\r\n                      }\r\n                    }\r\n                  },\r\n                  {\r\n                    \"name\": \"fpi\",\r\n                    \"type\": \"string\",\r\n                    \"config\": {\r\n                      \"displayNameFromDS\": \"app\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"name\": \"eh(xgvg.xqfb)\",\r\n                    \"type\": \"string\",\r\n                    \"config\": {\r\n                      \"displayNameFromDS\": \"by(span.name)\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"name\": \"cnaIk\",\r\n                    \"type\": \"string\",\r\n                    \"config\": {\r\n                      \"displayNameFromDS\": \"envId\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"name\": \"pptc.xjqpih\",\r\n                    \"type\": \"string\",\r\n                    \"config\": {\r\n                      \"displayNameFromDS\": \"http.method\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"name\": \"dspsyhm\",\r\n                    \"type\": \"string\",\r\n                    \"config\": {\r\n                      \"displayNameFromDS\": \"service\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"name\": \"sniocno.yhuh\",\r\n                    \"type\": \"string\",\r\n                    \"config\": {\r\n                      \"displayNameFromDS\": \"service.name\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"name\": \"yykkx\",\r\n                    \"type\": \"string\",\r\n                    \"config\": {\r\n                      \"displayNameFromDS\": \"stage\"\r\n                    }\r\n                  },\r\n                  {\r\n                    \"name\": \"lymyqpqf\",\r\n                    \"type\": \"number\",\r\n                    \"config\": {\r\n                      \"displayNameFromDS\": \"Duration\",\r\n                      \"unit\": \"ns\",\r\n                      \"custom\": {\r\n                        \"width\": 120\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    \"w170f51756i306b133qiw928158zmhv1\",\r\n                    \"39k1601jz22m7eva36uv87oc0ao2mqmv\",\r\n                    \"l6yd6x55jmn14j59441qx45j1h8n4red\",\r\n                    \"78202a8i9q658i456ohuam1i95q86nm6\",\r\n                    \"pk287423ua9z5ywjbblsex9e5ao8a0x3\",\r\n                    \"6514w8c660266muc100r9z2ri479e728\",\r\n                    \"jg19s0k1u5177963o61483ry33sgc421\",\r\n                    \"q02l6mk4349172317o16cw3vz5w011z4\",\r\n                    \"41jbj0v0jf1p7f65oa1k5gy934448002\",\r\n                    \"u1v9i2qk85r7fme18954q59eb27hu7pu\",\r\n                    \"87o5h375o27y9591q998o1n8o45d0kqp\",\r\n                    \"3w6m9x1ok7e490f935965i527h1ct5a8\",\r\n                    \"n7c1q3t1d2i780an2j49t6t4330z61ke\",\r\n                    \"74sdh03090e0b5v732j509hm47400xrj\",\r\n                    \"873849wp318708589b66y0510g6uw143\",\r\n                    \"o1iaq383321z8f2lqmav86583fb8r18l\",\r\n                    \"f48vf46f159q44l14p86c13q76zt1o5i\",\r\n                    \"797f98889djgh7448q0318g14q52flvp\",\r\n                    \"65r28u3q6bv64u61f86f97xu0w7d0939\",\r\n                    \"b857h97903bbji31z64h705w41o46a68\",\r\n                    \"b3qs51r11ey61l3y4m78lv2w5ki04z16\",\r\n                    \"rwa7976s2j8j826252t0n985855y75w6\",\r\n                    \"jc464w7vu44o3mu6284alo06qv98k627\",\r\n                    \"4edu049w4545c3gq7xp900as8h765j6\",\r\n                    \"334e9ykdy10v1zf99a44841bm9908cif\",\r\n                    \"4q883t3pol034ksurd1n0650s9h7t7\",\r\n                    \"y5c35w3826s798r93363ezr0q3spdo8f\",\r\n                    \"z4338w38i8isy2n3zze2e9fl8352c1s2\",\r\n                    \"l19g4px0vb5aqt23hthp1w6050a52x02\",\r\n                    \"74h4u73w6wb4375759ce728qh6218ex8\",\r\n                    \"lsa301068khjn3z65b5tno56q950ywe1\",\r\n                    \"ys7f43182gb5js07tvp7k0104w690u1t\",\r\n                    \"pk1121o36870z612260kf7244x35v608\",\r\n                    \"75q17o767x2la01d303ip473z48191k1\",\r\n                    \"i8z173lqwlw8q624323j4d4uwmb15a8n\",\r\n                    \"l24izzn2209625bh6s88c550a951l106\",\r\n                    \"t2jzv19q8652sl5a3b15f4l5a3fs3817\",\r\n                    \"fz0f0646h97572021csq2671ra80z29n\",\r\n                    \"u8713c0mq43x9764450520y2637d03r4\",\r\n                    \"q96x7413ha72vt9y68xb7699b042944m\",\r\n                    \"k780z98j21154273or9t18m61g4j9507\",\r\n                    \"r4073y2j0k610688ak47m04q6fw16557\",\r\n                    \"d7172j5380q2k3721845u8kv68m811g0\",\r\n                    \"d7172j5380q2k3721845u8kv68m811g0\",\r\n                    \"d7172j5380q2k3721845u8kv68m811g0\",\r\n                    \"d7172j5380q2k3721845u8kv68m811g0\",\r\n                    \"d7172j5380q2k3721845u8kv68m811g0\",\r\n                    \"d7172j5380q2k3721845u8kv68m811g0\",\r\n                    \"d7172j5380q2k3721845u8kv68m811g0\",\r\n                    \"bf183cw393s3j4j8tw4znbu3599616n8\",\r\n                    \"d71er32mp02300wr861v8322b0v4u32x\",\r\n                    \"rwj6e656v3189l2m98j7530xg7145359\",\r\n                    \"u546ox5140k462u74t273wk59vsj3528\",\r\n                    \"m4t2dp41dh8729jj90811p1b78ox0447\",\r\n                    \"o9dax9b249q744u6vd29g2z87666y187\",\r\n                    \"717920f6edk7f8gk4tu7b32665e1w90b\",\r\n                    \"w9dh0ynyn6v4iyabs50p079432y00042\",\r\n                    \"t3j48zy152zk7m8ld8815414mc5b5r4\"\r\n                  ],\r\n                  [\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\"\r\n                  ],\r\n                  [\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"niogwht - drhota.dtjeqph\",\r\n                    \"niogwht - drhota.dtjeqph\",\r\n                    \"niogwht - drhota.dtjeqph\",\r\n                    \"niogwht - drhota.dtjeqph\",\r\n                    \"niogwht - drhota.dtjeqph\",\r\n                    \"niogwht - drhota.dtjeqph\",\r\n                    \"kphmyqt - utmygkzcdv.snehb_flmbu.fqfrjnecvzgy\",\r\n                    \"kphmyqt - utmygkzcdv.snehb_flmbu.fqfrjnecvzgy\",\r\n                    \"kphmyqt - utmygkzcdv.snehb_flmbu.fqfrjnecvzgy\",\r\n                    \"kphmyqt - utmygkzcdv.snehb_flmbu.fqfrjnecvzgy\",\r\n                    \"kphmyqt - utmygkzcdv.snehb_flmbu.fqfrjnecvzgy\",\r\n                    \"kphmyqt - utmygkzcdv.snehb_flmbu.fqfrjnecvzgy\",\r\n                    \"kphmyqt - utmygkzcdv.snehb_flmbu.fqfrjnecvzgy\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\",\r\n                    \"GET /vcfkdm\"\r\n                  ],\r\n                  [\r\n                    \"64o2p11hu253331n\",\r\n                    \"36x8bmzy2lkq24yb\",\r\n                    \"31ch71309i888gl3\",\r\n                    \"db67ezb9717863xu\",\r\n                    \"6csfw9evx5p5a964\",\r\n                    \"13y2uj51tf9ss8ab\",\r\n                    \"m2q57r4ef9315n12\",\r\n                    \"604sly48r4ko8970\",\r\n                    \"87t1238r73g03685\",\r\n                    \"0g10w32o58y9knu5\",\r\n                    \"s99q63701104s7pw\",\r\n                    \"0s70458gx13u0095\",\r\n                    \"7zk55904qd5xu3js\",\r\n                    \"xa3s4x05h04nqg6w\",\r\n                    \"9o93140vq75c5qij\",\r\n                    \"3g97c2w12355l5j3\",\r\n                    \"7365d81460jw22fs\",\r\n                    \"2500740r8f34869v\",\r\n                    \"d9do1680pbqdwhef\",\r\n                    \"mm024ox00071k096\",\r\n                    \"56764bug25v12n49\",\r\n                    \"bvp51sz3040q8nvz\",\r\n                    \"92525053340403o6\",\r\n                    \"2nyc2ig29zul005m\",\r\n                    \"c3h93137815ws61t\",\r\n                    \"w4r6p686hr6r1278\",\r\n                    \"lh0u561686623012\",\r\n                    \"5191560hskx0h4g9\",\r\n                    \"4b474j832k7m54av\",\r\n                    \"gtr9t8vao78b8036\",\r\n                    \"9z49y601go13v29g\",\r\n                    \"q66jv586i8y06dde\",\r\n                    \"3jt3cp158r3ju376\",\r\n                    \"7n8701186qo262ru\",\r\n                    \"bth5m4aoc3u939oc\",\r\n                    \"346j9q8200d23u1s\",\r\n                    \"xdeb406m9637x33a\",\r\n                    \"x180382l43gb6t9n\",\r\n                    \"w25393m81esp0w7j\",\r\n                    \"37p38vbx154is705\",\r\n                    \"yx68v8c3r00v0k68\",\r\n                    \"swhu129nyw2f06b2\",\r\n                    \"15a16cu88b3r6e78\",\r\n                    \"6875z84pz6zjz332\",\r\n                    \"j9v1ck3q85b5b1jn\",\r\n                    \"3u88a027q44xa43t\",\r\n                    \"4cdi78usih9dxnrm\",\r\n                    \"u1zzy1d54iq3i161\",\r\n                    \"5sz5m08076c79i45\",\r\n                    \"6u588a6b03p6hi1u\",\r\n                    \"d550mtvm30swxm9k\",\r\n                    \"60z0v4x4f14j261h\",\r\n                    \"98528ik43v5bo951\",\r\n                    \"h81356l21j92l9y0\",\r\n                    \"870685y052a24yl5\",\r\n                    \"j801i81t1z9gws7l\",\r\n                    \"q1d82d7yzz270251\",\r\n                    \"8asva5k8569ek3g4\"\r\n                  ],\r\n                  [\r\n                    1707261227856,\r\n                    1707261166585,\r\n                    1707261077869,\r\n                    1707260958013,\r\n                    1707260957865,\r\n                    1707260957644,\r\n                    1707260956585.9998,\r\n                    1707260956585,\r\n                    1707260928013,\r\n                    1707260927856,\r\n                    1707260927643,\r\n                    1707260926585,\r\n                    1707260897856,\r\n                    1707260866585,\r\n                    1707260838014.0002,\r\n                    1707260838012,\r\n                    1707260837868,\r\n                    1707260837643,\r\n                    1707260836587,\r\n                    1707260808012,\r\n                    1707260778013,\r\n                    1707260777856,\r\n                    1707260777644,\r\n                    1707260747644,\r\n                    1707260718012,\r\n                    1707260717856,\r\n                    1707260716588,\r\n                    1707260716585.9998,\r\n                    1707260688012,\r\n                    1707260687643,\r\n                    1707260657855,\r\n                    1707260656585,\r\n                    1707260628012,\r\n                    1707260627643,\r\n                    1707260598014.0002,\r\n                    1707260597856,\r\n                    1707260406317,\r\n                    1707260406292,\r\n                    1707260406257.9998,\r\n                    1707260402483,\r\n                    1707260402393.9998,\r\n                    1707260402383,\r\n                    1707260401454.3247,\r\n                    1707260401370.3015,\r\n                    1707260401353,\r\n                    1707260401365,\r\n                    1707260401536,\r\n                    1707260401651,\r\n                    1707260401353,\r\n                    1707260327643,\r\n                    1707260296585.9998,\r\n                    1707260237857,\r\n                    1707260236585,\r\n                    1707260176585,\r\n                    1707260117860,\r\n                    1707260117645,\r\n                    1707260116585,\r\n                    1707260057856\r\n                  ],\r\n                  [\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\",\r\n                    \"vakulmbdg\"\r\n                  ],\r\n                  [\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"ivewsutq-mnw\",\r\n                    \"ivewsutq-mnw\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"nocid\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\"\r\n                  ],\r\n                  [\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\",\r\n                    \"nhv\"\r\n                  ],\r\n                  [\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\",\r\n                    \"zveqox\"\r\n                  ],\r\n                  [\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"POST\",\r\n                    \"POST\",\r\n                    \"POST\",\r\n                    \"POST\",\r\n                    \"POST\",\r\n                    \"POST\",\r\n                    \"POST\",\r\n                    \"POST\",\r\n                    \"GET\",\r\n                    \"POST\",\r\n                    \"POST\",\r\n                    \"POST\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\",\r\n                    \"GET\"\r\n                  ],\r\n                  [\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"crlfisxs\",\r\n                    \"crlfisxs\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"nocid\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\"\r\n                  ],\r\n                  [\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"ivewsutq-mnw\",\r\n                    \"ivewsutq-mnw\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"nocid\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\",\r\n                    \"xan\"\r\n                  ],\r\n                  [\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\",\r\n                    \"fpnieny\"\r\n                  ],\r\n                  [\r\n                    921864,\r\n                    876656,\r\n                    6313770,\r\n                    833879,\r\n                    7563049,\r\n                    909927,\r\n                    581813,\r\n                    824375,\r\n                    929980,\r\n                    820244,\r\n                    843685,\r\n                    850684,\r\n                    1127769,\r\n                    800949,\r\n                    626638,\r\n                    871668,\r\n                    787018,\r\n                    832104,\r\n                    744823,\r\n                    796120,\r\n                    967849,\r\n                    870422,\r\n                    1142815,\r\n                    906536,\r\n                    798838,\r\n                    909542,\r\n                    637091,\r\n                    826147,\r\n                    805119,\r\n                    919525,\r\n                    883492,\r\n                    880718,\r\n                    859338,\r\n                    850010,\r\n                    584696,\r\n                    802200,\r\n                    8435879,\r\n                    23758385,\r\n                    6309899,\r\n                    7470901,\r\n                    8587721,\r\n                    13893682,\r\n                    70185099,\r\n                    161753469,\r\n                    10829217,\r\n                    169844004,\r\n                    99658734,\r\n                    74149790,\r\n                    9971848,\r\n                    842342,\r\n                    842547,\r\n                    611176,\r\n                    824494,\r\n                    935705,\r\n                    806530,\r\n                    619278,\r\n                    871849,\r\n                    1141602\r\n                  ]\r\n                ]\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      \"options\": {\r\n        \"barRadius\": 0,\r\n        \"barWidth\": 0.97,\r\n        \"fullHighlight\": false,\r\n        \"groupWidth\": 0.7,\r\n        \"legend\": {\r\n          \"calcs\": [],\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"showLegend\": false\r\n        },\r\n        \"orientation\": \"horizontal\",\r\n        \"showValue\": \"never\",\r\n        \"stacking\": \"percent\",\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        },\r\n        \"xTickLabelRotation\": 0,\r\n        \"xTickLabelSpacing\": 100\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"custom\": {\r\n            \"axisBorderShow\": false,\r\n            \"axisCenteredZero\": false,\r\n            \"axisColorMode\": \"text\",\r\n            \"axisGridShow\": false,\r\n            \"axisLabel\": \"\",\r\n            \"axisPlacement\": \"left\",\r\n            \"fillOpacity\": 80,\r\n            \"gradientMode\": \"none\",\r\n            \"hideFrom\": {\r\n              \"legend\": false,\r\n              \"tooltip\": false,\r\n              \"viz\": false\r\n            },\r\n            \"lineWidth\": 1,\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          },\r\n          \"unitScale\": true\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"pluginVersion\": \"10.4.0-65875\",\r\n      \"transformations\": [\r\n        {\r\n          \"id\": \"groupingToMatrix\",\r\n          \"options\": {\r\n            \"columnField\": \"service.name\",\r\n            \"emptyValue\": \"null\",\r\n            \"rowField\": \"Trace Name\",\r\n            \"valueField\": \"Duration\"\r\n          }\r\n        }\r\n      ],\r\n      \"type\": \"barchart\",\r\n      \"description\": \"\"\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003ebarchart @ 10.4.0-65875\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003eA[tempo]\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eTransform\u003c/th\u003e\\n      \u003ctd\u003egroupingToMatrix\u003c/td\u003e\\n  \u003c/tr\u003e\\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003e 1 frames, 14 fields, 58 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e10.4.0-65875 (b758b91e84eabd3c829bc9228180c50f56d8279f) // Cloud Advanced\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"title\": \"Original Panel JSON\",\r\n      \"type\": \"text\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 7\r\n      },\r\n      \"options\": {\r\n        \"content\": \"{\\n  \\\"datasource\\\": {\\n    \\\"uid\\\": \\\"f911a872-dd04-4976-af95-d7585abddde5\\\",\\n    \\\"type\\\": \\\"tempo\\\"\\n  },\\n  \\\"gridPos\\\": {\\n    \\\"h\\\": 18,\\n    \\\"w\\\": 24,\\n    \\\"x\\\": 0,\\n    \\\"y\\\": 46\\n  },\\n  \\\"id\\\": 15,\\n  \\\"libraryPanel\\\": {\\n    \\\"id\\\": 33,\\n    \\\"orgId\\\": 1,\\n    \\\"folderId\\\": 354,\\n    \\\"folderUid\\\": \\\"f97e3d74-aa45-4203-baa3-33575ac51a5b\\\",\\n    \\\"uid\\\": \\\"cdc0990czbe9se\\\",\\n    \\\"name\\\": \\\"Resource Latency Distribution\\\",\\n    \\\"kind\\\": 1,\\n    \\\"type\\\": \\\"barchart\\\",\\n    \\\"description\\\": \\\"\\\",\\n    \\\"model\\\": {\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"tempo\\\",\\n        \\\"uid\\\": \\\"f911a872-dd04-4976-af95-d7585abddde5\\\"\\n      },\\n      \\\"description\\\": \\\"\\\",\\n      \\\"fieldConfig\\\": {\\n        \\\"defaults\\\": {\\n          \\\"color\\\": {\\n            \\\"mode\\\": \\\"palette-classic\\\"\\n          },\\n          \\\"custom\\\": {\\n            \\\"axisBorderShow\\\": false,\\n            \\\"axisCenteredZero\\\": false,\\n            \\\"axisColorMode\\\": \\\"text\\\",\\n            \\\"axisGridShow\\\": false,\\n            \\\"axisLabel\\\": \\\"\\\",\\n            \\\"axisPlacement\\\": \\\"left\\\",\\n            \\\"fillOpacity\\\": 80,\\n            \\\"gradientMode\\\": \\\"none\\\",\\n            \\\"hideFrom\\\": {\\n              \\\"legend\\\": false,\\n              \\\"tooltip\\\": false,\\n              \\\"viz\\\": false\\n            },\\n            \\\"lineWidth\\\": 1,\\n            \\\"scaleDistribution\\\": {\\n              \\\"type\\\": \\\"linear\\\"\\n            },\\n            \\\"thresholdsStyle\\\": {\\n              \\\"mode\\\": \\\"off\\\"\\n            }\\n          },\\n          \\\"mappings\\\": [],\\n          \\\"thresholds\\\": {\\n            \\\"mode\\\": \\\"absolute\\\",\\n            \\\"steps\\\": [\\n              {\\n                \\\"color\\\": \\\"green\\\",\\n                \\\"value\\\": null\\n              },\\n              {\\n                \\\"color\\\": \\\"red\\\",\\n                \\\"value\\\": 80\\n              }\\n            ]\\n          },\\n          \\\"unitScale\\\": true\\n        },\\n        \\\"overrides\\\": []\\n      },\\n      \\\"gridPos\\\": {\\n        \\\"h\\\": 18,\\n        \\\"w\\\": 24,\\n        \\\"x\\\": 0,\\n        \\\"y\\\": 46\\n      },\\n      \\\"id\\\": 15,\\n      \\\"options\\\": {\\n        \\\"barRadius\\\": 0,\\n        \\\"barWidth\\\": 0.97,\\n        \\\"fullHighlight\\\": false,\\n        \\\"groupWidth\\\": 0.7,\\n        \\\"legend\\\": {\\n          \\\"calcs\\\": [],\\n          \\\"displayMode\\\": \\\"list\\\",\\n          \\\"placement\\\": \\\"bottom\\\",\\n          \\\"showLegend\\\": false\\n        },\\n        \\\"orientation\\\": \\\"horizontal\\\",\\n        \\\"showValue\\\": \\\"never\\\",\\n        \\\"stacking\\\": \\\"percent\\\",\\n        \\\"tooltip\\\": {\\n          \\\"mode\\\": \\\"single\\\",\\n          \\\"sort\\\": \\\"none\\\"\\n        },\\n        \\\"xTickLabelRotation\\\": 0,\\n        \\\"xTickLabelSpacing\\\": 100\\n      },\\n      \\\"pluginVersion\\\": \\\"10.4.0-65875\\\",\\n      \\\"targets\\\": [\\n        {\\n          \\\"datasource\\\": {\\n            \\\"type\\\": \\\"tempo\\\",\\n            \\\"uid\\\": \\\"f911a872-dd04-4976-af95-d7585abddde5\\\"\\n          },\\n          \\\"limit\\\": 50,\\n          \\\"query\\\": \\\"{resource.stage=\\\\\\\"${stage}\\\\\\\" \u0026\u0026 resource.envId=\\\\\\\"${envId}\\\\\\\" \u0026\u0026 resource.service=\\\\\\\"${service}\\\\\\\" \u0026\u0026 resource.app=~\\\\\\\"${app:regex}\\\\\\\"} \u003e\u003e {.http.method!=\\\\\\\"\\\\\\\"} | by(span.name) | select(.app, .service.name)\\\",\\n          \\\"queryType\\\": \\\"traceql\\\",\\n          \\\"refId\\\": \\\"A\\\",\\n          \\\"spss\\\": 200,\\n          \\\"tableType\\\": \\\"spans\\\"\\n        }\\n      ],\\n      \\\"title\\\": \\\"Resource Latency Distribution\\\",\\n      \\\"transformations\\\": [\\n        {\\n          \\\"id\\\": \\\"groupingToMatrix\\\",\\n          \\\"options\\\": {\\n            \\\"columnField\\\": \\\"service.name\\\",\\n            \\\"emptyValue\\\": \\\"null\\\",\\n            \\\"rowField\\\": \\\"Trace Name\\\",\\n            \\\"valueField\\\": \\\"Duration\\\"\\n          }\\n        }\\n      ],\\n      \\\"type\\\": \\\"barchart\\\"\\n    },\\n    \\\"version\\\": 8,\\n    \\\"meta\\\": {\\n      \\\"folderName\\\": \\\"Foundation\\\",\\n      \\\"folderUid\\\": \\\"f97e3d74-aa45-4203-baa3-33575ac51a5b\\\",\\n      \\\"connectedDashboards\\\": 1,\\n      \\\"created\\\": \\\"2024-02-06T21:35:24Z\\\",\\n      \\\"updated\\\": \\\"2024-02-06T23:05:59.68550132Z\\\",\\n      \\\"createdBy\\\": {\\n        \\\"avatarUrl\\\": \\\"/avatar/34a7efc37cbf13c4b0025f5aec3dc287\\\",\\n        \\\"id\\\": 2,\\n        \\\"name\\\": \\\"avital.tamir@lemonade.com\\\"\\n      },\\n      \\\"updatedBy\\\": {\\n        \\\"avatarUrl\\\": \\\"/avatar/34a7efc37cbf13c4b0025f5aec3dc287\\\",\\n        \\\"id\\\": 2,\\n        \\\"name\\\": \\\"avital.tamir@lemonade.com\\\"\\n      }\\n    }\\n  },\\n  \\\"title\\\": \\\"Resource Latency Distribution\\\",\\n  \\\"targets\\\": [\\n    {\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"tempo\\\",\\n        \\\"uid\\\": \\\"f911a872-dd04-4976-af95-d7585abddde5\\\"\\n      },\\n      \\\"limit\\\": 50,\\n      \\\"query\\\": \\\"{resource.stage=\\\\\\\"${stage}\\\\\\\" \u0026\u0026 resource.envId=\\\\\\\"${envId}\\\\\\\" \u0026\u0026 resource.service=\\\\\\\"${service}\\\\\\\" \u0026\u0026 resource.app=~\\\\\\\"${app:regex}\\\\\\\"} \u003e\u003e {.http.method!=\\\\\\\"\\\\\\\"} | by(span.name) | select(.app, .service.name)\\\",\\n      \\\"queryType\\\": \\\"traceql\\\",\\n      \\\"refId\\\": \\\"A\\\",\\n      \\\"spss\\\": 200,\\n      \\\"tableType\\\": \\\"spans\\\"\\n    }\\n  ],\\n  \\\"options\\\": {\\n    \\\"barRadius\\\": 0,\\n    \\\"barWidth\\\": 0.97,\\n    \\\"fullHighlight\\\": false,\\n    \\\"groupWidth\\\": 0.7,\\n    \\\"legend\\\": {\\n      \\\"calcs\\\": [],\\n      \\\"displayMode\\\": \\\"list\\\",\\n      \\\"placement\\\": \\\"bottom\\\",\\n      \\\"showLegend\\\": false\\n    },\\n    \\\"orientation\\\": \\\"horizontal\\\",\\n    \\\"showValue\\\": \\\"never\\\",\\n    \\\"stacking\\\": \\\"percent\\\",\\n    \\\"tooltip\\\": {\\n      \\\"mode\\\": \\\"single\\\",\\n      \\\"sort\\\": \\\"none\\\"\\n    },\\n    \\\"xTickLabelRotation\\\": 0,\\n    \\\"xTickLabelSpacing\\\": 100\\n  },\\n  \\\"fieldConfig\\\": {\\n    \\\"defaults\\\": {\\n      \\\"color\\\": {\\n        \\\"mode\\\": \\\"palette-classic\\\"\\n      },\\n      \\\"custom\\\": {\\n        \\\"axisBorderShow\\\": false,\\n        \\\"axisCenteredZero\\\": false,\\n        \\\"axisColorMode\\\": \\\"text\\\",\\n        \\\"axisGridShow\\\": false,\\n        \\\"axisLabel\\\": \\\"\\\",\\n        \\\"axisPlacement\\\": \\\"left\\\",\\n        \\\"fillOpacity\\\": 80,\\n        \\\"gradientMode\\\": \\\"none\\\",\\n        \\\"hideFrom\\\": {\\n          \\\"legend\\\": false,\\n          \\\"tooltip\\\": false,\\n          \\\"viz\\\": false\\n        },\\n        \\\"lineWidth\\\": 1,\\n        \\\"scaleDistribution\\\": {\\n          \\\"type\\\": \\\"linear\\\"\\n        },\\n        \\\"thresholdsStyle\\\": {\\n          \\\"mode\\\": \\\"off\\\"\\n        }\\n      },\\n      \\\"mappings\\\": [],\\n      \\\"thresholds\\\": {\\n        \\\"mode\\\": \\\"absolute\\\",\\n        \\\"steps\\\": [\\n          {\\n            \\\"color\\\": \\\"green\\\",\\n            \\\"value\\\": null\\n          },\\n          {\\n            \\\"color\\\": \\\"red\\\",\\n            \\\"value\\\": 80\\n          }\\n        ]\\n      },\\n      \\\"unitScale\\\": true\\n    },\\n    \\\"overrides\\\": []\\n  },\\n  \\\"pluginVersion\\\": \\\"10.4.0-65875\\\",\\n  \\\"transformations\\\": [\\n    {\\n      \\\"id\\\": \\\"groupingToMatrix\\\",\\n      \\\"options\\\": {\\n        \\\"columnField\\\": \\\"service.name\\\",\\n        \\\"emptyValue\\\": \\\"null\\\",\\n        \\\"rowField\\\": \\\"Trace Name\\\",\\n        \\\"valueField\\\": \\\"Duration\\\"\\n      }\\n    }\\n  ],\\n  \\\"type\\\": \\\"barchart\\\",\\n  \\\"description\\\": \\\"\\\"\\n}\",\r\n        \"mode\": \"code\",\r\n        \"code\": {\r\n          \"language\": \"json\",\r\n          \"showLineNumbers\": true,\r\n          \"showMiniMap\": true\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above (after transformations)\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"id\": 100,\r\n      \"title\": \"Data (before transformations)\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 24,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": false,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: Resource Latency Distribution // 2024-02-07 01:24:12\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-barchart\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"2024-02-06T22:54:12.748Z\",\r\n    \"to\": \"2024-02-06T23:24:12.748Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\n\n### Environment (with versions)?\n\nGrafana: v10.4.0-65875 (b758b91e84)\r\nOS: MacOS Sonoma 14.3 (23D56)\r\nBrowser: Chrome Version 121.0.6167.139 (Official Build) (arm64)\r\n\n\n### Grafana platform?\n\nI use Grafana Cloud\n\n### Datasource(s)?\n\nTempo","labels":["area/transformations","triage/needs-confirmation"]},{"id":64194,"title":"Can't edit queries on a panel if they're using an undefined datasource","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: I upgraded my Prometheus \u0026 Grafana setup some time ago and noticed recently that I can't edit the existing dashboard that I had there. I was unable to expand the query row when editing a panel, nothing would show up there.\r\n\r\n**What you expected to happen**: I expected the query editor to render\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: Update your dashboard JSON in place and mess up the `uid` of a Prometheus data source, that should make the query editor not render at all.\r\n\r\n**Anything else we need to know?**: The query editor does not get rendered in HTML at all, see screenshot - query A is the old one pointing at an old `uid` of a datasource, query B was created in the editor as a new query. DOM element `#A_19` is empty where it should contain an editor.\r\n![image](https://user-images.githubusercontent.com/345808/222993914-c9090edb-9b57-4ccf-af95-15082ed07b77.png)\r\n\r\nIt's strange that the queries still execute just fine, despite being configured to use outdated datasource `uid` for Prometheus. It's only the editing that's broken.\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.6\r\n- Data source type \u0026 version: Prometheus 2.41.0\r\n- OS Grafana is installed on: NixOS 22.11\r\n- User OS \u0026 Browser: Windows 11 Firefox\r\n- Grafana plugins: -\r\n- Others:\r\n","labels":["type/bug","area/dashboard","needs more info","datasource/Prometheus","needs investigation","area/query-editor"]},{"id":56892,"title":"Dashboards with multiple template variables using key/value pairs have refresh problem","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: after upgrading to Grafana 9.2.0, all my dashboards having two or more comboboxes using key/value loaded from database have problem, only the last combobox if updated\r\n\r\n**What you expected to happen**: all the comboboxes must be updated\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: in attach a basic dashboard with two comboboxes with key/value pairs\r\n[grafana.txt](https://github.com/grafana/grafana/files/9778830/grafana.txt)\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**: CentOS Linux release 7.9.2009\r\n- Grafana version: 9.2.0 (2022-10-11)\r\n- Data source type \u0026 version: MySql\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n\r\n\r\n\r\n\nhttps://github.com/grafana/grafana/issues/56892#tasklist-block-40d30e9d-36e8-4816-bda1-6d7605536942\n","labels":["type/bug","area/dashboard/templating"]},{"id":75255,"title":"Query Editor: Switches Filter/Group/Order/Preview always change first Query","body":"### What happened?\r\n\r\nWhe I'm in query editor, and have more than one query, then click on any of the swicthes \"Filter\" \"Group\" \"Order\" \"Preview\" for the second query, actually the switches on the first query change.\r\n\r\n### What did you expect to happen?\r\n\r\nThe switches on the second query should change, if I click them.\r\n\r\n### Did this work before?\r\n\r\nI don't know.\r\n\r\n### How do we reproduce it?\r\n\r\n1. Edit Panel\r\n2. Add second query\r\n3. Click on any of the switches \"Filter\" \"Group\" \"Order\" \"Preview\" \r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n| Key | Value |\r\n|--|--|\r\n| Panel | timeseries @ 10.1.2 |\r\n| Grafana | 10.1.2 (8e428858dd) // Open Source |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"custom\": {\r\n            \"drawStyle\": \"line\",\r\n            \"lineInterpolation\": \"linear\",\r\n            \"barAlignment\": 0,\r\n            \"lineWidth\": 1,\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"spanNulls\": false,\r\n            \"insertNulls\": false,\r\n            \"showPoints\": \"auto\",\r\n            \"pointSize\": 5,\r\n            \"stacking\": {\r\n              \"mode\": \"none\",\r\n              \"group\": \"A\"\r\n            },\r\n            \"axisPlacement\": \"auto\",\r\n            \"axisLabel\": \"\",\r\n            \"axisColorMode\": \"text\",\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"axisCenteredZero\": false,\r\n            \"hideFrom\": {\r\n              \"tooltip\": false,\r\n              \"viz\": false,\r\n              \"legend\": false\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": [\r\n          {\r\n            \"matcher\": {\r\n              \"id\": \"byName\",\r\n              \"options\": \"Soll\"\r\n            },\r\n            \"properties\": [\r\n              {\r\n                \"id\": \"custom.lineInterpolation\",\r\n                \"value\": \"stepBefore\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        },\r\n        \"legend\": {\r\n          \"showLegend\": true,\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"right\",\r\n          \"calcs\": []\r\n        }\r\n      },\r\n      \"pluginVersion\": \"10.1.2\",\r\n      \"targets\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"grafana\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"snapshot\",\r\n          \"snapshot\": [\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"meta\": {\r\n                  \"typeVersion\": [\r\n                    0,\r\n                    0\r\n                  ],\r\n                  \"executedQueryString\": \"SELECT\\r\\n  \\\"time\\\" AS \\\"time\\\",\\r\\n  value AS \\\"Ladestand\\\"\\r\\nFROM auto_batterie_ladestand_154\\r\\nWHERE\\r\\n  \\\"time\\\" BETWEEN '2023-09-14T19:35:13.656Z' AND '2023-09-21T19:35:13.656Z'\\r\\nORDER BY 1\"\r\n                },\r\n                \"fields\": []\r\n              },\r\n              \"data\": {\r\n                \"values\": []\r\n              }\r\n            },\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"B\",\r\n                \"meta\": {\r\n                  \"typeVersion\": [\r\n                    0,\r\n                    0\r\n                  ],\r\n                  \"executedQueryString\": \"SELECT\\r\\n  \\\"time\\\" AS \\\"time\\\",\\r\\n  value AS \\\"Soll\\\"\\r\\nFROM auto_batterie_ladeziel_155\\r\\nWHERE\\r\\n  \\\"time\\\" BETWEEN '2023-09-14T19:35:13.656Z' AND '2023-09-21T19:35:13.656Z'\\r\\nORDER BY 1\"\r\n                },\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"time\",\r\n                    \"type\": \"time\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"time.Time\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"Soll\",\r\n                    \"type\": \"number\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"float64\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    1695321658379,\r\n                    1695321661209,\r\n                    1695321681978,\r\n                    1695321683015\r\n                  ],\r\n                  [\r\n                    80,\r\n                    70,\r\n                    80,\r\n                    70\r\n                  ]\r\n                ],\r\n                \"nanos\": [\r\n                  [\r\n                    964000,\r\n                    79000,\r\n                    819000,\r\n                    272000\r\n                  ],\r\n                  null\r\n                ]\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      \"title\": \"Reproduced with embedded data\",\r\n      \"type\": \"timeseries\",\r\n      \"description\": \"\"\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003etimeseries @ 10.1.2\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003eA[postgres], B[postgres]\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003e 2 frames, 2 fields, 4 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e10.1.2 (8e428858dd) // Open Source\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"title\": \"Original Panel JSON\",\r\n      \"type\": \"text\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 7\r\n      },\r\n      \"options\": {\r\n        \"content\": \"{\\n  \\\"datasource\\\": {\\n    \\\"uid\\\": \\\"000000001\\\",\\n    \\\"type\\\": \\\"postgres\\\"\\n  },\\n  \\\"fieldConfig\\\": {\\n    \\\"defaults\\\": {\\n      \\\"custom\\\": {\\n        \\\"drawStyle\\\": \\\"line\\\",\\n        \\\"lineInterpolation\\\": \\\"linear\\\",\\n        \\\"barAlignment\\\": 0,\\n        \\\"lineWidth\\\": 1,\\n        \\\"fillOpacity\\\": 0,\\n        \\\"gradientMode\\\": \\\"none\\\",\\n        \\\"spanNulls\\\": false,\\n        \\\"insertNulls\\\": false,\\n        \\\"showPoints\\\": \\\"auto\\\",\\n        \\\"pointSize\\\": 5,\\n        \\\"stacking\\\": {\\n          \\\"mode\\\": \\\"none\\\",\\n          \\\"group\\\": \\\"A\\\"\\n        },\\n        \\\"axisPlacement\\\": \\\"auto\\\",\\n        \\\"axisLabel\\\": \\\"\\\",\\n        \\\"axisColorMode\\\": \\\"text\\\",\\n        \\\"scaleDistribution\\\": {\\n          \\\"type\\\": \\\"linear\\\"\\n        },\\n        \\\"axisCenteredZero\\\": false,\\n        \\\"hideFrom\\\": {\\n          \\\"tooltip\\\": false,\\n          \\\"viz\\\": false,\\n          \\\"legend\\\": false\\n        },\\n        \\\"thresholdsStyle\\\": {\\n          \\\"mode\\\": \\\"off\\\"\\n        }\\n      },\\n      \\\"color\\\": {\\n        \\\"mode\\\": \\\"palette-classic\\\"\\n      },\\n      \\\"mappings\\\": [],\\n      \\\"thresholds\\\": {\\n        \\\"mode\\\": \\\"absolute\\\",\\n        \\\"steps\\\": [\\n          {\\n            \\\"color\\\": \\\"green\\\",\\n            \\\"value\\\": null\\n          },\\n          {\\n            \\\"color\\\": \\\"red\\\",\\n            \\\"value\\\": 80\\n          }\\n        ]\\n      }\\n    },\\n    \\\"overrides\\\": [\\n      {\\n        \\\"matcher\\\": {\\n          \\\"id\\\": \\\"byName\\\",\\n          \\\"options\\\": \\\"Soll\\\"\\n        },\\n        \\\"properties\\\": [\\n          {\\n            \\\"id\\\": \\\"custom.lineInterpolation\\\",\\n            \\\"value\\\": \\\"stepBefore\\\"\\n          }\\n        ]\\n      }\\n    ]\\n  },\\n  \\\"gridPos\\\": {\\n    \\\"h\\\": 8,\\n    \\\"w\\\": 12,\\n    \\\"x\\\": 0,\\n    \\\"y\\\": 23\\n  },\\n  \\\"id\\\": 21,\\n  \\\"options\\\": {\\n    \\\"tooltip\\\": {\\n      \\\"mode\\\": \\\"single\\\",\\n      \\\"sort\\\": \\\"none\\\"\\n    },\\n    \\\"legend\\\": {\\n      \\\"showLegend\\\": true,\\n      \\\"displayMode\\\": \\\"list\\\",\\n      \\\"placement\\\": \\\"right\\\",\\n      \\\"calcs\\\": []\\n    }\\n  },\\n  \\\"pluginVersion\\\": \\\"10.1.2\\\",\\n  \\\"targets\\\": [\\n    {\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"postgres\\\",\\n        \\\"uid\\\": \\\"000000001\\\"\\n      },\\n      \\\"editorMode\\\": \\\"builder\\\",\\n      \\\"format\\\": \\\"table\\\",\\n      \\\"hide\\\": false,\\n      \\\"rawQuery\\\": true,\\n      \\\"rawSql\\\": \\\"SELECT value, \\\\\\\"time\\\\\\\" FROM auto_batterie_ladestand_154 \\\",\\n      \\\"refId\\\": \\\"A\\\",\\n      \\\"sql\\\": {\\n        \\\"columns\\\": [\\n          {\\n            \\\"parameters\\\": [\\n              {\\n                \\\"name\\\": \\\"value\\\",\\n                \\\"type\\\": \\\"functionParameter\\\"\\n              }\\n            ],\\n            \\\"type\\\": \\\"function\\\"\\n          },\\n          {\\n            \\\"parameters\\\": [\\n              {\\n                \\\"name\\\": \\\"\\\\\\\"time\\\\\\\"\\\",\\n                \\\"type\\\": \\\"functionParameter\\\"\\n              }\\n            ],\\n            \\\"type\\\": \\\"function\\\"\\n          }\\n        ],\\n        \\\"groupBy\\\": [\\n          {\\n            \\\"property\\\": {\\n              \\\"type\\\": \\\"string\\\"\\n            },\\n            \\\"type\\\": \\\"groupBy\\\"\\n          }\\n        ]\\n      },\\n      \\\"table\\\": \\\"auto_batterie_ladestand_154\\\"\\n    },\\n    {\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"postgres\\\",\\n        \\\"uid\\\": \\\"000000001\\\"\\n      },\\n      \\\"editorMode\\\": \\\"builder\\\",\\n      \\\"format\\\": \\\"table\\\",\\n      \\\"hide\\\": false,\\n      \\\"rawQuery\\\": true,\\n      \\\"rawSql\\\": \\\"SELECT value, \\\\\\\"time\\\\\\\" FROM auto_batterie_ladeziel_155 LIMIT 50 \\\",\\n      \\\"refId\\\": \\\"B\\\",\\n      \\\"sql\\\": {\\n        \\\"columns\\\": [\\n          {\\n            \\\"parameters\\\": [\\n              {\\n                \\\"name\\\": \\\"value\\\",\\n                \\\"type\\\": \\\"functionParameter\\\"\\n              }\\n            ],\\n            \\\"type\\\": \\\"function\\\"\\n          },\\n          {\\n            \\\"parameters\\\": [\\n              {\\n                \\\"name\\\": \\\"\\\\\\\"time\\\\\\\"\\\",\\n                \\\"type\\\": \\\"functionParameter\\\"\\n              }\\n            ],\\n            \\\"type\\\": \\\"function\\\"\\n          }\\n        ],\\n        \\\"groupBy\\\": [\\n          {\\n            \\\"property\\\": {\\n              \\\"type\\\": \\\"string\\\"\\n            },\\n            \\\"type\\\": \\\"groupBy\\\"\\n          }\\n        ],\\n        \\\"limit\\\": 50\\n      },\\n      \\\"table\\\": \\\"auto_batterie_ladeziel_155\\\"\\n    }\\n  ],\\n  \\\"title\\\": \\\"Auto Batterie\\\",\\n  \\\"type\\\": \\\"timeseries\\\",\\n  \\\"description\\\": \\\"\\\"\\n}\",\r\n        \"mode\": \"code\",\r\n        \"code\": {\r\n          \"language\": \"json\",\r\n          \"showLineNumbers\": true,\r\n          \"showMiniMap\": true\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: Auto Batterie // 2023-09-21 21:42:03\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-timeseries\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"2023-09-14T19:42:03.297Z\",\r\n    \"to\": \"2023-09-21T19:42:03.297Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: v10.1.2\r\nOS: Windows 10\r\nBrowser: Firefox 117.0.1\r\n\r\n\r\n### Grafana platform?\r\n\r\nDocker\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["type/bug","datasource/Postgres","area/query-editor"]},{"id":63916,"title":"isolation_level config for Mysql 8 connections doesn't work","body":"**What happened**:\r\ngrafana.ini\r\n```\r\n[database]\r\ntype = mysql\r\nisolation_level = READ-COMMITTED\r\n```\r\nhttps://github.com/grafana/grafana/blob/main/conf/defaults.ini#L125-L129\r\n\r\ndoesn't work for Mysql 8.0.x connections\r\n```\r\nUnknown system variable 'tx_isolation'\r\n```\r\n\r\n\r\n**What you expected to happen**:\r\nconnection with config above works\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nsetup mysql DB 8.0.x\r\nadd in grafana.ini \r\n```\r\n[database]\r\ntype = mysql\r\n...\r\nisolation_level = READ-COMMITTED\r\n```\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.8\r\n\r\n","labels":["type/bug","area/backend/db/mysql","area/backend/db/sql"]},{"id":59288,"title":"Grafana variable don't use time range","body":"\r\n**What happened**: labels_values or variable query do not respect time range choosen in dashboard\r\n\r\n**What you expected to happen**: in variable i have all possibilite value in time range from dashboard\r\n![Peek 2022-11-24 13-10](https://user-images.githubusercontent.com/719392/203782007-3f06cc8b-b16e-439f-998f-3f639f03a96c.gif)\r\n\r\n**Environment**:\r\n- Grafana version: 9.1.7\r\n- Data source type \u0026 version: prometheus\r\n- OS Grafana is installed on: k8s using kube-prometheus-stack\r\n- User OS \u0026 Browser: chrome ubuntu\r\n","labels":["area/dashboard","area/dashboard/timerange","bot/no new info"]},{"id":78333,"title":"Alerting: Failed to build evaluator for queries and expressions after adding and removing a node","body":"### What happened?\n\nWhen I click preview, I get Failed to build evaluator for queries and expressions: unable to find dependent node 'D'. This happens after I add a new query node and then delete the query node.\n\n### What did you expect to happen?\n\nPreview should just work.\n\n### Did this work before?\n\nBefore I added the query node yes,\n\n### How do we reproduce it?\n\n1. Copy an alert\r\n2. Create a new query node\r\n3. Delete query node\r\n4. Click preview\r\n\n\n### Is the bug inside a dashboard panel?\n\n![image](https://github.com/grafana/grafana/assets/21298211/b17598a5-6dd6-403a-967d-0de356f284e1)\r\n\n\n### Environment (with versions)?\n\nGrafana: Grafana v9.4.7\r\nOS: Windows 10\r\nBrowser: Firefox\r\n\n\n### Grafana platform?\n\nI use Grafana Cloud\n\n### Datasource(s)?\n\n_No response_","labels":["area/alerting","datasource/Timestream","triage/needs-confirmation"]},{"id":88038,"title":"Data cleared for MQTT source when dashboard updates","body":"### What happened?\n\nWhen you have both a panel with a live MQTT data source and a DB query, every time the dashboard refreshes, it deletes any data from the live panel as well. This means the live panel will reset to empty every time the dashboard updates. (every 5, 10, 30 seconds or whatever)\n\n### What did you expect to happen?\n\nNot lose data from live panels when the dashboard gets now data from other panels.\n\n### Did this work before?\n\nNever seen it work \n\n### How do we reproduce it?\n\n1. Add a live panel to a dashboard\r\n2. Set \"Set auto refresh interval\" to some valie\r\n3. Wait for the interval\r\n\n\n### Is the bug inside a dashboard panel?\n\nNo, dashboard itself. \n\n### Environment (with versions)?\n\nGrafana: Grafana v10.4.1 (d94d597d84)\r\nOS: MacOS 13.2.1\r\nBrowser: Safari 16.3 / Chrome / FireFox\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nMQTT 1.0.0-beta.4","labels":["needs more info","area/backend","triage/needs-confirmation"]},{"id":81680,"title":"We upgrade the grafana 9.7.1 to 10.2.1 image version","body":"### What happened?\n\nwe upgrade the grafana image from 9.7.1 to 10.2.1, functionality looks good but in the container images i facing below error:\r\n\r\nlogger=http.server t=2024-02-01T05:40:43.437610261Z level=error msg=\"Failed to parse user ID\" error=\"identifier is not initialized\"\r\nlogger=context userId=0 orgId=0 uname= t=2024-02-01T05:41:13.429562988Z level=info msg=\"Request Completed\" method=GET path=/ status=302 remote_addr=172.18.0.1 time_ms=0 duration=150.996µs size=29 referer= handler=/\r\nlogger=http.server t=2024-02-01T05:41:13.43713415Z level=error msg=\"Failed to parse user ID\" error=\"identifier is not initialized\"\r\nlogger=context userId=0 orgId=0 uname= t=2024-02-01T05:41:43.435619728Z level=info msg=\"Request Completed\" method=GET path=/ status=302 remote_addr=172.18.0.1 time_ms=0 duration=184.426µs size=29 referer= handler=/\r\nlogger=http.server t=2024-02-01T05:41:43.445760902Z level=error msg=\"Failed to parse user ID\" error=\"identifier is not initialized\"\r\nlogger=context userId=0 orgId=0 uname= t=2024-02-01T05:42:13.430460485Z level=info msg=\"Request Completed\" method=GET path=/ status=302 remote_addr=172.18.0.1 time_ms=0 duration=193.203µs size=29 referer= handler=/\r\nlogger=http.server t=2024-02-01T05:42:13.439093708Z level=error msg=\"Failed to parse user ID\" error=\"identifier is not initialized\" \n\n### What did you expect to happen?\n\ni want to resolved this error\n\n### Did this work before?\n\nyes\n\n### How do we reproduce it?\n\n1. upgarde from 9.7.1 to 10.2.1 grafana image\r\n2.\r\n3.\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.2.1\r\nOS:\"Alpine Linux v3.18\"\r\nBrowser:chrome\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["area/auth","bot/no new info"]},{"id":66238,"title":"Grafana external Alertmanager datasource Skip TLS Verify or CA Cert options not working","body":"I set up an external Alertmanager datasource, which is using a self-signed certificate.\r\nI checked Skip TLS Verify in the datasource options UI and tried sending an alert.\r\nI also tried adding the CA cert using the CA cert option.\r\n\r\n**What happened:**\r\nGrafana logs saw \"x509 error certificate signed by unknown authority.\"\r\nAlertmanager logs saw something like \"TLS error.\"\r\n\r\n**What you expected to happen:**\r\nChecking Skip TLS Verify would not result in self-signed cert errors.\r\nOr, adding the CA cert in the Grafana UI would not result in errors.\r\n\r\n**How to reproduce it (as minimally and precisely as possible):**\r\nSee above.\r\n\r\n**Environment:**\r\nGrafana version: v9.3.2\r\nData source type \u0026 version: Alertmanager datasource (OpenShift)\r\nOS Grafana is installed on: Docker Grafana image\r\nUser OS \u0026 Browser: Windows, Edge","labels":["type/bug","area/alerting","needs investigation"]},{"id":81425,"title":"Update/DB migration from 10.2.3 to 10.3.1 - `disk I/O error: read-only file system`, if only `/var/lib/grafana` is writable (in AWS ECS)","body":"### What happened?\n\n#### Setup / Environment for Grafana\r\n* We are running Grafana in AWS ECS as Container.\r\n* We using a Container \"mountPoints\" for the Container path `/var/lib/grafana`. Hence, the Container can write/delete/read files within this folder/subfolders (only). \r\n* Within AWS ECS we have the option \"readonlyRootFilesystem\" enabled. When this parameter is enabled, the container is given read-only access to its root file system.\r\n\r\n#### Issue Description\r\nIf we switch the version of Grafana from version 10.2.3 (commit=1e84fede543acc892d2a2515187e545eb047f237 branch=HEAD compiled=2023-12-18T15:46:07Z) to new version version 10.3.1 (commit=00a22ff8b28550d593ec369ba3da1b25780f0a4a branch=HEAD compiled=2024-01-22T18:40:42Z) we see the following error (including a container-exit):\r\n\r\n```\r\nlogger=settings t=2024-01-26T12:08:39.948640486Z level=info msg=\"Starting Grafana\" version=10.3.1 commit=00a22ff8b28550d593ec369ba3da1b25780f0a4a branch=HEAD compiled=2024-01-22T18:40:42Z\r\nlogger=settings t=2024-01-26T12:08:39.94891029Z level=info msg=\"Config loaded from\" file=/usr/share/grafana/conf/defaults.ini\r\nlogger=settings t=2024-01-26T12:08:39.948923828Z level=info msg=\"Config loaded from\" file=/etc/grafana/grafana.ini\r\nlogger=settings t=2024-01-26T12:08:39.949079071Z level=info msg=\"Path Home\" path=/usr/share/grafana\r\nlogger=settings t=2024-01-26T12:08:39.949084891Z level=info msg=\"Path Data\" path=/var/lib/grafana\r\nlogger=settings t=2024-01-26T12:08:39.949090853Z level=info msg=\"Path Logs\" path=/var/log/grafana\r\nlogger=settings t=2024-01-26T12:08:39.949096261Z level=info msg=\"Path Plugins\" path=/var/lib/grafana/plugins\r\nlogger=settings t=2024-01-26T12:08:39.949102087Z level=info msg=\"Path Provisioning\" path=/etc/grafana/provisioning\r\nlogger=settings t=2024-01-26T12:08:39.949107436Z level=info msg=\"App mode production\"\r\nlogger=sqlstore t=2024-01-26T12:08:39.94960476Z level=info msg=\"Connecting to DB\" dbtype=sqlite3\r\nlogger=migrator t=2024-01-26T12:08:39.955959698Z level=info msg=\"Starting DB migrations\"\r\nlogger=migrator t=2024-01-26T12:08:40.305173539Z level=info msg=\"migrations completed\" performed=0 skipped=526 duration=1.361395ms\r\nlogger=accesscontrol.service t=2024-01-26T12:08:40.965868647Z level=error msg=\"Error saving permissions\" migration=scopeSplit error=\"disk I/O error: read-only file system\"\r\nlogger=accesscontrol.service t=2024-01-26T12:08:40.965973491Z level=error msg=\"Error updating permission batch\" migration=scopeSplit start=0 end=671\r\nlogger=accesscontrol.service t=2024-01-26T12:08:40.965988637Z level=error msg=\"Could not migrate permissions\" migration=scopeSplit total=671 succeeded=0 left=671 error=\"tx err: disk I/O error: read-only file system, rb err: cannot rollback - no transaction is active\"\r\nError: ✗ tx err: disk I/O error: read-only file system, rb err: cannot rollback - no transaction is active\r\n```\n\n### What did you expect to happen?\n\nGrafana Container should not fail (here during migration/permission step for `10.2.3` to `10.3.1` version-change), if only `/var/lib/grafana` is writable and `readonlyRootFilesystem` is enabled. Furthermore the folder/file for this `disk I/O error: read-only file system` would helpful to fix it.\n\n### Did this work before?\n\nWe are using Grafana is different stages, which differences of usage (e.g. amount of dashboards). There was stages, where the switch from `10.2.3` to `10.3.1` worked without any issue while have the same mount and `readonlyRootFilesystem` was enabled all the time. Jip, that's stange.\n\n### How do we reproduce it?\n\n#### Workaround\r\n1. We disabled readonlyRootFilesystem option within AWS ECS\r\n2. Afterwards, we started Grafana 10.3.1 again (\"against\" the files mounted via /var/lib/grafana, which was handled by 10.2.3 before)\r\n3. This time (with readonlyRootFilesystem disabled), we didn't see any error. Grafana started without errors. We stopped the Container graceful.\r\n4. We enabled readonlyRootFilesystem again and started the same 10.3.1 Container-Image.\r\n5. Now, we didn't see any error regarding `disk I/O error: read-only file system` or logs as shown above. Grafana started successful (by having again writeable access to /var/lib/grafana only).\r\n\r\n\r\n#### Questions\r\nDo we need to mount other folders (_in addition to `/var/lib/grafana`_) as writeable?\r\nDoes this permissions / permission batch during mirgation like to store (temporary) files somewhere outside of `/var/lib/grafana`?\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.3.1\r\nOS: Offical Grafana Image - As far as I know, Alpine Linux.\r\nBrowser:\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\nVictoriaMetrics","labels":["area/backend","area/backend/db/sql","storage backend","triage/needs-confirmation"]},{"id":75130,"title":"Data Sources: Data Source ID used instead of Database Name","body":"### What happened?\r\n\r\nI have started from a fresh download of Grafana 10.1.2 on Windows 10. I am running MariaDB 10.11.5.\r\n\r\n![image](https://github.com/grafana/grafana/assets/32853381/5765060f-e841-4a71-a5c7-9ccf5981810a)\r\n\r\nI have added the Data Source for the local MariaDB instance and it validates successfully.\r\n\r\n\u003cimg width=\"806\" alt=\"data_source2\" src=\"https://github.com/grafana/grafana/assets/32853381/68e53626-d9a8-4bb4-93c3-d6f5737f6462\"\u003e\r\n\r\nThe issue appears when I attempt to use a Data Source Variable on a Dashboard. I am not able to use the `$Database.` variable to select the database. The variable appears to use the Data Source's ID instead of the name.\r\n\r\n\u003cimg width=\"1004\" alt=\"data_source\" src=\"https://github.com/grafana/grafana/assets/32853381/fa6b2fd5-477f-4fbb-bb28-1c6e9b8bc023\"\u003e\r\n\r\nIf I do not use the variable and instead manually specify the database name it works correctly.\r\n\r\n\u003cimg width=\"1016\" alt=\"data_source1\" src=\"https://github.com/grafana/grafana/assets/32853381/27180998-3921-4f4c-a19a-16b3c2497de6\"\u003e\r\n\r\nSame behavior as #74777.\r\n\r\n### What did you expect to happen?\r\n\r\nWhen using the `$Database.` variable, the correct data source is used instead of the ID of the data source.\r\n\r\n### Did this work before?\r\n\r\nYes, this worked before in 10.1.0.\r\n\r\n### How do we reproduce it?\r\n\r\n1. Add a MariaDB database via the MySQL plugin\r\n2. Create a new dashboard and add a Data Source Variable named `Database`\r\n3. Create a new panel and attempt to use the `$Database.` variable to select data.\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n| Key | Value |\r\n|--|--|\r\n| Panel | table @ 10.1.2 |\r\n| Grafana | 10.1.2 (2b2d40ba32) // Enterprise |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"type\": \"table\",\r\n      \"title\": \"Reproduced with embedded data\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"id\": 2,\r\n      \"targets\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"grafana\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"snapshot\",\r\n          \"snapshot\": [\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"meta\": {\r\n                  \"typeVersion\": [\r\n                    0,\r\n                    0\r\n                  ],\r\n                  \"executedQueryString\": \"select * from dd758a09-5f4f-427c-af59-9b905b60c35e.test_table \"\r\n                },\r\n                \"fields\": []\r\n              },\r\n              \"data\": {\r\n                \"values\": []\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      \"options\": {\r\n        \"showHeader\": true,\r\n        \"cellHeight\": \"sm\",\r\n        \"footer\": {\r\n          \"show\": false,\r\n          \"reducer\": [\r\n            \"sum\"\r\n          ],\r\n          \"countRows\": false,\r\n          \"fields\": \"\"\r\n        }\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"custom\": {\r\n            \"align\": \"auto\",\r\n            \"cellOptions\": {\r\n              \"type\": \"auto\"\r\n            },\r\n            \"inspect\": false\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"value\": null,\r\n                \"color\": \"green\"\r\n              },\r\n              {\r\n                \"value\": 80,\r\n                \"color\": \"red\"\r\n              }\r\n            ]\r\n          },\r\n          \"color\": {\r\n            \"mode\": \"thresholds\"\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"pluginVersion\": \"10.1.2\"\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003etable @ 10.1.2\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003eA[mysql]\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003eError 1 frames, 0 fields, 0 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e10.1.2 (2b2d40ba32) // Enterprise\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"title\": \"Original Panel JSON\",\r\n      \"type\": \"text\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 7\r\n      },\r\n      \"options\": {\r\n        \"content\": \"{\\n  \\\"type\\\": \\\"table\\\",\\n  \\\"title\\\": \\\"Panel Title\\\",\\n  \\\"gridPos\\\": {\\n    \\\"x\\\": 0,\\n    \\\"y\\\": 0,\\n    \\\"w\\\": 12,\\n    \\\"h\\\": 8\\n  },\\n  \\\"datasource\\\": {\\n    \\\"uid\\\": \\\"${Database}\\\",\\n    \\\"type\\\": \\\"mysql\\\"\\n  },\\n  \\\"id\\\": 1,\\n  \\\"targets\\\": [\\n    {\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"mysql\\\",\\n        \\\"uid\\\": \\\"${Database}\\\"\\n      },\\n      \\\"refId\\\": \\\"A\\\",\\n      \\\"format\\\": \\\"table\\\",\\n      \\\"rawSql\\\": \\\"select * from ${Database}.test_table \\\",\\n      \\\"editorMode\\\": \\\"code\\\",\\n      \\\"sql\\\": {\\n        \\\"columns\\\": [\\n          {\\n            \\\"type\\\": \\\"function\\\",\\n            \\\"parameters\\\": []\\n          }\\n        ],\\n        \\\"groupBy\\\": [\\n          {\\n            \\\"type\\\": \\\"groupBy\\\",\\n            \\\"property\\\": {\\n              \\\"type\\\": \\\"string\\\"\\n            }\\n          }\\n        ],\\n        \\\"limit\\\": 50\\n      },\\n      \\\"dataset\\\": \\\"gpx2_flight\\\",\\n      \\\"rawQuery\\\": true\\n    }\\n  ],\\n  \\\"options\\\": {\\n    \\\"showHeader\\\": true,\\n    \\\"cellHeight\\\": \\\"sm\\\",\\n    \\\"footer\\\": {\\n      \\\"show\\\": false,\\n      \\\"reducer\\\": [\\n        \\\"sum\\\"\\n      ],\\n      \\\"countRows\\\": false,\\n      \\\"fields\\\": \\\"\\\"\\n    }\\n  },\\n  \\\"fieldConfig\\\": {\\n    \\\"defaults\\\": {\\n      \\\"custom\\\": {\\n        \\\"align\\\": \\\"auto\\\",\\n        \\\"cellOptions\\\": {\\n          \\\"type\\\": \\\"auto\\\"\\n        },\\n        \\\"inspect\\\": false\\n      },\\n      \\\"mappings\\\": [],\\n      \\\"thresholds\\\": {\\n        \\\"mode\\\": \\\"absolute\\\",\\n        \\\"steps\\\": [\\n          {\\n            \\\"value\\\": null,\\n            \\\"color\\\": \\\"green\\\"\\n          },\\n          {\\n            \\\"value\\\": 80,\\n            \\\"color\\\": \\\"red\\\"\\n          }\\n        ]\\n      },\\n      \\\"color\\\": {\\n        \\\"mode\\\": \\\"thresholds\\\"\\n      }\\n    },\\n    \\\"overrides\\\": []\\n  },\\n  \\\"pluginVersion\\\": \\\"10.1.2\\\"\\n}\",\r\n        \"mode\": \"code\",\r\n        \"code\": {\r\n          \"language\": \"json\",\r\n          \"showLineNumbers\": true,\r\n          \"showMiniMap\": true\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: Panel Title // 2023-09-19 18:11:57\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-table\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"2023-09-19T16:11:57.598Z\",\r\n    \"to\": \"2023-09-19T22:11:57.598Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.1.2\r\nOS: Windows 10\r\nBrowser: Firefox 102.15.1esr (32-bit) and Edge Version 117.0.2045.31 (Official build) (64-bit)\r\nData Source: MariaDB 10.11.5 via MySQL Plugin\r\n\r\n### Grafana platform?\r\n\r\nA downloaded binary\r\n\r\n### Datasource(s)?\r\n\r\nMariaDB 10.11.5 with the MySQL Data Source Plugin","labels":["area/dashboard/templating","datasource/MySQL","triage/needs-confirmation","team/grafana-dashboards"]},{"id":87858,"title":"Enviroment Provider Fails on Special Characters","body":"### What happened?\r\n\r\nWhen using the env provider (`$__env{EXAMPLE}`) the resulting value is incorrectly parsed when some special characters are in use, namely: `#` and `;`. This is highlighted in the database configuration as causing potential problems here:\r\n\r\n```\r\n# If the password contains # or ; you have to wrap it with triple quotes. Ex \"\"\"#password;\"\"\"\r\n```\r\n\r\nI attempted with both:\r\n\r\n```\r\npassword: $__env{ENV_PASSWORD}\r\n```\r\n\r\nand a triple quote:\r\n\r\n```\r\npassword: \"\"\"$__env{ENV_PASSWORD}\"\"\"\r\n```\r\n\r\nThe triple quote seems to cause more issues as it won't actually recognize the value in that case it seems like. This is remedied by changing the value to something that does not contain those special characters.\r\n\r\n### What did you expect to happen?\r\n\r\nI expected that I would either be able to use the env provider with the special characters, or work around it using the documented workaround. However, it seems that neither are the case.\r\n\r\n### Did this work before?\r\n\r\nNo.\r\n\r\n### How do we reproduce it?\r\n\r\n1. Set up a database user that has a password with special characters like `#` or `;`\r\n2. Attempt to connect grafana to that database instance using the env provider for the password\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.4.1\r\nOS: N/A\r\nBrowser: N/A\r\n\r\n\r\n### Grafana platform?\r\n\r\nKubernetes\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/admin/user","area/backend","triage/needs-confirmation"]},{"id":61896,"title":"Plotly: Public Dashboard with TypeError: Cannot read properties of undefined (reading 'fields') ","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n\r\n**What happened**:\r\nHi, I am building a public dashboard with plotly panel and elasticsearch datasource.\r\nWhen  I build the dashboard, make query to elasticsearch with metric of `rawdata`, the graph succesfully shown as below.\r\n\r\n\r\n\u003cimg width=\"558\" alt=\"image\" src=\"https://user-images.githubusercontent.com/1107085/213873169-7089dc01-a5e2-4ede-9740-70a965d23060.png\"\u003e\r\n\r\nHere is the sample script using in the panel\r\n\u003cimg width=\"517\" alt=\"image\" src=\"https://user-images.githubusercontent.com/1107085/213873817-ee59dfe5-2b8c-4764-8a48-a2e3d64a8d52.png\"\u003e\r\n\r\nHowever, when I export and make the dashboard public and access it,  there is a message of \r\n`TypeError: Cannot read properties of undefined (reading 'fields')  `in the panel. It seems that the data is not send to the public dashbord\r\n\r\n\u003cimg width=\"692\" alt=\"image\" src=\"https://user-images.githubusercontent.com/1107085/213873216-52c7e4d6-c192-4a4c-8b47-362d4efb7801.png\"\u003e\r\n\r\nHere is one of the script that can be executed in the dashboard but raise error when accessed from the public dashboard. \r\n\r\n`let pos  = data.series[0].fields[9].values.buffer[0]`\r\n\r\nThere is no `fields[9] `value, as  seen in developer console, when accessing the public version of dashboard.\r\n\r\nAdditional information: when query metric is `count`, the panel can be seen in public dashboard.\r\n**Environment**:\r\n- Grafana version: 9.2.1\r\n- Data source type \u0026 version: Elasticsearch 8\r\n- OS Grafana is installed on: Ubuntu\r\n- User OS \u0026 Browser: MacOS and Chrome\r\n- Grafana plugins: Plotly Panel\r\n- Others: \r\n\r\nAny help is appreciated.\r\n\r\nRegards\r\nWidy\r\n\r\n\r\n","labels":["needs more info","datasource/Elasticsearch","area/public-dashboards","triage/needs-confirmation","needs refinement"]},{"id":54578,"title":"Snapshot dropdown disabled - Makes dashbaord as code validation with snapshot worst?","body":"**What happened**:\r\nWith the merge of https://github.com/grafana/grafana/pull/52827\r\nWe are unable to select dropdowns on snapshots (which were working for our setup...)\r\n\r\nWe followed a presentation done at PromCon in order to generate a snapshot with dashboard as code to validate pull-requests \"visually\" on top of code changes. See https://youtu.be/kV3Ua6guynI?t=413\r\n\r\nBy disabling dropdowns on snapshot, its harder to validate that the dashboard as code change work for dropdowns :(\r\n\r\nWDYT?\r\n","labels":["type/feature-request","area/dashboard/snapshot","wontfix"]},{"id":52625,"title":"Value Mapping/Overrides when using RegEx on the Bar Chart Panel","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: When using the Value Mapping or Overrides through regex, it is inconsistent with what it picks up when changing the color property of the panel.\r\n\r\n**What you expected to happen**: Expected to accurately pickup the RegEx so that the specific bars of the bar chart are the correct colors.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: Create a bar chart panel with data, and attempt to use either value mappings or field overrides through regex changing the colors of a bar matching the regex.\r\n\r\n**Anything else we need to know?**: On one page the regex is working as expected with the same panel and same text, however the Identical regex does not work.\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.0\r\n- Data source type \u0026 version: Influx DB 2.09\r\n- OS Grafana is installed on: Linux Ubuntu\r\n- User OS \u0026 Browser: Windows 10 \u0026 Linux\r\n- Grafana plugins: Built-in Grafana Bar Chart\r\n- Others: The second line on the first picture, of the bar chart, should be orange for example.\r\n![image](https://user-images.githubusercontent.com/82121905/180294784-65ec1c82-7f71-4f9c-b4ac-42db4d50afe5.png)\r\n![image](https://user-images.githubusercontent.com/82121905/180294984-a724f97f-360e-4e3b-9a38-031a44159a4f.png)\r\n\r\n","labels":["needs more info","area/field/overrides"]},{"id":75027,"title":"There is no legend template in grafana 10 when sending an alert","body":"### What happened?\r\n\r\n\r\n![Screenshot from 2023-09-18 20-32-36](https://github.com/grafana/grafana/assets/29920438/3fb12d17-475d-4192-b390-9e7117efb789)\r\n\r\n\r\nIn Grafana 10 there is no legend template when sending an alert. \r\n\r\nPreviously, in grafana versions below 9, the following data was sent:\r\n`[metric='DLX.esb.responses.in' labels={queue=DLX.esb.responses.in} value=7 ])`\r\n\r\nnow in grafana 10:\r\n`[metric='rabbitmq_queue_messages' labels={__name__=rabbitmq_queue_messages, container=*, dc=*, endpoint=*, environment=*, exported_namespace=*, instance=*, job=*, namespace=*, node=*, prometheus=*, promxy_sg=*, queue=DLX.esb.responses.in, service=*, vhost=*} value=2 ]`\r\n\r\nThe metrics field used to contain Legend, but now contains the name of the metric and labels.\r\nOverriding a series or template name does not work\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nSeries name override or template. Ex. {{hostname}} will be replaced with label value for hostname\r\n\r\n### Did this work before?\r\n\r\nYes, in version below 10\r\n\r\n### How do we reproduce it?\r\n\r\nDescribed in the field - What happened?\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10+\r\n\r\n\r\n\r\n### Grafana platform?\r\n\r\nKubernetes\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["triage/needs-confirmation"]},{"id":72072,"title":"Unable to disable grafana live","body":"### What happened?\r\n\r\nBelow are my live settings\r\n\r\n```\r\n#################################### Grafana Live ##########################################\r\n[live]\r\n# max_connections to Grafana Live WebSocket endpoint per Grafana server instance. See Grafana Live docs\r\n# if you are planning to make it higher than default 100 since this can require some OS and infrastructure\r\n# tuning. 0 disables Live, -1 means unlimited connections.\r\nmax_connections = 0\r\n\r\n# allowed_origins is a comma-separated list of origins that can establish connection with Grafana Live.\r\n# If not set then origin will be matched over root_url. Supports wildcard symbol \"*\".\r\nallowed_origins = *\r\n```\r\n\r\nI am trying to disable the grafana live on my setup.\r\n\r\n### What did you expect to happen?\r\n\r\nGrafana live should be disabled.\r\n\r\n### Did this work before?\r\n\r\nNo\r\n\r\n### How do we reproduce it?\r\n\r\n1. Start grafana\r\nYou can see multiple ws  live call in the logs\r\n\r\n`2023-07-21T10:10:50.474186+05:30 hac-verma-1 grafana_0: {\"timestamp\":\"2023-07-21T04:40:50.468559Z\",\"host\":\"hac-verma-1\",\"container\":\"fbd06a7dfdff\",\"msg\":\"duration=24.488ms handler=/api/live/ws level=info logger=context method=GET msg=Request Completed orgId=1 path=/api/live/ws referer= remote_addr=10.124.6.201 size=10 status=403 time_ms=24 uname= userId=0\",\"priority\":7,\"namespace\":\"grafana-server\"}`\r\n\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nNo\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 9.4.3\r\nOS:  ubuntu\r\nBrowser: chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nDocker\r\n\r\n### Datasource(s)?\r\n\r\ngraphite","labels":["needs more info","area/docker","area/configuration"]},{"id":69277,"title":"Dashboards: same UID dashboard permissions removed when one is deleted in any org","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\n  - Dashboards in different Orgs can share the same UID, but when I delete a dashboard in one Org, all the dashboards in the other Orgs with the same UID lose their permissions. That usually happens with popular downloaded dashboards that are added into many Orgs: i.e. - Node Exporter Full. In this case users with Reader/Editor role won't see the dashboards and will assume that someone had deleted them. However re-creating (re-downloading or uploading them) will fail because the dashboards do exist, but cannot be seen and modified.\r\n\r\n**What did you expect to happen**:\r\n\r\n  - Dashboards with the same UID in different Orgs do not share the same permissions and if one dashboard is removed, the others are not affected.\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\n- Run a new Grafana from scratch, e.g. as a container on localhost and bind it to localhost:3000\r\n- Open localhost:3000, log in as admin/admin and skip changing the admin password\r\n\r\n**Step 2**:\r\n\r\n- Go to `Server admin` → `Organizations`\r\n- Click `New org` and create a new Org named `test`\r\n- You are now in this `test` Org\r\n\r\n**Step 3**:\r\n\r\n- Click `Dashboards` → `New dashboard`\r\n- Add a new panel — random walk example will do\r\n- Click `Save` and save it as `New dashboard`\r\n- Click `Dashboard settings` → `JSON Model` and copy the source code\r\n\r\n**Step 4**:\r\n\r\n- Go back, click `Profile`→ `Switch organization` and switch to the `Main Org.`\r\n- Click `Dashboards` → `Import`\r\n- Paste the source code from step 3, click `Load` and `Import`\r\n- Now you have 2 dashboards with the same UID in different Orgs.\r\n\r\n**Step 5**:\r\n\r\n- Click `Dashboard settings` → `General`, scroll down, click the red `Delete Dashboard` button and confirm by clicking `Delete`.\r\n- The dashboard is deleted in the `Main Org.`\r\n\r\n**Step 6**:\r\n- Click `Profile`→ `Switch organization` and switch to the `test` Org\r\n- Open the `New dashboard` - it should be available in the recently viewed.\r\n- Click `Dashboard settings` → `Permissions`\r\n- ... and all the permissions but Admin are gone.\r\n\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\n9.2.4\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\r\n\r\n### Grafana Platform?\r\n\r\nDocker\r\n\r\n### User's OS?\r\n\r\nAlmaLinux 8.7\r\n\r\n### User's Browser?\r\n\r\nGoogle Chrome 109.0.5414.119\r\n\r\n### Is this a Regression?\r\n\r\nNo\r\n\r\n### Are Datasources involved?\r\n\r\nNo\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["area/dashboard","area/permissions","area/dashboard/import","triage/needs-confirmation"]},{"id":76633,"title":"DashboardQueryRunner failed. Failed to fetch","body":"### What happened?\n\nI get this error when I switch organizations, it only appears on the switch, if I update the page after switching I don't get any error. Also, all our dashboards work without any issues. I couldn't find anything in the logs even after using debug mode\r\n![image](https://github.com/grafana/grafana/assets/64531970/46310778-cb18-421b-be67-39ca4e6f10d1)\r\n\n\n### What did you expect to happen?\n\nI don't want to see that error\n\n### Did this work before?\n\nWe migrated from version 8.3.3 with standard DB to version 10 and Aurora MySQL, we ran that standard database on versions in between to make sure it would upgrade all it needed, so it wasn't like we took the database and put it in 10.1.2\n\n### How do we reproduce it?\n\n1. I don't really know, I guess having multiple organizations is a must\r\n2. We provision our dashboards, don't know if it's helpful, we have a few yaml files for each organization, but the path inside is different for each one\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.1.2, but happened on previous versions too (AWS Linux 2 (CentOS 7))\r\nOS: Windows 10/11\r\nBrowser: OperaGX, Chrome, Edge\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\nCloudWatch, but not sure if it's the reason","labels":["area/dashboard","needs more info","triage/needs-confirmation","team/grafana-dashboards"]},{"id":46537,"title":"Grafana Dashboards not getting provisioned","body":"**What happened**: I have around 20 dashboards not getting provisioned with the below error in Grafana\r\n```\r\nt=2022-03-14T13:47:07+0000 lvl=dbug msg=\"saving new dashboard\" logger=provisioning.dashboard type=file name=default provisioner=default file=/var/lib/grafana/dashboards/some-dashboard-name.json folderId=0\r\nt=2022-03-14T13:47:07+0000 lvl=dbug msg=\"Extracted alerts from dashboard\" logger=alerting.extractor alertCount=0\r\nt=2022-03-14T13:47:07+0000 lvl=eror msg=\"failed to save dashboard\" logger=provisioning.dashboard type=file name=default error=\"Dashboard not found\"\r\n```\r\n\r\n**What you expected to happen**: Would expect the dashboards to get provisioned without any errors.\r\n\r\n**Anything else we need to know?**: \r\nLike mentioned in the  #31147 issue, it is getting fixed, when I remove the dashboard entry from the `dashboard_provisioning` table. This looks like a workaround and I have to do this manually every time this error occurs.\r\nAnd on the check for `id`,  I have checked all the dashboard json files which has issue for the `id` and only two of them has that attribute.\r\nI am looking forward to understand the root cause and so that we can fix it altogether.\r\n\r\n**Environment**:\r\n- Grafana version: v8.2.7\r\n- OS Grafana is installed on: k8s\r\n","labels":["area/provisioning","needs investigation"]},{"id":80785,"title":"Datasources: multiple default datasources","body":"### What happened?\r\n\r\nSince we upgraded to Grafana 10.2.3 (introduced in helm release 7.0.22) we are frequently seeing Grafana ignoring the  `is_default: false` attribute when creating new datasources. We even see multiple datasources being marked as default, which should not be possible.\r\n\r\nThis also leads to idempotency issues when using terraform:\r\n\r\n* a datasource is created with `is_default: false`\r\n* the next run of `terraform plan` reads the datasource and sees that attribute `is_default` is `true`\r\n* terraform reports that it wants to make a change\r\n\r\n```\r\n  # grafana_data_source.additional[\"foo\"] will be updated in-place\r\n  ~ resource \"grafana_data_source\" \"additional\" {\r\n        id                       = \"1:8\"\r\n      ~ is_default               = true -\u003e false\r\n        name                     = \"Foo\"\r\n        # (9 unchanged attributes hidden)\r\n    }\r\n\r\n  # grafana_data_source.additional[\"bar\"] will be updated in-place\r\n  ~ resource \"grafana_data_source\" \"additional\" {\r\n        id                       = \"1:15\"\r\n      ~ is_default               = true -\u003e false\r\n        name                     = \"Bar\"\r\n        # (9 unchanged attributes hidden)\r\n    }\r\n\r\n  # grafana_data_source.additional[\"baz\"] will be updated in-place\r\n  ~ resource \"grafana_data_source\" \"additional\" {\r\n        id                       = \"1:7\"\r\n      ~ is_default               = true -\u003e false\r\n        name                     = \"Baz\"\r\n        # (8 unchanged attributes hidden)\r\n    }\r\n\r\n  # grafana_data_source.additional[\"qux\"] will be updated in-place\r\n  ~ resource \"grafana_data_source\" \"additional\" {\r\n        id                       = \"1:6\"\r\n      ~ is_default               = true -\u003e false\r\n        name                     = \"Qux\"\r\n        # (8 unchanged attributes hidden)\r\n    }\r\n```\r\n\r\n### What did you expect to happen?\r\n\r\nDatasources should not be marked as default.\r\n\r\n### Did this work before?\r\n\r\nYes\r\n\r\n### How do we reproduce it?\r\n\r\nWe create tens of datasources with terraform with a parallelism of 25, so high concurrency. All have the `is_default` value set to false.\r\n\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana **Enterprise**: 10.2.3\r\n\r\n\r\n### Grafana platform?\r\n\r\nSelf-hosted\r\n\r\n### Datasource(s)?\r\n\r\nAll of them","labels":["needs more info","area/provisioning"]},{"id":63075,"title":"Fieldname \"Time\" should not changed in 9.4.0beta-1","body":"In 9.2.x Time was written in upper case:\r\n![grafik](https://user-images.githubusercontent.com/79257887/217488687-a4a959cc-63e5-46ef-9783-4401bb20e78e.png)\r\n![grafik](https://user-images.githubusercontent.com/79257887/217488782-c14e883e-a908-4d02-b88c-71726bc8c6b2.png)\r\n\r\nIn 9.3.x and above it is written in lower case: time\r\n\r\nWhy was this changed?\r\n","labels":["datasource/InfluxDB","area/panel/stat","area/panel/geomap","triage/needs-confirmation"]},{"id":71593,"title":"Alerting: The Alert list won't be refreshed automatically after upgrade to 10.0.2","body":"### What happened?\n\nThe Alert list won't be refreshed automatically after upgrade to 10.0.2\n\n### What did you expect to happen?\n\nshould be automatically refreshing the Alert list.\n\n### Did this work before?\n\nworking without issue on 10.0.1\n\n### How do we reproduce it?\n\n1.\r\n2.\r\n3.\r\n\n\n### Is the bug inside a dashboard panel?\n\nyes\n\n### Environment (with versions)?\n\nGrafana: 10.0.2\r\nOS: Debian 11 ARM64 on RaspberryPi 4\r\nBrowser: Chrome, FireFox\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\n_No response_","labels":["type/bug","area/alerting","area/frontend"]},{"id":64525,"title":"alert rules: UNIQUE constraint failed: dashboard.org_id, dashboard.folder_id, dashboard.title","body":"**What happened**:\r\nUpgrading from version 9.1.2 we tried to upgrade to the newest version of 9.4.3. This lead to the following error:\r\n\r\n```\r\nError: ✗ alert rules: UNIQUE constraint failed: dashboard.org_id, dashboard.folder_id, dashboard.title\r\n```\r\n\r\nThis happens during startup and terminates the process. It seems to happen while parsing the provisioned files (see below).\r\n\r\n**What you expected to happen**:\r\nProvisioned alert rules can be read without errors after upgrading,\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nWe've used a minimal Grafana `docker-compose.yml` setup:\r\n\r\n```yaml\r\nversion: '3'\r\n\r\nservices:\r\n  grafana:\r\n    image: grafana/grafana:9.1.2\r\n    ports:\r\n      - \"3000:3000\"\r\n    volumes:\r\n      - /srv/docker/grafana/:/var/lib/grafana\r\n      - ./grafana-config/:/etc/grafana/\r\n```\r\n\r\nWe provisioned a minimal `grafana-config/provisioning/alerting/rules.yml`:\r\n\r\n```yaml\r\napiVersion: 1\r\ngroups:\r\n  - orgId: 1\r\n    name: my_rule_group\r\n    folder: my_first_folder\r\n    interval: 60s\r\n    rules:\r\n      - uid: my_id_1\r\n        title: my_first_rule\r\n        condition: A\r\n        data:\r\n          - refId: A\r\n            datasourceUid: '__expr__'\r\n            model:\r\n              conditions:\r\n                - evaluator:\r\n                    params:\r\n                      - 3\r\n                    type: gt\r\n                  operator:\r\n                    type: and\r\n                  query:\r\n                    params:\r\n                      - A\r\n                  reducer:\r\n                    type: last\r\n                  type: query\r\n              datasource:\r\n                type: __expr__\r\n                uid: '__expr__'\r\n              expression: 1==0\r\n              intervalMs: 1000\r\n              maxDataPoints: 43200\r\n              refId: A\r\n              type: math\r\n        noDataState: Alerting\r\n        for: 60s\r\n```\r\nThis provisioned file is derived from the [documentations](https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/file-provisioning/#provision-alert-rules).\r\n\r\nStarting this instance leads to _no_ errors, as this works in Grafana 9.1.2 ✔️ .\r\n\r\nAfter stopping the container and upgrading the version from 9.1.2 to version 9.4.3 within the `docker-compose.yml` the following error occurred on `docker logs` (some debug logging was applied via `grafana.ini`) :x: :\r\n\r\n```\r\nlogger=provisioning.alerting t=2023-03-09T13:46:12.552109646Z level=debug msg=\"looking for alerting provisioning files\" path=/etc/grafana/provisioning/alerting\r\nlogger=provisioning.alerting t=2023-03-09T13:46:12.552183446Z level=debug msg=\"parsing alerting provisioning file\" path=/etc/grafana/provisioning/alerting file.Name=rules.yml\r\nlogger=provisioning.alerting t=2023-03-09T13:46:12.552635744Z level=info msg=\"starting to provision alerting\"\r\nlogger=provisioning.alerting t=2023-03-09T13:46:12.552660944Z level=debug msg=\"read all alerting files\" file_count=1\r\nError: ✗ alert rules: UNIQUE constraint failed: dashboard.org_id, dashboard.folder_id, dashboard.title\r\n```\r\n\r\nIt seems only to happen when the provisioned alert rule existed prior to the upgrade, and only when the folder (`my_first_folder` from above) contains an alert rule.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: Grafana Version 9.1.0 as Docker image (REPOSITORY: grafana/grafana, TAG 9.4.3, IMAGE ID: 944e84f25bc7)\r\n- OS Grafana is installed on: Docker image OS\r\n- Grafana plugins: none\r\n","labels":["type/bug","area/alerting","area/provisioning"]},{"id":59807,"title":"Some Panels Empty since 9.3.1 (Windows)","body":"**What happened**:\r\n\r\nAfter updating to 9.3.1 on Windows, some Table Panels appear empty, even there IS data behind\r\n\r\n**What you expected to happen**:\r\n\r\nTable with content\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\nUsing Table Panel 5.0 with MSSQL datasource\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.1\r\n- Data source type \u0026 version: MSSQL\r\n- OS Grafana is installed on: Windows Server 2019\r\n- User OS \u0026 Browser: Chrome\r\n- Grafana plugins: Table Panel v 5.0\r\n![Screenshot 2022-12-05 130241](https://user-images.githubusercontent.com/119508535/205632836-2778e986-4d0e-473a-8d14-abf812dc0378.png)\r\n\r\nas you can see, the table behind is empty, even tho there is data, no transformation or something applied","labels":["type/bug","area/panel/table","os/windows"]},{"id":56818,"title":"prometheus visual builder metric input is too slow","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nwe have 30000+ metrics, prometheus visual builder metric input is too show than code mode.\r\n\r\n**What you expected to happen**:\r\nbuilder mode as faster as code mode\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\u003cimg width=\"773\" alt=\"企业微信截图_20221013002339\" src=\"https://user-images.githubusercontent.com/983106/195397335-e0541866-d690-4c08-80c4-93daa0961ca6.png\"\u003e\r\n\u003cimg width=\"892\" alt=\"企业微信截图_20221013002407\" src=\"https://user-images.githubusercontent.com/983106/195397453-8e5ff6b4-19e1-4e09-b43d-3cde4a861f72.png\"\u003e\r\n![image](https://user-images.githubusercontent.com/983106/195398628-844467db-4351-4d22-a27c-52561c4cefa4.png)\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.1.17\r\n- Data source type \u0026 version:  prometheus\r\n- OS Grafana is installed on:  linux\r\n- User OS \u0026 Browser:  Microsoft Edge 106.0.1370.42\r\n- Grafana plugins:\r\n- Others:\r\n\r\n\r\n\nhttps://github.com/grafana/grafana/issues/56818#tasklist-block-4381cb48-1461-4965-971c-a869bec3c0de\n","labels":["datasource/Prometheus","stale","area/query-editor","kind/enhancement"]},{"id":60298,"title":"Sending two requests on every key stroke when changing the dashboard title","body":"**What happened**:\r\nLike said in title, when trying to create/update a dashboard, while changing the dashboard title on every key stroke, there two requests to check if there is a dashboard or folder with such name... \r\n\r\n![image](https://user-images.githubusercontent.com/23135339/207578273-9a8c4549-e2f3-42b7-b717-b0c0c7456036.png)\r\n\r\n**What you expected to happen**:\r\nUse a debounce\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.0\r\n- Data source type \u0026 version: N/A\r\n- OS Grafana is installed on: *\r\n- User OS \u0026 Browser: *\r\n- Grafana plugins: N/A\r\n- Others: N/A\r\n","labels":["type/bug","area/dashboard","help wanted","good first issue"]},{"id":73768,"title":"Expressions: return more than one frame result for a binary operator","body":"### What happened?\r\n\r\n[Screencast from 24.08.2023 17:24:41.webm](https://github.com/grafana/grafana/assets/1415309/487afa55-2839-40b7-b751-8d8791a5da01)\r\n\r\n### What did you expect to happen?\r\n\r\nExpression to return one frame. Having more similar queries added in expression result to amount of frames returned growing exponentially, that breaks Grafana backend. Computing this way one value from data from mixed datasources is impossible,\r\n\r\nFrames in response are following:\r\n`      \"TEST_EXPRESSION\": {\r\n        \"status\": 200,\r\n        \"frames\": [\r\n          {\r\n            \"schema\": {\r\n              \"refId\": \"TEST_EXPRESSION\",\r\n              \"meta\": {\r\n                \"type\": \"timeseries-multi\",\r\n                \"typeVersion\": [\r\n                  0,\r\n                  1\r\n                ]\r\n              },\r\n              \"fields\": [\r\n                {\r\n                  \"name\": \"Time\",\r\n                  \"type\": \"time\",\r\n                  \"typeInfo\": {\r\n                    \"frame\": \"time.Time\"\r\n                  }\r\n                },\r\n                {\r\n                  \"name\": \"TEST_EXPRESSION\",\r\n                  \"type\": \"number\",\r\n                  \"typeInfo\": {\r\n                    \"frame\": \"float64\",\r\n                    \"nullable\": true\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            \"data\": {\r\n              \"values\": [\r\n                [\r\n                  1692890100000,\r\n                  1692891000000\r\n                ],\r\n                [\r\n                  0,\r\n                  0\r\n                ]\r\n              ]\r\n            }\r\n          },\r\n          {\r\n            \"schema\": {\r\n              \"refId\": \"TEST_EXPRESSION\",\r\n              \"meta\": {\r\n                \"type\": \"timeseries-multi\",\r\n                \"typeVersion\": [\r\n                  0,\r\n                  1\r\n                ]\r\n              },\r\n              \"fields\": [\r\n                {\r\n                  \"name\": \"Time\",\r\n                  \"type\": \"time\",\r\n                  \"typeInfo\": {\r\n                    \"frame\": \"time.Time\"\r\n                  }\r\n                },\r\n                {\r\n                  \"name\": \"TEST_EXPRESSION\",\r\n                  \"type\": \"number\",\r\n                  \"typeInfo\": {\r\n                    \"frame\": \"float64\",\r\n                    \"nullable\": true\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            \"data\": {\r\n              \"values\": [\r\n                [\r\n                  1692891000000\r\n                ],\r\n                [\r\n                  0\r\n                ]\r\n              ]\r\n            }\r\n          },\r\n          {\r\n            \"schema\": {\r\n              \"refId\": \"TEST_EXPRESSION\",\r\n              \"meta\": {\r\n                \"type\": \"timeseries-multi\",\r\n                \"typeVersion\": [\r\n                  0,\r\n                  1\r\n                ]\r\n              },\r\n              \"fields\": [\r\n                {\r\n                  \"name\": \"Time\",\r\n                  \"type\": \"time\",\r\n                  \"typeInfo\": {\r\n                    \"frame\": \"time.Time\"\r\n                  }\r\n                },\r\n                {\r\n                  \"name\": \"TEST_EXPRESSION\",\r\n                  \"type\": \"number\",\r\n                  \"typeInfo\": {\r\n                    \"frame\": \"float64\",\r\n                    \"nullable\": true\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            \"data\": {\r\n              \"values\": [\r\n                [\r\n                  1692891000000\r\n                ],\r\n                [\r\n                  0\r\n                ]\r\n              ]\r\n            }\r\n          },\r\n          {\r\n            \"schema\": {\r\n              \"refId\": \"TEST_EXPRESSION\",\r\n              \"meta\": {\r\n                \"type\": \"timeseries-multi\",\r\n                \"typeVersion\": [\r\n                  0,\r\n                  1\r\n                ]\r\n              },\r\n              \"fields\": [\r\n                {\r\n                  \"name\": \"Time\",\r\n                  \"type\": \"time\",\r\n                  \"typeInfo\": {\r\n                    \"frame\": \"time.Time\"\r\n                  }\r\n                },\r\n                {\r\n                  \"name\": \"TEST_EXPRESSION\",\r\n                  \"type\": \"number\",\r\n                  \"typeInfo\": {\r\n                    \"frame\": \"float64\",\r\n                    \"nullable\": true\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            \"data\": {\r\n              \"values\": [\r\n                [\r\n                  1692891000000\r\n                ],\r\n                [\r\n                  0\r\n                ]\r\n              ]\r\n            }\r\n          }\r\n        ],\r\n        \"refId\": \"TEST_EXPRESSION\"\r\n      }` \r\n\r\n### Did this work before?\r\n\r\nN/A\r\n\r\n### How do we reproduce it?\r\n\r\n1. Create a query returning time series with one point (one date - one number)\r\n2. Create a simple math expression with comparison and refer to the query twice in it\r\n3. You get four data frame as results in response\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: Grafana v10.0.3 (eb8dd72637)\r\nOS: K8s\r\nBrowser: Chrome 115.0.5790.170\r\n\r\n\r\n### Grafana platform?\r\n\r\nKubernetes\r\n\r\n### Datasource(s)?\r\n\r\nElasticsearch","labels":["effort/large","area/expressions","triage/needs-confirmation"]},{"id":63484,"title":"Dashboard migration bug (from v8 to v9)","body":"**What happened**: \r\nDuring migration from version 8 (something) to version 9.3.6 dashboards using cloudwatch datasource were not properly migrated. \r\nOpening panel of migrated dashboard greets user with lack of queries. They are substituted with `Random Walk`.\r\n \r\n![image](https://user-images.githubusercontent.com/4123293/220315223-c387595c-3339-4737-81f1-ec003ed2aab3.png)\r\n\r\n**What you expected to happen**:\r\nSee all queries on migrated panels.\r\n\r\n**Anything else we need to know?**:\r\nLooks like migration incorrectly handles datasource references, quick JSON investigation revealed invalid datasource reference:\r\n![image](https://user-images.githubusercontent.com/4123293/220315737-7410c34d-40a5-4a47-a235-5efb87f5872d.png)\r\n\r\nChanging that to `\"datasource\" : \"cloudwatch\",` fixes issue, and panels contain queries once again.\r\n\r\nMy datasources are provisioned from file, and each has dedicated uid (in this case uid of data source is `cloudwatch`)\r\n\r\nEDIT:\r\n\r\nSame dashboard JSON fragment before migration:\r\n\r\n```json\r\n\"pluginVersion\": \"8.3.4\",\r\n      \"targets\": [\r\n        {\r\n          \"alias\": \"\",\r\n          \"datasource\": \"cloudwatch\",\r\n          \"dimensions\": {\r\n            \"DBInstanceIdentifier\": \"*\"\r\n          },\r\n          \"expression\": \"\",\r\n          \"highResolution\": false,\r\n          \"id\": \"\",\r\n          \"matchExact\": true,\r\n          \"metricEditorMode\": 0,\r\n          \"metricName\": \"BurstBalance\",\r\n          \"metricQueryType\": 0,\r\n          \"namespace\": \"AWS/RDS\",\r\n          \"period\": \"\",\r\n          \"queryMode\": \"Metrics\",\r\n          \"refId\": \"A\",\r\n          \"region\": \"us-east-1\",\r\n          \"returnData\": false,\r\n          \"sqlExpression\": \"SELECT MIN(BurstBalance) FROM \\\"AWS/RDS\\\" GROUP BY DBInstanceIdentifier\",\r\n          \"statistic\": \"Minimum\"\r\n        }\r\n      ],\r\n```\r\n\r\nEDIT 2:\r\nThis issue seems to not be limited to cloudwatch datasource. I just found panels with prometheus datasource suffering from same issue. \r\nSymptoms are the same:\r\n- before migration datasource is referenced via uid using `\"datasource\":\"\u003cDataSourceUID\u003e\"`\r\n- after migration datasource reference is off and has following format (example with datasource with `uid=prometheus`: \r\n```json\r\n\"datasource\": {\r\n            \"0\": \"p\",\r\n            \"1\": \"r\",\r\n            \"2\": \"o\",\r\n            \"3\": \"m\",\r\n            \"4\": \"e\",\r\n            \"5\": \"t\",\r\n            \"6\": \"h\",\r\n            \"7\": \"e\",\r\n            \"8\": \"u\",\r\n            \"9\": \"s\"\r\n          },\r\n```","labels":["area/dashboard","needs more info","needs investigation"]},{"id":78991,"title":"Config from query results \u0026 Ymax Variable","body":"### What happened?\n\nWITH FundTotalReturns AS (\r\n    SELECT\r\n        'edgehill' AS fund_name,\r\n        EXP(SUM(LN(1 + \"Daily PnL\")) OVER (ORDER BY \"Date\" ASC)) - 1 AS \"Total Return\"\r\n    FROM\r\n        \"edgehill_daily_data\"\r\n    WHERE 'edgehill' IN (${fund}) \r\n      AND extract(epoch from \"Date\") BETWEEN ${__from:date:seconds} AND ${__to:date:seconds}\r\n    UNION ALL\r\n    SELECT\r\n        'tagus' AS fund_name,\r\n        EXP(SUM(LN(1 + \"Daily PnL\")) OVER (ORDER BY \"Date\" ASC)) - 1 AS \"Total Return\"\r\n    FROM\r\n        \"tagus_daily_data\"\r\n    WHERE 'tagus' IN (${fund}) \r\n      AND extract(epoch from \"Date\") BETWEEN ${__from:date:seconds} AND ${__to:date:seconds}\r\n)\r\nSELECT\r\n    MAX(\"Total Return\") AS \"Global Max Total Return\",\r\n    MIN(\"Total Return\") AS \"Global Min Total Return\"\r\nFROM FundTotalReturns;\n\n### What did you expect to happen?\n\nI have the following sql code above where im looking to query the global max return of selected funds.\r\nI am using repeated rows and I have a mutli select variable called ${fund} where I have several funds liked edgehill and tagus.\r\nMy goal is simple, the ymax should be determined based on the selected funds. For example, if i select only tagus, the ymax is based off the tagus data only. If i select only edgehill, the ymax is based off the edgehill data only. However, if i select both tagus and edgehill, the ymax is based off the edgehill and tagus data. \n\n### Did this work before?\n\nYes, the code above works but there is only 1 problem. If I select only tagus or edgehill, it still gives me the ymax as if ive chose both. So its not really dynamic.\n\n### How do we reproduce it?\n\nN/A\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana:\r\nOS:\r\nBrowser:\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["area/dashboard/templating","bot/no new info","triage/needs-confirmation"]},{"id":80860,"title":"Updating from 9.2.1 to 10.2.3 results in \"Dashboard init failed\"","body":"### What happened?\r\n\r\nI have grafana with ~5 dashboards. when upgrading my 9.2.1 install to the most recent available on debian repos, 10.2.3, pulling up my main dashboard results in a blank page and the message \"dashboard init failed\". I've attached the errors that result in chrome's dev console. The other dashboards work. It is just this main \"overview\" dashboard. I have attached an export of this dashboard as well. Note that this dashboard previously caused problems due to trying to create a library panel from a panel on this overview dashboard, but that was patched. That ticket here - https://github.com/grafana/grafana/issues/48156 - I am wondering if I'm hitting an edge case bug because of some cursed code still on this panel from a broken library panel creation attempt? The full log is attached, but here's the summary:\r\n\r\n```\r\ninitDashboard.ts:202 TypeError: Cannot read properties of null (reading 'y')\r\n    at DashboardModel.ts:575:47\r\n    at Array.sort (\u003canonymous\u003e)\r\n    at V.sortPanelsByGridPos (DashboardModel.ts:574:17)\r\n    at new V (DashboardModel.ts:198:10)\r\n    at initDashboard.ts:199:19\r\n```\r\n\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.2.3\r\nOS: Windows 10 x64\r\nBrowser: Chrome, Firefox, Edge\r\n\r\n\r\n### Grafana platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)","labels":["area/dashboard","triage/needs-confirmation","team/grafana-dashboards"]},{"id":65005,"title":"Alerting: Permissions needed: users:read","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: When i tried to create an alert on save or on cancel i got this\r\nYou'll need additional permissions to perform this action. Permissions needed: users:read\r\nMy role is admin and login is performed via azure_auth\r\nI tried the same with admin account and i'ts working good\r\nThis started to happend after upgrade from 9.2.2 to 9.4.3\r\nI noticed that in console there is a call to /api/users/32 (not sure what 32 means i assume that is user id) with 403 error code   \r\n\r\n**What you expected to happen**:\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: Try to create a new alert and click save\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**: AKS (grafana official helm chart)\r\n- Grafana version: 9.4.3\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/auth","area/alerting","area/frontend"]},{"id":60807,"title":"Grafana managed alerts are not delivered to Mimir Alertmanager in multi-tenant mode","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif \r\n--\u003e\r\n\r\n**What happened**: \r\nGrafana Managed alerts are not delivered to Mimir Alertmanager. We have enabled Grafana Unified alerting and configured a Grafana managed alert.\r\nThe admin page of the Grafana managed is configured to send alerts to external Alertmanager, in our case it is Mimir Alertmanager and multi-tenancy is enabled.\r\nAlertmanager data source implementation is selected as Mimir, the health check of the data source is fine, we are able to configure  contact points and notifications policy and it’s getting uploaded to the respective tenants.\r\n\r\nUpon checking the Grafana logs we see Grafana is trying to do a POST request to Mimir Alertmanager on /api/v2/alerts and resulting in HTTP 404. \r\nWe further analysed and found the Mimir Alertmanager exposes the V2 api endpoints on /alertmanager/api/v2/alerts. So we need Grafana to include the /alertmanager to the URI when it’s trying to post the request to Mimir alertmanager.\r\n\r\nWe tried to include /alertmanager to the alertmanager url in the datasource configuration and upon saving changes we are getting warning stating “It looks like you have chosen a Mimir or Cortex implementation , but detected a Prometheus endpoint.Please update the implementation and try again”.\r\n\r\nThe change helps to include the /alertmanager to the URI but results in HTTP 401 as we suppose http header is excluded in the POST request sent to Mimir alertmanager.\r\n\r\n**What you expected to happen**:\r\n\r\nGrafana managed alerts gets delivered to Mimir alertmanager on the correct endpoint.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nConfigure Mimir alertmanager as alertmanager datasource in Grafana with implementation selected to Mimir.\r\nEnable the Receive Grafana alerts options in the datasource.\r\nConfigure X-scope-orgid header\r\nDefine contact points and notification policy using Grafana UI.\r\nNavigate to admin page of alert rules and set the “Send alerts to” under External alertmanagers to Only External or Both.\r\nConfigure a Grafana alert and verify the logs of Grafana once the alert is moved to Firing state.\r\n\r\n**Anything else we need to know?**:\r\n\r\nWe went one step further and removed the tenancy and post which we see alerts are getting delivered to Alertmanager but it’s not following our tenant specific contact points and notification policies instead using the mimir fallback alertmanager configuration which is kind of expected.\r\n\r\nThe removal of tenancy also results in contact points and notification policies getting a JSON response instead of YAML configuration.\r\n\r\nWe had a discussion in Grafana Slack Mimir channel and the link to the discussion is as below https://grafana.slack.com/archives/C039863E8P7/p1671787647315839\r\n\r\nI’m unable to add screenshots please refer to support ticket 74646.\r\n\r\n**Environment**: \r\n- Grafana version:  9.3.1 (Enterprise)\r\n- Data source type \u0026 version: Alertmanager (Mimir) \u0026 2.5.0\r\n- OS Grafana is installed on: RedHat Linux 8 (UBI 8 image)\r\n- User OS \u0026 Browser: Chrome\r\n- Grafana plugins: N/A\r\n- Others: N/A\r\n","labels":["type/bug","area/alerting"]},{"id":72361,"title":"Alerting: Filter paused alerts in Alert Rules view","body":"### What happened?\r\n\r\nI have enabled Paused for some alerts.\r\nI have tried to filter the view to see only paused alerts and have not found an option to do so.\r\nSearching on github I have found some information that this is possible, yet I can not find information about how.\r\n(link to issue: https://github.com/grafana/grafana/issues/7400)\r\n\r\n### What did you expect to happen?\r\n\r\nbe able to filter alerts by status:paused\r\n(tried also isPaused:paused, isPaused:true)\r\n\r\n### Did this work before?\r\n\r\ndon't know\r\n\r\n### How do we reproduce it?\r\n\r\n1. create / edit any alert\r\n2. enable Paused in alert edit view\r\n3. try to filter by paused  (i suppose state:paused) in Alert Rule main view\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nno\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: v10.0.2 (b2bbe10fbc)\r\nOS: Ubuntu 22.04.2.LTS (installation) / Windows (UI)\r\nBrowser: Edge\r\n\r\n\r\n### Grafana platform?\r\n\r\nA downloaded binary\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["type/feature-request","area/alerting"]},{"id":61526,"title":"Data source plugin errors","body":"**What happened**:\r\nWhen following the tutorial for a data source plugin at: https://grafana.com/tutorials/build-a-data-source-plugin/ a few errors are generated due to some disparities in the text and what grafana requires.\r\n\r\nIssues found:\r\n1. DefaultQuery is expected to be \"defaultQuery\" in dataframes section 2 but is actually DEFAULT_QUERY in types.ts file.\r\n2. defaults is not imported by default so an additional line of \"import { defaults } from 'lodash';\" is required in datasource.ts\r\n3. When binding the model to a form \"query;\" is expected but \"this.props.query;\" is required.\r\n\r\n**Environment**:\r\n- Grafana version: v9.3.2\r\n","labels":["type/docs","area/plugins","onboarding"]},{"id":51097,"title":"Explore queries containing %-character redirect incorrectly on login-flow.","body":"**What happened**:\r\n\r\n**Example of working flow:**\r\nA1. Log in to grafana\r\nA2. Open url: `/explore?orgId=1\u0026left={\"datasource\":\"Loki\",\"queries\":[{\"refId\":\"A\",\"expr\":\"{job%3D\\\"test\\\"} | line_format \\\"{{printf \\\\\\\"%25-100s\\\\\\\" .message}}\\\"\",\"hide\":false}],\"range\":{\"from\":\"1655480401649\",\"to\":\"1655481610633\"}}`\r\nA3. Query is displayed correctly \r\n\r\n**Repeat same thing, with same url, but start as logged out:**\r\nB1. Log out from grafana \r\nB2. Open url: `/explore?orgId=1\u0026left={\"datasource\":\"Loki\",\"queries\":[{\"refId\":\"A\",\"expr\":\"{job%3D\\\"test\\\"} | line_format \\\"{{printf \\\\\\\"%25-100s\\\\\\\" .message}}\\\"\",\"hide\":false}],\"range\":{\"from\":\"1655480401649\",\"to\":\"1655481610633\"}}`\r\nB3. Log in when prompted\r\nB4. Grafana dos not display query correctly, instead it redirects to `/explore?orgId=1\u0026left={\"datasource\":\"-- Grafana --\",\"queries\":[{\"refId\":\"A\"}],\"range\":{\"from\":\"now-1h\",\"to\":\"now\"}}`\r\n\r\n\r\n**Anything else we need to know?**:\r\nIt appears that somewhere in the redirection flow, the `redirect_to`-cookie gets the uri-encoding wrong for the percentage-character (`%25` becomes plain `%`).\r\nQueries that don't contain a `%`-character don't have the problem described above.\r\n\r\n**Environment**:\r\n- Grafana version: 8.5.5\r\n- User OS \u0026 Browser: Firefox\r\n- Grafana plugins: Azure AD auth\r\n","labels":["type/bug","prio/low","area/auth/oauth","area/explore","team/identity-access"]},{"id":68488,"title":"Regression: Explore: Elastic: lots of [object Object] values when viewing Elastic logs in 9.5.1","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n  - When using Explore with the Log query selected, we see a large amount of records with values of [object Object]\r\n\r\n**What did you expect to happen**:\r\n\r\n  - Each field should be individually displayed\r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- With a ElasticDatasource, have a log which contains nested fields (which has been parsed)\r\n\r\nFor example\r\n\r\n```\r\n\"cloud\": {\r\n    \"project\": {\r\n        \"name\": \"project_1\"\r\n    },\r\n    \"region\": \"us-central1\",\r\n    \"service\": {\r\n        \"name\": \"cloud_function\"\r\n    }\r\n}\r\n```\r\n\r\n**Step 2**:\r\n\r\n- Search for this record in Explore (select Logs as query type)\r\n\r\n**Step 3**:\r\n\r\n- Expand the Log - the field is displayed as so\r\n\r\n\u003cimg width=\"547\" alt=\"Screenshot 2023-05-15 at 18 02 32\" src=\"https://github.com/grafana/grafana/assets/22872863/ac8ed909-8205-40c0-ae6c-53c047d2d0cb\"\u003e\r\n\r\nPreviously (in 9.4) it would be displayed as so \r\n\r\n\u003cimg width=\"431\" alt=\"Screenshot 2023-05-15 at 18 04 58\" src=\"https://github.com/grafana/grafana/assets/22872863/e66de93b-3c02-48f5-a05b-2bc5e2d43db8\"\u003e\r\n\r\n\n\n### \n# What Grafana version are you using?\n\n\nGrafana v9.5.1 (bc353e4b2d)\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nKubernetes\n\n### User's OS?\n\nMacOS 13.2.1\n\n### User's Browser?\n\nChrome 113\n\n### Is this a Regression?\n\nNo\n\n### Are Datasources involved?\n\nElasticsearch \n\n### Anything else to add?\n\n\n_No response_","labels":["datasource/Elasticsearch","area/explore","bot/no new info","type/regression","area/logs"]},{"id":59805,"title":"Repeated library panels showing only after refresh, not on first load","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWhen I open a dashboard that\r\n- contains a libarary panel that is\r\n- set to repeat on a variable\r\n\r\nonly the first instance of the dashboard is displayed.\r\nWhen I manually click the refresh button inside Grafana (_not_ of the browser), the second instance appears.\r\n\r\nIn this GIF, the left panel is a non-library panel, the right panel is a libarary panel, both with mostly the same queries and settings behind them:\r\n\r\nhttps://user-images.githubusercontent.com/2277681/205628932-dff2d770-57a2-44bc-bdfd-98c91efd5237.mp4\r\n\r\nWhen I unlink that panel, it works expected immediately.\r\nWhen I replace it by a (newly created) library panel, it stops working again.\r\n\r\n\r\n**What you expected to happen**:\r\nThe second instance of the repeated panel should display on first load.\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nWorking as expected (two panels with title \"0\" and \"1\" are showing immediately):\r\n\r\n````json\r\n{\r\n  \"__inputs\": [\r\n    {\r\n      \"name\": \"DS_INFLUXDB\",\r\n      \"label\": \"InfluxDB\",\r\n      \"description\": \"\",\r\n      \"type\": \"datasource\",\r\n      \"pluginId\": \"influxdb\",\r\n      \"pluginName\": \"InfluxDB\"\r\n    }\r\n  ],\r\n  \"__elements\": {},\r\n  \"__requires\": [\r\n    {\r\n      \"type\": \"panel\",\r\n      \"id\": \"gauge\",\r\n      \"name\": \"Gauge\",\r\n      \"version\": \"\"\r\n    },\r\n    {\r\n      \"type\": \"grafana\",\r\n      \"id\": \"grafana\",\r\n      \"name\": \"Grafana\",\r\n      \"version\": \"9.3.1\"\r\n    },\r\n    {\r\n      \"type\": \"datasource\",\r\n      \"id\": \"influxdb\",\r\n      \"name\": \"InfluxDB\",\r\n      \"version\": \"1.0.0\"\r\n    }\r\n  ],\r\n  \"annotations\": {\r\n    \"list\": [\r\n      {\r\n        \"builtIn\": 1,\r\n        \"datasource\": {\r\n          \"type\": \"grafana\",\r\n          \"uid\": \"-- Grafana --\"\r\n        },\r\n        \"enable\": true,\r\n        \"hide\": true,\r\n        \"iconColor\": \"rgba(0, 211, 255, 1)\",\r\n        \"name\": \"Annotations \u0026 Alerts\",\r\n        \"target\": {\r\n          \"limit\": 100,\r\n          \"matchAny\": false,\r\n          \"tags\": [],\r\n          \"type\": \"dashboard\"\r\n        },\r\n        \"type\": \"dashboard\"\r\n      }\r\n    ]\r\n  },\r\n  \"editable\": true,\r\n  \"fiscalYearStartMonth\": 0,\r\n  \"graphTooltip\": 0,\r\n  \"id\": null,\r\n  \"links\": [],\r\n  \"liveNow\": false,\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"influxdb\",\r\n        \"uid\": \"${DS_INFLUXDB}\"\r\n      },\r\n      \"description\": \"\",\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"thresholds\"\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 9,\r\n        \"w\": 12,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"orientation\": \"auto\",\r\n        \"reduceOptions\": {\r\n          \"calcs\": [\r\n            \"lastNotNull\"\r\n          ],\r\n          \"fields\": \"\",\r\n          \"values\": false\r\n        },\r\n        \"showThresholdLabels\": false,\r\n        \"showThresholdMarkers\": true\r\n      },\r\n      \"pluginVersion\": \"9.3.1\",\r\n      \"repeat\": \"query0\",\r\n      \"repeatDirection\": \"v\",\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"influxdb\",\r\n            \"uid\": \"${DS_INFLUXDB}\"\r\n          },\r\n          \"query\": \"\",\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"$query0\",\r\n      \"type\": \"gauge\"\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"style\": \"dark\",\r\n  \"tags\": [],\r\n  \"templating\": {\r\n    \"list\": [\r\n      {\r\n        \"current\": {\r\n          \"selected\": true,\r\n          \"text\": [\r\n            \"0\",\r\n            \"1\"\r\n          ],\r\n          \"value\": [\r\n            \"0\",\r\n            \"1\"\r\n          ]\r\n        },\r\n        \"hide\": 0,\r\n        \"includeAll\": false,\r\n        \"multi\": true,\r\n        \"name\": \"query0\",\r\n        \"options\": [\r\n          {\r\n            \"selected\": true,\r\n            \"text\": \"0\",\r\n            \"value\": \"0\"\r\n          },\r\n          {\r\n            \"selected\": true,\r\n            \"text\": \"1\",\r\n            \"value\": \"1\"\r\n          }\r\n        ],\r\n        \"query\": \"0,1\",\r\n        \"queryValue\": \"\",\r\n        \"skipUrlSync\": false,\r\n        \"type\": \"custom\"\r\n      }\r\n    ]\r\n  },\r\n  \"time\": {\r\n    \"from\": \"now-6h\",\r\n    \"to\": \"now\"\r\n  },\r\n  \"timepicker\": {},\r\n  \"timezone\": \"\",\r\n  \"title\": \"New dashboard\",\r\n  \"uid\": \"PNF4_aKVk\",\r\n  \"version\": 9,\r\n  \"weekStart\": \"\"\r\n}\r\n````\r\n\r\nNot working as expected (even refresh doesn't work, you have to unselect one of the two values and reselect it again to get both showing):\r\n\r\n````json\r\n{\r\n  \"__inputs\": [],\r\n  \"__elements\": {\r\n    \"FeB1_aFVk\": {\r\n      \"name\": \"$query0 v2\",\r\n      \"uid\": \"FeB1_aFVk\",\r\n      \"kind\": 1,\r\n      \"model\": {\r\n        \"type\": \"gauge\",\r\n        \"title\": \"$query0\",\r\n        \"scopedVars\": {\r\n          \"query0\": {\r\n            \"selected\": true,\r\n            \"text\": \"0\",\r\n            \"value\": \"0\"\r\n          }\r\n        },\r\n        \"repeat\": \"query0\",\r\n        \"repeatDirection\": \"v\",\r\n        \"datasource\": {\r\n          \"type\": \"influxdb\",\r\n          \"uid\": \"-b7Thb27k\"\r\n        },\r\n        \"pluginVersion\": \"9.3.1\",\r\n        \"description\": \"\",\r\n        \"fieldConfig\": {\r\n          \"defaults\": {\r\n            \"color\": {\r\n              \"mode\": \"thresholds\"\r\n            },\r\n            \"mappings\": [],\r\n            \"thresholds\": {\r\n              \"mode\": \"absolute\",\r\n              \"steps\": [\r\n                {\r\n                  \"color\": \"green\",\r\n                  \"value\": null\r\n                },\r\n                {\r\n                  \"color\": \"red\",\r\n                  \"value\": 80\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          \"overrides\": []\r\n        },\r\n        \"options\": {\r\n          \"orientation\": \"auto\",\r\n          \"reduceOptions\": {\r\n            \"calcs\": [\r\n              \"lastNotNull\"\r\n            ],\r\n            \"fields\": \"\",\r\n            \"values\": false\r\n          },\r\n          \"showThresholdLabels\": false,\r\n          \"showThresholdMarkers\": true\r\n        },\r\n        \"targets\": [\r\n          {\r\n            \"datasource\": {\r\n              \"type\": \"influxdb\",\r\n              \"uid\": \"-b7Thb27k\"\r\n            },\r\n            \"query\": \"\",\r\n            \"refId\": \"A\"\r\n          }\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  \"__requires\": [\r\n    {\r\n      \"type\": \"grafana\",\r\n      \"id\": \"grafana\",\r\n      \"name\": \"Grafana\",\r\n      \"version\": \"9.3.1\"\r\n    }\r\n  ],\r\n  \"annotations\": {\r\n    \"list\": [\r\n      {\r\n        \"builtIn\": 1,\r\n        \"datasource\": {\r\n          \"type\": \"grafana\",\r\n          \"uid\": \"-- Grafana --\"\r\n        },\r\n        \"enable\": true,\r\n        \"hide\": true,\r\n        \"iconColor\": \"rgba(0, 211, 255, 1)\",\r\n        \"name\": \"Annotations \u0026 Alerts\",\r\n        \"target\": {\r\n          \"limit\": 100,\r\n          \"matchAny\": false,\r\n          \"tags\": [],\r\n          \"type\": \"dashboard\"\r\n        },\r\n        \"type\": \"dashboard\"\r\n      }\r\n    ]\r\n  },\r\n  \"editable\": true,\r\n  \"fiscalYearStartMonth\": 0,\r\n  \"graphTooltip\": 0,\r\n  \"id\": null,\r\n  \"links\": [],\r\n  \"liveNow\": false,\r\n  \"panels\": [\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 9,\r\n        \"w\": 12,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"libraryPanel\": {\r\n        \"uid\": \"FeB1_aFVk\",\r\n        \"name\": \"$query0 v2\"\r\n      }\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"style\": \"dark\",\r\n  \"tags\": [],\r\n  \"templating\": {\r\n    \"list\": [\r\n      {\r\n        \"current\": {\r\n          \"selected\": true,\r\n          \"text\": [\r\n            \"0\",\r\n            \"1\"\r\n          ],\r\n          \"value\": [\r\n            \"0\",\r\n            \"1\"\r\n          ]\r\n        },\r\n        \"hide\": 0,\r\n        \"includeAll\": false,\r\n        \"multi\": true,\r\n        \"name\": \"query0\",\r\n        \"options\": [\r\n          {\r\n            \"selected\": true,\r\n            \"text\": \"0\",\r\n            \"value\": \"0\"\r\n          },\r\n          {\r\n            \"selected\": true,\r\n            \"text\": \"1\",\r\n            \"value\": \"1\"\r\n          }\r\n        ],\r\n        \"query\": \"0,1\",\r\n        \"queryValue\": \"\",\r\n        \"skipUrlSync\": false,\r\n        \"type\": \"custom\"\r\n      }\r\n    ]\r\n  },\r\n  \"time\": {\r\n    \"from\": \"now-6h\",\r\n    \"to\": \"now\"\r\n  },\r\n  \"timepicker\": {},\r\n  \"timezone\": \"\",\r\n  \"title\": \"New dashboard\",\r\n  \"uid\": \"PNF4_aKVk\",\r\n  \"version\": 8,\r\n  \"weekStart\": \"\"\r\n}\r\n````\r\n\r\n\r\n**Anything else we need to know?**:\r\nCrocodiles cannot stick their tongue out.\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.1 (updated from 8.5.2, worked there)\r\n- Data source type \u0026 version: InfluxDB 2.1\r\n- OS Grafana is installed on: Ubuntu 20.04/Docker\r\n- User OS \u0026 Browser: Win 11, Chrome \u0026 Edge; FullPageOS, Chrome\r\n- Grafana plugins: -\r\n- Others:\r\n","labels":["type/bug","area/frontend/library-panels","type/regression","team/grafana-dashboards","prio/future"]},{"id":59350,"title":"Hover panels overlap useful content in mobile browsers","body":"The panels that are supposed to appear on mouse hover in desktop browsers, when on mobile, appear on tap.\r\n\r\n![image](https://user-images.githubusercontent.com/4903007/204122449-493daa21-c3da-4e65-af20-cfb708b4480f.png)\r\n\r\n![image](https://user-images.githubusercontent.com/4903007/204122438-66a480c2-2ad9-4265-84ce-0957e5c2f7a9.png)\r\n\r\nAfter appearing, they overlap controls underneath and do not allow to use them. Thus, it is very tricky to tap on the date picker or magnifying glass on the first screenshot and it is an annoyance on the second screenshot.\r\n\r\n**Expected behaviour:**\r\nDisable hover panels on mobile version, as there is no hover event.\r\n\r\n**Environment**:\r\n- Grafana version: Cloud\r\n- User OS \u0026 Browser: iOS 16.1.1 \u0026 Chrome 107.0.5304.101\r\n- Device: iPhone SE 2020\r\n- View port size: 375px × 667px\r\n\r\nPlease note that the issue is not reproducible in Desktop Chrome with dev tools, the hover panel does not appear on tap.","labels":["type/bug","area/mobile-support","timepicker"]},{"id":73795,"title":"Time series: y-axis becomes NaN for close values with hh:mm:ss","body":"### What happened?\n\nThe Y-axis is displayed as NaN if the unit is set to \"Duration hh:mm:ss\" and the values are close to each other.\r\n![image](https://github.com/grafana/grafana/assets/10489458/c2ee95dc-93f2-4d8f-bb88-77b560803519)\r\n\r\n\n\n### What did you expect to happen?\n\nAll values are valid and the axis should be able to be displayed. \r\nWhich works if the panel is small enough \r\n![image](https://github.com/grafana/grafana/assets/10489458/979b48ff-3020-4a87-9310-1f44ed98637b)\r\n\n\n### Did this work before?\n\nI do not know\n\n### How do we reproduce it?\n\n1) Dashboard with timeseries\r\n2) Data e.g.\r\n```\r\nTime: 25.08.2023 00:00:00\r\nValue: 20\r\nTime: 25.08.2023 00:01:00\r\nValue: 24\r\n```\r\n3) Set Unit to duration \"hh:mm:ss\"\r\n\r\nIf the window is now large enough that more subdivisions than 5 are displayed on the Y-Axe, Grafana fails and displays NaN.\r\n\r\nCause: between the values 00:00:20 and 00:00:24 there are only 5 values, if the panel is big enough Grafana tries to display more than 5 subdivisions on the Y-Axe.\r\nBut this is not possible with the unit hh:mm:ss. There are only 5.\n\n### Is the bug inside a dashboard panel?\n\n| Key | Value |\r\n|--|--|\r\n| Panel | timeseries @ 10.0.3 |\r\n| Grafana | 10.0.3 (eb8dd72637) // Open Source |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"type\": \"timeseries\",\r\n      \"title\": \"Reproduced with embedded data\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"id\": 2,\r\n      \"targets\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"grafana\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"snapshot\",\r\n          \"snapshot\": [\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"meta\": {\r\n                  \"typeVersion\": [\r\n                    0,\r\n                    0\r\n                  ],\r\n                  \"executedQueryString\": \"SELECT TOP(50) timestamp, metric FROM Grafana_Test.dbo.Table_1 \"\r\n                },\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"timestamp\",\r\n                    \"type\": \"time\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"time.Time\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"metric\",\r\n                    \"type\": \"number\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"float64\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    1692914400000,\r\n                    1692914460000\r\n                  ],\r\n                  [\r\n                    20,\r\n                    24\r\n                  ]\r\n                ]\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"custom\": {\r\n            \"drawStyle\": \"line\",\r\n            \"lineInterpolation\": \"linear\",\r\n            \"barAlignment\": 0,\r\n            \"lineWidth\": 1,\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"spanNulls\": false,\r\n            \"showPoints\": \"auto\",\r\n            \"pointSize\": 5,\r\n            \"stacking\": {\r\n              \"mode\": \"none\",\r\n              \"group\": \"A\"\r\n            },\r\n            \"axisPlacement\": \"auto\",\r\n            \"axisLabel\": \"\",\r\n            \"axisColorMode\": \"text\",\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"axisCenteredZero\": false,\r\n            \"hideFrom\": {\r\n              \"tooltip\": false,\r\n              \"viz\": false,\r\n              \"legend\": false\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"value\": null,\r\n                \"color\": \"green\"\r\n              },\r\n              {\r\n                \"value\": 80,\r\n                \"color\": \"red\"\r\n              }\r\n            ]\r\n          },\r\n          \"unit\": \"dthms\"\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"pluginVersion\": \"10.0.3\",\r\n      \"options\": {\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        },\r\n        \"legend\": {\r\n          \"showLegend\": true,\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"calcs\": []\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003etimeseries @ 10.0.3\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003eA[mssql]\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003e 1 frames, 2 fields, 2 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e10.0.3 (eb8dd72637) // Open Source\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"title\": \"Original Panel JSON\",\r\n      \"type\": \"text\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 7\r\n      },\r\n      \"options\": {\r\n        \"content\": \"{\\n  \\\"type\\\": \\\"timeseries\\\",\\n  \\\"title\\\": \\\"Panel Title\\\",\\n  \\\"gridPos\\\": {\\n    \\\"x\\\": 0,\\n    \\\"y\\\": 0,\\n    \\\"w\\\": 12,\\n    \\\"h\\\": 8\\n  },\\n  \\\"datasource\\\": {\\n    \\\"uid\\\": \\\"03uaxhBGz\\\",\\n    \\\"type\\\": \\\"mssql\\\"\\n  },\\n  \\\"id\\\": 1,\\n  \\\"targets\\\": [\\n    {\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"mssql\\\",\\n        \\\"uid\\\": \\\"03uaxhBGz\\\"\\n      },\\n      \\\"refId\\\": \\\"A\\\",\\n      \\\"format\\\": \\\"table\\\",\\n      \\\"rawSql\\\": \\\"SELECT TOP(50) timestamp, metric FROM Grafana_Test.dbo.Table_1 \\\",\\n      \\\"editorMode\\\": \\\"builder\\\",\\n      \\\"sql\\\": {\\n        \\\"columns\\\": [\\n          {\\n            \\\"type\\\": \\\"function\\\",\\n            \\\"parameters\\\": [\\n              {\\n                \\\"type\\\": \\\"functionParameter\\\",\\n                \\\"name\\\": \\\"timestamp\\\"\\n              }\\n            ]\\n          },\\n          {\\n            \\\"type\\\": \\\"function\\\",\\n            \\\"parameters\\\": [\\n              {\\n                \\\"type\\\": \\\"functionParameter\\\",\\n                \\\"name\\\": \\\"metric\\\"\\n              }\\n            ]\\n          }\\n        ],\\n        \\\"groupBy\\\": [\\n          {\\n            \\\"type\\\": \\\"groupBy\\\",\\n            \\\"property\\\": {\\n              \\\"type\\\": \\\"string\\\"\\n            }\\n          }\\n        ],\\n        \\\"limit\\\": 50\\n      },\\n      \\\"dataset\\\": \\\"Grafana_Test\\\",\\n      \\\"table\\\": \\\"dbo.Table_1\\\"\\n    }\\n  ],\\n  \\\"fieldConfig\\\": {\\n    \\\"defaults\\\": {\\n      \\\"custom\\\": {\\n        \\\"drawStyle\\\": \\\"line\\\",\\n        \\\"lineInterpolation\\\": \\\"linear\\\",\\n        \\\"barAlignment\\\": 0,\\n        \\\"lineWidth\\\": 1,\\n        \\\"fillOpacity\\\": 0,\\n        \\\"gradientMode\\\": \\\"none\\\",\\n        \\\"spanNulls\\\": false,\\n        \\\"showPoints\\\": \\\"auto\\\",\\n        \\\"pointSize\\\": 5,\\n        \\\"stacking\\\": {\\n          \\\"mode\\\": \\\"none\\\",\\n          \\\"group\\\": \\\"A\\\"\\n        },\\n        \\\"axisPlacement\\\": \\\"auto\\\",\\n        \\\"axisLabel\\\": \\\"\\\",\\n        \\\"axisColorMode\\\": \\\"text\\\",\\n        \\\"scaleDistribution\\\": {\\n          \\\"type\\\": \\\"linear\\\"\\n        },\\n        \\\"axisCenteredZero\\\": false,\\n        \\\"hideFrom\\\": {\\n          \\\"tooltip\\\": false,\\n          \\\"viz\\\": false,\\n          \\\"legend\\\": false\\n        },\\n        \\\"thresholdsStyle\\\": {\\n          \\\"mode\\\": \\\"off\\\"\\n        }\\n      },\\n      \\\"color\\\": {\\n        \\\"mode\\\": \\\"palette-classic\\\"\\n      },\\n      \\\"mappings\\\": [],\\n      \\\"thresholds\\\": {\\n        \\\"mode\\\": \\\"absolute\\\",\\n        \\\"steps\\\": [\\n          {\\n            \\\"value\\\": null,\\n            \\\"color\\\": \\\"green\\\"\\n          },\\n          {\\n            \\\"value\\\": 80,\\n            \\\"color\\\": \\\"red\\\"\\n          }\\n        ]\\n      },\\n      \\\"unit\\\": \\\"dthms\\\"\\n    },\\n    \\\"overrides\\\": []\\n  },\\n  \\\"pluginVersion\\\": \\\"10.0.3\\\",\\n  \\\"options\\\": {\\n    \\\"tooltip\\\": {\\n      \\\"mode\\\": \\\"single\\\",\\n      \\\"sort\\\": \\\"none\\\"\\n    },\\n    \\\"legend\\\": {\\n      \\\"showLegend\\\": true,\\n      \\\"displayMode\\\": \\\"list\\\",\\n      \\\"placement\\\": \\\"bottom\\\",\\n      \\\"calcs\\\": []\\n    }\\n  }\\n}\",\r\n        \"mode\": \"code\",\r\n        \"code\": {\r\n          \"language\": \"json\",\r\n          \"showLineNumbers\": true,\r\n          \"showMiniMap\": true\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: Panel Title // 24.08.2023 23:13:23\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-timeseries\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"2023-08-24T22:00:00.000Z\",\r\n    \"to\": \"2023-08-24T22:01:00.000Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\n\n### Environment (with versions)?\n\nGrafana: 10.0.3\r\nOS: Linux/Docker\r\nBrowser: Vivaldi\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\nAll","labels":["area/dashboard/timerange","area/panel/timeseries","triage/needs-confirmation"]},{"id":46301,"title":"Cannot create more than 1 api key","body":"**What happened**:\r\nWhen attempting to add a new API key, I receive `{\"message\":\"Failed to add API Key\"}` as the response instead of the new key. In the logs, there is: `t=xxx lvl=eror msg=\"Failed to add API Key\" logger=context userId=xxx orgId=xxx uname=\"xxx\" error=\"Error 1062: Duplicate entry '0' for key 'PRIMARY'\" remote_addr=xxx`. Deleting the existing key and adding a new one works -- I just can't have _more_ than one key at a time.\r\n\r\nComparing the behavior to a fresh copy of grafana running locally in docker and using the sqlite backend, I note that, while the single existing API key I have in the broken grafana has an ID of `0`, a new API key generated in the docker instance has an ID of `1` (and subsequent creations with IDs `2`, `3`, etc, work just fine). Not sure if that's relevant.\r\n\r\n**What you expected to happen**:\r\nA new API key!\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCannot reproduce outside of existing install yet.\r\n\r\n**Anything else we need to know?**:\r\nSeems like bad data somehow, but I have no idea how the DB got into this state.\r\n\r\n**Environment**:\r\n- Grafana version: `8.3.0`\r\n- Data source type \u0026 version: n/a\r\n- OS Grafana is installed on: linux\r\n- User OS \u0026 Browser: Chrome\r\n- Grafana plugins: n/a\r\n- Others: `mysql` backend\r\n","labels":["needs more info","area/backend/db/mysql"]},{"id":63645,"title":"Silence - alertname matcher requires trailing whitespace to match correctly","body":"**What happened**: I created a silence for a particular alert, whose name is \"critical system slow response times\", with the `alertname=\"critical system slow response times\"` label filter.\r\n\r\n**What you expected to happen**: The silence to match the aforementioned alert.  But it did not.  It only matched it when I changed the filter to be `alertname=\"critical system slow response times \"`.  I confirmed this happens with the regex operator (`~=`) as well.  I confirmed the actual alert does not have trailing whitespace.\r\n\r\n**Environment**:\r\n- Grafana version: v9.3.1 (89b365f8b1)\r\n","labels":["type/bug","area/alerting","area/alerting/notifications","area/frontend"]},{"id":55353,"title":"Grafana ES datasource issue when upgrading from v8 to v9.1.5","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI'm using this snippet to configure Grafana (NOT configure via UI) to connect ES, it is able to connect to ES without any issue in v8.3.5 but when I upgraded Grafana to v9.1.5 with the same snippet, it then unable to connect to ES, with this error \"Elasticsearch error: Authentication to data source failed\"\r\n```\r\n      - name: ES-SOC\r\n        type: elasticsearch\r\n        access: Server\r\n        url: https://es-soc-es-http.es-soc.svc.cluster.local:9200\r\n        basicAuth: true\r\n        basicAuthUser: ${username}\r\n        basicAuthPassword: ${password}\r\n        database: \".ds-metrics-rtarf-events-soc-*\"\r\n        jsonData:\r\n          interval: null\r\n          timeField: '@timestamp'\r\n          esVersion: '8.0.0'\r\n          tlsSkipVerify: true\r\n          tlsAuthWithCACert: false\r\n```\r\n![image](https://user-images.githubusercontent.com/28744323/190962707-7b3b10e1-a59b-45fd-b590-8b795fb0b826.png)\r\n\r\n**What you expected to happen**:\r\nAble to connect to ES as it was in v8.3.5\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: v9.1.5\r\n- Data source type \u0026 version: Elasticsearch\r\n- OS Grafana is installed on: Docker\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["needs more info","datasource/Elasticsearch","area/provisioning"]},{"id":63445,"title":"Alerting: every grafana instance generate an image","body":"**What happened**:\r\nSince the migration to unified alerting, the image renderer workload and the s3 storage consumption increased.\r\n\r\nI have 4 grafana instances, the unified alerting HA is correctly setup, only 1 servers sends the notification.\r\nBut it seems that every grafana instance tries to generate the image for the notification.\r\n\r\n\r\n**What you expected to happen**:\r\nOnly the instance that will send the notification should generate the image\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nhave several grafana instance with an image renderer.\r\nhave image rendering on notifications enable.\r\n\r\nTrigger an alert, you will see every grafana instance will try to render the image\r\n\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.10\r\n- OS Grafana is installed on: RHEL 8\r\n","labels":["area/alerting","area/image-rendering","bot/no new info"]},{"id":78650,"title":"Dashboards: Dashboard data source not available in mixed data source.","body":"### What happened?\n\nI am unable to select the dashboard from the list of data sources when using a mixed dource type.\n\n### What did you expect to happen?\n\nShouldn't it be an option?\n\n### Did this work before?\n\nNot sure\n\n### How do we reproduce it?\n\n1. Create a dashboard\r\n2. Add a panel\r\n3. Change query data source to be \"Mixed\"\r\n4. Select data source for query \"A\" and search for dashboard\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10\r\nOS: Windows\r\nBrowser: Firefox\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\n_No response_","labels":["area/datasource","area/datasource/frontend","triage/needs-confirmation"]},{"id":46393,"title":"When set Connect null values to always, the data is displayed abnormally","body":"When set Connect null values to always, the data is displayed abnormally.\r\nBefore\r\n![image](https://user-images.githubusercontent.com/58923704/157609265-782e743c-1595-4868-90c7-19186f3b79a9.png)\r\n\r\nAfter\r\n![image](https://user-images.githubusercontent.com/58923704/157609205-1f902839-b162-48dd-b677-1627bae0e628.png)\r\n","labels":["type/bug","area/frontend","area/panel/timeseries"]},{"id":59441,"title":"Config: Grafana fails to start if the working directory is not readable","body":"**What happened**:\r\n\r\nIf Grafana is started with the current working directory set to directory that the process does not have permission to access then it fails to start, yielding an error:\r\n\r\n```\r\npanic: error getting work directory: stat .: permission denied\r\n\r\ngoroutine 1 [running]:\r\ngithub.com/grafana/grafana/pkg/api/static.init.0()\r\n        github.com/grafana/grafana/pkg/api/static/static.go:38 +0x94\r\n```\r\n\r\nThis situation can occur, for instance, at system start-up time - see this bug for more context, although it may contain more gory FreeBSD details than one wants to see (and for full disclosure, there's arguably something fishy going on there resulting in Grafana running with a PWD of `/root` ... but generically running with a PWD that you don't have access to feels like a situation that could reasonably come up): https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=267914 .\r\n\r\nLooking at the code, https://github.com/grafana/grafana/blob/main/pkg/api/static/static.go#L38, it appears that the current working directory is stat'ed only for the purpose of resolving relative relative paths (at least in that module).\r\n\r\n**What you expected to happen**:\r\n\r\nIt feels like running from any working directory could be reasonable when all paths are absolutely specified. At least for the code linked above, this could be supported by checking whether the path is relative first, and only if it is stat'ing the working directory.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nRun Grafana from a directory that it cannot read. E.g. (see the bug above) if `/root` is owned `root:wheel`, permissions 0750, and the user `grafana` is not a member of wheel then\r\n```\r\ncd /root\r\nsu -m grafana -c '/usr/local/bin/grafana-server -config=/usr/local/etc/grafana/grafana.ini -homepath=/usr/local/share/grafana'\r\n```\r\nwill generate the error quoted above.\r\n\r\n\r\n**Environment**:\r\n- Grafana version: v 9.2.4\r\n- Data source type \u0026 version: n/a\r\n- OS Grafana is installed on: FreeBSD 13.1 (in a jail)\r\n- User OS \u0026 Browser: n/a\r\n- Grafana plugins: n/a\r\n- Others: n/a\r\n","labels":["area/backend","area/docker","stale","area/configuration","triage/needs-confirmation"]},{"id":76924,"title":"No more arm/v8 builds ?","body":"### What happened?\r\n\r\nlinux/arm/v8 docker builds are gone? Is it misstake or smth?\r\n\r\n![image](https://github.com/grafana/grafana/assets/13855710/8e42c722-8741-416a-b5c0-f13dbf7c1596)\r\n","labels":["type/build-packaging","area/docker","triage/needs-confirmation"]},{"id":45676,"title":"Grafana U.I freeze sometimes when select null value in variable drop-down","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nHello,\r\n\r\nI have a dashboard with a table panel and variables dynamically retrieve on PostgreSQL data source.\r\nThe table panel use  selected variable(s) on SQL query for show expected result.\r\nWhen I click on null value (empty) on the drop-down menu sometimes the U.I freeze, I can't unselected or click on other elements on the interface without reloading the dashboard.\r\nWhen the dashboard reload, the null value is unselected.\r\n\r\n**What you expected to happen**:\r\nGrafana U.I not freeze\r\n![image](https://user-images.githubusercontent.com/93267169/154972332-953f6f81-374b-4c5b-a202-f116a508f2ae.png)\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nVariable 'provider' query: ``` SELECT DISTINCT(provider) FROM public.my_table ```\r\nMulti-value: yes\r\n\r\nQuery table panel : \r\n```\r\nSELECT provider FROM public.my_table WHERE COALESCE(provider,'') IN ($provider)\r\n```\r\n**Anything else we need to know?**:\r\nOn the database, the table 'my_table' has less than 100 elements\r\n\r\n**Environment**:\r\n- Grafana OSS version: 8.1, 8.3.5, 8.4\r\n- Data source type \u0026 version: PostgreSQL 12+ (on PostgreSQL 13 backend)\r\n- OS Grafana is installed on: Bottlerocket OS on EKS (kube-prometheus-stack Helm chart)\r\n- User OS \u0026 Browser: tested on Firefox and Chrome\r\n","labels":["type/bug","area/dashboard/templating"]},{"id":84459,"title":"Influx datasource for user with viewer permission error","body":"### What happened?\r\n\r\nSince around 16h our influx 2.x datasource shows up a lot of errors.\r\nUsers with only viewer permission are not able to load data resulting in a data source error, while users with editor or admin permission everything still works fine.\r\n\r\nWe didn't change anything on our system\r\n\r\n### What did you expect to happen?\r\n\r\nDashboards with InfluxDB datasource also works for users with Viewer permission\r\n\r\n### Did this work before?\r\n\r\nYes before everything worked as expected\r\n\r\n### How do we reproduce it?\r\n\r\n1. Access a Dashboard with a user with viewer permission\r\n2. See error message: \"InfluxDB returned error:\"\r\n3.\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\nyes\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: Grafana v11.0.0-67977 (0e7c0d25fe)\r\nOS: Ubuntu 22.04\r\nBrowser: Firefox and Chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nI use Grafana Cloud\r\n\r\n### Datasource(s)?\r\n\r\nInfluxDB 2.7","labels":["datasource/InfluxDB","area/permissions","team/grafana-dashboards"]},{"id":61392,"title":"Public dashboards referencing other public dashboards shows unauthorised.","body":"We have been building dashboards internally and it seems that if you create a public dashboard as a 'landing page' that has a list of other public dashboards within a 'dashboard list' panel, the application returns unauthorised when accessing this externally or through a private browser.\r\n\r\nThe other 2 referenced dashboards are public and can be accessed externally, but when they are referenced within the dashboard list panel, the unauthorised banner appears.\r\n\r\n![image](https://user-images.githubusercontent.com/7142634/212093567-7bdb32b3-5de2-4049-96c9-0829b8d2cfc4.png)\r\n\r\nWe would expect this to not return unauthorised, but instead to allow a user to click into the 2 other public dashboards via the dashboard list panel.\r\n\r\nTested on firefox / ubuntu desktop. `Grafana v9.3.2 (21c1d14e91)`\r\n\r\n","labels":["area/panel/dashboard-list","area/public-dashboards","team/grafana-dashboards"]},{"id":64993,"title":"Expression not work well","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n-  I use influxdb source. \r\n- Query A, is integral(one influxdb measurement's field X) / float(v: \"${k}\") , k is grafana template variable, result is float type\r\n- Expression B, B=$A\r\n- if variable k is set a integer number( 1, 2 ,etc), it work well . if k is float ( any float num like 0.737), error happens.  server inner error 500\r\n- \r\n**What you expected to happen**:\r\nI think it should work on any Set value.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1- Query A\r\nfrom(bucket: \"Bucket_1\")\r\n      |\u003e range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n      |\u003e filter(fn: (r) =\u003e r[\"_measurement\"] == \"${measurement}\") \r\n      |\u003e filter(fn: (r) =\u003e r[\"_field\"] == \"Flow_Fuelconsump_ECU\")\r\n      |\u003e map(fn: (r) =\u003e ({r with _value: r._value / 3600.0/float(v: \"${FuelDensity}\")}))\r\n      |\u003e integral(unit: 1s)\r\n\r\n2- Expression B\r\nB = $A\r\n\r\n3 - If without B ,  it work well regardless  of  any  ${FuelDensity} .\r\n If with B,   {FuelDensity} must be a integer, it work well ,  if  ${FuelDensity} is  float number , All them not work\r\n\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**: CentOS 7.9\r\n- Grafana version: v 9.4.3\r\n- Data source type \u0026 version: v2.6.1\r\n- OS Grafana is installed on: ThinkPAD T470\r\n- User OS \u0026 Browser: Win11, Chrome\r\n- Grafana plugins:Gauge\r\n- Others:\r\n","labels":["datasource/InfluxDB","area/expressions","bot/no new info"]},{"id":80118,"title":"Transformations: Merge only 2 of 3 queries","body":"\u003c!-- Please only use this template for submitting feature requests --\u003e\r\n\r\n**Why is this needed**:\r\n\r\n[Add a description of the problem the feature is trying to solve.]\r\nI've got a graph with 3 queries:\r\n![image](https://github.com/grafana/grafana/assets/2401265/b69c9b87-2fb5-4442-a9e4-7f5bd1d36c02)\r\n\r\nI want to merge the last 2 queries.\r\nThe merge transformation merges *all* queries, which does not make much sense if different things are displayed:\r\n![image](https://github.com/grafana/grafana/assets/2401265/ce70f38f-a68c-4138-9529-0b8913a5760d)\r\n\r\nThere is a filter button, but I cannot select multiple queries:\r\n![image](https://github.com/grafana/grafana/assets/2401265/263fd13d-96c0-4c0a-90ca-611326e91a0a)\r\n\r\n\r\n**What would you like to be added**:\r\n\r\n* The filter button should be able to select multiple queries\r\n* *OR* some other mechanism to select N of M queries.\r\n\r\n\r\n**Who is this feature for?**\r\n\r\ngraph builder people.\r\n","labels":["area/transformations","triage/needs-confirmation"]},{"id":89188,"title":"Bar gauge visualization - Scrollbar hide values","body":"### What happened?\n\nBar gauge panels show scrollbars and hide partly the number.\r\n\r\n![grafana_bargauge](https://github.com/grafana/grafana/assets/72633075/4dcf04db-971c-4c33-a502-54cb08cba2b3)\r\n\r\n\n\n### What did you expect to happen?\n\nNot hide the numbers\n\n### Did this work before?\n\nYeah, on grafana 10.X this dont happen.\n\n### How do we reproduce it?\n\n1. Create panel\r\n2. Add bar gauge with horizontal orientation\r\n3. Most have some quantity of lines\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 11.0\r\nOS: Windows 10\r\nBrowser: Chrome 126\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\n_No response_","labels":["area/panel/bargauge"]},{"id":78743,"title":"Alerts: Unable to copy error message from tooltip","body":"### What happened?\r\n\r\nI wanted to google an error message that an alert query generated, but I was unable to copy the contents of the tooltip.\r\n\r\n![Screenshot 2023-11-28 at 15 04 55](https://github.com/grafana/grafana/assets/5144843/8e8ffec6-a4b1-4a67-8fb5-126e675fedc3)\r\n\r\n### What did you expect to happen?\r\n\r\nThe tooltip should stay open to allow me to copy the error message.\r\n\r\n### Did this work before?\r\n\r\nNo idea.\r\n\r\n### How do we reproduce it?\r\n\r\n1. Create a new alert\r\n2. Write some syntax errors\r\n3. Try to copy the content of the error popup/tooltip\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nNo\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.2.1\r\nOS: macOS 14\r\nBrowser: Edge\r\n\r\n\r\n### Grafana platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### Datasource(s)?\r\n\r\nLoki 2.9.2","labels":["type/bug","area/alerting","area/frontend"]},{"id":54016,"title":"Grafana problems deleting external alertmanager","body":"Hi , \r\n\r\nI have issues, when integrated external alertmanager with grafana and after that trying to delete it from UI , I get the following error:\r\n\r\n![image](https://user-images.githubusercontent.com/111745296/185903778-30b5df64-c787-4183-9ac5-afd444ae5287.png)\r\n\r\n![image](https://user-images.githubusercontent.com/111745296/185903835-7731ec53-3d7e-46f2-9487-339a2ae570ec.png)\r\n\r\n\r\nCan you help me figure this out ?","labels":["area/alerting","area/backend/db","bot/no new info"]},{"id":43957,"title":"User not able to see orgs when login back in Grafana ","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: We are using Grafana version 8+ (open source) where we have multiple users navigating through multiple orgs in grafana. But when the user logs out and log in back again, the user can only see default org all other are gone.\r\n\r\nfor example: if org 1 is default has one user has access to org2, org3 ,org4 and so on. now if user logs out or does not use grafana (automatically get logs out) . now if the user log in again he can only see org1 and all other orgs are gone. \r\n\r\neach time we have to add other orgs to user again\r\n\r\n**What you expected to happen**: user should be able to see same orgs when they log in back again , user access should persist\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: or example: if org 1 is default has one user has access to org2, org3 ,org4 and so on. now if user logs out or does not use grafana (automatically get logs out) . now if the user log in again he can only see org1 and all other orgs are gone. \r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8+\r\n- Data source type \u0026 version: NA\r\n- OS Grafana is installed on: Kubernetes 19+ (Alpine Linux)\r\n- User OS \u0026 Browser: Chrome (windows +Mac) \r\n- Grafana plugins: NA\r\n- Others:\r\n","labels":["needs more info","area/security","bot/no new info"]},{"id":64650,"title":"Grafana tries to automatically connect to Jaeger while using Helm Charts","body":"**What happened**:\r\nI had an install of grafana on my cluster. On that same namespace I installed Jaeger, note I did not in any way instruct grafana or jaeger to connect to eachother. And yet, grafana start crash looping with \r\n\r\n```\r\nlogger=settings t=2023-03-11T08:06:53.084719844Z level=warn msg=\"[Deprecated] the configuration setting 'tracing.jaeger' is deprecated, please use 'tracing.opentelemetry.jaeger' instead\"\r\nError: ✗ cannot obtain reporter config from env: cannot parse env var JAEGER_AGENT_PORT=udp://10.43.92.95:5775: strconv.ParseInt: parsing \"udp://10.43.92.95:5775\": invalid syntax\r\n```\r\n\r\n**What you expected to happen**:\r\nI expected grafana not to interfere with ANY other applications on the cluster/namespace by default unless specifically instructed to do so, the default settings shouldn't be \"if there is jaeger in this namespace hook it up\", thats reckless.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nInstall grafana and jaeger on the same namespace.\r\n\r\n**Anything else we need to know?**:\r\nI am very concerned by the fact that an application like Grafana starts to spontaneously break just because I installed something else, ideally I would have some network mesh to prevent this bs happening but frankly I have always had high expectations of Grafana and it surprised me that Grafana would even attempt such dodgy connection.\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.8\r\n- OS Grafana is installed on: Kubernetes / Ubuntu\r\n","labels":["type/bug","datasource/Jaeger","area/configuration"]},{"id":46806,"title":"utcOffsetSec is not consistently calculated when invoking /api/ds/query","body":"**What happened**:\r\nI am attempting to access a dashboard via a link, using `from` and `to` to specify the timerange in epoch ms, e.g. `...\u0026from=1647234000000\u0026to=1647666000000\u0026...`.  The dashboard is configured to use browser time, which in my case is `America/Chicago`.  When selecting a time range in the UI, I experience different results than when I access the dashboard via a link (this is also the case if I refresh the page after selecting a time range).  This appears to be attributable to the value of `utcOffsetSec` that's sent in the json payload to `/api/ds/query`.\r\n\r\nIn my specific case, I am executing a query with an interval (`minStep` in the UI) of `1d` and an end time at midnight (local), and am therefore expecting results to all be anchored to midnight as well.  This is the case when entering the time range in the UI, but when accessing via a link, the results are shifted by my time zone's UTC offset (Chicago, so currently -5 hrs, in my case)\r\n\r\n**What you expected to happen**:\r\nResults should be the same in either case (manually selecting time range or accessing via link)\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nSelect a time range in the UI.  Using query inspector, observe the time range and `utcOffsetSec` is equal to the utc offset corresponding to the dashboard settings (in my case, `-18000` for UTC-5).  Note that the results in my case are midnight aligned as expected (see specific use case above) in the local time zone (e.g. `1647666000000` == `March 19, 2022 12:00:00 AM [GMT-05:00]`)\r\n\r\n\u003cimg width=\"516\" alt=\"Screen Shot 2022-03-21 at 1 08 57 PM\" src=\"https://user-images.githubusercontent.com/529738/159340484-40495d97-b032-427d-80b6-df8f12ea10b8.png\"\u003e\r\n\u003cimg width=\"284\" alt=\"Screen Shot 2022-03-21 at 1 09 04 PM\" src=\"https://user-images.githubusercontent.com/529738/159340520-84af2f53-3505-4d21-aae1-82c4163060ff.png\"\u003e\r\n\r\nRefresh the page or copy the link and paste it in a new tab.  Now, `utcOffsetSec` is zero and the results are no longer midnight aligned (e.g. `1647648000000` == `Friday, March 18, 2022 7:00:00 PM [GMT-05:00]`)\r\n\r\n\u003cimg width=\"513\" alt=\"Screen Shot 2022-03-21 at 1 21 39 PM\" src=\"https://user-images.githubusercontent.com/529738/159340545-caecca74-c549-4ec5-a883-0e890be8c19a.png\"\u003e\r\n\u003cimg width=\"292\" alt=\"Screen Shot 2022-03-21 at 1 21 54 PM\" src=\"https://user-images.githubusercontent.com/529738/159340563-fc848265-2630-49b4-b8b5-71106ebffb34.png\"\u003e\r\n\r\n\r\nI have tested the request in postman and verified that changing `utcOffsetSec` results in the expected data.  Note that in either case, the time range appears correctly in the UI - it's only the data coming back that's incorrect.\r\n\r\n**Anything else we need to know?**:\r\n- This occurs whether the dashboard setting is default / browser / explicitly Chicago\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.4\r\n- Data source type \u0026 version: prometheus (plugin version 5.0.0, server version 2.2.1)\r\n- OS Grafana is installed on: Ubuntu\r\n- User OS \u0026 Browser: osx / chrome\r\n- Grafana plugins: prometheus\r\n- Others:\r\n","labels":["type/bug","area/dashboard/timerange","stale"]},{"id":67343,"title":"Root policy editing's permission needs to be well controlled","body":"## What happened:\r\nsome user with editor role  changes the root policy, this triggers the firing alert to send alert again\r\n\r\n## What you expected to happen:\r\nRoot policy editing's permission needs to be well controlled\r\n\r\n## How to reproduce it (as minimally and precisely as possible):\r\nlogin as an editor, go to alert tab and edit root policy in notification policy tab\r\n\r\n## Anything else we need to know?:\r\nNA\r\n\r\n## Environment:\r\n- Grafana version: 9.4.7\r\n- Data source type \u0026 version:  NA\r\n- OS Grafana is installed on: centos8\r\n- User OS \u0026 Browser: chrome\r\n- Grafana plugins: NA\r\n- Others: NA\r\n","labels":["area/alerting","area/auth/rbac"]},{"id":44381,"title":"$__rate_interval problem breaks Node Exporter Full, second most popular dashboard","body":"**What happened**:\r\nThe very popular Node Exporter Full dashboard was broken by a recent Grafana upgrade (last month)\r\nhttps://grafana.com/grafana/dashboards/1860\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nImport the 1860 dashboard and you'll see errors\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.4\r\n- Data source type \u0026 version: Prometheus 2.15.2\r\n- OS Grafana is installed on: Ubuntu 20.04\r\n- User OS \u0026 Browser: Windows 10, Chrome\r\n\r\n![1](https://user-images.githubusercontent.com/3753822/150796557-5166c4b3-487d-4a36-8038-5f47579be0f6.png)\r\n![2](https://user-images.githubusercontent.com/3753822/150796574-e95ce042-ca8a-47a1-bcc3-78ebf5398cba.png)\r\n","labels":["datasource/Prometheus","area/frontend"]},{"id":70902,"title":"Transform: \"Group by\" fails entire panel for missing values in subset of series","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n  - Following upgrade from Grafana docker image version 9.4.12 to 10.0.1, transform \"group by\" crashes the panel if there are empty series\r\n\r\n**What did you expect to happen**:\r\n  - That the dashboard transformations that worked in the previous version, also work in the new version\r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Open Grafana, create a dashboard with a time series panel\r\n- Add a query that returns a time series with missing values\r\n- Add a query that returns a time series with values\r\n\r\n**Step 2**:\r\n- On the dashboard, create a transform \"Group by\" \r\n- For field \"Time\" select \"Group by\"\r\n- For a the series, select \"Calculate\" and select \"Total\" in the Stats-field\r\n\r\n**Step 3**:\r\n- The panel stops rendering. The browser console contains the error message: \r\n```\r\nreportUnhandledError.js:10 \r\n Uncaught TypeError: Cannot read properties of undefined (reading 'length')\r\n    at P (processDataFrame.ts:263:36)\r\n    at m (groupBy.ts:183:14)\r\n    at groupBy.ts:143:39\r\n    at map.js:7:37\r\n    at E._next (OperatorSubscriber.js:15:21)\r\n    at M.next (Subscriber.js:34:18)\r\n    at b._subscribe (innerFrom.js:51:24)\r\n    at b._trySubscribe (Observable.js:38:25)\r\n    at Observable.js:32:31\r\n    at u (errorContext.js:19:9)\r\n```\n\n### \n# What Grafana version are you using?\n\n\nv10.0.1\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\n| Key | Value |\r\n|--|--|\r\n| Panel | timeseries @ 9.3.6 |\r\n| Grafana | 10.0.1 (5a30620b85) // Open Source |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"custom\": {\r\n            \"drawStyle\": \"line\",\r\n            \"lineInterpolation\": \"linear\",\r\n            \"barAlignment\": 0,\r\n            \"lineWidth\": 1,\r\n            \"fillOpacity\": 10,\r\n            \"gradientMode\": \"opacity\",\r\n            \"spanNulls\": false,\r\n            \"showPoints\": \"auto\",\r\n            \"pointSize\": 5,\r\n            \"stacking\": {\r\n              \"mode\": \"none\",\r\n              \"group\": \"A\"\r\n            },\r\n            \"axisPlacement\": \"auto\",\r\n            \"axisLabel\": \"\",\r\n            \"axisColorMode\": \"text\",\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"axisCenteredZero\": true,\r\n            \"hideFrom\": {\r\n              \"tooltip\": false,\r\n              \"viz\": false,\r\n              \"legend\": false\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            },\r\n            \"lineStyle\": {\r\n              \"fill\": \"solid\"\r\n            }\r\n          },\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          },\r\n          \"unit\": \"locale\"\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"tooltip\": {\r\n          \"mode\": \"multi\",\r\n          \"sort\": \"none\"\r\n        },\r\n        \"legend\": {\r\n          \"showLegend\": true,\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"calcs\": []\r\n        }\r\n      },\r\n      \"pluginVersion\": \"9.3.6\",\r\n      \"targets\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"grafana\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"snapshot\",\r\n          \"snapshot\": [\r\n            {\r\n              \"schema\": {\r\n                \"name\": \"Series0\",\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"Time\",\r\n                    \"type\": \"time\",\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"Value\",\r\n                    \"type\": \"number\",\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [],\r\n                  []\r\n                ]\r\n              }\r\n            },\r\n            {\r\n              \"schema\": {\r\n                \"name\": \"Series1\",\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"Time\",\r\n                    \"type\": \"time\",\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"Value\",\r\n                    \"type\": \"number\",\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    1688040000000,\r\n                    1688040900000,\r\n                    1688041800000,\r\n                    1688042700000,\r\n                  ],\r\n                  [\r\n                    1,\r\n                    2,\r\n                    3,\r\n                    4,\r\n                  ]\r\n                ]\r\n              }\r\n            },\r\n            {\r\n              \"schema\": {\r\n                \"name\": \"Series2\",\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"Time\",\r\n                    \"type\": \"time\",\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"Value\",\r\n                    \"type\": \"number\",\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    1688040000000,\r\n                    1688040900000,\r\n                    1688041800000,\r\n                    1688042700000,\r\n                  ],\r\n                  [\r\n                    5,\r\n                    6,\r\n                    7,\r\n                    8,\r\n                  ]\r\n                ]\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      \"transformations\": [\r\n        {\r\n          \"id\": \"groupBy\",\r\n          \"options\": {\r\n            \"fields\": {\r\n              \"Time\": {\r\n                \"aggregations\": [],\r\n                \"operation\": \"groupby\"\r\n              },\r\n              \"Series0\": {\r\n                \"aggregations\": [\r\n                  \"sum\"\r\n                ],\r\n                \"operation\": \"aggregate\"\r\n              },\r\n              \"Series1\": {\r\n                \"aggregations\": [\r\n                  \"sum\"\r\n                ],\r\n                \"operation\": \"aggregate\"\r\n              },\r\n              \"Series2\": {\r\n                \"aggregations\": [\r\n                  \"sum\"\r\n                ],\r\n                \"operation\": \"aggregate\"\r\n              }\r\n            }\r\n          }\r\n        }\r\n      ],\r\n      \"type\": \"timeseries\",\r\n      \"description\": \"\",\r\n      \"title\": \"Reproduced with embedded data\"\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003etimeseries @ 9.3.6\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003eA[grafana-simple-json-datasource], B[grafana-simple-json-datasource], C[grafana-simple-json-datasource]\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eTransform\u003c/th\u003e\\n      \u003ctd\u003erenameByRegex, groupBy\u003c/td\u003e\\n  \u003c/tr\u003e\\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003e 12 frames, 24 fields, 3420 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e10.0.1 (5a30620b85) // Open Source\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above (after transformations)\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"id\": 100,\r\n      \"title\": \"Data (before transformations)\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 24,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": false,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: undefined // 2023-06-29 15:21:18\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-timeseries\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"2023-06-28T22:00:00.000Z\",\r\n    \"to\": \"2023-06-29T21:59:59.999Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\n\n### Grafana Platform?\n\nDocker\n\n### User's OS?\n\nWindows 11\n\n### User's Browser?\n\nChrome Version 114.0.5735.199 (Official Build) (64-bit), Microsoft Edge Version 114.0.1823.58 (Official build) (64-bit)\n\n### Is this a Regression?\n\nYes\n\n### Are Datasources involved?\n\nSimpleJson 1.4.2\n\n### Anything else to add?\n\n\n_No response_","labels":["type/bug","area/dashboard","prio/medium","area/transformations"]},{"id":61521,"title":"Date format issue","body":"When we change the date format of Grafana, the date at the bottom of the Time Series chart does not change according to the format we have set.\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.2\r\n- Data source type \u0026 version: InfluxDB\r\n- OS Grafana is installed on: Ubuntu\r\n- User OS \u0026 Browser: MacOS Safari\r\n","labels":["datasource/InfluxDB","area/dashboard","bot/no new info"]},{"id":48032,"title":"Hide expressions in mixed mode for data sources that don't support expressions","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: Data source plugin doesn't support expressions but when a panel uses the data source in Mixed mode, the +Expressions button shows up. If you add an expression for your query and refresh the panel, it throws an error.\r\n\r\n**What you expected to happen**: The add expression button should not show up for data source queries that don't implement expressions.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n![Expressions](https://user-images.githubusercontent.com/10158691/164405042-302f9932-dabe-4ce7-85a3-c328cce1832d.gif)\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.5\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on: Windows\r\n- User OS \u0026 Browser: Windows, Chrome Version 100.0.4896.88 (Official Build) (32-bit)\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/bug","prio/medium","area/frontend","area/expressions","needs refinement","team/grafana-dashboards"]},{"id":72476,"title":"Auth: auth.proxy does not work with outh and auto_login enabled","body":"### What happened?\n\nWe have two auth plugins enabled:\r\n\r\n```ini\r\n[auth]\r\nlogin_cookie_name = grafana_session\r\n\r\n\r\n[auth.proxy]\r\nenabled = true\r\nheader_name = X-WEBAUTH-USER\r\nheader_property = username\r\nauto_sign_up = true\r\nsync_ttl = 60\r\nwhitelist = ::1,127.0.0.1\r\nheaders = Name:X-WEBAUTH-NAME Email:X-WEBAUTH-EMAIL Groups:X-WEBAUTH-GROUPS\r\nenable_login_token = true\r\n\r\n[auth.azuread]\r\nname = Azure AD\r\nenabled = true\r\nallow_sign_up = false\r\nclient_id = ****\r\nclient_secret = ***\r\nscopes = openid email profile\r\nauth_url = ***\r\ntoken_url = ***\r\nallowed_domains =\r\nallowed_groups =\r\nauto_login = true\r\n```\r\n\r\nWhen we make a call to `curl -k https://localhost:3000/login -H \"X-WEBAUTH-USER: username\"`  we do not get session cookie, but get redirected to azure auth page\n\n### What did you expect to happen?\n\nWhen auth proxy header is passed, user user should be authenticated via auth proxy, instead of being redirected to oauth\n\n### Did this work before?\n\nhaven't tried with previous versions\n\n### How do we reproduce it?\n\n1. enable auth.proxy with `enable_login_token = true`\r\n2. enable any other oauth plugin with `auto_login = true`\r\n3. try to receive session cookie with `curl -k https://localhost:3000/login -H \"X-WEBAUTH-USER: username\"`\r\n\n\n### Is the bug inside a dashboard panel?\n\nno\n\n### Environment (with versions)?\n\nGrafana: 10.0.1\r\nOS: Linux\r\nBrowser: Chrome, curl\r\n\n\n### Grafana platform?\n\nA downloaded binary\n\n### Datasource(s)?\n\n_No response_","labels":["area/auth","area/auth/oauth"]},{"id":79694,"title":"Data Sources: Provisioning config updated, but changes not reflected in Grafana","body":"### What happened?\n\nIn Grafana 10.2.x, I have made a change to a datasource, namely a http header value, but also the `editable` flag, but these changes have not been reflected back in Grafana, they are using the old configuration. When I look at the mysql database for the datasource after the provisioning file has been updated and Grafana restarted, the data in the database is completely unchanged. I used the editable flag as a good canary for this because it's unencrypted and therefore would be easy to see the read_only column in the data_source table switch from 1 to 0, but it has not.\n\n### What did you expect to happen?\n\nI expected the changes to the provisioning file to be picked up during a restart of Grafana (or even after 10 minutes of Grafana running), and the changes be visible (or at least the effects of the changes visible WRT changing header values) in the UI.\n\n### Did this work before?\n\n10.0.x\n\n### How do we reproduce it?\n\n1. Create a datasource provisioning file which looks similar to this:\r\n\r\n```\r\n        {\r\n            \"access\": \"proxy\",\r\n            \"editable\": false,\r\n            \"jsonData\": {\r\n                \"httpHeaderName1\": \"X-Scope-OrgID\",\r\n                \"incrementalQuerying\": true,\r\n                \"prometheusType\": \"Cortex\",\r\n                \"prometheusVersion\": \"1.14.0\",\r\n                \"timeInterval\": \"30s\"\r\n            },\r\n            \"name\": \"Foobar\",\r\n            \"orgId\": 1,\r\n            \"secureJsonData\": {\r\n                \"httpHeaderValue1\": \"foobar\",\r\n            },\r\n            \"type\": \"prometheus\",\r\n            \"url\": \"http://prometheus:9090/\",\r\n            \"version\": 1\r\n        },\r\n```\r\n\r\n2. Start grafana\r\n3. Update the provisioning file like so:\r\n\r\n```\r\n        {\r\n            \"access\": \"proxy\",\r\n            \"editable\": true,\r\n            \"jsonData\": {\r\n                \"httpHeaderName1\": \"X-Scope-OrgID\",\r\n                \"incrementalQuerying\": true,\r\n                \"prometheusType\": \"Cortex\",\r\n                \"prometheusVersion\": \"1.14.0\",\r\n                \"timeInterval\": \"30s\"\r\n            },\r\n            \"name\": \"Foobar\",\r\n            \"orgId\": 1,\r\n            \"secureJsonData\": {\r\n                \"httpHeaderValue1\": \"foobar\",\r\n            },\r\n            \"type\": \"prometheus\",\r\n            \"url\": \"http://prometheus:9090/\",\r\n            \"version\": 1\r\n        },\r\n```\r\n\r\n4. Restart Grafana\r\n5. Check to see that there are no changes\r\n\n\n### Is the bug inside a dashboard panel?\n\nn/a\n\n### Environment (with versions)?\n\nGrafana: 10.2.2 and 10.2.3\r\nOS: Linux / Kubernetes\r\nBrowser: Edge\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nPrometheus","labels":["area/provisioning","triage/needs-confirmation"]},{"id":46932,"title":"Alert List shows Grafana alerts (unified alerting) with \"Normal\" status as INACTIVE","body":"After migration from 8.2.4 with legacy alerting to 8.4.4 with Grafana Alerting, alerts in \"Normal\" status are not displayed any longer with \"Normal\" filter enable. The alerts are now listed as \"Inactive\". I expected the only silenced or paused alerts are shown under inactive filter. Pending and Firing status are working correctly.\r\n\r\nAlert rule displayed as \"Normal\" status in 8.4.4 in alert list panel correctly, with Grafana Alerting:\r\n![Grafana_Alerts](https://user-images.githubusercontent.com/8604822/159945630-191cfdcd-766f-4536-ab28-e2e5346a6bb0.png)\r\n\r\nAlert rule displayed as \"Inactive\" in panel in 8.4.4, **tile in a dashboard**, with Grafana Alerting:\r\n![Grafana_AlertList](https://user-images.githubusercontent.com/8604822/159945596-e999f515-a210-4842-926a-3f9f4cecbb72.png)\r\n\r\nAlert List in 8.2.4 or 8.4.4 with legacy alerting:\r\n![Grafana_AlertList_8 2](https://user-images.githubusercontent.com/8604822/159945663-fd2b79e4-894e-48de-9067-23ac48b00543.png)\r\n\r\n2nd and 3rd screenshots are from the same panel. \r\n\r\n**Environment**:\r\n- Grafana version: 8.4.4\r\n- Data source type \u0026 version: Promtheus\r\n- OS Grafana is installed on: Ubuntu 20.04\r\n- User OS \u0026 Browser: Chrome\r\n","labels":["type/bug","area/alerting","prio/low","area/frontend","stale","good first issue"]},{"id":62096,"title":"source code not available: one of auth,cloud_api_key,oncall_access_token,sm_access_token must be specified","body":"I want to create a grafana_rule_group resource as decribed in the official documentation: https://registry.terraform.io/providers/grafana/grafana/latest/docs/resources/rule_group)\r\n\r\nterraform {\r\n  required_version = \"\u003e= 1.0.0\"\r\n\r\n  required_providers {\r\n    grafana = {\r\n      source  = \"grafana/grafana\"\r\n      version = \"\u003e= 1.34.0\"\r\n    }\r\n  }\r\n}\r\n\r\nWhen I run apply, I got this error. auth is working fine defined in provider \"grafana\"  when I create dashboard resources from json files.\r\n\r\n│ Error: Invalid provider configuration\r\n│ \r\n│ Provider \"registry.terraform.io/grafana/grafana\" requires explicit\r\n│ configuration. Add a provider block to the root module and configure the\r\n│ provider's required arguments as described in the provider documentation.\r\n│ \r\n╵\r\n╷\r\n│ Error: Missing required argument\r\n│ \r\n│   with provider[\"registry.terraform.io/grafana/grafana\"],\r\n│   on \u003cempty\u003e line 0:\r\n│   (source code not available)\r\n│ \r\n│ \"auth\": one of `auth,cloud_api_key,oncall_access_token,sm_access_token`\r\n│ must be specified\r\n╵\r\n\r\n\r\n- Grafana version: 9.3.2\r\n","labels":["needs more info","area/provisioning"]},{"id":65131,"title":"gauge with \"config from query result\" transformation shows different values based on ","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: \r\nThe gauge value shows an inconsistent value and only shows it (but not always) after I have entered the edit mode and back to dashboard. Somethimes it stays at the correct value, somethimes it reverts back to its previous lower value.\r\n![gauge config from query result bug](https://user-images.githubusercontent.com/8981951/226669859-c4367ea5-0ad7-4637-90b8-305927ac1d94.gif)\r\n\r\n**What you expected to happen**:\r\nI expect it to show the maximum value of incomming and outgoing, but instead it shows a lower value. For example for incomming the value shown does correspond to neither the first or latest value in the dataset which are ~1.21 Tb and ~1.03 Tb.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nI have 3 queries to (in my case) Zabbix's postgress db. I pull the incomming traffic, the outging traffic and the speed as documented and perform a small transformation.\r\n![image](https://user-images.githubusercontent.com/8981951/226672423-be4193ea-22b1-4ef2-bd4b-64decfb06c6c.png)\r\nIn the transform tab I managed to set the threshold(50%) as maximum of the gauge's.\r\n![image](https://user-images.githubusercontent.com/8981951/226672923-fba55938-d0db-432e-b7ae-535bc48dd79f.png)\r\n\r\nThan I had this issue when saving the dashboard and reloading the page.\r\n\r\n**Anything else we need to know?**:\r\nThe speed table does contain less entries to safe storage. Therefor the choice for Max but Last* gives the same behavior..\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.1\r\n- Data source type \u0026 version: Zabbix 5.4.9\r\n- OS Grafana is installed on: dockerized on ubuntu\r\n- User OS \u0026 Browser: win11 - Edge and Firefox\r\n- Grafana plugins: grafana-zabbix v4.2.10 (https://github.com/alexanderzobnin/grafana-zabbix)\r\n- Others: -\r\n","labels":["prio/low","needs investigation","area/transformations","triage/needs-confirmation"]},{"id":51141,"title":"Alerting API: GET /api/alerts/:id has incorrect capitalization for value keys","body":"**What happened**:\r\nIt appears that some of the non-stable API endpoints return objects whose keys are not in `camelCase`. This is due to their model structure - they are not returning models defined in the API layer, but rather directly serializing database models.\r\n\r\nThe casing difference is a quirk caused by this.\r\n\r\nWe should improve the sep. of concerns here, which should also fix the casing.\r\n\r\ncall alerting http api: GET /api/alerts/:id response\r\n```json\r\n{\r\n    \"Id\": 1124,\r\n    \"Version\": 0,\r\n    \"OrgId\": 1,\r\n    \"DashboardId\": 1368,\r\n    \"PanelId\": 916,\r\n    \"Name\": \"xxx告警\",\r\n    \"Message\": \"xxx数量大于10\",\r\n    \"Severity\": \"\",\r\n    \"State\": \"ok\",\r\n    \"Handler\": 1,\r\n    \"Silenced\": false,\r\n    \"ExecutionError\": \" \",\r\n    \"Frequency\": 60,\r\n    \"For\": 0,\r\n    \"EvalData\": {},\r\n    \"NewStateDate\": \"2022-06-17T09:34:08Z\",\r\n    \"StateChanges\": 196,\r\n    \"Created\": \"2022-06-01T06:40:58Z\",\r\n    \"Updated\": \"2022-06-08T01:35:58Z\",\r\n    \"Settings\": {\r\n        \"alertRuleTags\": {\r\n            \"test1\": \"test2\"\r\n        },\r\n        \"conditions\": [\r\n            {\r\n                \"evaluator\": {\r\n                    \"params\": [\r\n                        10\r\n                    ],\r\n                    \"type\": \"gt\"\r\n                },\r\n                \"operator\": {\r\n                    \"type\": \"and\"\r\n                },\r\n                \"query\": {\r\n                    \"datasourceId\": 20,\r\n                    \"model\": {\r\n                        \"exemplar\": true,\r\n                        \"expr\": \"sum (increase(xxx_counter_total{job=~\\\"xxx\\\",code=~\\\"5.*\\\",}[5m]))\",\r\n                        \"hide\": true,\r\n                        \"interval\": \"\",\r\n                        \"legendFormat\": \"【告警】xxx总数量\",\r\n                        \"refId\": \"C\"\r\n                    },\r\n                    \"params\": [\r\n                        \"C\",\r\n                        \"1m\",\r\n                        \"now\"\r\n                    ]\r\n                },\r\n                \"reducer\": {\r\n                    \"params\": [],\r\n                    \"type\": \"avg\"\r\n                },\r\n                \"type\": \"query\"\r\n            }\r\n        ],\r\n        \"executionErrorState\": \"keep_state\",\r\n        \"for\": \"0m\",\r\n        \"frequency\": \"1m\",\r\n        \"handler\": 1,\r\n        \"message\": \"xxx数量大于10\",\r\n        \"name\": \"xxx数量告警\",\r\n        \"noDataState\": \"keep_state\",\r\n        \"notifications\": []\r\n    }\r\n}\r\n```\r\n**What you expected to happen**:\r\n```json\r\n{\r\n    \"id\": 1124,\r\n    \"version\": 0,\r\n    \"orgId\": 1,\r\n    \"dashboardId\": 1368,\r\n    \"panelId\": 916,\r\n    \"name\": \"xxx告警\",\r\n    \"message\": \"xxx数量大于10\",\r\n    \"severity\": \"\",\r\n    \"state\": \"ok\",\r\n    \"handler\": 1,\r\n    \"silenced\": false,\r\n    \"executionError\": \" \",\r\n    \"frequency\": 60,\r\n    \"for\": 0,\r\n    \"evalData\": {},\r\n    \"newStateDate\": \"2022-06-17T09:34:08Z\",\r\n    \"stateChanges\": 196,\r\n    \"created\": \"2022-06-01T06:40:58Z\",\r\n    \"updated\": \"2022-06-08T01:35:58Z\",\r\n    \"settings\": {\r\n        \"alertRuleTags\": {\r\n            \"test1\": \"test2\"\r\n        },\r\n        \"conditions\": [\r\n            {\r\n                \"evaluator\": {\r\n                    \"params\": [\r\n                        10\r\n                    ],\r\n                    \"type\": \"gt\"\r\n                },\r\n                \"operator\": {\r\n                    \"type\": \"and\"\r\n                },\r\n                \"query\": {\r\n                    \"datasourceId\": 20,\r\n                    \"model\": {\r\n                        \"exemplar\": true,\r\n                        \"expr\": \"sum (increase(xxx_counter_total{job=~\\\"xxx\\\",code=~\\\"5.*\\\",}[5m]))\",\r\n                        \"hide\": true,\r\n                        \"interval\": \"\",\r\n                        \"legendFormat\": \"【告警】xxx总数量\",\r\n                        \"refId\": \"C\"\r\n                    },\r\n                    \"params\": [\r\n                        \"C\",\r\n                        \"1m\",\r\n                        \"now\"\r\n                    ]\r\n                },\r\n                \"reducer\": {\r\n                    \"params\": [],\r\n                    \"type\": \"avg\"\r\n                },\r\n                \"type\": \"query\"\r\n            }\r\n        ],\r\n        \"executionErrorState\": \"keep_state\",\r\n        \"for\": \"0m\",\r\n        \"frequency\": \"1m\",\r\n        \"handler\": 1,\r\n        \"message\": \"xxx数量大于10\",\r\n        \"name\": \"xxx数量告警\",\r\n        \"noDataState\": \"keep_state\",\r\n        \"notifications\": []\r\n    }\r\n}\r\n```\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.x + 9.x\r\n- Data source type \u0026 version: mysql\r\n- OS Grafana is installed on: linux\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/alerting","prio/low","effort/none","stale","type/debt","bot/needs more info"]},{"id":59330,"title":"Alerting: $__to and $__from does not work in alert rules ","body":"**What happened**:\r\nI am trying to set up new alert rule. \r\n\r\n```\r\nSELECT\r\n    start_time as \"time\",\r\n    duration\r\nFROM cronscript_duration_ts\r\nWHERE\r\n  start_time between $__from and $__to\r\nGROUP BY 1\r\nORDER BY 1\r\n```\r\n\r\nThen I get error in upper right corner of the window:\r\n\r\n\u003e Failed to evaluate queries and expressions: failed to execute conditions: failed to execute query A: db query error: pq: syntax error at or near \"$\"\r\n\r\nI know I could have used $__timeFilter(start_time) in this example but I have just made a smallest example possible to show the problem, in reality I need those elsewhere.\r\nThe point is just that they dont work.\r\nI have tried '${__to}' and ${__to} and '$__to' as well, nothing works.\r\n\r\n**What you expected to happen**:\r\nI have expected that the variables would give the \"from\" and \"to\" time.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\ncreate a table, use a query.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version:\r\n- 9.2.2 (also tested on 9.2.6 with same result)\r\n- Data source type \u0026 version: Postgres 14 timescaledb 2.8.1\r\n- OS Grafana is installed on: rocky linux\r\n- User OS \u0026 Browser: ubuntu, brave\r\n- Grafana plugins: marcusolsson-dynamictext-panel\r\n- Others:\r\n","labels":["type/question","area/alerting"]},{"id":68750,"title":"Regression: MySQL Query Builder does not filter by selected time/date range","body":"### \r\n# What went wrong?\r\n\r\n\r\nAfter quite a while, I decided to add a new (time series) graph based on MySQL data. I was surprised to find myself unable to \"click myself a new graph\" in 9.5 as the query it comes up with looks like this:\r\n```sql\r\nSELECT\r\n  inserted AS \"time\",\r\n  temperature\r\nFROM\r\n  weather.meas_offset\r\nWHERE\r\n  NAME = 'Balkon'\r\nLIMIT\r\n  50\r\n```\r\n...leading my database to return four hours worth of data from 2019. This leads to a `Data outside time range` message in the graph. If I was a new user, I'd be clueless how to make grafana pull the data required for the currently selected time range (for me, defaulting to last 24 hours).\r\n\r\nOnly due to the fact that I already have some older graphs and am able to look at their (generated) SQL, I can basically copy-paste from there - an example:\r\n\r\n```sql\r\nSELECT\r\n  $__timeGroupAlias(inserted,$__interval,NULL),\r\n  avg(temperature) AS \"Temperatur\"\r\nFROM meas_offset\r\nWHERE\r\n  $__timeFilter(inserted) AND\r\n  name = 'Balkon'\r\nGROUP BY 1\r\nORDER BY $__timeGroup(inserted,$__interval,NULL)\r\n```\r\nI was looking for a button to add these or a help text telling me what to do, but couldn't find any. But honestly, I expect grafana to automatically add these, as it has done for the last years that I have been using it. I am not a novice, but had I just installed grafana for the first time, I would probably have given up.\r\n\r\nI then tried finding hints as for how to fix the query in the [docs](https://grafana.com/docs/grafana/latest/datasources/mysql/#time-series-queries), where I found a mention of using `WHERE $__timeFilter(time_date_time)`, but I couldn't figure out how to add this filter using the query builder. I had to switch to the `Code` panel, remove the `LIMIT 50` and add `WHERE $__timeFilter(time_date_time)` myself to get some useful data. But again, adding a simple time series graph should not require reading docs.\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\nhave a MySQL datasource with time series data (going back a while, maybe a year) and try to make a graph from it. Notice the UX difference between doing it with whatever grafana version had the old query builder and the 9.5.2 one.\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\nGrafana v9.5.2 (cfcea75916)\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\r\n\r\n### Grafana Platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### User's OS?\r\n\r\nUbuntu 22.04\r\n\r\n### User's Browser?\r\n\r\nGoogle Chrome Version 113.0.5672.92 (Official Build) (x86_64)\r\n\r\n### Is this a Regression?\r\n\r\nYes\r\n\r\n### Are Datasources involved?\r\n\r\nMySQL\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["datasource/MySQL","area/query-editor","kind/enhancement"]},{"id":69008,"title":"With anonymous mode enabled, many INSERT INTO cache_data already exists errors","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\nI enabled anonymous mode I get many errors in postgres (the database of grafana) in the cache_data table, probably at each user connection :\r\n\r\n````\r\n2023-05-24 16:44:19.894 UTC [37447] ERROR:  duplicate key value violates unique constraint \"cache_data_pkey\"\r\n\r\n\r\n2023-05-24 16:44:19.894 UTC [37447] DETAIL:  Key (cache_key)=(anon-session:\u003credacted\u003e) already exists.\r\n\r\n\r\n2023-05-24 16:44:19.894 UTC [37447] STATEMENT:  INSERT INTO cache_data (cache_key,data,created_at,expires) VALUES($1,$2,$3,$4)\r\n````\r\n\r\n\r\n**What did you expect to happen**:\r\n\r\n  No sql error.\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\n- Setup grafana with a postgres database\r\n\r\n**Step 2**:\r\n\r\n- Enable anonymous access\r\n\r\n**Step 3**:\r\n\r\n- in postgres an insert into error at each user connection\r\n\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\nv9.5.1\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\n_No response_\r\n\r\n### Grafana Platform?\r\n\r\nDocker\r\n\r\n### User's OS?\r\n\r\nUbuntu 22.04\r\n\r\n### User's Browser?\r\n\r\n_No response_\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\n_No response_\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["needs more info","area/auth","area/backend/db/postgres","triage/needs-confirmation"]},{"id":58385,"title":"Extra white space at sometime's visit, often occurs after long time's no action in page. ","body":"**What happened**:\r\n1.Extra white space at sometime's visit, often occurs after long time's no action in page. \r\n2.user icon often shows default(blank) pic\r\n**What you expected to happen**:\r\n1. no extra white space in page\r\n2. each user has his own icon pic\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nhard to reproduce.\r\nit occurs sometimes after upgrading to 9.2.0\r\n\r\n**Anything else we need to know?**:\r\nno\r\n**Environment**: centos 7.6 x64\r\n- Grafana version: 9.2.0\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on: NA\r\n- User OS \u0026 Browser: Version 107.0.5304.87 (Official Build) (arm64)   Chrome\r\n- Grafana plugins: NA\r\n- Others: NA\r\n![image](https://user-images.githubusercontent.com/8426828/200479232-68538f3b-ee36-44d9-9072-1f81617255b7.png)\r\n","labels":["area/grafana/ui","bot/no new info"]},{"id":59351,"title":"Dashboard list is not showing on small screen","body":"The dashboard list control disappears on the smartphone screen in landscape mode:\r\n\r\n![image](https://user-images.githubusercontent.com/4903007/204125217-aa29ee93-9136-453b-9403-d90ad7473aeb.png)\r\n\r\nWhile landscape mode is generally more preferable on a smartphone, this issue may make user frustrate, as it seems like no dashboards available.\r\n\r\n**Expected**:\r\nThe control is shown and allows to scroll through the list.\r\n\r\n**Environment**:\r\n- Grafana version: Cloud\r\n- User OS \u0026 Browser: iOS 16.1.1 \u0026 Chrome 107.0.5304.101\r\n- Device: iPhone SE 2020\r\n- View port size: 667px x 375px\r\n\r\nPlease note that the issue is not reproducible in Desktop Chrome with dev tools, probably because it skips all browser panels and assumes full screen mode. There is \"semi-full-screen\" mode in Chrome, but it can be activated when scrolling content up, which is not possible in this case as there's nothing to scroll.","labels":["type/bug","area/dashboard","area/mobile-support"]},{"id":65677,"title":"View rule - Rule could not be found.","body":"Hello.\r\n\r\nI have some inaccessible rules, which still generates alarms.\r\n![image](https://user-images.githubusercontent.com/21200507/229065874-984fb412-da28-4601-aa5a-23de36d1c752.png)\r\n\r\nRules are listed under Groups, but  \"See source\" button shows: \r\n![image](https://user-images.githubusercontent.com/21200507/229065957-1bfe63db-6605-48cf-a943-89840423e73d.png)\r\n\r\nHow can I view as well as delete those rules?\r\n\r\nThank You!\r\n","labels":["needs more info","area/alerting"]},{"id":61365,"title":"Listing alerts that are default grouped by importance doesn’t work as expected","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWhen sorting the alert list panel by importance alerts that are firing are not being bumped up.\r\n\r\n**What you expected to happen**:\r\nAlerts that are firing would go to the top of the list.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate a number of alerts using random walk and set a rule that will surly fire and a few that won't, crate an alert list panel with those alerts and set order to importance.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.3\r\n- Data source type \u0026 version: Prometheus 2.25\r\n- OS Grafana is installed on: Deployment on an Ubuntu Kubernetes Node\r\n- User OS \u0026 Browser: Windows 10 \u0026 Chrome latest version\r\n- Grafana plugins: -\r\n\r\n","labels":["area/alerting","area/frontend","stale","triage/needs-confirmation"]},{"id":58275,"title":"Annotations missing from many panels","body":"**What happened**:\r\n\r\nAn annotation that was succesfully saved with a tag, is only sporadically shown in panels on dashboards configured to show annotations with that tag.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n1. Go to \u003chttps://play.grafana.org/d/000000016/1-time-series-graphs?orgId=1\u003e.\r\n2. Alt-click somewhere in a timeseries panel on a dashboard.\r\n3. Write \"Hello\" and tag it with \"example\".\r\n4. Edit the dashboard config -\u003e Annotations -\u003e enable and query by tag \"example\".\r\n5. Click \"Apply\", go back to dashboard, and click \"Refresh dashboard\" just in case.\r\n\r\nProblem: The dashboard where the annotation was made, shows the annotation only in the panel where it was created. The other panels on the same dashboard do not show it!\r\n\r\n| Step 3 | Step 4 | Step 5: Problem\r\n|--|--|--\r\n| \u003cimg width=\"732\" alt=\"Screenshot\" src=\"https://user-images.githubusercontent.com/156867/200076254-c2287a1b-c549-405e-8ff5-c5d0741fec70.png\"\u003e | \u003cimg width=\"863\" alt=\"Screenshot\" src=\"https://user-images.githubusercontent.com/156867/200076288-8f1a4f70-b780-42ff-8b5d-a6cba9e24606.png\"\u003e | \u003cimg width=\"1329\" alt=\"Screenshot\" src=\"https://user-images.githubusercontent.com/156867/200076385-011c5a0e-707c-43f2-afcc-34325a05e7cb.png\"\u003e\r\n\r\n6. Go to a different dashboard.\r\n7. Edit its config also to enable the same annotation, query by tag \"example\"\r\n8. Click \"Apply\", go back to dashboard, and click \"Refresh dashboard\" just in case.\r\n\r\nOn most dashboards, it is now visible in all panels, which is great. But the dashboard where it originated shows it inconsistently. I also find that on some dashboards it is only showing on the first panel, even if it is not a repeating panel. I did not see anything obvious that is different from the dashboards where it works vs the ones where it shows only on the first.\r\n\r\n| Step 8: Problem\r\n|--\r\n| \u003cimg width=\"1339\" alt=\"Screenshot\" src=\"https://user-images.githubusercontent.com/156867/200076833-a998a743-eb0f-4272-80ca-467a9c1e3fb9.png\"\u003e\r\n\r\n**Anything else we need to know?**:\r\n\r\nI originally encountered this with Wikimedia's Grafana installation. The annotation is for 31 Aug 2022 14:00 and was created on the Traffic/Backend latency dashboard: \u003chttps://grafana.wikimedia.org/d/O2sTrqZVk/backend-layer-performance?orgId=1\u0026from=1661472000000\u0026to=1662235200000\u0026var-site=codfw\u0026var-cluster=All\u003e\r\n\r\nIn the browser tab where I the annotation, no matter the number of refreshes only the first original panel shows it. No other panel repeats, row repeats, or other panels show it. In a logged-out browser tab, it seems to show for half of the panels but still not all:\r\n\r\n\u003cimg height=\"200\" alt=\"Screenshot\" src=\"https://user-images.githubusercontent.com/156867/200077506-ae22f26e-a2b6-4bb5-a587-9d9599239dd6.png\"\u003e\r\n\r\nFor the Wikimedia install, when opening a different dashboard it does the annotation in all panels in all rows. This, unlike the above play.grafana.org example where even on a different dashboard it only showed in one panel.\r\n\r\n\u003chttps://grafana.wikimedia.org/d/000000066/resourceloader?from=1661472000000\u0026to=1662235200000\u003e\r\n\r\n\u003cimg height=\"200\" alt=\"Screenshot\" src=\"https://user-images.githubusercontent.com/156867/200077879-12e0f5dc-cfbb-4fc2-9176-41f86501d2a0.png\"\u003e\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.3-997144b7 (play.grafana.org), 8.5.14 (grafana.wikimedia.org)\r\n- Data source type \u0026 version: Prometheus metric source, Grafana built-in annotation source.\r\n- OS Grafana is installed on: Linux.\r\n- User OS \u0026 Browser: Firefox latest, macOS.","labels":["area/annotations","bot/no new info","triage/needs-confirmation","team/grafana-dashboards"]},{"id":64668,"title":"Can't access to Grafana Dashboard","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\u003cimg width=\"1299\" alt=\"image\" src=\"https://user-images.githubusercontent.com/93299415/224651814-7ab62575-48e3-4d66-ad31-00cce3e1db0f.png\"\u003e\r\n\r\n**What you expected to happen**:\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: chart grafana-6.17.8\r\n- Data source type \u0026 version: \r\n- OS Grafana is installed on: K8S\r\n- User OS \u0026 Browser: Chrome, EDGE, Safari\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["bot/no new info","area/frontend/login"]},{"id":61378,"title":"Alert is not triggering if the firing condition is equals to 0","body":"Alert is not firing even if the conditions are met\r\n\r\nI have a metric whose value can be any of -1, 0, or 1. I have set the alert to fire if the metric value is 0.\r\n\r\nThe alert doesn't fire when the metric value is 0. The alert fires, if I set the same alert(with the same search time range and other parameters) to fire when the metric value is 1.\r\n\r\nHave a metric whose value is 0. Set alert query as `metric == 0`.\r\nWhen you run the query, the data is seen but the alert never goes to the pending or firing state.\r\n\r\nI believe that the alert isn't firing only when it is compared with the value 0. If I set the query as (metric + 1) == 1, the same alert fires.\r\n\r\n- Grafana version: 9.1.5\r\n- Data source type \u0026 version: Prometheus 2.37.1\r\n- OS Grafana is installed on: Official grafana docker image running on Ubuntu\r\n- User OS \u0026 Browser: MacOS and Chrome\r\n- Grafana plugins: none\r\n\r\nhttps://user-images.githubusercontent.com/51957981/212086541-bff85b13-c743-4b03-979a-af5b6e589658.mov\r\n\r\n\r\n\r\n\r\n\r\n\r\n","labels":["area/alerting/evaluation"]},{"id":59007,"title":"99% is not shown in pie reasonably","body":"**What happened**:\r\n\r\nwhen I use new pie to replace old pie, I find the situation where one  occupies 99%, the others occupy 1%, and there are too many items in the others, the pie percentage is not reasonable.\r\n\r\n**What you expected to happen**:\r\n\r\nI expect that in pie, 99% is just like in the old pie.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\ncreate 100 items. and one item occupies 99%\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser: MacBook safari\r\n- Grafana plugins:\r\n- Others:\r\n![faf3b1a5-fb78-4778-ba29-698b1b81f68c](https://user-images.githubusercontent.com/50096879/202956330-82080592-c120-40a0-be3a-90df0e2a8046.jpeg)\r\n","labels":["type/bug","stale","area/panel/piechart","area/dataviz"]},{"id":87282,"title":"Alerting: When updating Evaluation Group on Alert rule page, got error message: Failed to update namespace / group: Access denied","body":"### What happened?\r\n\r\nWhen I try to edit exiting Evaluation Group on alert rule edit page. When I click save, it's blocked with error message: `Failed to update namespace / group: Access denied`. \r\n\r\n\r\n![Screenshot 2024-05-02 at 6 00 38 PM](https://github.com/grafana/grafana/assets/31761/556bc995-c6f4-4a07-afb4-10bbe1b985a2)\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nThe Evaluation Group should be saved. \r\n\r\n### Did this work before?\r\n\r\nNot tried before\r\n\r\n### How do we reproduce it?\r\n\r\n1. Open an alert to edit\r\n2. Click edit icon near blow evaluation group dropdown.\r\n3. Change the value in the evaluation group edit dialog\r\n4. Click save\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nNo\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana:10.4.1\r\nOS: Mac\r\nBrowser: Chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nDocker\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/auth","area/alerting","triage/needs-confirmation"]},{"id":77800,"title":"Add keep firing for to alerting to stop flapping notifications","body":"### What happened?\n\n## Problem\r\nWe are experiencing flapping alerts as the Keep Last State feature has been removed.\r\n\r\nHopefully there's a way to simulate this behaviour, but we've been unable to find a combination of the options to produce this behaviour\r\n\r\n## Situation\r\nWe have an alert that queries our db whose query is expected to fail sometimes (and we're not worried about the query failing).\r\nIn a previous version of grafana (I'm afraid I can't remember what version we were previously on, sorry), we were able to set it to \"Keep last state\", so if the query failed, the original alert state wouldn't change.\r\nAfter upgrading Grafana to v9.5.5 this option has disappeared. This has resulted in flapping alerts.\r\n\r\nConsider the following situation:\r\n- Alert is in failing condition\r\n- Query fails\r\n- Original alert closed (\u003c-- this is the bit we don't want)\r\n- Error alert opened\r\n- Query succeeds\r\n- Error alert closed\r\n- New alert opened in failing condition\r\n- Query fails\r\n- [repeat]\r\n\r\n\n\n### What did you expect to happen?\n\nTo be able to Keep Last State in the alerts to prevent alert flapping\n\n### Did this work before?\n\nYes, in the legacy alerting (pre v9)\n\n### How do we reproduce it?\n\n1. Using grafana v9.5.5\r\n2. Try to have an alert that doesn't flap if the query itself fails\r\n\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: v9.5.5\r\n\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["area/alerting"]},{"id":76052,"title":"Prometheus DataSource: x-forwarded-for header contains user-ip, localhost and server-ip for Get Requests","body":"### What happened?\n\nMy Prometheus (deployed on K8s) is secured by an Oauth-Proxy behind a Nginx-Ingress Controller and the Ingress is configured to bypass the Oauth Authentication if the requests origin is from an certain IP-Adress (The Grafana IP-Adress).\r\nWhen Grafana is executing an POST request to query a metric everything works fine but when a GET Request is performed I get a 401 Unauthorized from my Nginx-Ingress Controller.\r\nI saw that the x-forwarded-for header contains 3 IPs and not only the IP of the Grafana Server when an GET request is performed.\r\nThe 3 IPs are first the IP from my Computer, localhost/127.0.0.1 and the IP of the Grafana Server.\r\n\r\nGrafana uses Get Request for example for [label_values function](https://grafana.com/docs/grafana/latest/datasources/prometheus/template-variables/).\r\n\r\nIf I overwrite the header x-forwarded-for in the prometheus datasource settings with an empty value also the GET requests work correct.\r\n\u003cimg width=\"716\" alt=\"image\" src=\"https://github.com/grafana/grafana/assets/33369109/f2db9298-cee5-4715-8aaf-84599d26320e\"\u003e\r\n\n\n### What did you expect to happen?\n\nI would expect that the x-forwarded-for header only contains the Grafana Server IP for GET Request. (Similar to the POST Requests)\n\n### Did this work before?\n\nI don't know if this has worked in an earlier version of Grafana.\n\n### How do we reproduce it?\n\n1. Prometheus behind and Nginx-Ingress Controller with the configuration to only let through certain IPs.\r\n2. Configure the Prometheus-Datasource in Grafana\r\n3. Create a dashboard and try to create a variable from type Query for the corresponding Prometheus datasource with with the query label_values(namespace)\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: v9.4.13\r\nOS: macOS 14.0 (23A344)\r\nBrowser: Chrome Version 117.0.5938.132 (arm64)\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\nCould not find the version of the Prometheus DataSource","labels":["area/plugins","datasource/Prometheus","bot/no new info"]},{"id":64193,"title":"Alertmanager include image not working","body":"While using docker grafana with this env vars:\r\n```\r\n      GF_RENDERING_SERVER_URL: http://renderer:8081/render\r\n      GF_RENDERING_CALLBACK_URL: http://grafana:3000/\r\n      GF_LOG_FILTERS: rendering:debug\r\n      GF_UNIFIED_ALERTING_ENABLED: \"true\"\r\n      GF_ALERTING_ENABLED: \"false\"\r\n      GF_UNIFIED_ALERTING_SCREENSHOTS_CAPTURE: \"true\"\r\n      GF_FORCE_MIGRATION: \"true\"\r\n```\r\non grafana:8.1.0 all works fine, sharing screenshot on dashbord and \"include image\" in contact point BUT! on grafana:9.1.0 or 9.4.6 sharing screenshot on dashbord is fine, but there is no option \"include image\" at all, can't debug it cause it's not an error, option is just do not exists\r\n","labels":["type/bug","needs more info","area/alerting"]},{"id":76180,"title":"Plugins: Bumping SystemJS to 6.14.2 broke image rendering","body":"### What happened?\r\n\r\nI'm using image renderer plugin and was trying to render a panel from simpod-json-datasource.\r\n\r\nI'm seeing these issues:\r\n\r\n```\r\nlogger=context userId=1 orgId=1 uname=admin t=2023-10-09T09:40:53.551999241Z level=info msg=\"Request Completed\" method=GET path=/grafana/public/plugins/simpod-json-datasource/module.js status=404 remote_addr=[::1] time_ms=7 duration=7.407245ms size=49009 referer=\"http://localhost:3000/d-solo/f62e9b8ce669da4dbd37ffb05efb0949/asnrender?from=1696502356000\u0026height=400\u0026kiosk=tv\u0026orgId=1\u0026panelId=1\u0026render=1\u0026to=1696509556000\u0026tz=Europe%2FPrague\u0026var-asn_raw=8075\u0026width=900\" handler=notfound\r\nlogger=context userId=1 orgId=1 uname=admin t=2023-10-09T09:40:53.551999241Z level=info msg=\"Request Completed\" method=GET path=/grafana/public/plugins/simpod-json-datasource/module.js status=404 remote_addr=[::1] time_ms=7 duration=7.407245ms size=49009 referer=\"http://localhost:3000/d-solo/f62e9b8ce669da4dbd37ffb05efb0949/asnrender?from=1696502356000\u0026height=400\u0026kiosk=tv\u0026orgId=1\u0026panelId=1\u0026render=1\u0026to=1696509556000\u0026tz=Europe%2FPrague\u0026var-asn_raw=8075\u0026width=900\" handler=notfound\r\nlogger=plugin.grafana-image-renderer t=2023-10-09T09:40:53.552985487Z level=error msg=\"Browser console error\" msg=\"Failed to load resource: the server responded with a status of 404 (Not Found)\" url=\"http://localhost:3000/grafana/public/plugins/simpod-json-datasource/module.js?_cache=0.6.2\"\r\nlogger=plugin.grafana-image-renderer t=2023-10-09T09:40:53.552985487Z level=error msg=\"Browser console error\" msg=\"Failed to load resource: the server responded with a status of 404 (Not Found)\" url=\"http://localhost:3000/grafana/public/plugins/simpod-json-datasource/module.js?_cache=0.6.2\"\r\nlogger=plugin.grafana-image-renderer t=2023-10-09T09:40:53.555495565Z level=error msg=\"Browser console error\" msg=\"runRequest.catchError {\\\"message\\\":\\\"Datasource: 000000002 was not found\\\"}\" url=http://localhost:3000/public/build/8721.e20fc3671a22764fd1f1.js line=4487 column=22241\r\nlogger=plugin.grafana-image-renderer t=2023-10-09T09:40:53.555495565Z level=error msg=\"Browser console error\" msg=\"runRequest.catchError {\\\"message\\\":\\\"Datasource: 000000002 was not found\\\"}\" url=http://localhost:3000/public/build/8721.e20fc3671a22764fd1f1.js line=4487 column=22241\r\n```\r\n\r\n### What did you expect to happen?\r\n\r\nSuccessful render\r\n\r\n### Did this work before?\r\n\r\nI managed to track the issue to this commit 62821c69b331b0982ac4de07f9da580ec7bbac18. Without it it works.\r\n\r\n### How do we reproduce it?\r\n\r\n1. build simpod-json-datasource from source\r\n2. have a timeseries panel\r\n3. try to render it as image using renderer plugin\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 62821c69b331b0982ac4de07f9da580ec7bbac18\r\nOS: linux debian\r\nBrowser: chromium?\r\n\r\n\r\n### Grafana platform?\r\n\r\nOther\r\n\r\n### Datasource(s)?\r\n\r\nsimpod-json-datasource v0.6.2 (build from source)","labels":["type/bug","needs more info","area/plugins","area/frontend"]},{"id":73801,"title":"How to avoid retriggering firing unified alert again during helm upgrade","body":"### What happened?\r\n\r\nI have 2 instances(9.4.7) and set up HA alerting. backend db is PG.\r\nduring the helm upgrade for grafana, the firing alerts would be retriggered. I consider when pod gets inited, it cannot touch/detect well with rest of pods at startup.\r\nin grafana, we have a lot of monitoring. It’s hard to make a batch silence for all alerts as they are matched by tags.\r\nI even enarge the \"for\" param to 5m, it's still retriggered.\r\n\r\n### What did you expect to happen?\r\n\r\nnot retrigger\r\n\r\n### Did this work before?\r\n\r\nno\r\n\r\n### How do we reproduce it?\r\n\r\nas desc\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nno\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana:  9.4.7\r\nOS: centos 8\r\nBrowser: chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nKubernetes\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["type/bug","area/alerting/notifications","triage/needs-confirmation"]},{"id":46581,"title":"Shared crosshair not working","body":"**What happened**:\r\nI enabled \"shared crosshair\" in my dashboard with time series graphs. The crosshair is not getting shared, but remains per graph. When I change the graphs to \"Graph (old)\" they _do_ have a shared crosshair.\r\n\r\n**What you expected to happen**:\r\nA shared crosshair in time series graphs.\r\n\r\nI understand from #30564 and #33433 that this functionality should be available, as the boxes are checked and this seems merged since v8.0.0 (according to `git tag --contains 9f8fa421`).\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n- Install Grafana (8.3.6 in my case)\r\n- create at least two time series graphs\r\n- edit graph settings, enable \"Shared crosshair\" in the bottom\r\n- go back, observe crosshair not being shared\r\n- change graphs to \"Graph (old)\"\r\n- go back, observe crosshair to be shared\r\n\r\n**Anything else we need to know?**:\r\nI have not tried v8.4.x yet\r\n\r\n**Environment**:\r\n- Grafana version: v8.3.6\r\n- Data source type \u0026 version: Prometheus, InfluxDB and fetzerch-sunandmoon-datasource\r\n- OS Grafana is installed on: Talos OS v0.4.3 (Linux 5.15.26 + Kubernetes v1.23.4)\r\n- User OS \u0026 Browser: MacOS + Chrome\r\n- Grafana plugins: fetzerch-sunandmoon-datasource","labels":["type/bug","area/dashboard","area/panel/timeseries"]},{"id":57748,"title":"Legend for Prometheus queries and transformations issue","body":"**What happened**:\r\nIt's about transformations and queries Legend (Prometheus data source).\r\nI've created Table panel containing two metrics with Legend values set as 'CPU usage' and 'Memory usage'\r\n\r\n![image](https://user-images.githubusercontent.com/31762538/198282081-935eeee1-b064-4ef3-95e8-1882b1a1f26c.png)\r\n\r\nNow I've added two transformations: \r\n- Label to fields\r\n- Group by\r\n\r\n![image](https://user-images.githubusercontent.com/31762538/198282391-b5be19f1-2003-4efd-abfe-6373a11fb49c.png)\r\n\r\nQuestions is why I can see value for one query only in \"Group by' transformation (called 'Value') when I expect two values (as I've two queries) named 'CPU usage' and 'Memory usage' ?\r\n\r\nWhat's interesting it looks fine when I disable \"Labels to fields\" transformation using \"Group by\" only:\r\n\r\n![image](https://user-images.githubusercontent.com/31762538/198284010-ad5f08c5-3262-4142-bdbd-94ec50624e85.png)\r\n\r\n**What you expected to happen**:\r\nWould be great to have this running the same way as for Google Monitoring data source:\r\n\r\n![image](https://user-images.githubusercontent.com/31762538/198284716-0b2f3964-041f-4ec5-a4ab-d3b9dca02456.png)\r\n\r\n![image](https://user-images.githubusercontent.com/31762538/198285010-a6df179e-6736-41aa-9f64-5900092e53be.png)\r\n\r\nSummarizing:\r\nFor Prometheus data source value name set in Legend (for ex. \"CPU usage') is shown as 'Value' in 'Group by' transformation when 'Labels to fields' transformation is used first. \r\n\r\n**Environment**:\r\n- Grafana version: 9.1.5\r\n- Data source type \u0026 version: Prometheus 2.31.1\r\n- OS Grafana is installed on: Red Hat Enterprise Linux 7\r\n- User OS \u0026 Browser: Windows 10 / Chrome\r\n- Grafana plugins: none\r\n- Others:\r\n","labels":["type/bug","needs investigation","area/transformations"]},{"id":43983,"title":"Repeatedly getting error 'FileLogWriter(path\\to\\grafana.log): close path\\to\\grafana.log: file already closed'","body":"**What happened:**\r\nNSSM standard error log captured repeating error : 'FileLogWriter(path\\to\\grafana.log): close path\\to\\grafana.log: file already closed'\r\n\r\n**What you expected to happen:**\r\nIf file is already closed process shouldn't try to close the file again\r\n\r\n**How to reproduce it (as minimally and precisely as possible):**\r\nHave grafana.log open in a editor while Grafana is trying to rotate the log file. \r\n\r\n**Environment:**\r\nGrafana Version 8.2.3 Standalone Windows\r\nRunning Grafana via NSSM, capturing standard error using NSSM error log functionality.\r\n\r\n**Anything else we need to know?:**\r\nCode which I believe is responsible for error.\r\n\r\nhttps://github.com/grafana/grafana/blob/e01ac44cfae7d724daa89a916882fd08cc023de0/pkg/infra/log/file.go#L200\r\n\r\nfd.close() returns error if the file is already closed. I'm posting os.File.close() documentation below for reference.\r\n\r\nI believe there should be some kind of check if the file is already closed either before or after fd.close()\r\n\r\nhttps://pkg.go.dev/os#File.Close\r\n\r\nThis is the standard error that is repeating\r\nhttps://github.com/grafana/grafana/blob/e01ac44cfae7d724daa89a916882fd08cc023de0/pkg/infra/log/file.go#L117\r\n\r\n**Edit 1:** \r\n\r\nSingle instance of the following error appears before the repeated error.\r\n\r\n`'FileLogWriter(path\\to\\grafana.log): rotate: rename path\\to\\grafana.log path\\to\\grafana.log.2021-12-21.001: The process cannot access the file because it is being used by another process.'`\r\n\r\nError in code, which is consumed by the same function on line 117 above.\r\nhttps://github.com/grafana/grafana/blob/e01ac44cfae7d724daa89a916882fd08cc023de0/pkg/infra/log/file.go#L207","labels":["needs more info","area/backend/logging","area/backend","bot/no new info"]},{"id":78616,"title":"XY Chart Adjust X axis max","body":"### What happened?\n\nDear grafana community,\r\n\r\non the XY-Chart the limits do not work correctly.\r\n\r\nIf Min and Max are set individually for the x AND y axis (overrides), it only works for the y axis. In my case the x-axis should also be limited.\n\n### What did you expect to happen?\n\nThe overrides on the y-axis work, the max and min are set properly there, but the x axis completely ignores the settings.\n\n### Did this work before?\n\nNo\n\n### How do we reproduce it?\n\nN/A\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana:\r\nOS:\r\nBrowser:\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["area/panel/xychart"]},{"id":50865,"title":"Alerting: $value does not display in expected format in message template","body":"In grafana v8.3.3, when I configure the description of alert as `${{ $value }}`, the displayed content is: \r\n\r\n`[ metric='value' labels={hostname=test,os=windows} value=1 ]`\r\n\r\nbut I hope to be able to It is displayed as:\r\n \r\n`\"hostname is {{ $value.labels.hostname }}, os name is {{ $value.labels.os }}\"`\r\n\r\nwhat should I do?","labels":["type/question","area/alerting","area/backend","area/frontend"]},{"id":51387,"title":"Geomap: Do not show markers for rows that don't have coordinates","body":"I was expecting rows not to cause markers when the coordinates are empty. But this is not the case. Those rows are getting a marker at location 0/0.\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.0\r\n","labels":["type/bug","needs more info","area/panel/geomap"]},{"id":64863,"title":"Grafana version 9.4.1 fails to start,Executing migration failed\" id=\"move dashboard alerts to unified alerting\" error=\"UNIQUE constraint failed: alert_configuration.org_id","body":"logger=migrator t=2023-03-16T02:35:41.83237006Z level=error msg=\"Executing migration failed\" id=\"move dashboard alerts to unified alerting\" error=\"UNIQUE constraint failed: alert_configuration.org_id\"\r\nlogger=migrator t=2023-03-16T02:35:41.832392308Z level=error msg=\"Exec failed\" error=\"UNIQUE constraint failed: alert_configuration.org_id\" sql=\"code migration\"\r\nError: ✗ migration failed (id = move dashboard alerts to unified alerting): UNIQUE constraint failed: alert_configuration.org_id\r\n\r\nIs there a good way to start quickly","labels":["area/alerting","bot/no new info"]},{"id":65001,"title":"Cant hide x-axis on API generated timeseries panels","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI generate some dashboards by pushing up JSON through the grafana API. I start by designing the panel in the web interface as usual, copying the json to my application and then using that panel on various auto generated dashboards. But I notice that the x-axis labels that were hidden, are now showing once pushed up. In a small panel this completely obscures the graph. See before and after screenshot below:\r\n\r\n![image](https://user-images.githubusercontent.com/2304970/226169529-7849c362-1371-434b-8dc3-69f69e9d39a9.png)\r\n\r\n**What you expected to happen**:\r\n\r\nPanel with identical JSON should look the same.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nCreate a new panel, add a random walk or simple test series. Set axis placement to hidden. Observe both axis hide. Copy panel/dashboard JSON, push the JSON up to the dashboard using the API. See now the x-axis labels have appeared.\r\n\r\n**Anything else we need to know?**:\r\n\r\nI have done a diff on the original JSON vs that of the panel once pushed up through the API. It appears this is added to the `fieldConfig`-\u003e`overrides` section:\r\n\r\n```\r\n      {\r\n        \"matcher\": {\r\n          \"id\": \"byType\",\r\n          \"options\": \"time\"\r\n        },\r\n        \"properties\": [\r\n          {\r\n            \"id\": \"custom.axisPlacement\",\r\n            \"value\": \"auto\"\r\n          }\r\n        ]\r\n      }\r\n```\r\n\r\nChanging auto to hidden does hide the labels, so thought I could therefore add that to the source JSON, but when I tried it was still added and I ended up with:\r\n\r\n```\r\n      {\r\n        \"matcher\": {\r\n          \"id\": \"byType\",\r\n          \"options\": \"time\"\r\n        },\r\n        \"properties\": [\r\n          {\r\n            \"id\": \"custom.axisPlacement\",\r\n            \"value\": \"hidden\"\r\n          }\r\n        ]\r\n      },\r\n      {\r\n        \"matcher\": {\r\n          \"id\": \"byType\",\r\n          \"options\": \"time\"\r\n        },\r\n        \"properties\": [\r\n          {\r\n            \"id\": \"custom.axisPlacement\",\r\n            \"value\": \"auto\"\r\n          }\r\n        ]\r\n      }\r\n```\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.3\r\n- Data source type \u0026 version: Grafana\r\n- OS Grafana is installed on: Docker\r\n- User OS \u0026 Browser: Firefox Linux\r\n- Grafana plugins: \r\n- Others:\r\n","labels":["needs more info","area/backend/api"]},{"id":64902,"title":"Overrides with alias not found  9.3.6 -\u003e 9.4.3","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nOverrides linked to an `alias` stopped working.\r\n\r\n**What you expected to happen**:\r\nNothing\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n-grafana_docker_src_image: grafana/grafana:9.3.6\r\n+grafana_docker_src_image: grafana/grafana:9.4.3\r\n\r\nI can deploy the old image back, and it works just fine.\r\n\r\n**Anything else we need to know?**:\r\nImages: https://imgur.com/a/Sh6QgdF\r\n\r\n**Environment**:\r\n- Grafana version:\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["datasource/InfluxDB","area/field/overrides","bot/no new info","triage/needs-confirmation"]},{"id":73044,"title":"Repeated rows when expanded incorrectly use \"All\" for variables","body":"### What happened?\n\nI have defined simple custom variables as dictionary:\r\n\r\n![image](https://github.com/grafana/grafana/assets/136453859/2254cdda-a339-4427-9987-2219e375cbe3)\r\n\r\nAnd I have created a repeated row for this variable:\r\n\r\n![image](https://github.com/grafana/grafana/assets/136453859/227c9e31-8144-4211-afb2-d97c7ab34d8b)\r\n\r\nHowever when I expand the rows, the first one doesn't match the value:\r\n\r\n![image](https://github.com/grafana/grafana/assets/136453859/5cb6a0a0-795a-4c48-a5a8-4313ba61142c)\r\n\r\n\r\n\n\n### What did you expect to happen?\n\nI expect (and this is how this worked previously) for the first row to match the variable, ie \"var1 : 1\"\r\n\r\nThis is how \"var2\" is shown - \r\n\r\n![image](https://github.com/grafana/grafana/assets/136453859/56f12b9f-7c2e-4e15-9320-082506d51aa3)\r\n\n\n### Did this work before?\n\nWe have been recently updated to Grafana v9.5.6 (859a2654d3) and it worked before. Now pretty much all repeated panel rows are broken for the first panel.\n\n### How do we reproduce it?\n\n1. Create a custom variable var1 : 1, var2 : 2, var3 : 3\r\n2. Set \"multi select\" and \"all\" both to true\r\n3. Create a Row and set it to repeat for variable \"var\"\r\n4. Now add the text panel (see the dashboard markdown below)\r\n5. Collapse the rows and save the dashboard\r\n6. Reload the dashboard and expand the first one\r\n7. You should see that var1 is returning All for some reason\r\n\n\n### Is the bug inside a dashboard panel?\n\nYes, here is the panel contents that i use to render : \r\n\r\n```\r\n# Test this panel\r\n\r\n* var = ${var}\r\n* text = ${var:text}\r\n* value = ${var:value}\r\n```\n\n### Environment (with versions)?\n\nGrafana: Azure Managed Grafana v9.5.6 (859a2654d3)\r\nBrowser: Edge\r\n\n\n### Grafana platform?\n\nOther\n\n### Datasource(s)?\n\nno data sources","labels":["area/dashboard","needs more info","team/grafana-dashboards"]},{"id":43843,"title":"regression in 8.3.3: re-draw of all repeated panels at every poll interval","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nAfter upgrading from grafana 8.3.2 to 8.3.3, the repeated panels are re-painted every poll interval in both firefox and chromium. This is illustrated with the repeated SVG panel below with two screenshots taken in succession. The SVG plugin seems to be completely reloaded and looses its internal state (e.g. zoom-level of phasor magnitude)\r\n\r\n![image](https://user-images.githubusercontent.com/6523124/148739800-666a1634-2991-496e-900f-204cc6161c55.png)\r\n![image](https://user-images.githubusercontent.com/6523124/148739815-daa24edf-06df-46d4-b743-e30b2c426117.png)\r\n\r\n**What you expected to happen**:\r\nI expected the same behavior as in 8.3.2 where the panels are not redrawn but just refreshed with updated metric values. This is illustrated with the same repeated SVG panel in grafana 8.3.2.\r\n![image](https://user-images.githubusercontent.com/6523124/148739899-f9309618-0e4a-4101-8442-19e3bbb3a2f5.png)\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n* create at least two datasources\r\n* create a template variable that can multi-select the datasources\r\n* repeat a (SVG) panel for a multi-select datasource\r\n* set auto-refresh to e.g. 5 seconds\r\n\r\n**Anything else we need to know?**:\r\nMight be related to #42828.\r\nMy SVG panel configuration:\r\n![image](https://user-images.githubusercontent.com/6523124/148741862-fb92fa93-6c6b-4be0-8e6a-98a6346051ff.png)\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.3\r\n- Data source type \u0026 version: simpod-json-datasource @ 0.3.0\r\n- OS Grafana is installed on: Ubuntu 20.04.3 LTS\r\n- User OS \u0026 Browser: \r\n  - Ubuntu 20.04.3 LTS,  \r\n  - firefox 95.0.1+build2-0ubuntu0.20.04.1, \r\n  - chromium-browser 1:85.0.4183.83-0ubuntu0.20.04.2\r\n- Grafana plugins: \r\n  - alexandra-trackmap-panel @ 2.3.0, \r\n  - agenty-flowcharting-panel @ 1.0.0a,  \r\n  - marcuscalidus-svg-panel @ 0.3.4, \r\n  - natel-plotly-panel @ 0.0.7\r\n- Others:\r\n","labels":["type/duplicate","area/dashboard","area/panel/common","area/panel/infrastructure"]},{"id":44878,"title":"Alert tab missing post upgrade from 7.5.7 to 8.2.3","body":"**What happened**: After upgrading Grafana from 7.5.7 to 8.2.3, we noticed that graph type is set to \"Graph(old)\" and the alerting tab is missing. Its only when we manually change type to \"Time series\", alert tab comes up. \r\n\r\n**What you expected to happen**: Alert tab should show up as it was and perhaps default type should be changed to TimeSeries. https://grafana.com/docs/grafana/latest/visualizations/time-series/\r\n\r\n![image](https://user-images.githubusercontent.com/25523197/152441526-9d31d2b4-6799-4bfa-aa82-0572c5aa4010.png)\r\n\r\n\r\n**Anything else we need to know?**: We have 100s of dashboards and we would like to change all of them. \r\n\r\n**Environment**:\r\n- Grafana version: 8.2.3\r\n- Data source type \u0026 version: Prometheus\r\n- OS Grafana is installed on: Amazon Linux 2\r\n- User OS \u0026 Browser: MacOs/Brave\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/panel/graph","needs more info","area/backend/db/migration"]},{"id":80185,"title":"TypeError: undefined is not an object (evaluating 'Ue.type.toLowerCase')","body":"### What happened?\n\ntrying to edit a query i have just typed in: \r\n\r\nhappens for me on both `grafana-enterprise-10.2.3.linux-arm64.tar.gz` and `grafana-enterprise_10.3.0-64837_64837_darwin_arm64.tar.gz`\n\n### What did you expect to happen?\n\nto be able to edit the query \n\n### Did this work before?\n\nnot sure, just updated grafana from a very old version, started from scratch. \n\n### How do we reproduce it?\n\n1. add a prom query\r\n2. apply, save\r\n3. come back to edit it\r\n\r\n\u003cimg width=\"1912\" alt=\"Screenshot 2024-01-08 at 21 52 34\" src=\"https://github.com/grafana/grafana/assets/4228377/22cc3aa7-e700-4831-b301-1986df4b10c5\"\u003e\r\n\u003cimg width=\"1912\" alt=\"Screenshot 2024-01-08 at 21 52 33\" src=\"https://github.com/grafana/grafana/assets/4228377/b206e7dd-8b0c-40a2-853d-77cd1858e6ec\"\u003e\r\n\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: \r\ndrwxr-xr-x 12 pi pi      4096 Jan  8 21:43 grafana-10.3.0-64837\r\n-rw-r--r--  1 pi pi 111751536 Dec 19 03:13 grafana-enterprise-10.2.3.linux-arm64.tar.gz\r\n-rw-r--r--  1 pi pi 161598224 Jan  8 21:42 grafana-enterprise_10.3.0-64837_64837_darwin_arm64.tar.gz\r\ndrwxr-xr-x 12 pi pi      4096 Jan  8 14:41 grafana-v10.2.3\r\n\u003cimg width=\"1912\" alt=\"Screenshot 2024-01-08 at 21 52 33\" src=\"https://github.com/grafana/grafana/assets/4228377/03ae5d66-457d-4ab6-977d-e88d50f59b33\"\u003e\r\n\u003cimg width=\"1912\" alt=\"Screenshot 2024-01-08 at 21 52 34\" src=\"https://github.com/grafana/grafana/assets/4228377/007a4fab-7a9f-4a44-ba01-a4826388bd5a\"\u003e\r\n\r\nOS: MacOS\r\nBrowser: Chrome / Safari\r\n\n\n### Grafana platform?\n\nA downloaded binary\n\n### Datasource(s)?\n\nprometheus","labels":["type/bug","datasource/Prometheus","needs investigation","area/editor","area/panel/edit"]},{"id":64943,"title":"scrollbars showing in iframe embed (again)","body":"**What happened**:\r\n\r\nWhen embedding a graph in an iframe with kiosk mode, all graphs show a minimal scrollbar, which is scrolling only a few pixels. No matter how I resize the iframe or panel, they do not disappear. But these scrollbars are **_not_** shown in the native grafana dashboard, only when embedding single graph. As I do not have possibilities, to alter html or css in my visualisation, I cannot get rid of this. There was a similar issue in the past, which should have been solved: https://github.com/grafana/grafana/issues/3607\r\n\r\nThis is shown in all of my used browsers: Chrome Windows (Version 111.0.5563.65) and Firefox (Version 111.0), and even on an Android mobile phones (native and chrome). Grafana version: V9.3.2\r\n\r\n![Animation](https://user-images.githubusercontent.com/35151132/225859682-171255a4-1033-42d2-a450-9ef56cda3ecf.gif)\r\n","labels":["area/dashboard","bot/no new info"]},{"id":87888,"title":"Dashboards: How to disable /api/search?","body":"### What happened?\r\n\r\nWhenever the page is accessed, it automatically loads \r\nHTTP GET \"/api/search?limit=5\u0026dashboardUID=xxx\u0026dashboardUID=yyy\"\r\nHow can I avoid duplicate dashboardUID or disable it?\r\n\r\n### What did you expect to happen?\r\n\r\navoid or disable it\r\n\r\n### Did this work before?\r\n\r\nNo\r\n\r\n### How do we reproduce it?\r\n\r\n1.reload page, and use browser tools\r\n\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 9.4.3\r\nOS:windows/mac\r\nBrowser: Edge,chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nA downloaded binary\r\n","labels":["area/dashboard","triage/needs-confirmation","team/grafana-dashboards"]},{"id":53716,"title":"Inconsistent in showing logs for the query with empty filter in Loki query dashboard","body":"What happened:\r\nIn the Loki query dashboard, No data present in the logs for the query with empty filter. Ran a query with empty filter results in No data present for that empty filter. \r\n\r\nWhat you expected to happen:\r\nBased on the time range, It should show all the logs for the query with empty filters present in the query field.\r\n\r\n**How to reproduce it (as minimally and precisely as possible):**\r\n1. Go to the Loki query dashboard.\r\n2. Add a query with empty filter in the query field and run it.\r\n3. It will show that no logs present for the query with empty filter.\r\n\r\n**Anything else we need to know?:**\r\n![image](https://user-images.githubusercontent.com/37366893/184538447-13165747-da14-459e-a24c-6d020c0aca5f.png)\r\n\r\n**Environment:**\r\nGrafana version: _9.0.5_\r\nData source type \u0026 version:\r\nOS Grafana is installed on:\r\nUser OS \u0026 Browser: _Windows 10 \u0026 Google Chrome_\r\nGrafana plugins:\r\nOthers:","labels":["needs investigation","area/explore","datasource/Loki","area/query-editor"]},{"id":45927,"title":"Alerts in pending state: request handler error: failed to query data: EOF","body":"**What happened**: Since we migrated to Grafana 8.2.5, we imported few dashboards from an older Grafana version into the new one and tried to setup alerting, but the alerts are failing with the following error: request handler error: failed to query data: EOF\r\n\r\n**What you expected to happen**:\r\nThe alerts should be triggered and running with success as before\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nThe issue is visible even if the alert is recreated, it is showing up upon clicking on \"Test rule\" button:\r\n\r\n![image](https://user-images.githubusercontent.com/85614462/155750328-528074e1-8cd4-42da-9d51-7ac2a14ecc3d.png)\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/85614462/155750145-e69a8af8-34be-4bf7-85f2-6348cecf8f13.png)\r\n\r\nApparently the datasource and query are OK:\r\n\r\n![image](https://user-images.githubusercontent.com/85614462/155750223-d4c47a39-a834-434d-8d99-d4f351ee225c.png)\r\n\r\n![image](https://user-images.githubusercontent.com/85614462/155750267-e341e9fc-ae24-4071-8a72-0d418cca283e.png)\r\n\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.2.5\r\n- Data source type \u0026 version:  ElasticSearch 7.10.2\r\n- OS Grafana is installed on: Linux/AWS\r\n- User OS \u0026 Browser: Windows 10, Chrome\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/alerting","datasource/Elasticsearch","needs investigation"]},{"id":62927,"title":"failed to save and apply Alertmanager configuration: UNIQUE constraint failed: alert_configuration.org_id","body":"**What happened**:\r\nUnable to add new contact points in rules or change admin alerting settings. These actions produce the following error:\r\n\r\n```\r\nError: failed to save and apply Alertmanager configuration: UNIQUE constraint failed: alert_configuration.org_id\r\n```\r\n\r\nNot sure how to proceed at this point, as manually recreating/copying existing configuration in a newly installed database would be really cumbersome. Is there maybe a way to just reset alert settings? I can then manually reconstruct that part.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nI am unable to provide a way to reproduce this, but on my side this was the result of the following actions:\r\n\r\n1. I created a set of rules in the main org with different contact points.\r\n2. I then created another organization\r\n3. I deleted the newly created organization\r\n4. I then tried adding new contact points and got the following error.\r\n\r\n**Anything else we need to know?**:\r\n\r\nIf needed I can provide an sqlite dump of the alerts.\r\n\r\n**Environment**:\r\n- Grafana version: [v9.3.6 (978237e7cb)](https://github.com/grafana/grafana/blob/main/CHANGELOG.md)\r\n\r\n","labels":["area/alerting","triage/needs-confirmation"]},{"id":65105,"title":"Provisioned datasource's `database` field is missing","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nProvision datasource's `database` field is missing. \r\n\r\n**What you expected to happen**:\r\n\r\nThe older version of grafana (e.g. 9.3.x) works as expected.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nInstall grafana, and use the following provisioning config:\r\n\r\n`/etc/grafana/provisioning/datasources/pigsty.yml`\r\n\r\n\r\n```yaml\r\n---\r\napiVersion: 1\r\n\r\n# remove provisioned data sources\r\ndeleteDatasources:\r\n  - { name: Prometheus , orgId: 1 }\r\n  - { name: Meta       , orgId: 1 }\r\n  - { name: Loki       , orgId: 1 }\r\n\r\n# install following data sources\r\ndatasources:\r\n\r\n  # Pigsty Monitor Database (Prometheus)\r\n  - name: Prometheus\r\n    uid: ds-prometheus\r\n    type: prometheus\r\n    url: http://127.0.0.1:9090\r\n    access: proxy\r\n    isDefault: true\r\n    editable: true\r\n    version: 1\r\n    jsonData:\r\n      timeInterval: \"2s\"\r\n      queryTimeout: \"60s\"\r\n      tlsAuth: false\r\n      tlsAuthWithCACert: false\r\n    secureJsonData: {}\r\n\r\n  # Pigsty Meta Database (PostgreSQL)\r\n  - name: Meta\r\n    type: postgres\r\n    uid: ds-meta\r\n    url: 127.0.0.1:5432\r\n    access: proxy\r\n    user: dbuser_view\r\n    database: meta      # \u003c------- This field is missing in grafana datasoure\r\n    editable: true\r\n    jsonData: {\r\n      \"connMaxLifetime\": 14400,\r\n      \"maxIdleConns\": 10,\r\n      \"maxOpenConns\": 64,\r\n      \"postgresVersion\": 1500,\r\n      \"sslmode\": \"require\",\r\n      \"tlsAuth\": false,\r\n      \"tlsAuthWithCACert\": false\r\n    }\r\n    secureJsonData:\r\n      password: DBUser.Viewer\r\n\r\n  # Pigsty Logging Database (Loki)\r\n  - name: Loki\r\n    type: loki\r\n    uid: ds-loki\r\n    url: http://127.0.0.1:3100\r\n    access: proxy\r\n    editable: true\r\n...\r\n```\r\n\r\nAnd if you list datasource API, you will get \r\n\r\n```yaml\r\n {'id': 2,\r\n  'uid': 'ds-meta',\r\n  'orgId': 1,\r\n  'name': 'Meta',\r\n  'type': 'postgres',\r\n  'typeName': 'PostgreSQL',\r\n  'typeLogoUrl': 'public/app/plugins/datasource/postgres/img/postgresql_logo.svg',\r\n  'access': 'proxy',\r\n  'url': '127.0.0.1:5432',\r\n  'user': 'dbuser_view',\r\n  'database': '',            # \u003c-------- Problematic\r\n  'basicAuth': False,\r\n  'isDefault': False,\r\n  'jsonData': {'connMaxLifetime': 14400,\r\n   'maxIdleConns': 10,\r\n   'maxOpenConns': 64,\r\n   'postgresVersion': 1500,\r\n   'sslmode': 'require',\r\n   'tlsAuth': False,\r\n   'tlsAuthWithCACert': False},\r\n  'readOnly': False}\r\n```\r\n\r\n\r\n**Anything else we need to know?**:\r\n\r\ncheck the default `/etc/grafana/provisioning/datasources/sample.yaml`\r\n\r\nsomething looks wierd, like missing a filed and 'database' type is wrong (`boolean` rather than `string`). Guess may have something to do with this issue.\r\n\r\n```yaml\r\n# # config file version\r\napiVersion: 1\r\n\r\n# # list of datasources that should be deleted from the database\r\n#deleteDatasources:\r\n#   - name: Graphite\r\n#     orgId: 1\r\n\r\n# # list of datasources to insert/update depending\r\n# # on what's available in the database\r\n#datasources:\r\n#   # \u003cstring, required\u003e name of the datasource. Required\r\n# - name: Graphite\r\n#   # \u003cstring, required\u003e datasource type. Required\r\n#   type: graphite\r\n#   # \u003cstring, required\u003e access mode. direct or proxy. Required\r\n#   access: proxy\r\n#   # \u003cint\u003e org id. will default to orgId 1 if not specified\r\n#   orgId: 1\r\n#   # \u003cstring\u003e url\r\n#   url: http://localhost:8080\r\n#   # \u003cstring\u003e database user, if used\r\n#   user:\r\n#   # \u003cstring\u003e database name, if used\r\n#   database:            # \u003c----------- LOOKS LIKE SOMETHING WRONG HERE:\r\n#   # \u003cbool\u003e enable/disable basic auth\r\n#   basicAuth:\r\n#   # \u003cstring\u003e basic auth username\r\n#   basicAuthUser:\r\n#   # \u003cbool\u003e enable/disable with credentials headers\r\n#   withCredentials:\r\n#   # \u003cbool\u003e mark as default datasource. Max one per org\r\n#   isDefault:\r\n#   # \u003cmap\u003e fields that will be converted to json and stored in json_data\r\n#   jsonData:\r\n#      graphiteVersion: \"1.1\"\r\n#      tlsAuth: true\r\n#      tlsAuthWithCACert: true\r\n#      httpHeaderName1: \"Authorization\"\r\n#   # \u003cstring\u003e json object of data that will be encrypted.\r\n#   secureJsonData:\r\n#     tlsCACert: \"...\"\r\n#     tlsClientCert: \"...\"\r\n#     tlsClientKey: \"...\"\r\n#     # \u003copenshift\\kubernetes token example\u003e\r\n#     httpHeaderValue1: \"Bearer xf5yhfkpsnmgo\"\r\n#   version: 1\r\n#   # \u003cbool\u003e allow users to edit datasources from the UI.\r\n#   editable: false\r\n```\r\n\r\n\r\n\r\n\r\n**Environment**:\r\n- Grafana version: Version 9.4.3 (commit: cf0a135595, branch: HEAD)\r\n- Data source type \u0026 version: PostgreSQL\r\n- OS Grafana is installed on: Rocky Linux 9.1 x86_64\r\n- User OS \u0026 Browser: MacOS \r\n- Grafana plugins: N/A\r\n- Others: N/a\r\n","labels":["area/backend","area/provisioning","triage/needs-confirmation"]},{"id":64187,"title":"Templating [tag] Error updating options: undefined is not an object (evaluating 'V.fields')","body":"With a variable using a regex the following error occurs when the query returns no data:\r\nTemplating [tag] Error updating options: undefined is not an object (evaluating 'V.fields')\r\n\u003cimg width=\"627\" alt=\"Bildschirm­foto 2023-03-04 um 11 13 52\" src=\"https://user-images.githubusercontent.com/3825852/222894277-e7406413-a742-49e7-a49f-349097309907.png\"\u003e\r\n\r\n**What you expected to happen**:\r\nNo error and list of template variables empty\r\n\r\n**Anything else we need to know?**:\r\n\u003cimg width=\"501\" alt=\"Bildschirm­foto 2023-03-04 um 11 17 19\" src=\"https://user-images.githubusercontent.com/3825852/222894303-f7ec1edf-c8d0-4518-bb5a-b034a6c2189c.png\"\u003e\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.3\r\n","labels":["type/bug","help wanted","prio/support-subscription","datasource/MySQL","datasource/Postgres","good first issue","prio/customer-support"]},{"id":43937,"title":"Geomap data links don't work","body":"Grafana 8.3.0, self hosted, open source\r\n\r\nWhen setting a data-link in the Geomap panel, I expect map markers to become clickable as per the data link. However, the map markers are not clickable and there is no link.","labels":["area/panel/geomap"]},{"id":44086,"title":"Gauge visualization and Math Expression","body":"**What happened**:\r\nIf a Math Expression is used with the Gauge visualization \"No data\" is represented\r\n\r\n**What you expected to happen**:\r\nExpression is calculated and shown\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nQuery A (disabled):\r\nfrom(bucket: \"xxx\")\r\n  |\u003e range(start: v.timeRangeStart, stop:v.timeRangeStop)\r\n  |\u003e filter(fn: (r) =\u003e\r\n    r._measurement == \"xxx\" and\r\n    r._field == \"xxx\"\r\n  )\r\n  |\u003e last()\r\n\r\nExpression:\r\n$A*-1\r\n\r\nOther info:\r\nData contains \"0\"\r\nSeems to be an issue also for Time series/graph\r\n\r\n**Environment**:\r\n- Grafana version: 8.1.2\r\n- Data source type \u0026 version: Influxdb\r\n- OS Grafana is installed on: Windows 10\r\n","labels":["needs more info","area/expressions","bot/no new info"]},{"id":80823,"title":"Cannot edit/create a new rule in an evaluation group if another alert is invalid","body":"### What happened?\r\n\r\n- Have an evaluation group with broken alerts (tested with a removed datasource) in Grafana alerting.\r\n- Edit one alert to fix the issue (so here it would be migrating the datasource), or try to create a new one in the same evaluation group\r\n- Click the button to save the rule\r\n- An error occurs: \"Failed to save rule: failed to update rule group: invalid alert rule etc.\" but which concerns another alert of the current evaluation group (not the one being currently edited)\r\n\r\nWhen looking at the requests performed by the browser, it seems that when saving an alert it re-saves the entire evaluation group at once and not just the alert being edited currently.\r\nSo a workaround is: replay manually the API POST request to edit all alerts at once (in a way that all alerts are fixed and valid): everything is saved and the evaluation groups and the alerts work again. \r\n\r\n### What did you expect to happen?\r\n\r\n- The current rule can be edited or another new rule can be created in an evaluation group even if another rule is broken\r\n\r\n### Did this work before?\r\n\r\nI don't know\r\n\r\n### How do we reproduce it?\r\n\r\n1. Create an evaluation group and some alerts\r\n2. Remove the datasource used by one of the alert\r\n3. It's impossible to edit or create a new alert in the evaluation group\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.2.2\r\nOS: Ubuntu 22.04\r\nBrowser: firefox 121.0.1\r\n\r\n\r\n### Grafana platform?\r\n\r\nI don't know\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/alerting"]},{"id":71022,"title":"Server URL difference in the two tab URLs of \"share\" and \"Public dashboard\"","body":"### \r\n# What went wrong?\r\n\r\n\r\nComparison with 2 URLs when sharing a graph\r\n1. Link tap URL\r\n  A typical Share Link represents an IP.\r\n - ex) https://{Server IP}:3000/d/000000001/TEST?orgId=1\u0026from=1687826901284\u0026to=1688431701284\r\n2. Public dashboard URL\r\n  The public dashboard shows localhost.\r\n - ex) https://localhost:3000/public-dashboards/abaede9e003c4d198660654955dbd83a\r\n\r\n###  v10.0.1 (5a30620b85)\r\nWhy is my public dashboard URL localhost?\r\nConsistency is required.\r\n![v10.3.2 (21c1d14e91)](https://file.notion.so/f/s/4b70b235-559b-479c-bce7-cfcb863ddd90/Grafana_URL_localhost.png?id=97a5aaab-66cb-456d-ba4f-13755f760b97\u0026table=block\u0026spaceId=343a1c7d-523d-4c9a-9f95-0c4b068afb2b\u0026expirationTimestamp=1688464800000\u0026signature=b_4PXo5jOP_Zrn_mQ6DybLbP3lwLgQnLUfdgFkRzLTk\u0026download=true\u0026downloadName=Grafana_URL_localhost.png)\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\nAfter installation, you can verify by comparing the URLs of the two tabs \"Share\" and \"Public Dashboard\".\r\n\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\n5a30620b85\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\n_No response_\r\n\r\n### Grafana Platform?\r\n\r\nA downloaded binary\r\n\r\n### User's OS?\r\n\r\nubuntu 20.04\r\n\r\n### User's Browser?\r\n\r\n_No response_\r\n\r\n### Is this a Regression?\r\n\r\nNo\r\n\r\n### Are Datasources involved?\r\n\r\n_No response_\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["area/dashboard","bot/no new info","triage/needs-confirmation","team/grafana-dashboards"]},{"id":64226,"title":"\"Grouping to matrix\" transform breaks \"Convert field type\" and footer sum","body":"**What happened**:\r\n\r\nIn a table panel, when the datasource query results are formatted using a `Grouping to matrix` transform, the cell values are converted to the string type for one reason or the other.\r\n\r\nNevertheless, trying to convert said cell values back to `Numeric` using a `Convert field type` transform will fail and throw an error:\r\n\r\n![Screenshot 2023-03-06 at 14 29 25](https://user-images.githubusercontent.com/4224802/223125851-d9106c44-520f-4b4a-a8ab-2148d0781b7b.png)\r\n\r\n**What you expected to happen**:\r\n\r\nI would expect the value to be converted to `Numeric` and the `Total` footer aggregation to be calculated instead of concatenating the cell values as strings.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n1. Create a table panel\r\n2. Query a data source where the cell value is numeric\r\n3. Use a `Grouping to matrix` transform\r\n4. Follow up with a `Convert field type` transform with data type `Numeric` on the cell column specified in the grouping stage\r\n\r\nIf you look at your console, you will see an error with the message: `s.replace is not a function`.\r\nAdditionally, if you enable the table footer feature and set the aggregation to be `Total`, the result will be the concatenated string values instead of the sum of all values.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: v9.2\r\n- Data source type \u0026 version: PostgreSQL\r\n- OS Grafana is installed on: Ubuntu\r\n- User OS \u0026 Browser: Google Chrome on OSX Apple Silicon\r\n- Grafana plugins: N/A\r\n- Others: -\r\n","labels":["needs more info","area/panel/table","datasource/Postgres","area/transformations"]},{"id":70669,"title":"Annotations: Cannot disable annotations with the same name ","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n  - When having 2 annotations with the same name (in my case, 2 time regions) it is impossible to disable both in the dashboard header. Toggling the first and second one will both toggle the first one, and it is impossible to disable the second annotation this way\r\n![image](https://github.com/grafana/grafana/assets/32877621/f9c958ff-7fbe-4657-bd9e-55f25b8a69ad)\r\n![image](https://github.com/grafana/grafana/assets/32877621/ad55223a-3b0d-4b2c-b893-6283ee7dbd88)\r\n\r\n\r\n**What did you expect to happen**:\r\n\r\n  - When toggling the first one, it should toggle the first time region, and when toggling the second one it should toggle the second one\r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Open Grafana and create a new dashboard.\r\n\r\n**Step 2**:\r\n\r\n- Open Dashboard settings \u003e Annotations and create 2 annotations with the same name, in my case, those are Time regions from the Grafana Datatsource. Make sure Hidden is unclicked\r\n![image](https://github.com/grafana/grafana/assets/32877621/a3630c32-e701-4a44-abf7-ce765617cfd4)\r\n\r\n\r\n**Step 3**:\r\n\r\n- Go back to the dashboard (maybe a refresh/save is needed?) and try to toggle the 2 annotations with similar names in the dashboard header. Toggling the first and second one will both toggle the first one, and it is impossible to disable the second annotation this way\r\n\n\n### \n# What Grafana version are you using?\n\n\nGrafana v10.0.1 (5a30620b85)\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nDocker\n\n### User's OS?\n\nWindows 10 Pro 22H2\n\n### User's Browser?\n\nChrome 114\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\nUnsure if this issue was happening before 10.x.x, as I started to use annotations for the time regions.","labels":["area/annotations","triage/needs-confirmation","team/grafana-dashboards"]},{"id":88769,"title":"Grafana Alerts Rules don't work with non root users","body":"### What happened?\n\nI am trying to create an alert rule with my custom datasource plugin and get an error that the plugin is unavailable.\r\nThis error:\r\n\r\n\u003e [sse.dataQueryError] failed to execute query [A]: [plugin.unavailable] plugin unavailable\r\n\r\nSome details:\r\nI am running grafana as a podman container:\r\n\r\n\u003e grafana:\r\n\u003e     image: grafana/grafana:11.0.0-preview\r\n\u003e     container_name: grafana\r\n\u003e     ports:\r\n\u003e       - 172.17.0.1:3000:3000\r\n\u003e     volumes:\r\n\u003e       - /var/don/grafana/:/var/lib/grafana:z\r\n\u003e       - /var/don/grafana/plugins/:/plugins:z\r\n\u003e       - /var/don/grafana/grafana.ini:/etc/grafana/grafana.ini:z\r\n\u003e     user: 1000:357\r\n\u003e     environment:\r\n\u003e       - GF_LOG_LEVEL=error\r\n\u003e       - GF_SERVER_ROOT_URL=%(protocol)s://%(domain)s/proxy/grafana/?(.*)\r\n\u003e       - GF_SECURITY_ALLOW_EMBEDDING=true\r\n\r\nThe issue is very similar to this one:\r\nhttps://github.com/grafana/opensearch-datasource/issues/251\r\n\r\nThe error is the same. The only difference is the content of the /tmp directory. With non-root user, it looks like this:\r\n![image](https://github.com/grafana/grafana/assets/89776717/a49da745-5f75-4b5f-baa0-4fefa8f3a9ec)\r\n\r\nWith the root user like this (with have several custom datasources with alerting feature):\r\n![image](https://github.com/grafana/grafana/assets/89776717/635446b5-33d9-4298-ad6e-d2c4879d51d6)\r\nThe question is why the custom plugins are not shown in the /tmp directory. I assumed that permission and ownership of /tmp or /plugins directories would be the problem. But giving full permission to all users doesn't solve the problem. \r\n\r\nWhen I try to start the binaries manually, I have this:\r\n![image](https://github.com/grafana/grafana/assets/89776717/cdb7b86f-47af-444a-a828-308932193305)\r\n\r\nIn Grafana logs, I see the following:\r\n\r\n\u003e logger=plugins.initialization t=2024-06-05T11:58:17.554137733Z level=error msg=\"Could not initialize plugin\" pluginId=optimax-streaming-datasource error=\"Unrecognized remote plugin message: \\nFailed to read any lines from plugin's stdout\\nThis usually means\\n  the plugin was not compiled for this architecture,\\n  the plugin is missing dynamic-link libraries necessary to run,\\n  the plugin is not executable by this process due to file permissions, or\\n  the plugin failed to negotiate the initial go-plugin protocol handshake\\n\\nAdditional notes about plugin:\\n  Path: /var/lib/grafana/plugins/optimax-streaming-datasource/dist/gpx_backend_datasource_linux_amd64\\n  Mode: -rwxr-xr-x\\n  Owner: 1000 [optimax] (current: 1000 [optimax])\\n  Group: 357 [357] (current: 357 [357])\\n  ELF architecture: EM_X86_64 (current architecture: amd64)\\n\"\r\n\r\nThe binaries are compiled with the latest grafana-plugin-sdk-go, the GO version: 1.21.7. \r\n\r\n\n\n### What did you expect to happen?\n\nalert rules created without any errors.\n\n### Did this work before?\n\nIt works flawlessly with the root user.\n\n### How do we reproduce it?\n\n1. Take any plugin with enabled and working alerting feature\r\n2. Create a new alert rule\r\n3. Click \"Preview\".\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: v11.0.0-preview (tested in other versions - same error)\r\nPodman: v4.6.1\r\nBrowser: Chrome\r\nLinux: RHEL 9.3\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\nCustom, not published Datasource","labels":["area/plugins","area/backend/plugins","not implemented"]},{"id":89893,"title":"Dashboards not refreshing upon entry","body":"### What happened?\r\n\r\nWe have just upgraded to Grafana 11, and it appears that Grafana is unable to refresh dashboards upon entry. This means that regardless of the refresh time setting, including \"auto,\" you'll need to wait for the dashboards to refresh to display the current data. \r\n\r\n### What did you expect to happen?\r\n\r\nI expect that when I enter a dashboard, it will display the current changes immediately and then start to use the configured refresh interval.\r\n\r\n### Did this work before?\r\n\r\nWe did not encounter this issue in Grafana 10, which was the version we used previously.\r\n\r\n### How do we reproduce it?\r\n\r\n1. Open the dashboard, set the refresh interval to 10 seconds, and save your changes.\r\n2. Re-enter the dashboard and select a different time range to ensure it doesn't use cached data.\r\n![image](https://github.com/grafana/grafana/assets/138589531/3a109cb3-8537-4cfd-b28f-f02c1ce2c374)\r\n\r\n3. Notice that the dashboard will wait 10 seconds before refreshing.\r\n![image](https://github.com/grafana/grafana/assets/138589531/e9212fd6-ad5a-46a1-bed5-b76500752ec0)\r\n\r\nThe images above illustrate this issue: the first image shows the dashboard upon entry, and the second image shows it after 10 seconds.\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nOld Helm Version: 6.60.6\r\nOld Application Version: 10.1.5\r\n\r\nCurrent Helm Version: 8.0.2\r\nCurrent Application Version: 11.0.0\r\n\r\n### Grafana platform?\r\n\r\nKubernetes\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/dashboard","needs more info"]},{"id":64578,"title":"Error loading Alertmanager config: Missing service or routing key in PagerDuty config","body":"### What happened:\r\nConfigured an alert (on the prometheus alertmanager). Also added a pagerduty contact point and provided pagerduty service_key via `service_key_file`.\r\nError on Contact points and Notification policies - \"Error loading Alertmanager config: Missing service or routing key in PagerDuty config\"\r\n\r\n### What you expected to happen:\r\nNo error in alertmanager pod logs. Prometheus alertmanager UI on grafana should work properly.\r\n\r\n### How to reproduce it (as minimally and precisely as possible):\r\n```\r\n\r\nreceivers:\r\n- name: pd-test\r\n  pagerduty_configs:\r\n    service_key_file: /etc/vm/secrets/pd-test/pd-test-key\r\n```\r\n\r\nthe key is mounted as an optional volume-mount:\r\n```\r\n    volumes:\r\n      - name: 'pd-test'\r\n        secret:\r\n          secretName: 'pd-test'\r\n          optional: true\r\n    volumeMounts:\r\n       - name: 'pd-test'\r\n         mountPath: '/etc/vm/secrets/pd-test'\r\n         readOnly: true\r\n\r\n```\r\n### Screenshot:\r\n![image](https://user-images.githubusercontent.com/46317159/224194934-a9108a4f-ef67-4d79-bdc9-7b46fdbab841.png)\r\n","labels":["area/alerting","area/frontend","stale"]},{"id":53907,"title":"Alert manager data source yaml doesn't show how to specify the implementation","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nThe Alertmanager UI shows an \"Implementation\" drop down, with Mimir, Cortex and Prometheus. \r\nThe documentation at https://grafana.com/docs/grafana/latest/datasources/alertmanager/#alertmanager-implementations does not show how to configure this in the provisioning yaml.\r\n\r\n**What you expected to happen**:\r\n\r\nA reference for the alertmanager provisioning YAML - the possible configuration options, including implementation, auth and the types of value accepted here.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nCompare the UI options with the documentation.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: v9.1.0 (82e32447b4)\r\n- Data source type \u0026 version: alertmanager\r\n- OS Grafana is installed on: grafana/grafana container image\r\n- User OS \u0026 Browser: Chrome, MacOS\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/docs","area/alerting","stale","datasource/Alertmanager"]},{"id":69349,"title":"Grafana dashboard keep prompt to save change when there isn't changes to save","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\n  - I have create a new dashboard with a new panel and custom datasource.\r\n  - I have just upgraded Grafana from 8.1.2 to 9.1.0.\r\n  - I navigate to the new dashboard and click on editing, but didn't make any changes, then go back to dashboad and click on logo to leave the dashboard.\r\n  - It prompt me to save unsaved changes, but I click on save dashboard it shows no changes to save and disabled the save button.\r\n  - The only way I could get out there is either of click discard to reload.\r\n\r\n**What did you expect to happen**:\r\n\r\n  - It should not keep prompt me to save when I leave the dashboard when there isn't changes to save.\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\n9.1.0 - 9.5.2\r\n\r\n### Grafana Platform?\r\n\r\nKubernetes\r\n\r\n### User's OS?\r\n\r\nUbutun\r\n\r\n### User's Browser?\r\n\r\nEdge\r\n\r\n### Is this a Regression?\r\n\r\nYes\r\n\r\n### Are Datasources involved?\r\n\r\nA custom datasource\r\n\r\n### Anything else to add?\r\n\r\n\r\nN/A","labels":["area/dashboard","team/grafana-dashboards","prio/future"]},{"id":53504,"title":"Geomap tooltip is not shown.","body":"Geomap tooltip is no longer shown.\r\n\r\nAfter an upgrade from grafana 8.x to 9.x the tooltip is no longer show when hovering/clicking a marker.\r\n\r\nWhen in Edit modus, the tooltip is shown, and works as expected, BUT it is shown in the wrong place!\r\n\r\n![image](https://user-images.githubusercontent.com/8330653/183856390-cc1b087c-bece-4795-9a28-15f2891c9d75.png)\r\n\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nAdd a geomap. \r\nAdd a marker layer.\r\nHover a marker.\r\nClick a marker.\r\n\r\n**Environment**:\r\n- Grafana version: v9.0.6 (556faf829)\r\n- Data source type \u0026 version: Microsoft SQL Server - 5.0.0\r\n- OS Grafana is installed on:  Windows Server 2019 - Microsoft Windows Server Version 1809 (OS Build 17763.3046)\r\n- User OS \u0026 Browser:  Windows - Chrome\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["needs more info","area/panel/geomap"]},{"id":59408,"title":"Zooming in on Panel reveals \"No Data\" although data is present","body":"**What happened**:\r\nI have a docker-compose setup for Grafana + Promtail + Loki\r\nI have a set of config files written by my software that I am reading from /var/log\r\nI can display the data and it is shown and I love it but the resolution I can select with Grafana (e.g. 1h, 3h, 6h, ...) is not useful for the analysis I need. \r\n\u003cimg width=\"1310\" alt=\"Screenshot 2022-11-28 at 15 39 17\" src=\"https://user-images.githubusercontent.com/24893086/204307727-a3ad62fb-6c5e-4c8c-84a4-34645762691b.png\"\u003e\r\n\r\nSo I am trying to zoom into the data but no matter how I try to access the data, any approach that is NOT selecting a time slot provided in the dropdown at the panel results in a \"No Data\" output.\r\n\u003cimg width=\"1310\" alt=\"Screenshot 2022-11-28 at 15 51 36\" src=\"https://user-images.githubusercontent.com/24893086/204307866-6f0edbaa-22e0-40fd-b56e-5b89a9111a07.png\"\u003e\r\n\r\n**What you expected to happen**:\r\nI expected to zoom into the data and see fewer data points\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nLoad a log file into Grafana with Loki as data source.\r\nCreate a very simple query: {filename=\"/var/log/nf_transport_new.log\"} |= ``\r\nAdd transformation to get values:\r\n\u003cimg width=\"1310\" alt=\"Screenshot 2022-11-28 at 15 48 45\" src=\"https://user-images.githubusercontent.com/24893086/204307410-fb8386fd-1569-4472-9a68-e126501eec0c.png\"\u003e\r\n\r\n\r\n**Anything else we need to know?**:\r\nThis is the log file I am using in case that shows anything :S\r\n[nf_transport_new.log](https://github.com/grafana/grafana/files/10104820/nf_transport_new.log)\r\n\r\n**Environment**:\r\n- Grafana version:     \r\n  - image: grafana/grafana:latest\r\n- Data source type \u0026 version:\r\n  - image: grafana/promtail:2.4.0\r\n  - image: grafana/loki:2.4.0\r\n- OS Grafana is installed on: MacOS X 10.15.7 (Localhost)\r\n- User OS \u0026 Browser: MacOS X 10.15.7 \u0026 Safari\r\n- Grafana plugins: \r\n- Others:\r\n","labels":["area/dashboard","area/dashboard/timerange","area/docker","datasource/Loki","bot/no new info"]},{"id":46592,"title":"Gauge panel showing g.toFixed is not a function error","body":"**What happened**:\r\nWhen a query was run on the Gauge panel that returned no data, it showed a red \"g.toFixed is not a function\" error:\r\n![image](https://user-images.githubusercontent.com/98583473/158408932-3e1eb779-c3c7-486c-90b7-0206fc6bdce4.png)\r\n\r\nUnder inspect, with the Gauge panel displaying as broken, we have:\r\n```\r\n[request:Object]()\r\n[url:\"\u003cquery url\u003e\"]()\r\n[method:\"GET\"]()\r\n[hideFromInspector:false]()\r\n[response:Object]()\r\n[status:\"success\"]()\r\n[data:Object]()\r\n[resultType:\"matrix\"]()\r\n[result:Array[1]]()\r\n```\r\nI have removed the actual query URL for privacy reasons, please let me know if you need to see this.\r\n\r\nThe panel JSON is here:\r\n```\r\n{\r\n  \"cacheTimeout\": null,\r\n  \"gridPos\": {\r\n    \"h\": 8,\r\n    \"w\": 6,\r\n    \"x\": 18,\r\n    \"y\": 9\r\n  },\r\n  \"id\": 92,\r\n  \"links\": [],\r\n  \"options\": {\r\n    \"reduceOptions\": {\r\n      \"values\": false,\r\n      \"calcs\": [\r\n        \"last\"\r\n      ],\r\n      \"fields\": \"\"\r\n    },\r\n    \"text\": {},\r\n    \"showThresholdLabels\": false,\r\n    \"showThresholdMarkers\": false,\r\n    \"orientation\": \"auto\"\r\n  },\r\n  \"pluginVersion\": \"7.5.12\",\r\n  \"targets\": [\r\n    {\r\n      \"expr\": \"globalStatSIPCongestionQOldestPkt{instance=~\\\"$instance\\\", regionShortname=~\\\"$region\\\", azureAvailabilityZone=~\\\"$az\\\", siName=~\\\"$si_name\\\", softwareVersion=~\\\"$version\\\", siType=~\\\"$siType\\\"}\",\r\n      \"format\": \"time_series\",\r\n      \"intervalFactor\": 1,\r\n      \"legendFormat\": \"\",\r\n      \"refId\": \"A\"\r\n    }\r\n  ],\r\n  \"timeFrom\": null,\r\n  \"timeShift\": null,\r\n  \"title\": \"Oldest Packet in Queue\",\r\n  \"type\": \"gauge\",\r\n  \"fieldConfig\": {\r\n    \"defaults\": {\r\n      \"thresholds\": {\r\n        \"mode\": \"absolute\",\r\n        \"steps\": [\r\n          {\r\n            \"color\": \"green\",\r\n            \"index\": 0,\r\n            \"value\": null\r\n          },\r\n          {\r\n            \"color\": \"red\",\r\n            \"index\": 1,\r\n            \"value\": 800\r\n          }\r\n        ]\r\n      },\r\n      \"mappings\": [],\r\n      \"color\": {\r\n        \"mode\": \"thresholds\"\r\n      },\r\n      \"decimals\": null,\r\n      \"max\": \"1000\",\r\n      \"min\": 0,\r\n      \"unit\": \"ms\"\r\n    },\r\n    \"overrides\": []\r\n  },\r\n  \"datasource\": null\r\n}\r\n```\r\n\r\n**What you expected to happen**:\r\nWe expect the panel to show 0 when there is no data, e.g.\r\n![image](https://user-images.githubusercontent.com/98583473/158409041-4877d9ef-bddb-46be-b44a-e4bec6ad13d9.png)\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nRun a query that returns no data on a Gauge panel.\r\n\r\n**Anything else we need to know?**:\r\nThere is some strange behaviour with this, in that it will work as expected for some queries, then if a historical query is run it will break. Once it is broken, it continue to show the above error even on queries that were previously working.\r\n\r\nI am aware this has been raised as an issue before, for example [here](https://github.com/grafana/grafana/issues/24897), with a fix put into [v7.0.4](https://github.com/grafana/grafana/pull/24938/files), and [here](https://github.com/grafana/grafana/issues/25279?msclkid=7983faaca46c11ecb7f021ddd1bc2e3c), with a fix put into [v7.4.0](https://github.com/grafana/grafana/pull/30156). Unfortunately, we are using v7.5.10 and this still isn't working.\r\n\r\n**Environment**:\r\n- Grafana version: 7.5.10\r\n- Data source type \u0026 version: Prometheus, via kube-prometheus-stack v30.0.1\r\n- OS Grafana is installed on: Azure Kubernetes Service\r\n","labels":["needs more info","area/panel/gauge"]},{"id":66544,"title":"Gauge Panel: Repeat options/Repeat by variable + Transform/Config from query results does not set maximum correctly only for the first value","body":"**What happened**:\r\n\r\nGauge panel sets maximum value only for the first value of the repeated variable with Transform/Config from query.\r\n\r\n**What you expected to happen**:\r\n\r\nI expect that maximum value from query will set correctly for all values of the repeated variable\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nHere are the details [Gauge Panel: Repeat options/Repeat by variable + Transform/Config from query results does not set maximum correctly](https://community.grafana.com/t/gauge-panel-repeat-options-repeat-by-variable-transform-config-from-query-results-does-not-set-maximum-correctly/85707)\r\n\r\n**Anything else we need to know?**:\r\n\r\nLet me know what else to share\r\n\r\n**Environment**:\r\n- Grafana version: v9.4.7 (4add91f03d) \r\n- Data source type \u0026 version: Prometheus 2.43.0\r\n- OS Grafana is installed on: Desktop Docker For Windows 4.18.0\r\n- User OS \u0026 Browser: Windows 10 Pro 64bit, Chrome\r\n- Grafana plugins: default installation based on the official Grafana Docker image [grafana/grafana ](https://hub.docker.com/r/grafana/grafana)\r\n- Others:\r\n","labels":["area/panel/gauge","stale","triage/needs-confirmation","area/dataviz"]},{"id":69664,"title":"Setup: configure HTTPS \u003e can't self-generate certificate","body":"### \n# What went wrong?\n\n\nhttps://grafana.com/docs/grafana/latest/setup-grafana/set-up-https/\r\n\r\nthis command does not works, because  grafana.csr has no path:\r\n```\r\nopenssl x509 -req -days 365 -in grafana.csr -signkey /etc/grafana/grafana.key -out /etc/grafana/grafana.crt\r\nCan't open grafana.csr for reading, No such file or directory\r\n```\r\n\n\n### \n# How do we reproduce it?\n\n\nrun the command \n\n### \n# What Grafana version are you using?\n\n\nasdf\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nasfd\n\n### Grafana Platform?\n\nNone\n\n### User's OS?\n\n_No response_\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["area/auth","triage/needs-confirmation"]},{"id":48156,"title":"Creating library panel from specific panel kills dashboard","body":"I'm using a stat panel with a TestData DB source, to display a static value. This value is then mapped to text, and a data link is used. Long story short it's an easy shortcut for large, auto-scaled clickable text without having to deal with HTML blocks in text panels. This has worked great for a long time. However I've just started experimenting with creating library panels from these, for easy re-use in other dashboards. This has worked with every stat panel I'm using in this fashion, except for one particular panel (the panel displaying the large HVAC text in the attached dashboard). On this particular panel, I can click More \u003e Create Library Panel and it works just fine like the others, but it kills the dashboard. When I save the dashboard after this, then refresh the page (hit f5, or pull it up elsewhere), I get a Dashboard Init Failed, and the dashboard is entirely blank and unusable. This is what Chrome console has to say (the full chrome console log is attached):\r\n\r\n```\r\ninitDashboard.ts:137 TypeError: Cannot read properties of null (reading 'y')\r\n    at DashboardModel.ts:521:47\r\n    at Array.sort (\u003canonymous\u003e)\r\n    at O.sortPanelsByGridPos (DashboardModel.ts:520:17)\r\n    at new O (DashboardModel.ts:181:10)\r\n    at initDashboard.ts:134:19\r\n  ```\r\n\r\nThis should (hopefully) be easily reproducible by importing my attached dashboard, and on the top left most panel (that says HVAC), click More \u003e Create Library Panel. Save the dashboard, then F5 the page. If it's reproducible, you'll get an empty dashboard with an init error. No new lines or errors logged in grafana.log on the server\r\n\r\n**Environment**:\r\n- Grafana version: occurs in both v8.4.6 and v8.5.0\r\n- Data source: TestData DB\r\n- OS Grafana is installed on: Debian 11 x64\r\n- User OS \u0026 Browser: Windows 10 x64, Google Chrome, same result in IE \u0026 Edge\r\n\r\n[Bug-example-library-panel.json.txt](https://github.com/grafana/grafana/files/8549646/Bug-example-library-panel.json.txt)\r\n[chrome-log.log](https://github.com/grafana/grafana/files/8549647/chrome-log.log)","labels":["bot/no new info","area/frontend/library-panels"]},{"id":58914,"title":"Alerts - Go Template not fetching \".Values\" when using \"default code\"","body":"**What happened**:\r\ni'm trying to play a bit with GO Template to create a easy to read notification for Telegram when an alert is fired\r\nMy template is as follow and the intention is to fetch the .Values particularly the name and the value of the variable i want to be alerted on (refID and value).\r\n\r\n```\r\n{{ define \"values_list\" }}\r\n\t{{ $len := len .Values }}\r\n\t{{ if $len }}\r\n\t\t{{ $first := gt $len 1 }}\r\n\t\t{{ range $refID, $value := .Values -}}\r\n\t\t\t{{ $refID }}={{ $value }}\r\n\t\t\t{{ if $first }}, {{ end }}\r\n\t\t\t{{ $first = false }}\r\n\t\t{{ end -}}\r\n\t{{ else }}\r\n\t\t[no value]\r\n\t{{ end }}\r\n{{ end }}\r\n\r\n{{ define \"alerts_list\" }}\r\n\t{{ range . }}\r\n\t\tValue: {{ template \"values_list\" . }}\r\n\t{{ end }}\r\n{{ end }}\r\n\r\n{{ define \"mymessage\" }}\r\n\t{{ if gt (len .Alerts.Firing) 0 }}\r\n\t\t[Alert]: {{ template \"alerts_list\" .Alerts.Firing }}\r\n\t\t{{ if gt (len .Alerts.Resolved) 0 }}\r\n\t\t\r\n\t\t{{ end }}\r\n\t{{ end }}\r\n\t{{ if gt (len .Alerts.Resolved) 0 }}\r\n\t\t[OK]: {{ template \"alerts_list\" .Alerts.Resolved }}\r\n\t{{ end }}\r\n{{ end }}\r\n```\r\n\r\n**What you expected to happen**:\r\nAs you can see my \"value_list\" and \"alerts_list\" are pretty much identical to the default \"__text_value_list\" and \"__text_alert_list\" but for whatever reason the Telegram message reports empty content\r\n\r\n```\r\n[Alert]:\r\n  Value: \r\n```\r\n\r\nIf i change my template so that it calls the default \"__text_alert_list\", variable name and value are reported as expected.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nAdd the template above to a Telegram contact points and make it react in case a variable is above e.g. 100\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.4\r\n","labels":["area/alerting/notifications","bot/no new info"]},{"id":56445,"title":"Panels with DataSource \"-- Dashboard --\" don't refresh on variable change","body":"**What happened**:\r\nI have a table panel with a MySQL query, using a variable.\r\nIn the same dashboard, I have another panel, using DataSource : \"-- Dashboard --\".\r\nWhen I change the value of the variable, the table panel refresh, but the other don't.\r\n\r\n**What you expected to happen**:\r\nI want the second panel to also refresh when the datas of it's referenced panel change.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.1.6\r\n- Data source type \u0026 version: MySQL 5.0.0\r\n- OS Grafana is installed on: linux debian 10\r\n- User OS \u0026 Browser: Windows 10 / Firefox 105.0.1\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["datasource/MSSQL","needs investigation","area/panel/stat"]},{"id":53212,"title":"'folder:current' query no longer works in Grafana 9","body":"**What happened**:\r\nAfter upgrading to Grafana 9.0.6, we've noticed that searching dashboards with `folder:current` no longer works as it used to. The issue can be reproduced on Grafana playground too.\r\n\r\n**What you expected to happen**:\r\nExpected to see dashboards in the current folder.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n![reproduce](https://user-images.githubusercontent.com/36602611/182601246-11dd0bbf-b799-4c3c-91cf-7ebb3b8522be.gif)\r\n","labels":["type/bug","area/manage-dashboards"]},{"id":68277,"title":"\"Config from Query\" disables config overrides","body":"### \r\n# What went wrong?\r\n\r\n\r\nWhen adding a \"config from query\" the overrides are disabled. \r\n\r\nIn a Time Series with three variables graphed, each variable has some overrides applied using \"Field returned by query.\" But when I add a Config from Query, the overrides are still there, but the \"field returned by query\" goes blank, and nothing can be selected until the Config from Query is disabled or deleted. \r\n\r\nI want to add a single threshold to one of the series base on a query, but all the other overrides should still apply. \r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\nBuild a time series with 3 queries. \r\n\r\n**Step 2**:\r\n\r\nSet \"Field returned by query\" overrides for each query. \r\n\r\n**Step 3**:\r\n\r\nAdd a fourth query that will serve as the threshold value.\r\n\r\n**Step 4**:\r\n\r\nAdd a \"Config from Query\" transform for Threshold1\r\n\r\n**Step 5**:\r\nWatch your overrides disable. \r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\nGrafana: 9.3.6\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\r\n\r\n### Grafana Platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### User's OS?\r\n\r\ndebian 11\r\n\r\n### User's Browser?\r\n\r\nChrome\r\n\r\n### Is this a Regression?\r\n\r\nNo\r\n\r\n### Are Datasources involved?\r\n\r\nInfluxDB\r\n\r\n### Anything else to add?\r\n\r\n\r\nMight not be a bug? I know it's in Beta, but the ability to use Config from Query would be hurt if other overrides couldn't be set. ","labels":["type/bug","effort/small","help wanted","area/transformations","good first issue","team/grafana-dashboards","prio/future"]},{"id":63219,"title":"External Users can no longer be configured with IaC ","body":"**What happened**:\r\nhttps://github.com/grafana/grafana/pull/58442 was merged and practitioners are no longer able to re-configure an external user from the outside, e.g. with the Grafana terraform provider. They get an error: \"User info cannot be updated for external Users\"\r\n \r\n**What you expected to happen**:\r\nPractitioners can still re-configure an existing Grafana user and e.g. toggle the `is_admin` flag\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Configure grafana.ini with `auth.gitlab`\r\n2. Configure a user with [terraform](https://registry.terraform.io/providers/grafana/grafana/latest/docs/resources/user) with `is_admin = false` \r\n3. Configure grafana.ini with `auth.gitlab`\r\n4. Login with this user from gitlab\r\n5. Run your terraform script again with `is_admin = true`\r\n\r\n**Anything else we need to know?**:\r\nhttps://github.com/grafana/grafana/pull/58442#discussion_r1101657015\r\n\r\n**Environment**:\r\n- Grafana version: v9.3.1\r\n","labels":["needs more info","area/auth"]},{"id":69916,"title":"Dashboards: Switching orgs from anywhere except the standard homepage throws an error","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n  - Upgraded to v.9.5.2 and v.9.5.3, when performing a switch of org a TypeError is thrown.\r\n\r\n**What did you expect to happen**:\r\n- Switch org without an error\r\n\r\n**Firefox**\r\n[firefox.txt](https://github.com/grafana/grafana/files/11723713/firefox.txt)\r\n\r\n**Chrome**\r\n[chrome.txt](https://github.com/grafana/grafana/files/11723711/chrome.txt)\n\n### \n# How do we reproduce it?\n\n\n\r\nFirefox:\r\nPerform an org switch from anything but the standard homepage (any other dashboards, alerting menu)\r\n\r\nChrome:\r\nPerform an org switch from any dashboard that isn't the grafana standard dashboard (switching from a non-dashboard page does not fail)\n\n### \n# What Grafana version are you using?\n\n\nv9.5.3\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\n_No response_\n\n### Grafana Platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### User's OS?\n\nMacOS Ventura\n\n### User's Browser?\n\nFirefox 114.0 - Chrome 114.0.5736.106\n\n### Is this a Regression?\n\nYes\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["area/auth","triage/needs-confirmation"]},{"id":53089,"title":"Grafana removing duplicate values in fields","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nWhen trying to make a pie chart with values coming from a certain field, duplicate values in an array are automatically removed.\r\n\r\n**What you expected to happen**:\r\nI expected duplicate values to stay.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Have a Elasticsearch log with the field and values: `failure: [“Test failed”,“Test failed”]`. \r\n2. Make a pie chart with count of `failure`, and the pie chart only shows one count of `“Test failed”` even though it should show two.\r\n\r\n**Anything else we need to know?**:\r\nI inspected the query editor and it is only returning one `“Test failed”`, so I'm not sure if the problem is in Elasticsearch side or Grafana.\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.4\r\n- Data source type \u0026 version: Elasticsearch 8.2.3\r\n","labels":["needs more info","datasource/Elasticsearch"]},{"id":62070,"title":"heatmap: RangeError: invalid array length ","body":"**What happened**:\r\nGrafana heatmap panel shows: `RangeError: invalid array length` \r\nwith  a histogram_quantile() query which returns some data points and NaN.\r\n\r\n![Screenshot from 2023-01-25 10-34-50](https://user-images.githubusercontent.com/2376735/214530481-d6702abf-91b5-47de-a963-a9c97bfccbb7.png)\r\n\r\n\r\n**What you expected to happen**:\r\nA heatmap with empty spots and the data points.\r\nIf no data at all it should show \"No data\".\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\nIt works with grafana 9.2.0 as expected.\r\nChanging the graph type to for example time series works. It shows the data points and nothing for NaN.\r\n\r\n\r\n**Environment**:\r\n- Grafana version: v9.3.1\r\n- Data source type \u0026 version: prometheus\r\n","labels":["type/bug","area/panel/heatmap","type/regression"]},{"id":52211,"title":"dashboards link issue","body":"**What happened**:\r\nWhen \"dashboard links\" is created and \"Dropdown\" option is used - panel appears but dashboards are not shown \r\n\r\n**What you expected to happen**:\r\nDropdown menu shows list of dashboards\r\n\r\nLooks like the same issue as was [here](https://github.com/grafana/grafana/issues/12315)\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.2\r\n- Data source type \u0026 version: Prometheus (2.36.1)\r\n- OS Grafana is installed on: Docker\r\n- User OS \u0026 Browser: OS X, Safari","labels":["needs more info","needs investigation","area/dashboard/links","bot/no new info"]},{"id":65053,"title":"mssql: query variable returns empty the variable keeps the last non null value","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nIf a query variable returns from mssql without row the values of this variable keeps the previous non null value and Grafana shows an error:\r\n \r\n![grafana_templating_error_001](https://user-images.githubusercontent.com/31093540/226345869-987c3ec2-5905-473d-9873-f18dc9e1a5ac.png)\r\n\r\n**What you expected to happen**:\r\nIn case when no return value the variable should be empty.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate\r\n- variable, var1, text box\r\n- variable, var2, query, `select city_id from dbo.cities where city_name = '$var1'`\r\n- panel, text, content: ${var2}\r\n- panel, table, table_city_id, `select city_id from dbo.cities where city_name = '$var1'`\r\n- panel, table, table_streets, `select street_name from dbo.streets where city_id = '$var2'`\r\n\r\nDo\r\n- type a city name into var1, you will see the $var2 in the text, the list of the streets in the tabe_streets and the city_id in the table_city_id (table_city_id is the same value as $var2)\r\n- type a non exists city name, you will get an error about var2, table_city_id will be empty but in the text and table_streets will show the previous values\r\n\r\nOr just create a query variable from mssql with `select 'grafana' from dbo.abc where 2=1` and the templating error will be showed.\r\n\r\n**Anything else we need to know?**:\r\nThis behavior appeared from 9.4.1.\r\nIt seems that the problem is in the query variables. In the panel query it works properly.\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.3\r\n- Data source type \u0026 version: MSSQL Server 13.0.5102.14\r\n- OS Grafana is installed on: Ubuntu 18.04.6 LTS\r\n- User OS \u0026 Browser: Windows 10, Opera 96.0.4693.50, Chrome 111.0.5563.65\r\n- Grafana plugins: native mssql, 5.0.0\r\n","labels":["type/bug","type/duplicate","area/dashboard/templating","datasource/MSSQL"]},{"id":56859,"title":"Status History Panel click and drag to zoom in no longer works in v9.2.0","body":"**What happened**:\r\nViewing an exisiting status history panel, I clicked and dragged a time period of interest. A lightly shaded area appears across the time period but on releasing the mouse button, the panel did not zoom into the chosen period. The time period can still be explicitly chosen in the time picker control and the zoom out and move time forwards/backwards still work as expected.\r\n\r\n**What you expected to happen**:\r\nI expected the panel to zoom into the time range selected with the click and drag action. \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nDescribed in the 'What happended' section.\r\n\r\n**Anything else we need to know?**:\r\nI use this functionality all the time and I believe it was working as expected in v9.1.7 but not in v9.2.0\r\n\r\n**Environment**:\r\n- Grafana version: 9.2\r\n- Data source type \u0026 version: PostgreSQL\r\n- OS Grafana is installed on: CentOS 7\r\n- User OS \u0026 Browser: Windows 10 Enterprise (21H2), Chrome 106.0.5249.119\r\n","labels":["type/bug","prio/high","type/regression","area/panel/status-history"]},{"id":76743,"title":"\"Label filters\" in Variables Settings not working at all","body":"### What happened?\n\nWhatever I put in \"Label filters\" the \"Preview of values\" is showing the same list.\r\n\r\n\n\n### What did you expect to happen?\n\nI'd expect filter to be applied and to show only the part of the list.\n\n### Did this work before?\n\nYes!\r\n\r\nI'm cocmparing `Grafana v10.1.1 (0cfa76b22d)` and `v9.3.6 (978237e7cb)`\r\n\r\nIn version 9, we had old Query Options query field (no query builder like in v10), and filters were working all the time.\n\n### How do we reproduce it?\n\nTry to add any filter by any label and it won't work.\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana v10.1.1 (0cfa76b22d)\r\nOS: MacOS\r\nBrowser: Chrome\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nThanos","labels":["area/dashboard/templating","datasource/Prometheus","area/query-editor","triage/needs-confirmation"]},{"id":77825,"title":"Public Dashboards: Panel menu and data inspection not working","body":"### What happened?\n\nWhen viewing a public dashboard, occasionally the panel menu is unavailable, and if it is available the inspect-\u003edata view does not load.\r\n\r\nhttps://github.com/grafana/grafana/assets/6424912/18415318-40b5-4bbd-8bdf-1dfca0384450\r\n\r\n\n\n### What did you expect to happen?\n\nBoth the panel menu should be available and inspect-\u003edata should work as expected.\n\n### Did this work before?\n\nI do not know if this has ever worked, it has only been tried on one Grafana version (10.1.2) and it did not work there.\n\n### How do we reproduce it?\n\n1. Create a public dashboard with a time series panel and attempt to view the panel menu and inspect the panel data.\r\n\n\n### Is the bug inside a dashboard panel?\n\nThis has only been tried with the time series panel.\n\n### Environment (with versions)?\n\nGrafana: 10.1.2\r\nOS: MacOS 12.5.1\r\nBrowser: Brave  1.57.47 Chromium: 116.0.5845.96\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nPostgres","labels":["bot/no new info","area/public-dashboards"]},{"id":46570,"title":"Grafana time series duplicated values in left axis","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nTime series graph displays duplicate values\r\n**What you expected to happen**:\r\nno duplicate values\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nI have a series of time buckets from SQL that counts an event every 15 minutes. The count can only be a whole number. I have set decimals to 0 in  grafana believing that it would give me a simple graph with the left axis count from 0,1,2,3,4 but actually it shows 0,1,2,2,3,3.\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: latest\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on: Server 2019\r\n- User OS \u0026 Browser:Windows 10, edge\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/bug","area/panel/timeseries"]},{"id":47455,"title":"Unified alerting migrations not working.  No unified alerts and also legacy alerts are removed.","body":"**What happened**:\r\n\r\nUpgraded from 8.0.6 to 8.4.5 (also tried 8.3.7) to try out unified alerting \r\n\r\n**What you expected to happen**:\r\n\r\nAccording to the docs our legacy alerts should be migrated to unified alerts on any version newer than 8.3\r\n\r\nI've tried upgrading our grafana deployment to both 8.3.7 and 8.4.5 and I get the same results with either.  There are no unified alerts and the legacy style alerts that we had previously are no longer there.   I also made sure to add the following to our config:\r\n\r\n```\r\n[unified_alerting]\r\nenabled = true\r\n```\r\n\r\nI see some logs about migrations related to alerts running however there are no errors.  This line seemed particularly interesting:\r\n```\r\nlogger=migrator t=2022-04-05T18:01:36.59+0000 lvl=info msg=\"alerts found to migrate\" alerts=0\r\n```\r\n\r\nWhen attempting to access the alert rules in the UI this is logged:\r\n```\r\nlogger=context t=2022-04-05T18:23:35.37+0000 lvl=eror msg=\"no rule groups found\\n\" error=\"no rule groups found\\n\" remote_addr=[172.18.251.97](https://172.18.251.97/)\r\n\r\nlogger=context t=2022-04-05T18:23:35.37+0000 lvl=info msg=\"Request Completed\" method=GET path=/api/ruler/15/api/v1/rules status=404 remote_addr=[172.18.251.97](https://172.18.251.97/) time_ms=77 size=36 referer=[https://grafana.dev-mgmt-eastus.domain.com/alerting/list](https://grafana.dev-mgmt-eastus.bentleyhosted.com/alerting/list)\r\n```\r\n\r\nFor datasources we are using primarily elasticsearch with some loki and azure.  \r\n\r\nWe are running grafana on k8s.  We load our config and dashboards from git.  I'm not sure that this should matter but wanted to include it.  Could it be possible that the unified alert migration only works if you have previous alerts in the database and it doesn't work on new dashboards that get loaded with legacy style alerts?\r\n","labels":["area/alerting","needs investigation"]},{"id":72165,"title":"Product Area: renderChart func does not work","body":"### What happened?\r\n\r\nwhen I use  Stat component, renderChart func does not work, I found the renderChart has 2 useless definitions\r\n\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nrenderChart could run, here is my pr : https://github.com/grafana/grafana/pull/72120\r\n\r\n### Did this work before?\r\n\r\nno\r\n\r\n### How do we reproduce it?\r\n\r\n\r\n```\r\n\u003ctemplate\u003e\r\n    \u003cStatVue\r\n          v-if=\"SnapshotDataR\"\r\n          :data=\"SnapshotDataR\"\r\n          :config=\"config\"\r\n          width=\"120\"\r\n          height=\"120\"\r\n          :options=\"Statopts\"\r\n          :fidle-config=\"fidleConfig\"\r\n        /\u003e\r\n\u003c/template\u003e\r\n\u003cscript setup lang=\"tsx\"\u003e\u003c/script\u003e\r\nimport { applyPureReactInVue } from 'veaury'\r\nconst StatVue = applyPureReactInVue(StatPanel)\r\n  const SnapshotDataR = ref()\r\n  const Statopts = ref({\r\n    colorMode: 'value',\r\n    graphMode: 'area',\r\n  })\r\n  const fidleConfig = {\r\n    mappings: [],\r\n  }\r\n\r\n```\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana:10.1.0\r\nOS: 12.1 (Apple M1)\r\nBrowser:版本 114.0.5735.198（正式版本） (arm64)\r\n\r\n### Grafana platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### Datasource(s)?\r\n\r\n_No response_\r\n```[tasklist]\r\n### Tasks\r\n- [ ] https://github.com/grafana/grafana/pull/72120\r\n```\r\n","labels":["area/frontend","triage/needs-confirmation"]},{"id":53294,"title":"Alerting: Subfolder in alerting folder broke provisioning","body":"I created folder named \"subfolder\" in \"alerting\" folder on my provisioning path.\r\n\r\n**What happened**:\r\nAll alerts stop loading. Can see \"file has invalid suffix 'subfolder' (.yaml,.yml,.json accepted)\" in logs.\r\n\r\n**What you expected to happen**:\r\nProvisioning alerts in \"alerting\" should continue to work. \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Create any folder inside \"alerting\" folder.\r\n2. Reload provisioning.\r\n\r\n**Environment**:\r\n- Grafana version: 9.1.0-beta1","labels":["type/bug","area/alerting","area/provisioning"]},{"id":77414,"title":"TimeSeries: Wrong Data display after adjusting the time range ","body":"### What happened?\n\n![01](https://github.com/grafana/grafana/assets/141797260/01f03a73-7e93-4763-b777-cee35a2c6524)\n\n### What did you expect to happen?\n\nThe value should be show 60 not 160\r\n![02](https://github.com/grafana/grafana/assets/141797260/0fed51f6-b121-42c2-9a5d-2fe270bd03dd)\n\n### Did this work before?\n\nnot yet\n\n### How do we reproduce it?\n\nEnlarge the time interval for a certain value\r\n![image](https://github.com/grafana/grafana/assets/141797260/575c0241-1e50-48c8-a3db-c0711eb499c6)\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.2.0\r\nOS:Ubuntu 20.04\r\nBrowser:Chrome 118.0.5993.71\r\n\n\n### Grafana platform?\n\nA downloaded binary\n\n### Datasource(s)?\n\n_No response_","labels":["bot/no new info","area/panel/timeseries","triage/needs-confirmation"]},{"id":61972,"title":"Data outside time range, but data is present in the table","body":"When I reduce the time range for the visualization (about 10 points in my selection) I get the message \"Data out of time range\". When I switch to \"Table View\" mode, I see the 10 rows corresponding to the data. When I increase the size little by little, it works again... It prevents me from processing data over a time range of a few minutes, and it's quite annoying...\r\n\r\n**Environment**: Raspbian on a raspberry pi 4 \r\n- Grafana version: v9.3.2 (21c1d14e91)\r\n- Data source type \u0026 version: Mysql 5.0.0\r\n- User OS \u0026 Browser: Windows Chrome\r\n\r\nThanks for your reply !\r\n","labels":["type/bug","area/panel/timeseries"]},{"id":62807,"title":"Grafana 9.3 API does not support AlertGroup with AlertRulev9","body":"**What happened**:\r\nAfter generation of AlertGroup using AlertRulev9 and try to deploy it via `api/ruler/grafana/api/v1/rules/{namespace}` endpoint I'm getting 500 error with message `unexpected backend type (grafana) for payload type (lotex)`. \r\n\r\n**What you expected to happen**:\r\nAlertGroup added to Grafana.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Create AlerGroup with AlertRulev9 using grafanalib 0.7.0\r\n2. Generate JSON\r\n3. Call `api/ruler/grafana/api/v1/rules/{namespace}` endpoint with generated JSON as a body/\r\n\r\n**Environment**:\r\n- Grafana version: 9.3\r\n- grafnalib: 0.7.0","labels":["area/alerting","triage/needs-confirmation"]},{"id":88096,"title":"Nested Pie/Donut Charts ","body":"### What happened?\n\nI am working with google sheets as my datasource (query A \u0026 B) and I am trying to implement a donut with 2 layers (inner and outer layers). \r\n![1](https://github.com/grafana/grafana/assets/139092406/348cdc64-a7f4-46ce-b749-1a3f337f4619)\r\n![2](https://github.com/grafana/grafana/assets/139092406/4b0bbff1-1e3c-4606-944d-20b29f8571d1)\r\n\n\n### What did you expect to happen?\n\nRight now I am able to create a donut chart but i want my query B to be in the inner donut chart.\n\n### Did this work before?\n\nNo\n\n### How do we reproduce it?\n\n1. It is pretty straightforward, just some data in google sheets\r\n2.\r\n3.\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana:\r\nOS:\r\nBrowser:\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["area/panel/piechart","triage/needs-confirmation"]},{"id":46093,"title":"Ad-hoc filter datasource does not load named datasource","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nWhen provisioning a dashboard with an ad-hoc filter, the datasource for just the ad-hoc filter is empty.\r\n\r\n**What you expected to happen**:\r\n\r\nLike the other variables, I expected the ad-hoc filter to have the datasource ser.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n```json\r\n{\r\n        \"datasource\": {\r\n          \"uid\": \"My-Datasource-Name\"\r\n        },\r\n        \"description\": \"My awesome ad-hoc filter\",\r\n        \"filters\": [],\r\n        \"hide\": 0,\r\n        \"label\": \"Ad-hoc Filter\",\r\n        \"name\": \"filter\",\r\n        \"skipUrlSync\": false,\r\n        \"type\": \"adhoc\"\r\n      }\r\n```\r\n\r\n**Anything else we need to know?**:\r\n\r\nThe same datasource name is used in multiple other variables, and they all work fine. It is just the ad-hoc filter where the datasource is always empty. I have tried multiple datasource names and no dice.\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.2\r\n- Data source type \u0026 version: vertamedia-clickhouse-datasource 2.4.2\r\n- OS Grafana is installed on: linux/docker container\r\n- User OS \u0026 Browser: MacOS Chrome\r\n- Grafana plugins: vertamedia-clickhouse-datasource\r\n- Others:\r\n","labels":["area/dashboard/templating","area/provisioning"]},{"id":74302,"title":"nestedFolders: Dashboard Permissions by Team not works","body":"### What happened?\r\n\r\nDashboard Permissions by Team not works if enable nested folders\r\n\r\n### What did you expect to happen?\r\n\r\nMember of team must have view access to dashboar if team was added on Permissions \r\n\r\n### Did this work before?\r\n\r\nno, as nested folders are a new feature\r\n\r\n### How do we reproduce it?\r\n\r\n1. set\r\n[feature_toggles]\r\nnestedFolders = true\r\n2. Create team team1\r\n3. Add user1 to team1\r\n4. Create dashboard1\r\n5. Add team1 to dashboard1 Permissions  as viewver \r\n6. Login as user1\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.1.1\r\nOS: Windows10\r\nBrowser: Chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nNone\r\n\r\n### Datasource(s)?\r\n\r\nmssql","labels":["needs more info","area/dashboard/folders"]},{"id":67035,"title":"Resource peaks in Grafana every 5 minutes","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n## What happened:\r\nHello,\r\n\r\nWe currently have Grafana version 9.3.6 with unified_alerting enabled deployed through Helm Chart in Kubernetes. We use victoria-metrics for querying and storing metrics and we found while checking the resources of both Grafana and VictoriaMetrics that every 5 minutes there are considerable spikes in the CPU and memory usage of both tools.\r\n\r\nWe think it is due to alerting, but we are not sure and we would like to solve this problem as the resource consumption is very high.\r\n\r\nCan you help us?\r\n\r\nThank you very much.\r\n\r\n## What you expected to happen:\r\n\r\nWe would like the resource consumption of both Grafana and Victoria Metrics to be stable and not have peaks every 5 minutes.\r\n\r\n## How to reproduce it (as minimally and precisely as possible):\r\n\r\n## Anything else we need to know?:\r\n\r\n![image](https://user-images.githubusercontent.com/128470256/233603461-0c98a96a-41f2-4bfd-8bfa-08dcd4a89b94.png)\r\n\r\n![image](https://user-images.githubusercontent.com/128470256/233604125-e7dcc1aa-8a4a-44d1-9e10-7e912a0fc4f4.png)\r\n\r\n## Environment:\r\n- Grafana version: 9.3.6\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on: Kubernetes / Helm Chart\r\n- User OS \u0026 Browser: Chrome / Firefox / Safari / Edge\r\n- Grafana plugins: \r\n- Others:\r\n\r\nConfigmap from Grafana\r\n\r\n_apiVersion: v1\r\nkind: ConfigMap\r\nmetadata:\r\n  name: grafana\r\n  namespace: grafana\r\n  uid: ae81f8d7\r\n  resourceVersion: '1125841717'\r\n  creationTimestamp: '2023-03-03T10:52:35Z'\r\n  labels:\r\n    app.kubernetes.io/instance: grafana\r\n    app.kubernetes.io/managed-by: Helm\r\n    app.kubernetes.io/name: grafana\r\n    app.kubernetes.io/version: 9.3.6\r\n    helm.sh/chart: grafana-6.50.6\r\n  annotations:\r\n    meta.helm.sh/release-name: grafana\r\n    meta.helm.sh/release-namespace: grafana\r\n  managedFields:\r\n    - manager: Go-http-client\r\n      operation: Update\r\n      apiVersion: v1\r\n      time: '2023-03-23T12:11:39Z'\r\n      fieldsType: FieldsV1\r\n      fieldsV1:\r\n        f:data:\r\n          .: {}\r\n          f:grafana.ini: {}\r\n        f:metadata:\r\n          f:annotations:\r\n            .: {}\r\n            f:meta.helm.sh/release-name: {}\r\n            f:meta.helm.sh/release-namespace: {}\r\n          f:labels:\r\n            .: {}\r\n            f:app.kubernetes.io/instance: {}\r\n            f:app.kubernetes.io/managed-by: {}\r\n            f:app.kubernetes.io/name: {}\r\n            f:app.kubernetes.io/version: {}\r\n            f:helm.sh/chart: {}\r\n    - manager: node-fetch\r\n      operation: Update\r\n      apiVersion: v1\r\n      time: '2023-04-05T08:40:50Z'\r\n      fieldsType: FieldsV1\r\n      fieldsV1:\r\n        f:data:\r\n          f:plugins: {}\r\n  selfLink: /api/v1/namespaces/grafana/configmaps/grafana\r\ndata:\r\n  grafana.ini: |\r\n    [alerting]\r\n    concurrent_render_limit = 8\r\n    enabled = false\r\n    max_annotation_age = 24h\r\n    [analytics]\r\n    check_for_updates = true\r\n    [annotations]\r\n    cleanupjob_batchsize = 20000\r\n    [annotations.api]\r\n    max_age = 6M\r\n    [annotations.dashboard]\r\n    max_age = 6M\r\n    [grafana_net]\r\n    url = https://grafana.net\r\n    [log]\r\n    mode = console\r\n    [paths]\r\n    data = /var/lib/grafana/data\r\n    logs = /var/log/grafana\r\n    plugins = /var/lib/grafana/plugins\r\n    provisioning = /etc/grafana/provisioning\r\n    [plugins]\r\n    allow_loading_unsigned_plugins = goshposh-metaqueries-datasource\r\n    [server]\r\n    domain = grafana.domain.com\r\n    enable_gzip = true\r\n    [unified_alerting]\r\n    enabled = true\r\n    ha_advertise_address = ${POD_IP}:9094\r\n    ha_listen_address = ${POD_IP}:9094\r\n    ha_peers = grafana-headless:9094\r\n  plugins: \u003e-\r\n    instana-datasource,farski-blendstat-panel,yesoreyeram-boomtable-panel,yesoreyeram-infinity-datasource,jdbranham-diagram-panel,natel-discrete-panel,agenty-flowcharting-panel,pierosavi-imageit-panel,simpod-json-datasource,marcusolsson-json-datasource,grafana-piechart-panel,natel-plotly-panel,vonage-status-panel,grafana-worldmap-panel,https://github.com/GoshPosh/grafana-meta-queries/archive/refs/tags/0.0.9.zip;goshposh-metaqueries-datasource,flant-statusmap-panel,grafana-athena-datasource,grafana-timestream-datasource,grafana-oncall-app,grafana-redshift-datasource\r\nbinaryData: {}_\r\n\r\n","labels":["needs more info","area/alerting","area/backend"]},{"id":69515,"title":"Grafana: 9.5.2 fatal error: concurrent map read and map write","body":"### \n# What went wrong?\n\n\n**What happened**: from time to time all panels turned into black screan and right top corenr shows \"Failed to fetch\r\n\r\n  - \r\n\r\n**What did you expect to happen**: normal work of grafana\r\n\r\n  - \r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Open Grafana and opend some graphs\r\n\r\n**Step 2**:\r\n\r\nwait a little bit\r\n\r\n**Step 3**:\r\n\r\n- Wait for the issue to occur\r\n\n\n### \n# What Grafana version are you using?\n\n\n9.5.2\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nDocker\n\n### User's OS?\n\nCentOS 7.9.\n\n### User's Browser?\n\nchrome differnet versions\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\nClickhouse\n\n### Anything else to add?\n\n\n\r\n\r\nDuring log analyses we found \r\n\r\n^[[36mgrafana_1  |^[[0m fatal error: concurrent map read and map write\r\n^[[36mgrafana_1  |^[[0m\r\n^[[36mgrafana_1  |^[[0m goroutine 2171019 [running]:\r\n^[[36mgrafana_1  |^[[0m net/textproto.MIMEHeader.Get(0xc000bbea80, {0x3950431?, 0x46e7ce?})\r\n^[[36mgrafana_1  |^[[0m         /usr/local/go/src/net/textproto/header.go:34 +0x45\r\n^[[36mgrafana_1  |^[[0m net/http.Header.Get(...)\r\n^[[36mgrafana_1  |^[[0m         /usr/local/go/src/net/http/header.go:50\r\n^[[36mgrafana_1  |^[[0m github.com/grafana/grafana/pkg/web.RemoteAddr(0xc002b92200)\r\n^[[36mgrafana_1  |^[[0m         /drone/src/pkg/web/context.go:77 +0x54\r\n^[[36mgrafana_1  |^[[0m github.com/grafana/grafana/pkg/services/anonymous/anonimpl.(*AnonSessionService).TagSession(0xc001614b70, {0x4102d70, 0xc00005c018}, 0xc002b92200)\r\n^[[36mgrafana_1  |^[[0m         /drone/src/pkg/services/anonymous/anonimpl/impl.go:71 +0x4e\r\n^[[36mgrafana_1  |^[[0m github.com/grafana/grafana/pkg/services/contexthandler.(*ContextHandler).initContextWithAnonymousUser.func1()\r\n^[[36mgrafana_1  |^[[0m         /drone/src/pkg/services/contexthandler/contexthandler.go:246 +0x87\r\n^[[36mgrafana_1  |^[[0m created by github.com/grafana/grafana/pkg/services/contexthandler.(*ContextHandler).initContextWithAnonymousUser\r\n^[[36mgrafana_1  |^[[0m         /drone/src/pkg/services/contexthandler/contexthandler.go:240 +0x36a\r\n^[[36mgrafana_1  |^[[0m\r\n^[[36mgrafana_1  |^[[0m goroutine 1 [semacquire, 7 minutes]:\r\n^[[36mgrafana_1  |^[[0m sync.runtime_Semacquire(0x4?)\r\n^[[36mgrafana_1  |^[[0m         /usr/local/go/src/runtime/sema.go:62 +0x27\r\n^[[36mgrafana_1  |^[[0m sync.(*WaitGroup).Wait(0xc003bb3b00?)\r\n^[[36mgrafana_1  |^[[0m         /usr/local/go/src/sync/waitgroup.go:116 +0x4b\r\n^[[36mgrafana_1  |^[[0m golang.org/x/sync/errgroup.(*Group).Wait(0xc003bb1180)\r\n^[[36mgrafana_1  |^[[0m         /opt/drone/gomodcache/golang.org/x/sync@v0.1.0/errgroup/errgroup.go:53 +0x27\r\n^[[36mgrafana_1  |^[[0m github.com/grafana/grafana/pkg/server.(*Server).Run(0xc0004cc3c0)\r\n^[[36mgrafana_1  |^[[0m         /drone/src/pkg/server/server.go:190 +0x2ed\r\n^[[36mgrafana_1  |^[[0m github.com/grafana/grafana/pkg/cmd/grafana-server/commands.RunServer({{0x40ca490, 0x5}, {0x40cb730, 0xa}, {0x40ca488, 0x4}, {0x40cb720, 0xa}, 0xc0010b6780})\r\n^[[36mgrafana_1  |^[[0m         /drone/src/pkg/cmd/grafana-server/commands/cli.go:251 +0x1088\r\n\r\nThe issue is not reproducible on grafana 10-preview","labels":["area/docker","area/backend/db/postgres","triage/needs-confirmation"]},{"id":73140,"title":"stats.grafana.org used every 15 seconds","body":"### What happened?\n\nthere is a connection to stats.grafana.org every 15 seconds\n\n### What did you expect to happen?\n\nthis to happen one time per day\n\n### Did this work before?\n\nno idea\n\n### How do we reproduce it?\n\nlook at network lol\n\n### Is the bug inside a dashboard panel?\n\nno\n\n### Environment (with versions)?\n\nGrafana:\r\nOS:\r\nBrowser:\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\n_No response_","labels":["needs more info","area/backend","triage/needs-confirmation"]},{"id":80703,"title":"Grafana UI: Broken TimeRangeInput component","body":"### What happened?\r\n\r\nThe problem I am facing is that the TimeRangeInput component seems broken and not interactable.\r\n\r\n- Here is the component in itself, in my plugin\r\n![image](https://github.com/grafana/grafana/assets/112857106/972a2e40-5855-43b7-8989-fadb0ccfc5a4)\r\n\r\n- Here is the component when I click on the agenda and it opens the calendar date picker (i can’t interact with it)\r\n![image](https://github.com/grafana/grafana/assets/112857106/48f9b660-6ec8-4288-a3c3-d456d6f85808)\r\n\r\n- Here is the calendar in the responsive mode on a small screen (it works and is interactable)\r\n![image](https://github.com/grafana/grafana/assets/112857106/ca6c8158-f854-47ee-b74e-22ba39ed5ccc)\r\n\r\n- I also tried to set the “isReversed” option to false, I can see the calendar better, but it is still not interactable.\r\n![image](https://github.com/grafana/grafana/assets/112857106/1701f0ad-a4f8-4771-9aef-92cbaf67fc41)\r\n\r\n\r\nAt first I thought the issue came from my own css file, but I tried to delete my whole css, refreshed the plugin (without any cache) and it still didn’t work.\r\n\r\nThe code i am using is litteraly the one used in the Grafana storybook, and the value types are correct.\r\nhttps://developers.grafana.com/ui/latest/index.html?path=/story/pickers-and-editors-timepickers-timerangeinput--basic\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nA TimeRangeInput component working as expected with the calendar date picker interactable, like in your reporting functionnality in grafana cloud for example :\r\n\r\n![image](https://github.com/grafana/grafana/assets/112857106/8fdb3532-b0fa-42e9-a4db-ead9708ba407)\r\n\r\n\r\n### Did this work before?\r\n\r\n//\r\n\r\n### How do we reproduce it?\r\n\r\n1. Initialize a grafana plugin\r\n```\r\nnpx grafana create plugin@latest\r\n``` \r\n(but my version of grafana is now 9.3.8)\r\n\r\n2. Add grafana/ui \r\n```\r\nyarn add @grafana/ui\r\n``` \r\n(but now my version of @grafana/ui is 10.2.3)\r\n\r\n3. Inside a test.tsx component, you can import a TimeRangeInput as an example\r\n```typescript\r\nimport React from 'react';\r\nimport { Field, TimeRangeInput } from '@grafana/ui';\r\nimport { TimeRange, dateTime } from '@grafana/data';\r\n\r\nconst test = () =\u003e {\r\n  return (\r\n    \u003cField label=\"Time range\" description=\"Generate report with the data from specified time range. If custom time range is empty the time range from the report's dashboard is used.\"\u003e\r\n      \u003cTimeRangeInput\r\n        value={{\r\n          from: dateTime(null),\r\n          to: dateTime(null),\r\n          raw: {\r\n            from: dateTime(null),\r\n            to: dateTime(null),\r\n          },\r\n        }}\r\n        onChange={(timeRange) =\u003e {\r\n          console.log(timeRange);\r\n          console.log(dateTime());\r\n        }}\r\n        clearable={true}\r\n      /\u003e\r\n    \u003c/Field\u003e\r\n  );\r\n};\r\n\r\nexport default test;\r\n``` \r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 9.3.8\r\nOS: Windows 10 Profesional (version 10.0.19045 Build 19045)\r\nBrowser: Mozilla Firefox version 115.6.0esr (64 bits)\r\n\r\n\"@grafana/data\": \"^9.5.1\",\r\n\"@grafana/runtime\": \"9.3.8\",\r\n\"@grafana/ui\": \"^10.2.3\",\r\n\r\n### Grafana platform?\r\n\r\nDocker\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["needs more info","area/frontend"]},{"id":68283,"title":"Dashboard Table Panel Dropdown shows concatted column names instead of the query","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\nI’ve got a Grafana dashboard with a table panel showing data from an Opensearch database. Each day, we’ve got a nightly job that tabulates some various data coming from around (~30) different monitors, each of which aggregate data from a number of sub-monitors. Each monitor is a separate Elasticsearch index/query. The job pre-calculates which sub-monitors for each monitor are the worst ones.\r\n\r\nWe’ve been able to pull this data into a table in Grafana pretty easily using a Table Panel with a custom field filter. The filter is needed because we've got about 600 columns per index, but we only care about 5 of them for this panel. The table provides a drop-down selector for switching between the monitors, which is nice. However, the drop-down selector, which switches between each data source, instead shows the names of the columns instead of each datasource’s name. (or, alternatively, I’d like it to show the “description_orig” column, which is the same value in my case) In the attached screenshot, I’m pointing to this with an orange arrow; as you can see, the dropdown selector is the same every time, making it super obnoxious to use. \r\n\r\n![Screenshot 2023-05-10 at 11 59 39 AM](https://github.com/grafana/grafana/assets/838930/fc42bc7c-819d-49b2-b473-9ab702f006c2)\r\n\r\n**What did you expect to happen**:\r\n\r\nI was expecting that the dropdown would use each query's alias instead of joining all column names together into an uberstring. (Note that without the filter, the UI will freeze up for a good ~10 seconds due to trying to render such a massively wide dropdown) However, it seems that table aliases are non-functional except for date histogram queries.\r\n\r\nSearching past github issues, I see this has come up at least once before, as https://github.com/grafana/grafana/issues/31517. However, that one seemed to get lost due to getting linked to another issue specifically about disabling table aliases for non Date Histogram queries. I have no opinion about whether aliases should work for non Date-Histogram queries, but would just like to my dropdown to show some sensible values. If I could have it show the value of one of my columns, that would be fine too. \r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\n- Create a table panel, add multiple queries, select \"Raw Data\" as the Metric\r\n\r\n**Step 2**:\r\n\r\n- Add a filter to choose a few columns\r\n\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\nv9.3.1\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\n[debug-table panel-2023-05-11 08 35 50.json.txt](https://github.com/grafana/grafana/files/11453980/debug-table.panel-2023-05-11.08.35.50.json.txt)\r\n\r\n\r\n### Grafana Platform?\r\n\r\nI don't know\r\n\r\n### User's OS?\r\n\r\nMac OS\r\n\r\n### User's Browser?\r\n\r\nFirefox 112.0.2\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\nElasticsearch / Opensearch\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["datasource/Elasticsearch","area/panel/table"]},{"id":83919,"title":"Latest version of dashboard not coming.","body":"### What happened?\n\nI updated an Dashboard or create new dashboard.. That latest version of dashboard is not coming on other users browser. But when they cleared all time history of browser, latest version dashboard is showing. \r\n\r\nWhen we hit same dashboard on incognito it's working fine.\n\n### What did you expect to happen?\n\nIt should show latest version of Dashboard every time we load the page on any browser.\n\n### Did this work before?\n\nNo idea about this.\n\n### How do we reproduce it?\n\n1. Create an new dashboard.\r\n2. Hit URL of that browser in any other browser.\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 8.0.6\r\nOS: Windows\r\nBrowser: Google chrome\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\nPostgreSQL-MetricsDB","labels":["area/dashboard","bot/no new info","team/grafana-dashboards"]},{"id":48177,"title":"Failed to start grafana. error: section \"tracing.opentelemetry.jaeger\" does not exist","body":"**What happened**:\r\nApr 25 13:10:21 server01 grafana-server[9584]: Failed to start grafana. error: section \"tracing.opentelemetry.jaeger\" does not exist\r\nApr 25 13:10:21 server01 grafana-server[9584]: section \"tracing.opentelemetry.jaeger\" does not exist\r\n\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n_grafana.ini:_\r\n..\r\n`\r\n#################################### Distributed tracing ############\r\n[tracing.jaeger]\r\n;address = localhost:6831\r\n;always_included_tag = tag1:value1\r\n;sampler_type = const\r\n;sampler_param = 1\r\n;sampling_server_url =\r\n;zipkin_propagation = false\r\n;disable_shared_zipkin_spans = false\r\n\r\n[tracing.opentelemetry.jaeger]\r\n; address = http://localhost:14268/api/traces\r\n`\r\n..\r\n\r\nIf i set address = http://localhost:14268/api/traces Grafana starts but i have many logs \r\n'Post \"http://localhost:14268/api/traces\": dial tcp [::1]:14268: connect: connection refused' \r\nbecause I don't have jaeger, of course.\r\n\r\n**Environment**:\r\n- Grafana version: 8.5.0\r\n- OS Grafana is installed on: Ubuntu 18.04 (no Docker!)\r\n- User OS \u0026 Browser: Firefox 99.0.1 (64-Bit)\r\n","labels":["needs more info","area/backend/config","needs investigation"]},{"id":54369,"title":"Missing $__timeEpoch function when provisioning alert rule","body":"**What happened**:\r\nUsing provisioning feature to provision an alert rule which contains a rawSql like below\r\n```\r\n                SELECT \r\n                  temperature as temperature,\r\n                  $__timeEpoch(date_time) \r\n                FROM dbo.records \r\n                WHERE \r\n                  device='device1'\r\n                ORDER BY \r\n                  date_time ASC\r\n```\r\n\r\nWhen the grafana started, the sql in alert rule is like below\r\n```\r\nSELECT \r\n  temperature as temperature,\r\n  (date_time) \r\nFROM dbo.records \r\nWHERE \r\n  device='device1'\r\nORDER BY \r\n  date_time ASC\r\n```\r\n\r\nthe $__timeEpoch is gone.\r\n\u003cimg width=\"543\" alt=\"image\" src=\"https://user-images.githubusercontent.com/106508895/187078634-933bd107-9fa7-4676-9fc4-5eb178252ca1.png\"\u003e\r\nIs this a bug?\r\n\r\n**What you expected to happen**:\r\nthe $__timeEpoch function stays as I provisioned.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Start a MS SQL SERVER\r\n2. Using alert-rule.yaml in attached zip when provisioning.\r\n3. When Grafana started. check the sql in alert rule\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.1.1\r\n- Data source type \u0026 version: Latest version of MS SQL SERVER \r\n- OS Grafana is installed on: Docker Image\r\n- User OS \u0026 Browser: Docker Image\r\n- Grafana plugins: none\r\n- Others:\r\n[alert-rule.yaml.zip](https://github.com/grafana/grafana/files/9439824/alert-rule.yaml.zip)\r\n\r\n","labels":["type/duplicate","area/alerting"]},{"id":65525,"title":"Default time series panel's threshold settings \"flap\" on save when entire dashboard is not loaded","body":"**What happened**:\r\n\r\nWhen working with time-series panels on a dashboard with enough panels to have some of them off-screen and not rendered yet, grafana subtly changes the configuration for the thresholds. Specifically, it attempts to change this:\r\n\r\n```\r\n\"thresholds\": {\r\n  \"mode\": \"absolute\",\r\n  \"steps\": [\r\n    {\r\n      \"color\": \"green\"\r\n    },\r\n    {\r\n      \"color\": \"red\",\r\n      \"value\": 80\r\n    }\r\n  ]\r\n}\r\n```\r\nto this:\r\n```\r\n\"thresholds\": {\r\n  \"mode\": \"absolute\",\r\n  \"steps\": [\r\n    {\r\n      \"color\": \"green\",\r\n      \"value\": null\r\n    },\r\n    {\r\n      \"color\": \"red\",\r\n      \"value\": 80\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nThis spurious change means that simply loading a dashboard, _not_ scrolling all the way down to force all panels to render, then closing the window, prompts grafana for you to \"save\" the change, even though nothing on the dashboard has actually changed. Dashboards that _have_ been rendered change in the opposite direction, removing the `\"value\": null` field, which generates its own change warning.\r\n\r\nMy guess is this is some sort of serialization difference between rendered and un-rendered panels that needs to be unified.\r\n\r\n**What you expected to happen**:\r\n\r\nLoading and viewing a dashboard without forcing all its panels to render should not prompt me to save my changes when navigating away from the panel.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nAttached at the bottom of this ticket is a dashboard with a reasonable-number of time-series panels.\r\n\r\n1. Import the dashboard\r\n2. Make sure window is small enough to hide a number of panels\r\n3. Refresh the page, allowing some (but not all!) panels to render\r\n4. Hit \"save\" and note the spurious changes in the JSON diff view.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: v9.4.7\r\n- Data source type \u0026 version: any datasource\r\n- OS Grafana is installed on: linux\r\n- User OS \u0026 Browser: Mac, Chrome\r\n- Grafana plugins: None\r\n\r\n\u003cdetails\u003e\r\n\u003csummary\u003eexample dashboard\u003c/summary\u003e\r\n```\r\n{\r\n  \"annotations\": {\r\n    \"list\": [\r\n      {\r\n        \"builtIn\": 1,\r\n        \"datasource\": {\r\n          \"type\": \"grafana\",\r\n          \"uid\": \"-- Grafana --\"\r\n        },\r\n        \"enable\": true,\r\n        \"hide\": true,\r\n        \"iconColor\": \"rgba(0, 211, 255, 1)\",\r\n        \"name\": \"Annotations \u0026 Alerts\",\r\n        \"target\": {\r\n          \"limit\": 100,\r\n          \"matchAny\": false,\r\n          \"tags\": [],\r\n          \"type\": \"dashboard\"\r\n        },\r\n        \"type\": \"dashboard\"\r\n      }\r\n    ]\r\n  },\r\n  \"editable\": true,\r\n  \"fiscalYearStartMonth\": 0,\r\n  \"graphTooltip\": 0,\r\n  \"id\": 11,\r\n  \"links\": [],\r\n  \"liveNow\": false,\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"custom\": {\r\n            \"axisCenteredZero\": false,\r\n            \"axisColorMode\": \"text\",\r\n            \"axisLabel\": \"\",\r\n            \"axisPlacement\": \"auto\",\r\n            \"barAlignment\": 0,\r\n            \"drawStyle\": \"line\",\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"hideFrom\": {\r\n              \"legend\": false,\r\n              \"tooltip\": false,\r\n              \"viz\": false\r\n            },\r\n            \"lineInterpolation\": \"linear\",\r\n            \"lineWidth\": 1,\r\n            \"pointSize\": 5,\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"showPoints\": \"auto\",\r\n            \"spanNulls\": false,\r\n            \"stacking\": {\r\n              \"group\": \"A\",\r\n              \"mode\": \"none\"\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 8,\r\n        \"w\": 12,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"legend\": {\r\n          \"calcs\": [],\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"showLegend\": true\r\n        },\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Panel\",\r\n      \"type\": \"timeseries\"\r\n    },\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"custom\": {\r\n            \"axisCenteredZero\": false,\r\n            \"axisColorMode\": \"text\",\r\n            \"axisLabel\": \"\",\r\n            \"axisPlacement\": \"auto\",\r\n            \"barAlignment\": 0,\r\n            \"drawStyle\": \"line\",\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"hideFrom\": {\r\n              \"legend\": false,\r\n              \"tooltip\": false,\r\n              \"viz\": false\r\n            },\r\n            \"lineInterpolation\": \"linear\",\r\n            \"lineWidth\": 1,\r\n            \"pointSize\": 5,\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"showPoints\": \"auto\",\r\n            \"spanNulls\": false,\r\n            \"stacking\": {\r\n              \"group\": \"A\",\r\n              \"mode\": \"none\"\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 8,\r\n        \"w\": 12,\r\n        \"x\": 12,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 14,\r\n      \"options\": {\r\n        \"legend\": {\r\n          \"calcs\": [],\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"showLegend\": true\r\n        },\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Panel\",\r\n      \"type\": \"timeseries\"\r\n    },\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"custom\": {\r\n            \"axisCenteredZero\": false,\r\n            \"axisColorMode\": \"text\",\r\n            \"axisLabel\": \"\",\r\n            \"axisPlacement\": \"auto\",\r\n            \"barAlignment\": 0,\r\n            \"drawStyle\": \"line\",\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"hideFrom\": {\r\n              \"legend\": false,\r\n              \"tooltip\": false,\r\n              \"viz\": false\r\n            },\r\n            \"lineInterpolation\": \"linear\",\r\n            \"lineWidth\": 1,\r\n            \"pointSize\": 5,\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"showPoints\": \"auto\",\r\n            \"spanNulls\": false,\r\n            \"stacking\": {\r\n              \"group\": \"A\",\r\n              \"mode\": \"none\"\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 8,\r\n        \"w\": 12,\r\n        \"x\": 0,\r\n        \"y\": 8\r\n      },\r\n      \"id\": 15,\r\n      \"options\": {\r\n        \"legend\": {\r\n          \"calcs\": [],\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"showLegend\": true\r\n        },\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Panel\",\r\n      \"type\": \"timeseries\"\r\n    },\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"custom\": {\r\n            \"axisCenteredZero\": false,\r\n            \"axisColorMode\": \"text\",\r\n            \"axisLabel\": \"\",\r\n            \"axisPlacement\": \"auto\",\r\n            \"barAlignment\": 0,\r\n            \"drawStyle\": \"line\",\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"hideFrom\": {\r\n              \"legend\": false,\r\n              \"tooltip\": false,\r\n              \"viz\": false\r\n            },\r\n            \"lineInterpolation\": \"linear\",\r\n            \"lineWidth\": 1,\r\n            \"pointSize\": 5,\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"showPoints\": \"auto\",\r\n            \"spanNulls\": false,\r\n            \"stacking\": {\r\n              \"group\": \"A\",\r\n              \"mode\": \"none\"\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 8,\r\n        \"w\": 12,\r\n        \"x\": 12,\r\n        \"y\": 8\r\n      },\r\n      \"id\": 13,\r\n      \"options\": {\r\n        \"legend\": {\r\n          \"calcs\": [],\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"showLegend\": true\r\n        },\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Panel\",\r\n      \"type\": \"timeseries\"\r\n    },\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"custom\": {\r\n            \"axisCenteredZero\": false,\r\n            \"axisColorMode\": \"text\",\r\n            \"axisLabel\": \"\",\r\n            \"axisPlacement\": \"auto\",\r\n            \"barAlignment\": 0,\r\n            \"drawStyle\": \"line\",\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"hideFrom\": {\r\n              \"legend\": false,\r\n              \"tooltip\": false,\r\n              \"viz\": false\r\n            },\r\n            \"lineInterpolation\": \"linear\",\r\n            \"lineWidth\": 1,\r\n            \"pointSize\": 5,\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"showPoints\": \"auto\",\r\n            \"spanNulls\": false,\r\n            \"stacking\": {\r\n              \"group\": \"A\",\r\n              \"mode\": \"none\"\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 8,\r\n        \"w\": 12,\r\n        \"x\": 0,\r\n        \"y\": 16\r\n      },\r\n      \"id\": 12,\r\n      \"options\": {\r\n        \"legend\": {\r\n          \"calcs\": [],\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"showLegend\": true\r\n        },\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Panel\",\r\n      \"type\": \"timeseries\"\r\n    },\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"custom\": {\r\n            \"axisCenteredZero\": false,\r\n            \"axisColorMode\": \"text\",\r\n            \"axisLabel\": \"\",\r\n            \"axisPlacement\": \"auto\",\r\n            \"barAlignment\": 0,\r\n            \"drawStyle\": \"line\",\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"hideFrom\": {\r\n              \"legend\": false,\r\n              \"tooltip\": false,\r\n              \"viz\": false\r\n            },\r\n            \"lineInterpolation\": \"linear\",\r\n            \"lineWidth\": 1,\r\n            \"pointSize\": 5,\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"showPoints\": \"auto\",\r\n            \"spanNulls\": false,\r\n            \"stacking\": {\r\n              \"group\": \"A\",\r\n              \"mode\": \"none\"\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 8,\r\n        \"w\": 12,\r\n        \"x\": 12,\r\n        \"y\": 16\r\n      },\r\n      \"id\": 11,\r\n      \"options\": {\r\n        \"legend\": {\r\n          \"calcs\": [],\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"showLegend\": true\r\n        },\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Panel\",\r\n      \"type\": \"timeseries\"\r\n    },\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"custom\": {\r\n            \"axisCenteredZero\": false,\r\n            \"axisColorMode\": \"text\",\r\n            \"axisLabel\": \"\",\r\n            \"axisPlacement\": \"auto\",\r\n            \"barAlignment\": 0,\r\n            \"drawStyle\": \"line\",\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"hideFrom\": {\r\n              \"legend\": false,\r\n              \"tooltip\": false,\r\n              \"viz\": false\r\n            },\r\n            \"lineInterpolation\": \"linear\",\r\n            \"lineWidth\": 1,\r\n            \"pointSize\": 5,\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"showPoints\": \"auto\",\r\n            \"spanNulls\": false,\r\n            \"stacking\": {\r\n              \"group\": \"A\",\r\n              \"mode\": \"none\"\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\"\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 8,\r\n        \"w\": 12,\r\n        \"x\": 0,\r\n        \"y\": 24\r\n      },\r\n      \"id\": 10,\r\n      \"options\": {\r\n        \"legend\": {\r\n          \"calcs\": [],\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"showLegend\": true\r\n        },\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Panel\",\r\n      \"type\": \"timeseries\"\r\n    },\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"custom\": {\r\n            \"axisCenteredZero\": false,\r\n            \"axisColorMode\": \"text\",\r\n            \"axisLabel\": \"\",\r\n            \"axisPlacement\": \"auto\",\r\n            \"barAlignment\": 0,\r\n            \"drawStyle\": \"line\",\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"hideFrom\": {\r\n              \"legend\": false,\r\n              \"tooltip\": false,\r\n              \"viz\": false\r\n            },\r\n            \"lineInterpolation\": \"linear\",\r\n            \"lineWidth\": 1,\r\n            \"pointSize\": 5,\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"showPoints\": \"auto\",\r\n            \"spanNulls\": false,\r\n            \"stacking\": {\r\n              \"group\": \"A\",\r\n              \"mode\": \"none\"\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\"\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 8,\r\n        \"w\": 12,\r\n        \"x\": 12,\r\n        \"y\": 24\r\n      },\r\n      \"id\": 9,\r\n      \"options\": {\r\n        \"legend\": {\r\n          \"calcs\": [],\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"showLegend\": true\r\n        },\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Panel\",\r\n      \"type\": \"timeseries\"\r\n    },\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"custom\": {\r\n            \"axisCenteredZero\": false,\r\n            \"axisColorMode\": \"text\",\r\n            \"axisLabel\": \"\",\r\n            \"axisPlacement\": \"auto\",\r\n            \"barAlignment\": 0,\r\n            \"drawStyle\": \"line\",\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"hideFrom\": {\r\n              \"legend\": false,\r\n              \"tooltip\": false,\r\n              \"viz\": false\r\n            },\r\n            \"lineInterpolation\": \"linear\",\r\n            \"lineWidth\": 1,\r\n            \"pointSize\": 5,\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"showPoints\": \"auto\",\r\n            \"spanNulls\": false,\r\n            \"stacking\": {\r\n              \"group\": \"A\",\r\n              \"mode\": \"none\"\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\"\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 8,\r\n        \"w\": 12,\r\n        \"x\": 0,\r\n        \"y\": 32\r\n      },\r\n      \"id\": 8,\r\n      \"options\": {\r\n        \"legend\": {\r\n          \"calcs\": [],\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"showLegend\": true\r\n        },\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Panel\",\r\n      \"type\": \"timeseries\"\r\n    },\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"custom\": {\r\n            \"axisCenteredZero\": false,\r\n            \"axisColorMode\": \"text\",\r\n            \"axisLabel\": \"\",\r\n            \"axisPlacement\": \"auto\",\r\n            \"barAlignment\": 0,\r\n            \"drawStyle\": \"line\",\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"hideFrom\": {\r\n              \"legend\": false,\r\n              \"tooltip\": false,\r\n              \"viz\": false\r\n            },\r\n            \"lineInterpolation\": \"linear\",\r\n            \"lineWidth\": 1,\r\n            \"pointSize\": 5,\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"showPoints\": \"auto\",\r\n            \"spanNulls\": false,\r\n            \"stacking\": {\r\n              \"group\": \"A\",\r\n              \"mode\": \"none\"\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\"\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 8,\r\n        \"w\": 12,\r\n        \"x\": 12,\r\n        \"y\": 32\r\n      },\r\n      \"id\": 7,\r\n      \"options\": {\r\n        \"legend\": {\r\n          \"calcs\": [],\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"showLegend\": true\r\n        },\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Panel\",\r\n      \"type\": \"timeseries\"\r\n    },\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"custom\": {\r\n            \"axisCenteredZero\": false,\r\n            \"axisColorMode\": \"text\",\r\n            \"axisLabel\": \"\",\r\n            \"axisPlacement\": \"auto\",\r\n            \"barAlignment\": 0,\r\n            \"drawStyle\": \"line\",\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"hideFrom\": {\r\n              \"legend\": false,\r\n              \"tooltip\": false,\r\n              \"viz\": false\r\n            },\r\n            \"lineInterpolation\": \"linear\",\r\n            \"lineWidth\": 1,\r\n            \"pointSize\": 5,\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"showPoints\": \"auto\",\r\n            \"spanNulls\": false,\r\n            \"stacking\": {\r\n              \"group\": \"A\",\r\n              \"mode\": \"none\"\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\"\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 8,\r\n        \"w\": 12,\r\n        \"x\": 0,\r\n        \"y\": 40\r\n      },\r\n      \"id\": 6,\r\n      \"options\": {\r\n        \"legend\": {\r\n          \"calcs\": [],\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"showLegend\": true\r\n        },\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Panel\",\r\n      \"type\": \"timeseries\"\r\n    },\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"custom\": {\r\n            \"axisCenteredZero\": false,\r\n            \"axisColorMode\": \"text\",\r\n            \"axisLabel\": \"\",\r\n            \"axisPlacement\": \"auto\",\r\n            \"barAlignment\": 0,\r\n            \"drawStyle\": \"line\",\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"hideFrom\": {\r\n              \"legend\": false,\r\n              \"tooltip\": false,\r\n              \"viz\": false\r\n            },\r\n            \"lineInterpolation\": \"linear\",\r\n            \"lineWidth\": 1,\r\n            \"pointSize\": 5,\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"showPoints\": \"auto\",\r\n            \"spanNulls\": false,\r\n            \"stacking\": {\r\n              \"group\": \"A\",\r\n              \"mode\": \"none\"\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\"\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 8,\r\n        \"w\": 12,\r\n        \"x\": 12,\r\n        \"y\": 40\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"legend\": {\r\n          \"calcs\": [],\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"showLegend\": true\r\n        },\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Panel\",\r\n      \"type\": \"timeseries\"\r\n    },\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"custom\": {\r\n            \"axisCenteredZero\": false,\r\n            \"axisColorMode\": \"text\",\r\n            \"axisLabel\": \"\",\r\n            \"axisPlacement\": \"auto\",\r\n            \"barAlignment\": 0,\r\n            \"drawStyle\": \"line\",\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"hideFrom\": {\r\n              \"legend\": false,\r\n              \"tooltip\": false,\r\n              \"viz\": false\r\n            },\r\n            \"lineInterpolation\": \"linear\",\r\n            \"lineWidth\": 1,\r\n            \"pointSize\": 5,\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"showPoints\": \"auto\",\r\n            \"spanNulls\": false,\r\n            \"stacking\": {\r\n              \"group\": \"A\",\r\n              \"mode\": \"none\"\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\"\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 8,\r\n        \"w\": 12,\r\n        \"x\": 0,\r\n        \"y\": 48\r\n      },\r\n      \"id\": 4,\r\n      \"options\": {\r\n        \"legend\": {\r\n          \"calcs\": [],\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"showLegend\": true\r\n        },\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Panel\",\r\n      \"type\": \"timeseries\"\r\n    },\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"custom\": {\r\n            \"axisCenteredZero\": false,\r\n            \"axisColorMode\": \"text\",\r\n            \"axisLabel\": \"\",\r\n            \"axisPlacement\": \"auto\",\r\n            \"barAlignment\": 0,\r\n            \"drawStyle\": \"line\",\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"hideFrom\": {\r\n              \"legend\": false,\r\n              \"tooltip\": false,\r\n              \"viz\": false\r\n            },\r\n            \"lineInterpolation\": \"linear\",\r\n            \"lineWidth\": 1,\r\n            \"pointSize\": 5,\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"showPoints\": \"auto\",\r\n            \"spanNulls\": false,\r\n            \"stacking\": {\r\n              \"group\": \"A\",\r\n              \"mode\": \"none\"\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\"\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 8,\r\n        \"w\": 12,\r\n        \"x\": 12,\r\n        \"y\": 48\r\n      },\r\n      \"id\": 3,\r\n      \"options\": {\r\n        \"legend\": {\r\n          \"calcs\": [],\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"showLegend\": true\r\n        },\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Panel\",\r\n      \"type\": \"timeseries\"\r\n    }\r\n  ],\r\n  \"refresh\": \"\",\r\n  \"revision\": 1,\r\n  \"schemaVersion\": 38,\r\n  \"style\": \"dark\",\r\n  \"tags\": [],\r\n  \"templating\": {\r\n    \"list\": []\r\n  },\r\n  \"time\": {\r\n    \"from\": \"now-6h\",\r\n    \"to\": \"now\"\r\n  },\r\n  \"timepicker\": {},\r\n  \"timezone\": \"\",\r\n  \"title\": \"test\",\r\n  \"uid\": \"b2qXoQfVz\",\r\n  \"version\": 5,\r\n  \"weekStart\": \"\"\r\n}\r\n```\r\n\u003c/details\u003e","labels":["area/dashboard","bot/no new info","triage/needs-confirmation"]},{"id":81139,"title":"Grafana: When Running Multiple Grafana Pods It's Getting - failure: contact points: could not find object using provided id and hash","body":"### What happened?\n\nWhen running multiple Grafana pods I keep getting the following error:\r\n \"failure: contact points: could not find object using provided id and hash\"\r\n It causes the pod to restart multiple times.\n\n### What did you expect to happen?\n\nI expected Grafana to spin up without any issues\n\n### Did this work before?\n\nNo\n\n### How do we reproduce it?\n\n1. Use contact points and run Grafana in HA mode inside K8S\n\n### Is the bug inside a dashboard panel?\n\nNo\n\n### Environment (with versions)?\n\nGrafana: 10.1.2\r\nOS: amazon-eks-node-1.27-v20240117\r\nBrowser: Chrome\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nLoki","labels":["needs more info"]},{"id":67694,"title":"Metric query CloudWatch AWS/Lamb \"!=\" create Other in Alert, and alert does not work","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n![image](https://user-images.githubusercontent.com/91407250/235840217-43699649-2a88-430f-9382-80096147084f.png)\n\n### \n# How do we reproduce it?\n\n\nI have two Lambda\r\n\r\n![image](https://user-images.githubusercontent.com/91407250/235840069-d901ff92-13e7-4703-80d4-36f8596d0166.png)\r\n\r\nI want to create an Alert without \"us-east-1.TF-PROD-Frontend-Sign-S3-Request\", but it generates for me \"Other\" FunctionName, and Alert does not work \r\n\r\n![image](https://user-images.githubusercontent.com/91407250/235840204-b9f42524-6529-42df-aa7d-f358abac2b27.png)\r\n\r\nIf i set \"=\", then it's even more interesting\r\n\r\n![image](https://user-images.githubusercontent.com/91407250/235840462-8fc41004-987d-4131-bb62-a869c48604e3.png)\r\n\n\n### \n# What Grafana version are you using?\n\n\nGrafana v9.4.7, v9.5.1\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nNone\n\n### User's OS?\n\n_No response_\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["area/alerting","datasource/CloudWatch","triage/needs-confirmation"]},{"id":64273,"title":"Moving from 9.3.8 to 9.4.{1 or 3} PostgreSQL data sources are losing their database names","body":"\r\n**What happened**:\r\nMoving from 9.3.8 to 9.4.1 (or 9.4.3) none of my Postgresql data sources work because their database name fields are empty (i.e. were not loaded correctly from file). I'm provisioning the data source descriptions via YAML files (all of which have the correct database names specified).\r\n\r\n**What you expected to happen**:\r\nI expect the database name in the YAML file to work as it did previously.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\nI note that if I create a new posgresql data source it works as expected BUT if I dump that data source via api/datasources the database field is emitted with its value as the empty string.\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.1\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on: docker container\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/bug","datasource/Postgres","area/provisioning","area/docker"]},{"id":60905,"title":"Grafana live websocket closes after 30s","body":"**What happened**:\r\n\r\nI'm sending data to grafana via the websocket via this python code:\r\n\r\n```python\r\nimport websocket\r\nimport time\r\n\r\n\r\nheaders = {\r\n    'Authorization': f'Bearer eyJrIjoiejRoVTN0RHN5MlNaakI3RHlZc3U0VjhpaFU2WE02RUUiLCJuIjoiWWVwWWVwIiwiaWQiOjF9'\r\n}\r\n\r\ngrafana_ws = \"ws://localhost:3000/api/live/push/test\"\r\n\r\n\r\n\r\nws = websocket.WebSocket(skip_utf8_validation=True, enable_multithread=False)\r\n\r\nws.connect(grafana_ws, header=headers)\r\nprint(ws.sock_opt.timeout)\r\n\r\nfor idx in range(5000):\r\n    print(idx)\r\n    influx_time = int(time.time() * 1_000_000_000)\r\n    ws.send(f\"test ype={idx} {influx_time}\")\r\n    time.sleep(0.01)\r\n\r\nws.close()\r\n```\r\n\r\nThis works fine in the beginning, but it seems to stop working after 30s. If I change the time.sleep to 1.0 (in seconds) I get around 29 sends, when I change to 0.1 I get around 290 and with 0.01 I get around 2700. \r\n\r\nAll these seems very close to 30s, so I suspect some timeout is reached. I looked into the configuration ini but found nothing about websocket timeouts. \r\n\r\nThis is the grafana logs:\r\n\r\n```\r\ngrafana    | logger=live.push_ws t=2023-01-03T12:38:53.030498125Z level=debug msg=\"Live Push request\" protocol=http streamId=test bodyLength=33 frameFormat=labels_column\r\ngrafana    | logger=live.managed_stream t=2023-01-03T12:38:53.030592012Z level=debug msg=\"Publish data to channel\" channel=stream/test/test dataLength=49\r\ngrafana    | logger=live.push_ws t=2023-01-03T12:38:53.040643555Z level=debug msg=\"Live Push request\" protocol=http streamId=test bodyLength=33 frameFormat=labels_column\r\ngrafana    | logger=live.managed_stream t=2023-01-03T12:38:53.040742924Z level=debug msg=\"Publish data to channel\" channel=stream/test/test dataLength=49\r\ngrafana    | logger=live.push_ws t=2023-01-03T12:38:53.05080159Z level=debug msg=\"Live Push request\" protocol=http streamId=test bodyLength=33 frameFormat=labels_column\r\ngrafana    | logger=live.managed_stream t=2023-01-03T12:38:53.050876527Z level=debug msg=\"Publish data to channel\" channel=stream/test/test dataLength=49\r\ngrafana    | logger=live.push_ws t=2023-01-03T12:38:53.060949851Z level=debug msg=\"Live Push request\" protocol=http streamId=test bodyLength=33 frameFormat=labels_column\r\ngrafana    | logger=live.managed_stream t=2023-01-03T12:38:53.06101352Z level=debug msg=\"Publish data to channel\" channel=stream/test/test dataLength=49\r\ngrafana    | logger=live.push_ws t=2023-01-03T12:38:53.071118649Z level=debug msg=\"Live Push request\" protocol=http streamId=test bodyLength=33 frameFormat=labels_column\r\ngrafana    | logger=live.managed_stream t=2023-01-03T12:38:53.071233386Z level=debug msg=\"Publish data to channel\" channel=stream/test/test dataLength=49\r\ngrafana    | logger=live.push_ws t=2023-01-03T12:38:53.081273804Z level=debug msg=\"Live Push request\" protocol=http streamId=test bodyLength=33 frameFormat=labels_column\r\ngrafana    | logger=live.managed_stream t=2023-01-03T12:38:53.081376048Z level=debug msg=\"Publish data to channel\" channel=stream/test/test dataLength=49\r\ngrafana    | logger=live.push_ws t=2023-01-03T12:38:53.088642404Z level=debug msg=\"Error reading websocket connection\" error=\"read tcp 127.0.0.1:3000-\u003e127.0.0.1:49540: i/o timeout\"\r\ngrafana    | logger=context userId=0 orgId=1 uname= t=2023-01-03T12:38:53.088717195Z level=info msg=\"Request Completed\" method=GET path=/api/live/push/test status=-1 remote_addr=127.0.0.1 time_ms=27794 duration=27.794504485s size=0 referer= handler=/api/live/push/:streamId\r\n\r\n```\r\n\r\nI indeed get a ` i/o timeout` but I don't know how to solve this. No mention if this is client or server.\r\nEverything runs locally on my pc, so not network problems should exist.\r\n\r\n**What you expected to happen**:\r\n\r\nInfinitely long websocket connection.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nCode from above with this grafana.ini\r\n\r\n```\r\napp_mode = development\r\n\r\n[auth.anonymous]\r\nenabled = true\r\n\r\n[log]\r\nmode = console\r\nlevel = debug\r\n\r\n[live]\r\nallowed_origins = 127.0.0.1,localhost,*\r\nmax_connections = -1\r\n```\r\n\r\n\r\n**Environment**:\r\n- Grafana version: v9.3.2 (Docker latest atm)\r\n- Data source type \u0026 version: Grafana live\r\n- OS Grafana is installed on: Docker on Ubuntu 20.04\r\n- User OS \u0026 Browser: Ubuntu20.04, Chrome\r\n- Grafana plugins: /\r\n- Others: /\r\n","labels":["area/backend/api","area/backend","triage/needs-confirmation"]},{"id":72501,"title":"NetworkError when switching organization","body":"### What happened?\r\n\r\nError: NetworkError when attempting to fetch resource.\r\n\r\n![grafik](https://github.com/grafana/grafana/assets/13609443/3671a36c-1491-40b0-839d-acdf8b30055d)\r\n\r\nThis happens when switching from a organization with a default dashboard set to another organization. If both organizations have default dashboards set, this error is displayed each time. If none of them has a default dashboard, the error does not occur.\r\n\r\nIf the same dashboard is reloaded (i.e. F5) the error does not occur.\r\n\r\nMaybe helpful JS stack:\r\n```\r\nTypeError: NetworkError when attempting to fetch resource. 7362.acb44db65e8b744c275b.js:26:20566\r\n\tZ https://mygrafanainstall.com:3000/public/build/7362.acb44db65e8b744c275b.js:26\r\n\tre https://mygrafanainstall.com:3000/public/build/7362.acb44db65e8b744c275b.js:26\r\n\tLr https://mygrafanainstall.com:3000/public/build/5226.48dbd59a341e1b9072d3.js:37\r\n\tZt https://mygrafanainstall.com:3000/public/build/5226.48dbd59a341e1b9072d3.js:175\r\n\tinitDashboard https://mygrafanainstall.com:3000/public/build/6281.b9f076aaf49d7d0d7d60.js:391\r\n\tcomponentDidMount https://mygrafanainstall.com:3000/public/build/6281.b9f076aaf49d7d0d7d60.js:391\r\n\t_c https://mygrafanainstall.com:3000/public/build/5226.48dbd59a341e1b9072d3.js:156\r\n\tKc https://mygrafanainstall.com:3000/public/build/5226.48dbd59a341e1b9072d3.js:156\r\n\tKc https://mygrafanainstall.com:3000/public/build/5226.48dbd59a341e1b9072d3.js:156\r\n\tuc https://mygrafanainstall.com:3000/public/build/5226.48dbd59a341e1b9072d3.js:156\r\n\tBh https://mygrafanainstall.com:3000/public/build/5226.48dbd59a341e1b9072d3.js:156\r\n\tXd https://mygrafanainstall.com:3000/public/build/5226.48dbd59a341e1b9072d3.js:156\r\n\tHl https://mygrafanainstall.com:3000/public/build/5226.48dbd59a341e1b9072d3.js:156\r\n\tgl https://mygrafanainstall.com:3000/public/build/5226.48dbd59a341e1b9072d3.js:154\r\n\trd https://mygrafanainstall.com:3000/public/build/5226.48dbd59a341e1b9072d3.js:156\r\n\t(Async: VoidFunction)\r\n```\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nNo error.\r\n\r\n### Did this work before?\r\n\r\nI cannot tell about older versions because it is a fresh new installation.\r\n\r\n### How do we reproduce it?\r\n\r\n1. Create 2 organizations\r\n2. Create a simple dashboard with data visualisation\r\n3. Set those dashboards as default dashboard for each organization\r\n4. Switch between those organizations\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nNo.\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.0.3\r\nOS: Ubuntu 22.04.2\r\nBrowser: Firefox 115.0.2 (64-Bit)\r\n\r\n\r\n### Grafana platform?\r\n\r\nA downloaded binary\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["type/bug","area/dashboard","triage/needs-confirmation"]},{"id":89977,"title":"Variables Overflow into Query Settings Screen in Grafana ","body":"### What happened?\n\nWhen multiple variables are defined, they overflow into the query settings screen, causing an inconvenient user experience.\r\n\r\n![image](https://github.com/grafana/grafana/assets/83022575/3abb1bd1-7a47-462a-8c66-4d6deca4495a)\n\n### What did you expect to happen?\n\nImplement a single-line variable configuration with a scroll option.\r\nAdjust the screen to accommodate the size of multiple variables.\r\nAdd an option to collapse and expand variables in the settings row.\n\n### Did this work before?\n\nNo\n\n### How do we reproduce it?\n\nDefine a large amount of variables and then try to use them in the query settings Screen \r\n\r\n![image](https://github.com/grafana/grafana/assets/83022575/3a0a4893-19be-4958-a43d-ae908e3e6c3d)\r\n![image](https://github.com/grafana/grafana/assets/83022575/2817c5f8-6529-49ab-aeeb-d79cb4a0f026)\r\n\n\n### Is the bug inside a dashboard panel?\n\nYes\n\n### Environment (with versions)?\n\nGrafana:v11.0.0 (277ef258d4)\r\nOS: windows \r\nBrowser: chrome\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["type/bug","prio/high","area/dashboard/templating","area/frontend","team/grafana-dashboards"]},{"id":84687,"title":"Dashboards: Newline symbols converted to space","body":"### What happened?\n\nIf a label value includes a newline symbol (`\\n`), grafana fails to match it from dropdowns. It is instead converted to a space in some areas.\n\n### What did you expect to happen?\n\nFrom a UI design perspective, it makes sense to replace newline characters with white space in the legend and dropdown options, but for the data query, it should match.\r\n![image](https://github.com/grafana/grafana/assets/52802566/d6a00ce7-98c8-447c-9f7d-53cdbb451140)\r\n\n\n### Did this work before?\n\nNo.\n\n### How do we reproduce it?\n\n1. Push a metric with a label value ending in a newline character.\r\n2. Use metric name as variable for a dropdown.\r\n3. Use dropdown in query expression.\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 9.5.3\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nPrometheus 2.49.1","labels":["area/dashboard","team/grafana-dashboards"]},{"id":63256,"title":"[Timeseries] Infinite loop with logarithmic axis","body":"**What happened**:\r\n\r\nTimeseries panel with logarithmic axis and this dataset\r\n\r\n```csv\r\n\"Time\",\"DEN\"\r\n2023-02-10 13:55:00,\r\n2023-02-10 14:00:00,134 ms\r\n2023-02-10 14:05:00,132 ms\r\n2023-02-10 14:10:00,133 ms\r\n2023-02-10 14:15:00,138 ms\r\n2023-02-10 14:20:00,138 ms\r\n2023-02-10 14:25:00,133 ms\r\n2023-02-10 14:30:00,138 ms\r\n2023-02-10 14:35:00,129 ms\r\n2023-02-10 14:40:00,126 ms\r\n2023-02-10 14:45:00,137 ms\r\n2023-02-10 14:50:00,127 ms\r\n```\r\n\r\ncrashes on\r\n\r\n```\r\nes.array.push.js:34 Uncaught RangeError: Invalid array length\r\n    at Array.push (es.array.push.js:34:1)\r\n    at Object.logAxisSplits [as splits] (uPlot.esm.js:1358:1)\r\n    at uPlot.esm.js:4085:1\r\n    at Array.forEach (\u003canonymous\u003e)\r\n    at axesCalc (uPlot.esm.js:4050:1)\r\n    at convergeSize (uPlot.esm.js:3129:1)\r\n    at _commit (uPlot.esm.js:4340:1)\r\n```\r\n\r\nThis is the commit that caused it, without it, it does not happen\r\n\r\nhttps://github.com/grafana/grafana/pull/60768\r\n\r\nIt infinitely loops through this do statement \r\n\r\nhttps://github.com/leeoniya/uPlot/blob/1e4ea5427100f81750a93c1ab9f5b78d3c0bf116/dist/uPlot.esm.js#L1357-L1367\r\n\r\n**Environment**:\r\n- Grafana version: 0bd326d846bba158be115cb2de8992d9e037409c\r\n\r\n","labels":["type/bug","area/panel/timeseries"]},{"id":86731,"title":"Organizations: Cannot add alerts to panels in a new organization","body":"### What happened?\n\nWhen trying to add alerts to dashboards under a new organization, I cannot add them through the panels:\r\n![image](https://github.com/grafana/grafana/assets/116166721/7bafd79a-27e6-46da-b2c0-5e1ad6fbd8a6)\r\n\r\nI must create them through the alerts page then manually link it to the panel.\n\n### What did you expect to happen?\n\nI expect it to allow me to make alerts from panels on new orgs like I did on the originial main org.\n\n### Did this work before?\n\nIt works on the main org.\n\n### How do we reproduce it?\n\nCreate a new org, add a prometheus datasource, add a panel, try to add an alert to the panel.\r\n\n\n### Is the bug inside a dashboard panel?\n\nYes?\n\n### Environment (with versions)?\n\nGrafana: Grafana v10.4.1 (d3ce857c0e)\r\nOS: Docker\r\nBrowser: Firefox 124.0.2 \r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\nPrometheus","labels":["area/alerting","triage/needs-confirmation"]},{"id":57962,"title":"Grouping to matrix transformation in Bar Charts does not run correctly in single X-axis value cases","body":"**What happened**:\r\nThe bar chart is using \"Grouping to matrix\" transformation works in multi X-axis values but not working with single X-axis value.\r\n\r\n**What you expected to happen**:\r\nIt should show 1 column, but showing nothing but weird row label in left-top of the panel.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate a Bar chart, use \"Grouping to matrix\" transformation (play with row/column, switch them if needed). Use query that just creates only 1 bar (1 X axis value). See no bars and only strange row label appearing on the left top of the panel.\r\n\r\n**Anything else we need to know?**:\r\nAccording to my trials, it is related with Grafana \"Grouping to Matrix\" transformation,\r\n\r\n**Environment**:\r\n- Grafana version: v8.4.2\r\n- Data source type \u0026 version: ElasticSearch v7.1.1\r\n- OS Grafana is installed on: K8s (sorry I don't know the version. If needed I can find later.)\r\n- User OS \u0026 Browser: Chrome(Version 107.0.5304.87), Firefox(Version 107.0.5304.87) \r\n- Grafana plugins: \"barchar\"t(8.4.2) with transformation \"groupingToMatrix\"\r\n- Others:\r\n\r\n**Panel JSON:**\r\n```\r\n{\r\n  \"id\": 8,\r\n  \"gridPos\": {\r\n    \"h\": 15,\r\n    \"w\": 24,\r\n    \"x\": 0,\r\n    \"y\": 56\r\n  },\r\n  \"type\": \"barchart\",\r\n  \"title\": \"TITLE of the panel\",\r\n  \"transformations\": [\r\n    {\r\n      \"id\": \"groupingToMatrix\",\r\n      \"options\": {\r\n        \"columnField\": \"data.STRING_FIELD1\",\r\n        \"rowField\": \"data.STRING_FIELD2\",\r\n        \"valueField\": \"Sum\"\r\n      }\r\n    }\r\n  ],\r\n  \"datasource\": {\r\n    \"type\": \"elasticsearch\",\r\n    \"uid\": \"-----------\"\r\n  },\r\n  \"pluginVersion\": \"8.4.2\",\r\n  \"timeFrom\": \"24h\",\r\n  \"links\": [],\r\n  \"fieldConfig\": {\r\n    \"defaults\": {\r\n      \"custom\": {\r\n        \"lineWidth\": 1,\r\n        \"fillOpacity\": 72,\r\n        \"gradientMode\": \"none\",\r\n        \"axisPlacement\": \"auto\",\r\n        \"axisLabel\": \"\",\r\n        \"axisSoftMin\": 0,\r\n        \"scaleDistribution\": {\r\n          \"type\": \"linear\"\r\n        },\r\n        \"hideFrom\": {\r\n          \"tooltip\": false,\r\n          \"viz\": false,\r\n          \"legend\": false\r\n        },\r\n        \"axisGridShow\": true\r\n      },\r\n      \"color\": {\r\n        \"mode\": \"palette-classic\"\r\n      },\r\n      \"mappings\": [],\r\n      \"unit\": \"decbytes\"\r\n    }\r\n  },\r\n  \"options\": {\r\n    \"orientation\": \"vertical\",\r\n    \"xTickLabelRotation\": -90,\r\n    \"xTickLabelSpacing\": 0,\r\n    \"showValue\": \"never\",\r\n    \"stacking\": \"percent\",\r\n    \"groupWidth\": 0.7,\r\n    \"barWidth\": 0.77,\r\n    \"barRadius\": 0.05,\r\n    \"tooltip\": {\r\n      \"mode\": \"multi\",\r\n      \"sort\": \"desc\"\r\n    },\r\n    \"legend\": {\r\n      \"displayMode\": \"list\",\r\n      \"placement\": \"right\",\r\n      \"calcs\": []\r\n    },\r\n    \"text\": {\r\n      \"valueSize\": 13\r\n    },\r\n    \"xTickLabelMaxLength\": 30\r\n  },\r\n  \"targets\": [\r\n    {\r\n      \"alias\": \"\",\r\n      \"bucketAggs\": [\r\n        {\r\n          \"field\": \"STRING_FIELD2\",\r\n          \"id\": \"2\",\r\n          \"settings\": {\r\n            \"min_doc_count\": \"1\",\r\n            \"order\": \"asc\",\r\n            \"orderBy\": \"_term\",\r\n            \"size\": \"0\"\r\n          },\r\n          \"type\": \"terms\"\r\n        },\r\n        {\r\n          \"field\": \"STRING_FIELD1\",\r\n          \"id\": \"3\",\r\n          \"settings\": {\r\n            \"min_doc_count\": \"1\",\r\n            \"order\": \"desc\",\r\n            \"orderBy\": \"_term\",\r\n            \"size\": \"0\"\r\n          },\r\n          \"type\": \"terms\"\r\n        }\r\n      ],\r\n      \"datasource\": {\r\n        \"type\": \"elasticsearch\",\r\n        \"uid\": \"---------------\",\r\n      },\r\n      \"metrics\": [\r\n        {\r\n          \"field\": \"data.INT_FIELD1\",\r\n          \"id\": \"1\",\r\n          \"type\": \"sum\"\r\n        }\r\n      ],\r\n      \"query\": \"---------------\",\r\n      \"refId\": \"A\",\r\n      \"timeField\": \"metadata.timestamp\"\r\n    }\r\n  ],\r\n  \"hideTimeOverride\": false\r\n}\r\n```\r\n\r\n**With 2+ X axis values, working fine like below:**\r\n![image](https://user-images.githubusercontent.com/17744226/199218823-b40d2fce-7a57-42f8-a79e-20f841d820da.png)\r\n\r\n**With 1 X axis value, see left top:**\r\n![image](https://user-images.githubusercontent.com/17744226/199218500-3a6e0e70-954c-45e0-b9f1-694107195f34.png)\r\n\r\n","labels":["datasource/Elasticsearch","area/transformations","bot/no new info","area/panel/barchart"]},{"id":66324,"title":"Unable to provision multiple Notification policies using file provisioning","body":"Grafana 9.4.7\r\n\r\n**What happened**:\r\nI'm attempting to provision all of my unified alerting configuration via yaml files.  I've been able to get contact points and alert rules provisioned however I'm having some strange issues with Notification policies.  I can get it to provision a single policy but I can't figure out how to provision more than 1.\r\n\r\nIf I use something like this:\r\n```\r\napiVersion: 1\r\npolicies:\r\n  - orgId: 1\r\n    receiver: Teams\r\n    routes:\r\n      - receiver: Teams\r\n        object_matchers:\r\n          - [ 'Teams', '=', 'True' ]\r\n  - orgId: 1\r\n    receiver: GoAlert\r\n    routes:\r\n      - receiver: GoAlert\r\n        object_matchers:\r\n          - [ 'GoAlert', '=', 'True' ]\r\n```\r\n\r\nThen I only end up with the GoAlert Notification policy.  I don't see anything mentioned in the logs about why one is getting ignored or any errors or anything like that.  I've also tried breaking each of these out into multiple files and I still only end up with 1 getting created.  I also am seeing that using this configuration grafana is saying that my root notification policy has been configured via provisioning and cannot be edited but I don't think I've done anything here that should or would be touching the root notification policy?\r\n![Notification_policies_-_Alerting_-_Grafana](https://user-images.githubusercontent.com/5891946/231287679-adf074c2-ce16-4734-9c35-b68a27d33d16.jpg)\r\n\r\nIt would be nice if the examples that you gave showed had to add multiples of things.  For example, with contact points I was not able to determine how to provision multiple contact points in a single file so I've had to break each one out into it's own file but I'm suspecting there's a better way to do this but I don't see it mentioned in any docs anywhere.\r\n\r\n\r\n**What you expected to happen**:\r\n\r\nTo be able to create multiple notification policies and to have documentation that is useful.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nUse example yaml above and put that in your provisioning folder\r\n","labels":["needs more info","area/alerting"]},{"id":79313,"title":"Dashboards: \"Auto Fit\" makes page too tall when dashboard contains a variable input","body":"### What happened?\n\nMade a dashboard that uses a variable that is shown in the UI, then executing \"Auto Fit\" (shortcut: d + a), dashboard was resized to be larger than the full height of the visible window canvas\r\n\r\nDemo dashboard: https://snapshots.raintank.io/dashboard/snapshot/5BwzIEyYjaLs0Resj6TJQUdTjUSDWELh\n\n### What did you expect to happen?\n\nThat the dashboard was resized to exactly fit the visible browser canvas\n\n### Did this work before?\n\nNot that I know of, seems to have been mentioned on the initial implementation issue too: https://github.com/grafana/grafana/issues/12768#issuecomment-877234071\n\n### How do we reproduce it?\n\n1. Create a dashboard with a table, e.g from the test grafana random walk\r\n2. Make the table span the full dashboard height\r\n3. Add a \"Text Box\" variable in the dashboard and save it\r\n4. Resize the browser window (smaller or larger)\r\n5. Make grafana Auto Fit dashboard (shortcut: d+a)\r\n\r\nObserve that the dashboard is resized to be larger than the visible browser view\n\n### Is the bug inside a dashboard panel?\n\nNo\n\n### Environment (with versions)?\n\nGrafana: Grafana cloud and local grafana version v9.1.6 (92461d8d1e)\r\nOS: Ubuntu 22.04\r\nBrowser: Firefox (120.0 (64-bit)) and Chromium Version 120.0.6099.71 (Official Build) snap (64-bit)\r\n\n\n### Grafana platform?\n\nI use Grafana Cloud\n\n### Datasource(s)?\n\n_No response_","labels":["area/dashboard","team/grafana-dashboards"]},{"id":72694,"title":"Dashboards: Inspect \u003e Data does not permit series selection when there are multiple time series","body":"### What happened?\n\n[grafana-inspect-bug.zip](https://github.com/grafana/grafana/files/12231449/grafana-inspect-bug.zip)\r\n\r\nIn play.grafana.com, go to the time series graphs example, simple graph.\r\nClick on three dots, then Inspect \u003e Data.\r\nA pop-up window appears.\r\nExpand the Data Options\r\nBelow \"Show data frame\" click on the downward-pointing arrow in order to choose the desired time series.\r\nThe pop-up window vanishes.\r\n\r\nThis behavior also happens in our Grafana instance.\r\nI have only tested this with the time series visualization.\n\n### What did you expect to happen?\n\nExpected behavior is for the pop-up window to remain and display a drop-down list of available time series.\r\n\r\nNote that if I use alternates to mouse use, such as use of TAB, SPACE, arrow key, then and ENTER, then the expected results do  occur!!\n\n### Did this work before?\n\nNo\n\n### How do we reproduce it?\n\n1. Follow steps in What Happened.\r\n2.\r\n3.\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.0.0\r\nOS: Ubuntu 20.04.6\r\nBrowser: Edge 115.0.1901.183 running on Windows 10 21H1\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\n_No response_","labels":["area/dashboard","team/grafana-dashboards"]},{"id":79783,"title":"Grouped servers are not showing up in panel overrides option","body":"### What happened?\r\n\r\nI was trying to override some fields from a grouped server on grafana panel. But on the recent version of Grafana, when I check fields with a name instead of getting URL in my case (I am using telegraf http_response plugin) I am getting results.\r\n\r\n![image](https://github.com/grafana/grafana/assets/69236638/6a631cf9-b130-447f-8211-18488c37f37c)\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nThe parameters I used in telegraf http_response plugin must be shown instead of results since it is impossible to override results that change in time. \r\n\r\nHere is a screenshot from Grafana-server Version 10.0.1 (commit: 5a30620b85, branch: HEAD)\r\n![image](https://github.com/grafana/grafana/assets/69236638/9a09c96f-acf1-40b7-9e38-e3c41ebc3306)\r\n\r\n\r\n### Did this work before?\r\n\r\nYes it works fine on Grafana-server Version 10.0.1 (commit: 5a30620b85, branch: HEAD)\r\n\r\nI have posted the screenshot above.\r\n\r\n### How do we reproduce it?\r\n\r\n1. use telegraf http_response plugin and add multiple URLs to monitor\r\n2. add a panel on Grafana and add a flux query \r\n```\r\nfrom(bucket: \"system_stat\")\r\n  |\u003e range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n  |\u003e filter(fn: (r) =\u003e r[\"_measurement\"] == \"http_response\")\r\n  |\u003e filter(fn: (r) =\u003e r[\"_field\"] == \"result_code\")\r\n  |\u003e filter(fn: (r) =\u003e r[\"host\"] == \"fedora\")\r\n  |\u003e filter(fn: (r) =\u003e r[\"method\"] == \"GET\")\r\n  |\u003e group(columns: [\"server\"])\r\n  |\u003e aggregateWindow(every: v.windowPeriod, fn: last, createEmpty: false)\r\n  |\u003e yield(name: \"last\")\r\n```\r\n3. Go to overrides and click on Add field override\r\n4. Select fields with a name option and you can see multiple results instead of URL\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nYes\r\n\r\n| Key | Value |\r\n|--|--|\r\n| Panel | stat @ 10.2.3 |\r\n| Grafana | 10.2.3 (1e84fede543acc892d2a2515187e545eb047f237) // Open Source |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"description\": \"\",\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"mappings\": [\r\n            {\r\n              \"options\": {\r\n                \"0\": {\r\n                  \"color\": \"green\",\r\n                  \"index\": 0,\r\n                  \"text\": \"UP\"\r\n                },\r\n                \"1\": {\r\n                  \"color\": \"yellow\",\r\n                  \"index\": 6,\r\n                  \"text\": \"UP | response_string_mismatch\"\r\n                },\r\n                \"2\": {\r\n                  \"color\": \"yellow\",\r\n                  \"index\": 5,\r\n                  \"text\": \"UP | body_read_error\"\r\n                },\r\n                \"3\": {\r\n                  \"color\": \"red\",\r\n                  \"index\": 4,\r\n                  \"text\": \"DOWN | connection_failed\"\r\n                },\r\n                \"4\": {\r\n                  \"color\": \"red\",\r\n                  \"index\": 3,\r\n                  \"text\": \"DOWN | timeout\"\r\n                },\r\n                \"5\": {\r\n                  \"color\": \"yellow\",\r\n                  \"index\": 2,\r\n                  \"text\": \"UP | dns_error\"\r\n                },\r\n                \"6\": {\r\n                  \"color\": \"yellow\",\r\n                  \"index\": 1,\r\n                  \"text\": \"UP | response_status_code_mismatch\"\r\n                },\r\n                \"408\": {\r\n                  \"color\": \"red\",\r\n                  \"index\": 8,\r\n                  \"text\": \"Timeout\"\r\n                },\r\n                \"503\": {\r\n                  \"color\": \"red\",\r\n                  \"index\": 7,\r\n                  \"text\": \"Service Unavailable\"\r\n                }\r\n              },\r\n              \"type\": \"value\"\r\n            }\r\n          ],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 6\r\n              }\r\n            ]\r\n          },\r\n          \"color\": {\r\n            \"mode\": \"thresholds\"\r\n          }\r\n        },\r\n        \"overrides\": [\r\n          {\r\n            \"matcher\": {\r\n              \"id\": \"byName\",\r\n              \"options\": \"result_code {host=\\\"fedora\\\", method=\\\"GET\\\", result=\\\"success\\\", server=\\\"http://192.168.1.20:1010/BRClient/General/\\\", status_code=\\\"200\\\"}\"\r\n            },\r\n            \"properties\": [\r\n              {\r\n                \"id\": \"displayName\",\r\n                \"value\": \"MAINSYS PROD\"\r\n              }\r\n            ]\r\n          },\r\n          {\r\n            \"matcher\": {\r\n              \"id\": \"byName\",\r\n              \"options\": \"result_code {host=\\\"fedora\\\", method=\\\"GET\\\", result=\\\"success\\\", server=\\\"http://192.168.1.213:1010/BRClient/General/\\\", status_code=\\\"200\\\"}\"\r\n            },\r\n            \"properties\": [\r\n              {\r\n                \"id\": \"displayName\",\r\n                \"value\": \"MAINSYS TEST\"\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"reduceOptions\": {\r\n          \"values\": false,\r\n          \"calcs\": [\r\n            \"lastNotNull\"\r\n          ],\r\n          \"fields\": \"\"\r\n        },\r\n        \"orientation\": \"auto\",\r\n        \"textMode\": \"auto\",\r\n        \"wideLayout\": true,\r\n        \"colorMode\": \"background\",\r\n        \"graphMode\": \"none\",\r\n        \"justifyMode\": \"center\",\r\n        \"text\": {\r\n          \"titleSize\": 18\r\n        }\r\n      },\r\n      \"pluginVersion\": \"10.2.3\",\r\n      \"targets\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"grafana\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"snapshot\",\r\n          \"snapshot\": [\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"meta\": {\r\n                  \"typeVersion\": [\r\n                    0,\r\n                    0\r\n                  ],\r\n                  \"executedQueryString\": \"from(bucket: \\\"liyu_data\\\")\\n  |\u003e range(start: 2023-12-21T09:19:19.421Z, stop: 2023-12-21T09:24:19.421Z)\\n  |\u003e filter(fn: (r) =\u003e r[\\\"_measurement\\\"] == \\\"http_response\\\")\\n  |\u003e filter(fn: (r) =\u003e r[\\\"host\\\"] == \\\"fedora\\\")\\n  |\u003e filter(fn: (r) =\u003e r[\\\"_field\\\"] == \\\"result_code\\\")\\n  |\u003e filter(fn: (r) =\u003e r[\\\"method\\\"] == \\\"GET\\\")\\n  |\u003e filter(fn: (r) =\u003e r[\\\"server\\\"] == \\\"http://192.168.1.20:1010/BRClient/General/\\\" or r[\\\"server\\\"] == \\\"http://192.168.1.213:1010/BRClient/General/\\\")\\n  |\u003e aggregateWindow(every: 500ms, fn: last, createEmpty: false)\\n  |\u003e yield(name: \\\"last\\\")\"\r\n                },\r\n                \"name\": \"http_response\",\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"Time\",\r\n                    \"type\": \"time\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"time.Time\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"result_code\",\r\n                    \"type\": \"number\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"int64\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"labels\": {\r\n                      \"host\": \"fedora\",\r\n                      \"method\": \"GET\",\r\n                      \"result\": \"success\",\r\n                      \"server\": \"http://192.168.1.20:1010/BRClient/General/\",\r\n                      \"status_code\": \"200\"\r\n                    },\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    1703150365500,\r\n                    1703150371500,\r\n                    1703150383500,\r\n                    1703150393500,\r\n                    1703150405500,\r\n                    1703150415500,\r\n                    1703150421500,\r\n                    1703150431500,\r\n                    1703150442500,\r\n                    1703150451500,\r\n                    1703150461500,\r\n                    1703150471500,\r\n                    1703150482500,\r\n                    1703150491500,\r\n                    1703150503500,\r\n                    1703150511500,\r\n                    1703150522500,\r\n                    1703150531500,\r\n                    1703150541500,\r\n                    1703150551500,\r\n                    1703150561500,\r\n                    1703150571500,\r\n                    1703150581500,\r\n                    1703150591500,\r\n                    1703150601500,\r\n                    1703150612500,\r\n                    1703150622500,\r\n                    1703150631500,\r\n                    1703150645500,\r\n                    1703150651500\r\n                  ],\r\n                  [\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0\r\n                  ]\r\n                ]\r\n              }\r\n            },\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"name\": \"http_response\",\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"Time\",\r\n                    \"type\": \"time\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"time.Time\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"result_code\",\r\n                    \"type\": \"number\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"int64\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"labels\": {\r\n                      \"host\": \"fedora\",\r\n                      \"method\": \"GET\",\r\n                      \"result\": \"success\",\r\n                      \"server\": \"http://192.168.1.213:1010/BRClient/General/\",\r\n                      \"status_code\": \"200\"\r\n                    },\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    1703150365500,\r\n                    1703150371500,\r\n                    1703150383500,\r\n                    1703150393500,\r\n                    1703150405500,\r\n                    1703150415500,\r\n                    1703150421500,\r\n                    1703150431500,\r\n                    1703150442500,\r\n                    1703150451500,\r\n                    1703150461500,\r\n                    1703150471500,\r\n                    1703150482500,\r\n                    1703150491500,\r\n                    1703150503500,\r\n                    1703150511500,\r\n                    1703150522500,\r\n                    1703150531500,\r\n                    1703150541500,\r\n                    1703150551500,\r\n                    1703150561500,\r\n                    1703150571500,\r\n                    1703150581500,\r\n                    1703150591500,\r\n                    1703150601500,\r\n                    1703150612500,\r\n                    1703150622500,\r\n                    1703150631500,\r\n                    1703150645500,\r\n                    1703150651500\r\n                  ],\r\n                  [\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0\r\n                  ]\r\n                ]\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      \"title\": \"Reproduced with embedded data\",\r\n      \"transformations\": [],\r\n      \"type\": \"stat\"\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003estat @ 10.2.3\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003eA[influxdb]\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eTransform\u003c/th\u003e\\n      \u003ctd\u003e\u003c/td\u003e\\n  \u003c/tr\u003e\\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003e 2 frames, 4 fields, 60 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e10.2.3 (1e84fede543acc892d2a2515187e545eb047f237) // Open Source\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"title\": \"Original Panel JSON\",\r\n      \"type\": \"text\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 7\r\n      },\r\n      \"options\": {\r\n        \"content\": \"{\\n  \\\"datasource\\\": {\\n    \\\"type\\\": \\\"influxdb\\\",\\n    \\\"uid\\\": \\\"VPT3dRHIk\\\"\\n  },\\n  \\\"description\\\": \\\"\\\",\\n  \\\"fieldConfig\\\": {\\n    \\\"defaults\\\": {\\n      \\\"mappings\\\": [\\n        {\\n          \\\"options\\\": {\\n            \\\"0\\\": {\\n              \\\"color\\\": \\\"green\\\",\\n              \\\"index\\\": 0,\\n              \\\"text\\\": \\\"UP\\\"\\n            },\\n            \\\"1\\\": {\\n              \\\"color\\\": \\\"yellow\\\",\\n              \\\"index\\\": 6,\\n              \\\"text\\\": \\\"UP | response_string_mismatch\\\"\\n            },\\n            \\\"2\\\": {\\n              \\\"color\\\": \\\"yellow\\\",\\n              \\\"index\\\": 5,\\n              \\\"text\\\": \\\"UP | body_read_error\\\"\\n            },\\n            \\\"3\\\": {\\n              \\\"color\\\": \\\"red\\\",\\n              \\\"index\\\": 4,\\n              \\\"text\\\": \\\"DOWN | connection_failed\\\"\\n            },\\n            \\\"4\\\": {\\n              \\\"color\\\": \\\"red\\\",\\n              \\\"index\\\": 3,\\n              \\\"text\\\": \\\"DOWN | timeout\\\"\\n            },\\n            \\\"5\\\": {\\n              \\\"color\\\": \\\"yellow\\\",\\n              \\\"index\\\": 2,\\n              \\\"text\\\": \\\"UP | dns_error\\\"\\n            },\\n            \\\"6\\\": {\\n              \\\"color\\\": \\\"yellow\\\",\\n              \\\"index\\\": 1,\\n              \\\"text\\\": \\\"UP | response_status_code_mismatch\\\"\\n            },\\n            \\\"408\\\": {\\n              \\\"color\\\": \\\"red\\\",\\n              \\\"index\\\": 8,\\n              \\\"text\\\": \\\"Timeout\\\"\\n            },\\n            \\\"503\\\": {\\n              \\\"color\\\": \\\"red\\\",\\n              \\\"index\\\": 7,\\n              \\\"text\\\": \\\"Service Unavailable\\\"\\n            }\\n          },\\n          \\\"type\\\": \\\"value\\\"\\n        }\\n      ],\\n      \\\"thresholds\\\": {\\n        \\\"mode\\\": \\\"absolute\\\",\\n        \\\"steps\\\": [\\n          {\\n            \\\"color\\\": \\\"green\\\",\\n            \\\"value\\\": null\\n          },\\n          {\\n            \\\"color\\\": \\\"red\\\",\\n            \\\"value\\\": 6\\n          }\\n        ]\\n      },\\n      \\\"color\\\": {\\n        \\\"mode\\\": \\\"thresholds\\\"\\n      }\\n    },\\n    \\\"overrides\\\": [\\n      {\\n        \\\"matcher\\\": {\\n          \\\"id\\\": \\\"byName\\\",\\n          \\\"options\\\": \\\"result_code {host=\\\\\\\"fedora\\\\\\\", method=\\\\\\\"GET\\\\\\\", result=\\\\\\\"success\\\\\\\", server=\\\\\\\"http://192.168.1.20:1010/BRClient/General/\\\\\\\", status_code=\\\\\\\"200\\\\\\\"}\\\"\\n        },\\n        \\\"properties\\\": [\\n          {\\n            \\\"id\\\": \\\"displayName\\\",\\n            \\\"value\\\": \\\"MAINSYS PROD\\\"\\n          }\\n        ]\\n      },\\n      {\\n        \\\"matcher\\\": {\\n          \\\"id\\\": \\\"byName\\\",\\n          \\\"options\\\": \\\"result_code {host=\\\\\\\"fedora\\\\\\\", method=\\\\\\\"GET\\\\\\\", result=\\\\\\\"success\\\\\\\", server=\\\\\\\"http://192.168.1.213:1010/BRClient/General/\\\\\\\", status_code=\\\\\\\"200\\\\\\\"}\\\"\\n        },\\n        \\\"properties\\\": [\\n          {\\n            \\\"id\\\": \\\"displayName\\\",\\n            \\\"value\\\": \\\"MAINSYS TEST\\\"\\n          }\\n        ]\\n      }\\n    ]\\n  },\\n  \\\"gridPos\\\": {\\n    \\\"h\\\": 5,\\n    \\\"w\\\": 9,\\n    \\\"x\\\": 7,\\n    \\\"y\\\": 0\\n  },\\n  \\\"id\\\": 2,\\n  \\\"options\\\": {\\n    \\\"reduceOptions\\\": {\\n      \\\"values\\\": false,\\n      \\\"calcs\\\": [\\n        \\\"lastNotNull\\\"\\n      ],\\n      \\\"fields\\\": \\\"\\\"\\n    },\\n    \\\"orientation\\\": \\\"auto\\\",\\n    \\\"textMode\\\": \\\"auto\\\",\\n    \\\"wideLayout\\\": true,\\n    \\\"colorMode\\\": \\\"background\\\",\\n    \\\"graphMode\\\": \\\"none\\\",\\n    \\\"justifyMode\\\": \\\"center\\\",\\n    \\\"text\\\": {\\n      \\\"titleSize\\\": 18\\n    }\\n  },\\n  \\\"pluginVersion\\\": \\\"10.2.3\\\",\\n  \\\"targets\\\": [\\n    {\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"influxdb\\\",\\n        \\\"uid\\\": \\\"VPT3dRHIk\\\"\\n      },\\n      \\\"query\\\": \\\"from(bucket: \\\\\\\"liyu_data\\\\\\\")\\\\n  |\u003e range(start: v.timeRangeStart, stop: v.timeRangeStop)\\\\n  |\u003e filter(fn: (r) =\u003e r[\\\\\\\"_measurement\\\\\\\"] == \\\\\\\"http_response\\\\\\\")\\\\n  |\u003e filter(fn: (r) =\u003e r[\\\\\\\"host\\\\\\\"] == \\\\\\\"fedora\\\\\\\")\\\\n  |\u003e filter(fn: (r) =\u003e r[\\\\\\\"_field\\\\\\\"] == \\\\\\\"result_code\\\\\\\")\\\\n  |\u003e filter(fn: (r) =\u003e r[\\\\\\\"method\\\\\\\"] == \\\\\\\"GET\\\\\\\")\\\\n  |\u003e filter(fn: (r) =\u003e r[\\\\\\\"server\\\\\\\"] == \\\\\\\"http://192.168.1.20:1010/BRClient/General/\\\\\\\" or r[\\\\\\\"server\\\\\\\"] == \\\\\\\"http://192.168.1.213:1010/BRClient/General/\\\\\\\")\\\\n  |\u003e aggregateWindow(every: v.windowPeriod, fn: last, createEmpty: false)\\\\n  |\u003e yield(name: \\\\\\\"last\\\\\\\")\\\",\\n      \\\"refId\\\": \\\"A\\\"\\n    }\\n  ],\\n  \\\"title\\\": \\\"MAINSYS Status\\\",\\n  \\\"transformations\\\": [],\\n  \\\"type\\\": \\\"stat\\\"\\n}\",\r\n        \"mode\": \"code\",\r\n        \"code\": {\r\n          \"language\": \"json\",\r\n          \"showLineNumbers\": true,\r\n          \"showMiniMap\": true\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: MAINSYS Status // 2023-12-21 12:25:37\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-stat\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"2023-12-21T09:20:37.911Z\",\r\n    \"to\": \"2023-12-21T09:25:37.911Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: Version 10.2.3 (commit: 1e84fede543acc892d2a2515187e545eb047f237, branch: HEAD)\r\nOS: Fedora 39 Workstation\r\nBrowser: Firefox 120\r\n\r\n\r\n### Grafana platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### Datasource(s)?\r\n\r\nInfluxdb v2.7.4","labels":["area/dashboard","area/field/overrides","triage/needs-confirmation","team/grafana-dashboards"]},{"id":65034,"title":"Small Stat with two queries overlaps title","body":"**What happened**:\r\nI created a small stat card with two queries and with the graphs enabled, pretty much everything set to auto. Now the graph seems to be able to overlap the title/current value in some cases (actualy quite often), although there is plenty of space between the title and the title of the individual queries. See:\r\n![2023-03-20 11_11_32-Window](https://user-images.githubusercontent.com/393641/226312265-e88dcb7a-835a-471d-bdd2-7bf304dcce79.png)\r\n\r\n\r\n**What you expected to happen**:\r\nThe title/current value of the individual queries should be above the graphs and never overlap.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate a small stat card with two values which generate a lot of spikes probably.\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.3\r\n- Data source type \u0026 version: Prometheus, connecting to VictoriaMetrics\r\n- OS Grafana is installed on: Official Grafana Docker Image\r\n- User OS \u0026 Browser: Windows 10/11, Chrome\r\n- Grafana plugins: None\r\n","labels":["type/bug","stale","area/panel/stat"]},{"id":44003,"title":"Importing Dashboard through Grafana API does not import panels","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nUsing gdg (https://github.com/netsage-project/gdg) for trying to import Dashboard to Grafana result with Error connecting Panels\r\n![Screenshot 2022-01-10 at 21 14 51](https://user-images.githubusercontent.com/31982508/149338640-c432b530-25f0-4628-b308-b6785400f34f.png)\r\n\r\n**What you expected to happen**:\r\nPanel in Dashboard to be imported and linked properly.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Export any Dashboard with panels\r\n2. Try to POST that Dashboard to Grafana that does not yet have it.\r\n\r\n**Anything else we need to know?**:\r\n\r\nIt works if Imported through Grafana UI\r\nPR with fix: https://github.com/grafana/grafana/pull/43525\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.3 and main branch\r\n- Data source type \u0026 version: \r\n- OS Grafana is installed on: Alpine\r\n- User OS \u0026 Browser: MacOS BigSur\r\n- Grafana plugins: NA\r\n- Others: NA\r\n","labels":["area/backend/api","not implemented","area/dashboard/import","area/frontend/library-panels"]},{"id":70938,"title":"Dashboards: Template Variable Not Populating Correctly in Repeated Rows","body":"### \n# What went wrong?\n\n\nUsing Grafana 10.x but have seen the issue on older versions as well.\r\n\r\nBasically i have a template variable \"disk_type\" and the values it takes are data, metadata, redundant. On the dashboard, it is selected via dropdown with default value being \"ALL\".\r\n\r\nBased on this variable three rows (the name of the row being the value of the template variable) are  dynamically created. Within each row, there are couple of panels that also depend on the template variable.  Something like this:\r\n\r\nRow - $disk_type\r\n  Panel 1 - IOPS. --\u003e Sample query node_disk_iops{dev=\"$disk_type\"}\r\n   Panel 2 - Latency\r\nRow - $disk_type\r\n    Panel 1 - IOPS. --\u003e Sample query node_disk_iops{dev=\"$disk_type\"}\r\n   Panel 2 - Latency\r\nRow - $disk_type\r\n  Panel 1 - IOPS. --\u003e Sample query node_disk_iops{dev=\"$disk_type\"}\r\n   Panel 2 - Latency\r\n\r\nBased on above setting, I would expect to see the following\r\n\r\nRow - data\r\n  Panel 1 - IOPS. --\u003e Sample query node_disk_iops{dev=\"data\"}\r\n   Panel 2 - Latency\r\nRow - metadata\r\n    Panel 1 - IOPS. --\u003e Sample query node_disk_iops{dev=\"metadata\"}\r\n   Panel 2 - Latency\r\nRow - redundant\r\n  Panel 1 - IOPS. --\u003e Sample query node_disk_iops{dev=\"redundant\"}\r\n   Panel 2 - Latency\r\n\r\nBut often times I see \r\n\r\n1.\r\nRow - data\r\n  Panel 1 - IOPS. --\u003e Sample query node_disk_iops{dev=\"data\"}\r\n   Panel 2 - Latency\r\nRow - **data**\r\n    Panel 1 - IOPS. --\u003e Sample query node_disk_iops{dev=\"**data**\"}\r\n   Panel 2 - Latency\r\nRow - **data**\r\n  Panel 1 - IOPS. --\u003e Sample query node_disk_iops{dev=\"**data**\"}\r\n   Panel 2 - Latency\r\n\r\nOR \r\n2.\r\n\r\nRow - data\r\n  Panel 1 - IOPS. --\u003e Sample query node_disk_iops{dev=\"data\"}\r\n   Panel 2 - Latency\r\nRow - metadata\r\n    Panel 1 - IOPS. --\u003e Sample query node_disk_iops{dev=\"**data**\"}\r\n   Panel 2 - Latency\r\nRow - redundant\r\n  Panel 1 - IOPS. --\u003e Sample query node_disk_iops{dev=\"**data**\"}\r\n   Panel 2 - Latency\r\n\n\n### \n# How do we reproduce it?\n\n\nBased on the above steps, create a template variable and use it to create rows and within rows use it in panels.\n\n### \n# What Grafana version are you using?\n\n\n10.x\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### User's OS?\n\nLinux centos\n\n### User's Browser?\n\nChrome Version 114.0.5735.106 (Official Build) (x86_64)\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["area/dashboard/templating","area/dashboard","area/frontend","team/grafana-dashboards","prio/planned"]},{"id":75307,"title":"Alerting: Notifications are sent to the wrong contact point with nested policies","body":"### What happened?\n\nA child policy `A` from the default notification policy does not define a contact point and thus inherits it from the default notification policy:\r\n\r\n![image](https://github.com/grafana/grafana/assets/5902830/813a984b-7dcd-4c18-96a8-5cbb70716891)\r\n\r\n![image](https://github.com/grafana/grafana/assets/5902830/c9ab4fa0-0b2f-4e57-8f83-4ef1331bd282)\r\n\r\nThe children of policy `A` do define selectors and contact points accordingly:\r\n\r\n![image](https://github.com/grafana/grafana/assets/5902830/8b4631f5-41f3-4b25-8467-8376a99d5d93)\r\n\r\nAn alert that match of of the children correctly shows the expected policy in `Preview routing`:\r\n\r\n![image](https://github.com/grafana/grafana/assets/5902830/23cede75-172b-43f5-abfc-2927b6d81cfd)\r\n\r\nHowever, notifications are still sent to the contact point default in the default notification policy.\r\n\r\nThe same contact point is used in other notification policies and delivers messages to the right place so we assume it's properly configured (it's not easy/possible to access a secured field).\n\n### What did you expect to happen?\n\nBecause the contact point (receiver) defined by a notification policy that matched the alert (a child of `A`), we expected that the receiver from the default notification policy would be overridden and the only from the child policy uses.\n\n### Did this work before?\n\nWe did not have this nested notification policies before.\n\n### How do we reproduce it?\n\n1. Configure a receiver `R1` in the default notification policy\r\n2. Create a child policy `A` that matches `foo = bar` label and do not define a receiver\r\n3. Create a child policy `X` under `A` that matches `x = y` label and defines a receiver `R2`\r\n4. Create an alert with labels `foo = bar` and `x = y`\r\n5. Confirm in `Preview Routing` that policy `X` is used.\r\n6. Cause the alert to trigger and send a notification\r\n7. Confirm if the notification was sent to receiver `R1` or `R2`\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.1.0\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["area/alerting","triage/needs-confirmation"]},{"id":65741,"title":"Invited LDAP users are asked to create password","body":"When a LDAP user is invited to an org, the invitation link opens a screen that asks to enter a password, which in the case of LDAP users is unnecessary.","labels":["type/bug","area/auth/ldap","triage/needs-confirmation"]},{"id":47605,"title":"Legacy alerts on provisioned dashboards reporting nodata","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI'm trying to set up a provisioned dashboard a legacy alert, via grafonnet.\r\n\r\nThe grafana instance successfully boots and loads the provisioned dashboard, and data retrieval is successful and the appropriate graphs are shown as exepcted.\r\n\r\n![grafana_issue_alert_nodata_target](https://user-images.githubusercontent.com/19969292/162890596-3bcd1718-ea49-4189-9e33-5dd3b3c8f37b.png)\r\n\r\nHowever, the no data annotation appeared shortly after, indicating that the alert was not successful in retrieving the data necessary for the processing of its rules.\r\n\r\nInspection of the panel shows that the alert is present, and it was possible to use the \"Test Rule\" function which returned the following result:\r\n\r\n![grafana_issue_alert_nodata_alert](https://user-images.githubusercontent.com/19969292/162890672-e7f1c178-b06d-433a-a01b-4b6ca17f176a.png)\r\n\r\n```\r\n{\r\n  \"firing\": false,\r\n  \"state\": \"ok\",\r\n  \"conditionEvals\": \"false = false\",\r\n  \"timeMs\": \"1.453ms\",\r\n  \"logs\": [\r\n    {\r\n      \"message\": \"Condition[0]: Query\",\r\n      \"data\": {\r\n        \"from\": 1649736909453,\r\n        \"queries\": [\r\n          {\r\n            \"refId\": \"A\",\r\n            \"model\": {\r\n              \"datasource\": {\r\n                \"type\": \"postgres\"\r\n              },\r\n              \"format\": \"time_series\",\r\n              \"group\": [],\r\n              \"hide\": false,\r\n              \"metricColumn\": \"CONCAT('upper')\",\r\n              \"rawQuery\": false,\r\n              \"rawSql\": \"SELECT\\n  \\\"time\\\" AS \\\"time\\\",\\n  CONCAT('upper') AS metric,\\n  value\\nFROM c_239\\nWHERE\\n  $__timeFilter(\\\"time\\\") AND\\n  meta_id = 5\\nORDER BY 1,2\",\r\n              \"refId\": \"E\",\r\n              \"select\": [\r\n                [\r\n                  {\r\n                    \"params\": [\r\n                      \"value\"\r\n                    ],\r\n                    \"type\": \"column\"\r\n                  }\r\n                ]\r\n              ],\r\n              \"table\": \"c_239\",\r\n              \"timeColumn\": \"\\\"time\\\"\",\r\n              \"timeColumnType\": \"timestamp\",\r\n              \"where\": [\r\n                {\r\n                  \"name\": \"$__timeFilter\",\r\n                  \"params\": [],\r\n                  \"type\": \"macro\"\r\n                },\r\n                {\r\n                  \"datatype\": \"int4\",\r\n                  \"name\": \"\",\r\n                  \"params\": [\r\n                    \"meta_id\",\r\n                    \"=\",\r\n                    5\r\n                  ],\r\n                  \"type\": \"expression\"\r\n                }\r\n              ]\r\n            },\r\n            \"datasource\": {\r\n              \"id\": 1,\r\n              \"name\": \"iot-database\"\r\n            },\r\n            \"maxDataPoints\": 0,\r\n            \"intervalMs\": 0\r\n          }\r\n        ],\r\n        \"to\": 1649737209453\r\n      }\r\n    },\r\n    {\r\n      \"message\": \"Condition[0]: Query Result\",\r\n      \"data\": {\r\n        \"meta\": {\r\n          \"executedQueryString\": \"SELECT\\n  \\\"time\\\" AS \\\"time\\\",\\n  CONCAT('upper') AS metric,\\n  value\\nFROM c_239\\nWHERE\\n  \\\"time\\\" BETWEEN '2022-04-12T04:15:09.453450624Z' AND '2022-04-12T04:20:09.453450624Z' AND\\n  meta_id = 5\\nORDER BY 1,2\",\r\n          \"rowCount\": 0\r\n        },\r\n        \"series\": [\r\n          {\r\n            \"name\": \"upper\",\r\n            \"points\": [\r\n              [\r\n                4.29,\r\n                1649736920460\r\n              ],\r\n              [\r\n                5.59,\r\n                1649737000889.9998\r\n              ]\r\n            ]\r\n          }\r\n        ]\r\n      }\r\n    },\r\n    {\r\n      \"message\": \"Condition[0]: Eval: false, Metric: upper, Value: 4.940\",\r\n      \"data\": null\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nResulting JSON model for the alert:\r\n```\r\n\"alert\": {\r\n  \"alertRuleTags\": { },\r\n  \"conditions\": [\r\n      {\r\n        \"evaluator\": {\r\n            \"params\": [\r\n              20\r\n            ],\r\n            \"type\": \"gt\"\r\n        },\r\n        \"operator\": {\r\n            \"type\": \"and\"\r\n        },\r\n        \"query\": {\r\n            \"params\": [\r\n              \"E\",\r\n              \"5m\",\r\n              \"now\"\r\n            ]\r\n        },\r\n        \"reducer\": {\r\n            \"params\": [ ],\r\n            \"type\": \"avg\"\r\n        },\r\n        \"type\": \"query\"\r\n      }\r\n  ],\r\n  \"executionErrorState\": \"alerting\",\r\n  \"for\": \"5m\",\r\n  \"frequency\": \"60s\",\r\n  \"handler\": 1,\r\n  \"message\": \"Alert message\",\r\n  \"name\": \"Panel 1 Alert\",\r\n  \"noDataState\": \"nodata\",\r\n  \"notifications\": [\r\n      {\r\n        \"uid\": \"xxxxx\"\r\n      }\r\n  ]\r\n}\r\n```\r\n\r\nResulting JSON model for the target:\r\n```\r\n{\r\n    \"datasource\": {\r\n      \"type\": \"postgres\"\r\n    },\r\n    \"format\": \"time_series\",\r\n    \"group\": [ ],\r\n    \"hide\": false,\r\n    \"metricColumn\": \"CONCAT('upper')\",\r\n    \"rawQuery\": false,\r\n    \"refId\": \"E\",\r\n    \"select\": [\r\n      [\r\n          {\r\n            \"params\": [\r\n                \"value\"\r\n            ],\r\n            \"type\": \"column\"\r\n          }\r\n      ]\r\n    ],\r\n    \"table\": \"c_239\",\r\n    \"timeColumn\": \"time\",\r\n    \"where\": [\r\n      {\r\n          \"name\": \"$__timeFilter\",\r\n          \"params\": [ ],\r\n          \"type\": \"macro\"\r\n      },\r\n      {\r\n          \"datatype\": \"int4\",\r\n          \"name\": \"\",\r\n          \"params\": [\r\n            \"meta_id\",\r\n            \"=\",\r\n            5\r\n          ],\r\n          \"type\": \"expression\"\r\n      }\r\n    ]\r\n}\r\n```\r\n\r\nGrafana alert configuration:\r\n```\r\nGF_ALERTING_ENABLED__FILE: 'true'\r\nGF_UNIFIED_ALERTING_ENABLED__FILE: 'false'\r\n```\r\n\r\n**What you expected to happen**:\r\nProvisioned legacy alerts should retrieve data and be evaluated successfully.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Create datasource provisioning yaml file, according to https://grafana.com/docs/grafana/latest/datasources/postgres/ and https://grafana.com/docs/grafana/latest/administration/provisioning/.\r\n```\r\napiVersion: 1\r\n\r\n# list of datasources to insert/update depending\r\n# what's available in the database\r\ndatasources:\r\n  # \u003cstring, required\u003e name of the datasource. Required\r\n  - name: iot-database\r\n    # \u003cstring, required\u003e datasource type. Required\r\n    type: postgres\r\n    url: url:5432\r\n    database: database\r\n    user: $USER\r\n    secureJsonData:\r\n      password: $PASSWORD\r\n    # only fields common to all datasources are fields.\r\n    # the rest should be stored as a json blob in the jsonData field.\r\n    jsonData:\r\n      sslmode: 'disable' # disable/require/verify-ca/verify-full\r\n      # maxOpenConns: 0 # Grafana v5.4+\r\n      # maxIdleConns: 2 # Grafana v5.4+\r\n      # connMaxLifetime: 14400 # Grafana v5.4+\r\n      postgresVersion: 1200 # 903=9.3, 904=9.4, 905=9.5, 906=9.6, 1000=10\r\n      timescaledb: true\r\n      timeInterval: 1m\r\n    # \u003cbool\u003e mark as default datasource. Max one per org\r\n    isDefault: true\r\n    # \u003cint\u003e org id. will default to orgId 1 if not specified\r\n    orgId: 1\r\n    # \u003cstring\u003e custom UID which can be used to reference this datasource in other parts of the configuration, if not specified will be generated automatically\r\n    uid: uid\r\n    version: 1\r\n    # \u003cbool\u003e allow users to edit datasources from the UI.\r\n    editable: false\r\n\r\n```\r\n2. Create dashboard provisioning yaml file, according to https://grafana.com/docs/grafana/latest/administration/provisioning/.\r\n```\r\napiVersion: 1\r\n\r\nproviders:\r\n  # \u003cstring\u003e an unique provider name. Required\r\n  - name: 'dashboards'\r\n    # \u003cint\u003e Org id. Default to 1\r\n    orgId: 1\r\n    # \u003cstring\u003e name of the dashboard folder.\r\n    folder: ''\r\n    # \u003cstring\u003e folder UID. will be automatically generated if not specified\r\n    folderUid: ''\r\n    # \u003cstring\u003e provider type. Default to 'file'\r\n    type: file\r\n    # \u003cbool\u003e disable dashboard deletion\r\n    disableDeletion: false\r\n    # \u003cint\u003e how often Grafana will scan for changed dashboards\r\n    # updateIntervalSeconds: 10\r\n    # \u003cbool\u003e allow updating provisioned dashboards from the UI\r\n    allowUiUpdates: false\r\n    options:\r\n      # \u003cstring, required\u003e path to dashboard files on disk. Required when using the 'file' type\r\n      # path: /var/lib/grafana/dashboards\r\n      path: /etc/grafana/provisioning/dashboards\r\n      # \u003cbool\u003e use folder names from filesystem to create folders in Grafana\r\n      foldersFromFilesStructure: true\r\n```\r\n3. Use Jsonnet and Grafonnet to generate a panel using legacy alerts.\r\n```\r\ndashboard.new(title='title').addPanels(\r\n  [graphPanel.new(\r\n    title='title'\r\n  ).addAlert(\r\n    panel.alert.name,\r\n    executionErrorState=panel.alert.executionErrorState,\r\n    forDuration=panel.alert.forDuration,\r\n    frequency=panel.alert.frequency,\r\n    handler=panel.alert.handler,\r\n    message=panel.alert.message,\r\n    noDataState=panel.alert.noDataState,\r\n    alertRuleTags=panel.alert.alertRuleTags,\r\n    notifications=panel.alert.notifications\r\n  ).addConditions(\r\n    [\r\n      alertCondition.new(\r\n        evaluatorParams=[20],\r\n        evaluatorType='gt',\r\n        operatorType='and',\r\n        queryRefId='E',\r\n        queryTimeEnd='now',\r\n        queryTimeStart='5m',\r\n        reducerParams=[],\r\n        reducerType='avg',\r\n      )\r\n    ]\r\n  ) + {\r\n    targets+: [\r\n      {\r\n          datasource: {\r\n            type: 'postgres',\r\n          },\r\n          format: 'time_series',\r\n          group: [],\r\n          hide: false,\r\n          metricColumn: 'desc',\r\n          rawQuery: false,\r\n          refId: 'E',\r\n          select: [\r\n            [\r\n              {\r\n                type: 'column',\r\n                params: [\r\n                  'value',\r\n                ],\r\n              },\r\n            ],\r\n          ],\r\n          table: 'c_239',\r\n          timeColumn: 'time',\r\n          where: [\r\n            { name: '$__timeFilter', params: [], type: 'macro' },\r\n            {\r\n              type: 'expression',\r\n              datatype: 'int4',\r\n              name: '',\r\n              params: [\r\n                'meta_id',\r\n                '=',\r\n                5,\r\n              ],\r\n            },\r\n          ],\r\n        }\r\n    ]\r\n  }]\r\n)\r\n```\r\n2. \r\n\r\n**Anything else we need to know?**:\r\nNo.\r\n\r\n**Environment**:\r\n- Grafana version: grafana/grafana:7.5.15 (from docker hub)\r\n- Data source type \u0026 version: timescaledb 2.5.1-pg14 (from docker hub)\r\n- OS Grafana is installed on: Alpine\r\n- User OS \u0026 Browser: Windows 10/ Ubuntu 20.04, Chrome\r\n- Grafana plugins: Nil\r\n- Others: Grafonnet (3626fc4)","labels":["type/bug","needs more info","area/alerting","area/alerting-legacy"]},{"id":53349,"title":"High memory usage","body":"## What happened :\r\n\r\nI create an alert and the memory consumption increases a lot because of the PromQL evaluation of the alert.\r\n\r\n## What you expected to happen :\r\n\r\nI expected to have a memory consumption equivalent to the PromQL evaluation in explore feature.\r\n\r\n## How to reproduce it (as minimally and precisely as possible) :\r\n\r\n### Step 1 : Evaluation in \"explore\" tab\r\n\r\nClick on the \"explore\" tab.\r\n\r\nRun some query like `{namespace=\"caascad-monitoring\"}` for a period of 15 minutes.\r\n\r\nCheck memory consumption of Grafana. In our case : 180MB.\r\n\r\n### Step 2 : Evaluation for an alert\r\n\r\nClick on the \"alerting\" tab and \"New alert rule\".\r\n\r\nSet the same query and alert condition `{namespace=\"caascad-monitoring\"}` for a period of 15 minutes.\r\n\r\nCheck memory consumption of Grafana. In our case : 1.61GB.\r\n\r\n## Environment :\r\n- Grafana version: 9.0.2\r\n- Data source type \u0026 version: Prometheus (using the built-in datasource)\r\n- OS Grafana is installed on: Kubernetes with chart grafana from https://grafana.github.io/helm-charts\r\n- User OS \u0026 Browser: Ubuntu 20.04 / Chrome\r\n- Grafana plugins: no additional plugins\r\n- Others: -\r\n","labels":["needs more info","area/alerting"]},{"id":79898,"title":"Alert Formatting in Outlook","body":"### What happened?\n\n![grafana email outlook](https://github.com/grafana/grafana/assets/34842138/fd8026d5-4d8e-4ac9-b90e-39e598adb83a)\r\n\r\nSince the light themed email was introduced in https://github.com/grafana/grafana/pull/72398 the formatting has been incorrect in Microsoft Outlook.  It is displaying like this in Outlook 2016 and 2019 (two different systems, on different networks/configurations).\r\n\r\nI am not well versed in HTML and CSS, but it appears to me that there are classes being called which don't exist (or I can't find any mention of them in Grafana files or on the internet).  These classes have outlook in the name (e.g. border-top-outlook, background-outlook).  Is this something inherent in Outlook, or is it just missing?\n\n### What did you expect to happen?\n\n![grafana email firefox](https://github.com/grafana/grafana/assets/34842138/684f4de7-4d47-4b6d-a43b-87baaf71085f)\r\n\r\nThis is what the same html looks like when opened in a browser.\n\n### Did this work before?\n\nThis worked prior to 10.2.0, though the theme changed considerably so it was not formatted the same.\n\n### How do we reproduce it?\n\n1. Install Grafana 10.2.x\r\n2. Create an email contact point\r\n3. Create an alert\r\n4. Open alert email in Microsoft Outlook\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.2.0/10.2.2\r\nOS: Microsoft Windows 10\r\nBrowser: Mozilla Firefox/Microsoft Edge\r\nEmail Client: Microsoft Outlook 2016/2019\r\n\n\n### Grafana platform?\n\nA downloaded binary\n\n### Datasource(s)?\n\n_No response_","labels":["area/alerting","area/frontend"]},{"id":45377,"title":"soft link from /usr/local/grafana to /var/lib/grafana caused migration failure \"attempt to write a readonly database\" while upgrading grafana v8.3.5","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nwhen i was updating grafana v8.1.5 to v8.3.5 (the original version is v6.7.1), errors occurred as the following logs:\r\ngrafana-server[32284]: t=2021-12-08T14:29:35+0800 lvl=info msg=\"Starting DB migrations\" logger=migrator\r\ngrafana-server[32284]: t=2021-12-08T14:29:35+0800 lvl=info msg=\"Executing migration\" logger=migrator id=\"Add is_service_account column to user\"\r\ngrafana-server[32284]: t=2021-12-08T14:29:35+0800 **lvl=eror msg=\"Executing migration failed\" logger=migrator id=\"Add is_service_account column to user\" error=\"attempt to write a readonly database\"**\r\ngrafana-server[32284]: t=2021-12-08T14:29:35+0800 lvl=eror msg=\"Exec failed\" logger=migrator error=\"attempt to write a readonly database\" sql=\"alter table user ADD COLUMN is_service_account INTEGER NOT NULL DEFAULT 0 \"\r\ngrafana-server[32284]: Failed to start grafana. error: migration failed (id = Add is_service_account column to user): attempt to write a readonly database\r\ngrafana-server[32284]: migration failed (id = Add is_service_account column to user): attempt to write a readonly database\r\ngrafana-server.service: Main process exited, code=exited, status=1/FAILURE\r\nFailed to start Grafana instance.\r\n\r\nAll the related folders and the grafana.db's mod has been changed to  777, own is grafana:grafana\r\n\r\nAfter serveral times of attempts , we found that the failure maybe related to the soft link from  /usr/local/grafana to /var/lib/grafana\r\nBefore we installed the original version v6.7.1，we created a soft link as below:\r\n\u003e **ln -s /usr/local/grafana /var/lib/grafana**\r\n**Both the original installation and v8.1.5 upgrade succeed before.**\r\n**But the upgrade of v8.3.5 failed...**\r\n  \r\n**What you expected to happen**:\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version:v8.1.5 to v8.3.5\r\n- Data source type \u0026 version:sqlite3\r\n- OS Grafana is installed on:suse linux 12\r\n- User OS \u0026 Browser:chrome\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/build-packaging","needs investigation","area/backend/db/migration"]},{"id":61671,"title":"Grafana alerting rules","body":"Hello. After the upgrade to the new version of Grafana, I started seeing some strange errors:\r\n```\r\nlogger=context userId=0 orgId=2 uname= t=2023-01-18T11:05:10.898340569Z level=info msg=\"Request Completed\" method=GET path=/api/prometheus/yiD6mUhVk/api/v1/rules status=404 remote_addr=************* time_ms=3 duration=3.832991ms size=72 referer=https://localhost:3000/alerting/list handler=/api/prometheus/:DatasourceUID/api/v1/rules\r\n\r\nlogger=context userId=0 orgId=2 uname= t=2023-01-18T11:05:10.897954976Z level=error msg=\"data source not found\" error=\"data source not found\" remote_addr=*********\r\n```\r\nDatasource with UID yiD6mUhVk does not exist and there are no alerts/rules in the second org\r\n\u003cimg width=\"1499\" alt=\"Screenshot 2023-01-18 at 14 10 30\" src=\"https://user-images.githubusercontent.com/21221420/213168274-3c1f39a6-ffe6-4f36-afb1-1aaf993541b9.png\"\u003e\r\n\r\nIn the previous version, there were no errors like that.\r\n\r\nPrevious version: 9.0.2\r\nCurrent version: 9.3.1\r\n\r\nI'm trying to understand what is causing those errors.\r\n\r\nWould appreciate any help.","labels":["area/alerting"]},{"id":57985,"title":"Minified React error #185 on Grafana Cloud trace view in Firefox","body":"**What happened**:\r\n\r\n- Browse to **trace view** on Grafana Cloud 'Explore' page\r\n- Open a trace by ID and expand some of the spans + span fields\r\n\r\n**What you expected to happen**:\r\n\r\nI can browse the fields and spans properly, highlighting any text to copy paste etc\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nSee above\r\n\r\n**Anything else we need to know?**:\r\n\r\nReproduced in Incognito tab with no extensions, does **not** reproduce on Chromium 107.0.5304.68\r\n\r\n![image](https://user-images.githubusercontent.com/18282288/199251703-c40c8735-0861-4e4e-9a86-11d8383af4a6.png)\r\n\r\n\r\n```\r\nError: Minified React error #185; visit https://reactjs.org/docs/error-decoder.html?invariant=185 for the full message or use the non-minified dev environment for full errors and additional helpful warnings.\r\n\r\nf@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:4425:2518\r\njt@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:5050:594\r\nWithTheme(undefined)\r\ndiv\r\nU@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:5229:58\r\nWithTheme(undefined)\r\nR@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:7624:145\r\ndiv\r\ndiv\r\ndiv\r\nu@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:247:390\r\nQs@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/explore.278ac94d79c0c9010b9c.js:480:1986\r\nc@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:1194:301\r\nu@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:1194:855\r\nc@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:1194:301\r\nu@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:1194:855\r\nmain\r\ndiv\r\nt@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/4713.232e2ff90daf715727af.js:2:1168940\r\ndiv\r\ndiv\r\ndiv\r\nt@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/4713.232e2ff90daf715727af.js:2:681364\r\np@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:420:3558\r\nYs@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/explore.278ac94d79c0c9010b9c.js:480:3181\r\nWithTheme(undefined)\r\ng@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/4713.232e2ff90daf715727af.js:2:999564\r\ndiv\r\nso@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/explore.278ac94d79c0c9010b9c.js:501:2811\r\ng@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/4713.232e2ff90daf715727af.js:2:999564\r\nWithTheme(Connect(so))\r\nc@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:1194:301\r\nu@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:1194:855\r\ndiv\r\ndiv\r\npo@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/explore.278ac94d79c0c9010b9c.js:517:157\r\ng@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/4713.232e2ff90daf715727af.js:2:999564\r\nSuspense\r\nc@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:1194:301\r\nkn@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:5514:360\r\nt@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/4713.232e2ff90daf715727af.js:2:1014882\r\nt@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/4713.232e2ff90daf715727af.js:2:1016903\r\nmain\r\nst@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:5475:13057\r\nt@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/4713.232e2ff90daf715727af.js:2:1011500\r\ndiv\r\no@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:2035:4592\r\n19175/t.KBarProvider@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/4713.232e2ff90daf715727af.js:2:261503\r\nl@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:6236:19191\r\nc@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:1194:301\r\nu@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:1194:855\r\ny@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/4713.232e2ff90daf715727af.js:2:2892428\r\nu@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:6229:10875\r\nl@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/4713.232e2ff90daf715727af.js:2:997607\r\nss@https://grafana-assets.grafana.net/grafana-pro/9.2.2-eb6f0ffe76/public/build/3191.b435f28b2412ca47983f.js:5527:167\r\n```\r\n\r\n**Environment**:\r\n- Grafana version: Cloud\r\n- Data source type \u0026 version: Tempo (whatever version is on Cloud)\r\n- OS Grafana is installed on: Cloud\r\n- User OS \u0026 Browser: Arch Linux + Firefox 106.0.1 \r\n- Grafana plugins: unknown\r\n","labels":["type/bug","prio/medium","prio/support-subscription","area/explore","datasource/Tempo","os/mac","prio/customer-support","area/panel/traceview"]},{"id":62414,"title":"query editor missing","body":"Yesterday I updated to 9.3.6 and now the query editor is missing:\r\n\r\n![grafik](https://user-images.githubusercontent.com/81651521/215264283-9c4013a0-87d6-4e50-aa89-0d4c8a3650a0.png)\r\n\r\nany idea how to get it back ?\r\n\r\n\r\n","labels":["type/bug","datasource/InfluxDB","area/query-editor"]},{"id":44204,"title":"Table Panel: Numeric columns are sorted alphabetically","body":"**What happened**:\r\nNumeric field is sorted alphabetically\r\n\r\n**What you expected to happen**:\r\nNumeric fields using numeric sort\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nAdd Elasticsearch datasource.\r\nAdd Table panel\r\nSort numeric column by clicking on column header\r\n\r\n**Anything else we need to know?**:\r\nThis is an issue we saw before, but was fixed at a certain time. But it seems to be back with the latest Grafana versions (8.3.2 \u0026 8.3.4)\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.4\r\n- Data source type \u0026 version: Elasticsearch 7.16.2\r\n- OS Grafana is installed on: Official Docker Image\r\n- User OS \u0026 Browser: Firefox 96.0.1\r\n\r\n![sort-order](https://user-images.githubusercontent.com/29406536/150118615-5a5fbec9-eb88-452a-a79d-31e55f4af5a9.gif)\r\n\r\n","labels":["needs more info","datasource/Elasticsearch","area/panel/table"]},{"id":65408,"title":"Time series: tooltip not visible while other panels are loading","body":"**What happened**:\r\nUsing \"Time series\" visualization with tooltip enabled, the tooltip does not display while other panels are loading.  In other words, the panel with tooltip may have all its series loaded and displayed, but display of tooltip is deferred until other panels on the dashboard are done loading (many seconds depending on number of preceding panels and query demands).\r\n\r\nupdate:  the bug is only seen when the dashboard has a mix of \"Time series\" and \"Graph (old)\" components\r\n\r\nhttps://user-images.githubusercontent.com/1708631/228134082-1c25d89d-e36c-46b6-b5c1-9393b935077e.mov\r\n\r\n**What you expected to happen**:\r\nThe tooltip should be available whenever the panel's series are displayed.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. create dashboard with panel using \"Time series\" viz with a lightweight query and tooltip enabled.  Additionally, create some panels using \"Graph (old)\" with a heavy query.\r\n2. load the dashboard.  Observe that the \"Time series\" panel with light query displays the time series quickly, but tooltip display is deferred until the \"Graph (old)\" panels are done loading.\r\n\r\n**Anything else we need to know?**:\r\nNotably, this problem does not exist for \"Graph (old)\" visualization.\r\n\r\nThis bug is probably as old as the new Time series, and at least present since Grafana 7.x.\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.7\r\n- Data source type \u0026 version: Prometheus\r\n","labels":["area/panel/timeseries","area/tooltip"]},{"id":51222,"title":"Stacked 100% with zero values breaks chart","body":"**What happened**:\r\nI'm building graphs to visualise events and status changes from lot of logs. I tried both Grafana and Kibana in parallel to valuate best options for us (prefer Grafana myself though). When I tried stacked 100% for a log showing alert levels for memory availability (green, yellow, red status) for VMware, the graphs suddenly vanished when selecting a longer period. Have the same setup for CPU alerts, which worked (no zero values though). Although, hoovering the chart still showed the values them self in the tool tip. The logs them self are pulled from the ELK stack. The same setup works in Kibana. When I did some research I found out that the issue seems to be that if no status changes is made (have interval om 1d for better view), all three values (Normal, Medium, High) are zero. That broke the graph, it works if one of the values are at least 1.\r\n\r\n![Skärmbild 2022-06-22 081345](https://user-images.githubusercontent.com/22789493/174957961-1b248b87-c421-4cf5-b5ba-a96359a1d332.png)\r\nHow it looks in Kibana.\r\n\r\n![Skärmbild 2022-06-22 081418](https://user-images.githubusercontent.com/22789493/174957984-6542e1c8-6dc8-4a2f-8098-22cca2069379.png)\r\nHaving set the time to now-30d, now-31d brakes it.\r\n\r\n![Skärmbild 2022-06-22 081517](https://user-images.githubusercontent.com/22789493/174957992-008f3b0a-4292-40c6-8296-ee1e0d6d6ca4.png)\r\nSame data but with just stacked.\r\n\r\n![Skärmbild 2022-06-22 081535](https://user-images.githubusercontent.com/22789493/174958000-3207b0a6-166a-4fc7-a228-43efabf81130.png)\r\nLonger period than now-30d. The values are still shown in the tool tip.\r\n\r\n\r\n**What you expected to happen**:\r\nChart should be shown anyway, just with all lines set to zero like in Kibana.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate couple of data series with values for stacked visualisation, and have data set to zero for the same timer period. When selecting stacked 100% the graph will be gone.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: v8.5.5\r\n- Data source type \u0026 version: ELK v7.17.4\r\n- OS Grafana is installed on: Unkown (but probably some Linux flavour in VMware).\r\n- User OS \u0026 Browser: Windows 10 / MS Edge\r\n- Grafana plugins: N/A\r\n- Others:\r\n","labels":["needs more info","area/panel/timeseries"]},{"id":67466,"title":"Can't load alerting rules if datasource different from `prometheus` or `loki`","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n## What happened:\r\nWe are developing our data sources and have a problem loading alerting rules from the data source. \r\nIf you click on alerting -\u003e alerting rules request from our data source implementation goes to `api/prometheus/grafana/api/v1/rules`, but if you choose `prometheus` or `loki` as data source, it sends the requests to the \r\n`api/prometheus/{datasource_id}/api/v1/rules`.\r\n## What you expected to happen:\r\nThe requests should send to the `api/prometheus/{datasource_id}/api/v1/rules` for different data sources and not just for `prometheus` or `loki`\r\n## How to reproduce it (as minimally and precisely as possible):\r\nYou can setup grafana with any other datasource except of the `prometheus` or ` loki` and check request which grafana sends to the API\r\n## Anything else we need to know?:\r\n\r\nFrom the code side, there is a constant defined that prevents make requests to different datasource: \r\n\r\n```typescript\r\nexport const RulesDataSourceTypes: string[] = [DataSourceType.Loki, DataSourceType.Prometheus];\r\n```\r\n\r\nThe chain of function calls goes like this:\r\n1. `fetchAllPromAndRulerRulesAction` https://github.com/grafana/grafana/blob/64ee42d01ef779647e04fc88aa46673db38773f3/public/app/features/alerting/unified/state/actions.ts#L362 \r\ngets data sources from the call of the `getAllRulesSourceNames`\r\nhttps://github.com/grafana/grafana/blob/64ee42d01ef779647e04fc88aa46673db38773f3/public/app/features/alerting/unified/state/actions.ts#L370\r\n\r\n2. `getAllRulesSourceNames` calls `getRulesDataSources`\r\nhttps://github.com/grafana/grafana/blob/329d94044891b6a7ec0df5cf9b3d84c0ccbb38fd/public/app/features/alerting/unified/utils/datasource.ts#L28\r\n\r\n3. `getRulesDataSource` has filter https://github.com/grafana/grafana/blob/329d94044891b6a7ec0df5cf9b3d84c0ccbb38fd/public/app/features/alerting/unified/utils/datasource.ts#L34 where only `prometheus` or `loki` can handle those requests, because \r\n```typescript\r\nexport const RulesDataSourceTypes: string[] = [DataSourceType.Loki, DataSourceType.Prometheus];\r\n```\r\n\r\n## Environment:\r\n- Grafana version: v9.4.3\r\n- Data source type \u0026 version: \r\n- OS Grafana is installed on: MacOS\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["needs more info","area/plugins","area/alerting","area/frontend"]},{"id":56771,"title":"Geomap: Heatmap not rendering after page refresh","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n * The Geomap in the Heatmap mode stopped working.\r\n * I slightly edited the Panel by changeing the name (just removing and adding the same character is enough)\r\n * The preview in the edit-panel page did not work\r\n * I press `Apply`\r\n * The Panel is working and displays the map and heatmap layer as expected\r\n * I save the dashboard and refresh the page\r\n * The panel is broken again (the change in the panel name persists)\r\n\r\nRepeating these steps makes the panel work until the next page refresh\r\n\r\n**What you expected to happen**:\r\nThe Geomap panel should display the map in the edit menu and should not break after a page refresh.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n * Inspecting the query and data behind the panel shows the expected data.\r\n * The Basemap layer is set to `Open Street Map` with opacity = 1\r\n * I raised the `Max data points` limit for that panel to `100000` because we are expecting many data points. But this problem also occurs with a limit of `1000`.\r\n *  The Panel Json from the working panel and the broken panel are identical\r\n\r\n**Environment**:\r\n- Grafana version: 9.1.7\r\n- Data source type \u0026 version: PostgreSQL 5.0.0\r\n- OS Grafana is installed on: Ubuntu 20.04.4 LTS\r\n- User OS \u0026 Browser: Ubuntu 20.04 - Firefox 105.0 (other browsers don't work as well)\r\n- Grafana plugins: -\r\n- Others: -\r\n\r\n**Screenshots**\r\nAfter i edited the panel name - before the page refresh\r\n![Screenshot 1](https://user-images.githubusercontent.com/100762533/195282982-cb5128d7-7308-42b1-940b-2982417dda47.png)\r\n\r\nAfter the page refresh:\r\n![Screenshot from 2022-10-12 09-50-51](https://user-images.githubusercontent.com/100762533/195283263-53b36f14-694c-47f3-9365-21c6ffcaa33f.png)\r\n","labels":["area/panel/geomap","triage/needs-confirmation"]},{"id":72766,"title":"no value alerts after update","body":"### What happened?\n\nwhen i update alert i get after a time this alert\r\n\r\n![Screenshot_5](https://github.com/grafana/grafana/assets/82488489/f5506ffd-b387-4e36-be8f-44d8b9b127c6)\r\n\r\n```\r\n**Resolved**\r\n\r\nValue: [no value]\r\nLabels:\r\n - alertname = API Server - Memory Usage by instance 10.19.70.13\r\n - cluster_name = kubernetes\r\n - endpoint = https\r\n - env = prod\r\n - grafana_folder = cloud-bi\r\n - instance = 10.19.70.13:6443\r\n - job = apiserver\r\n - namespace = default\r\n - prometheus = victoria-vm/vm-victoria-metrics-k8s-stack\r\n - service = kubernetes\r\nAnnotations:\r\n - Message = Слишком большое потребление оперативной памяти\r\n - grafana_state_reason = Updated\r\nSource: http://svc-grafana.cloud-bi.dfcloud.ru:3000/alerting/grafana/b1f6fff4-e1c9-46c7-b6a3-e25bf682a1c6/view?orgId=1\r\nSilence: http://svc-grafana.cloud-bi.dfcloud.ru:3000/alerting/silence/new?alertmanager=grafana\u0026matcher=alertname%3DAPI+Server+-+Memory+Usage+by+instance+10.19.70.13\u0026matcher=cluster_name%3Dkubernetes\u0026matcher=endpoint%3Dhttps\u0026matcher=env%3Dprod\u0026matcher=grafana_folder%3Dcloud-bi\u0026matcher=instance%3D10.19.70.13%3A6443\u0026matcher=job%3Dapiserver\u0026matcher=namespace%3Ddefault\u0026matcher=prometheus%3Dvictoria-vm%2Fvm-victoria-metrics-k8s-stack\u0026matcher=service%3Dkubernetes\u0026orgId=1\r\nDashboard: http://svc-grafana.cloud-bi.dfcloud.ru:3000/d/k8s_system_apisrv?orgId=1\r\nPanel: http://svc-grafana.cloud-bi.dfcloud.ru:3000/d/k8s_system_apisrv?orgId=1\u0026viewPanel=48\r\n```\n\n### What did you expect to happen?\n\ndont get no value alerts\n\n### Did this work before?\n\nno\n\n### How do we reproduce it?\n\n1. install grafana latest\r\n2. create alert in dashboard \r\n3. set alerting to telegram group\r\n\n\n### Is the bug inside a dashboard panel?\n\ni think no\n\n### Environment (with versions)?\n\nGrafana: latest\r\nOS: debian 11\r\nBrowser: google\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nvictoriametrics","labels":["type/bug","area/alerting","area/alerting/notifications","stale"]},{"id":50528,"title":"dashboards and alerts that share same elasticsearch datasource displays \"No Data\"","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWhen selecting datasource(that is being used by a functional dashboard) for alerting, we get \"No Data\" \r\n\r\n**What you expected to happen**:\r\nExpecting to see data immediately, and even after adding a query, still get no data. \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate elasticsearch datasource.\r\nCreate a dashboard using said datasource.\r\nCreate an alert using same datasource.  \r\n\r\n**Anything else we need to know?**:\r\nIf i create an exact copy of the datasource(besides the name), and use it, i get data and can carry on configuring the alert.  \r\n\r\n**Environment**:\r\n- Grafana version: 8.5.5\r\n- Data source type \u0026 version: Elasticsearch 5.0.0\r\n- OS Grafana is installed on: Unix Ubuntu\r\n- User OS \u0026 Browser: Unix Arch \u0026 Brave\r\n- Grafana plugins: n/a\r\n- Others: n/a\r\n","labels":["needs more info","datasource/Elasticsearch","area/alerting/evaluation"]},{"id":70865,"title":"Dashboards: Deep links do not carry over information about selected time range in a query","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n A user of the Azure Monitor plugin for Grafana reported this issue. It exists with deep links that link from a dashboard panel to an outside source, which in this case, is a panel with an azure monitor query linking out to the Azure Portal.\r\n\r\n![image](https://github.com/grafana/grafana/assets/77704161/78b825ea-45d9-4156-8c9c-64fd883bd3d5)\r\n\r\nSeen here is the \"View in Azure Portal\" link that is clicked, and the fact that a time frame has been set in the query as well in Grafana UI. When the link is clicked, the Azure Portal is opened with the correct query input correctly, yet it defaults to a 24 hour timeframe in all cases.\r\n\r\n![image](https://github.com/grafana/grafana/assets/77704161/15152b18-1224-48b5-9422-de6e1d5a1252)\r\n\r\n**What did you expect to happen**:\r\n\r\n  If possible, we would like to see the query time frame automatically set to the Grafana timeframe from the dashboard panel or the timeframe that is set in the query.\r\n\r\n![image](https://github.com/grafana/grafana/assets/77704161/98a468f1-6c8b-42c8-9db7-739e3c2b01b4)\r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Open Grafana and create a dashboard with a panel that uses a query with a set timeframe. \r\n\r\n**Step 2**:\r\n\r\n- Create a deep link from the dashboard that carries the query across and check to see if any information is about the timeframe is transferred over with the deep link.\r\n\n\n### \n# What Grafana version are you using?\n\n\nv9.4.12\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nNone\n\n### User's OS?\n\nWindows 11\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\nAzure Monitor\n\n### Anything else to add?\n\n\n_No response_","labels":["effort/small","area/dashboard","datasource/Azure","team/grafana-dashboards"]},{"id":56751,"title":"9.2.0: buggy behavior for time range selector on iOS","body":"**What happened**:\r\n\r\n- updated to Grafana 9.2.0\r\n- opened a dashboard on iOS 15.x (Safari)\r\n- selected time range picker while in regular (vertical) view\r\n- submenu pops up (patially out of frame to the left), window locks up\r\n\r\nAt this point I have to force-close the browser window.\r\nThe behaviour is repeatable.\r\n\r\n**What you expected to happen**:\r\n\r\nPropely opened time range popup menu.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nSee above\r\n\r\n**Anything else we need to know?**:\r\n\r\nIt worked fine with 9.1.x.\r\nThe lockup does not happen in horizontal view.\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.0\r\n- Data source type \u0026 version: Prometheus latest\r\n- OS Grafana is installed on: Linux\r\n- User OS \u0026 Browser: iOS 15\r\n- Grafana plugins: none\r\n- Others: none\r\n\r\nThanks for Grafana! :heart: \r\n","labels":["type/bug","type/ux","area/mobile-support","timepicker","triage/needs-confirmation"]},{"id":57656,"title":"Security: Grafana behind Azure Application Gateway","body":"**What happened**:\r\n\r\nWe are hosting Grafana, without any customizations, (on an AKS Cluster using [grafana helm charts](https://github.com/grafana/helm-charts)) behind an Azure Application Gateway, with Web Application Firewall(WAF) enabled and following the OWASP 3.1 rule set. However from the Firewall Logs, we see that Grafana application has multiple vulnerability entries which indicates that the application doesn't clearly follow the OWASP 3.1 rules. This result in blocked requests and unable to connect to the datasource without whitelisting each and every query going to the datasource.\r\nFollowing are the Firewall Rules/Vulnerabilities that are reported in the logs so far.\r\n\r\nRule ID | Description\r\n-- | --\r\n931130 | Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link\r\n932105 | Remote Command Execution: Unix Command Injection\r\n932110 | Remote Command Execution: Windows Command Injection\r\n932115 | Remote Command Execution: Windows Command Injection\r\n942410 | SQL Injection Attack\r\n942120 | SQL Injection Attack: SQL Operator Detected\r\n942130 | SQL Injection Attack: SQL Tautology Detected.\r\n942150 | SQL Injection Attack\r\n942180 | Detects basic SQL authentication bypass attempts 1/3\r\n942360 | Detects concatenated basic SQL injection and SQLLFI attempts\r\n942410 | SQL Injection Attack\r\n942430 | Restricted SQL Character Anomaly Detection (args): # of special characters exceed\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.1.6\r\n- Data source type \u0026 version: data explorer\r\n- OS Grafana is installed on:  Kubernetes / Linux\r\n- User OS \u0026 Browser: Chrome\r\n- Grafana plugins: Azure Data Explorer Datasource\r\n- Others:","labels":["needs more info","area/security","area/backend/security","area/backend","area/frontend"]},{"id":73608,"title":"Transformations: \"Partition by values\" drop-down options view identical for all partitions","body":"### What happened?\n\nWhen we try to use the \"Partition by value\" transformation on a tabular data, the generated partitions names (in the drop-down menu) are not the partitions actual names.\n\n### What did you expect to happen?\n\nPartitions names will be the name of the partition.\n\n### Did this work before?\n\nYes,\r\nI encountered this issue after upgrading Grafana from 9.3.2 to 10.0.3.\n\n### How do we reproduce it?\n\n1. Create a dashboard panel of some tabular data (in our simple reproduction example we used CSV File from TestData datasource).\r\n2. Add a \"Partition by value\" transformation and select some field to partition by (in our example \"State\" was selected).\r\n3. Have a look at the partitions drop-down menu 🥲\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.0.3\r\nOS: Ubuntu\r\nBrowser: Chrome 114\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\nTestData","labels":["type/bug","area/transformations"]},{"id":77124,"title":"Stats chart disappeared due to size of stat panel","body":"### What happened?\n\nSince updated to 10.2 this morning, the charts in the stats panel are not visible anymore. Resizing the stats panel bigger the charts become visible.\r\n\u003cimg width=\"1489\" alt=\"Screenshot 2023-10-25 at 12 28 39\" src=\"https://github.com/grafana/grafana/assets/122860105/f3b15050-91c0-4764-9fa9-2bf7e82b2cf5\"\u003e\r\n\u003cimg width=\"1298\" alt=\"Screenshot 2023-10-25 at 12 28 55\" src=\"https://github.com/grafana/grafana/assets/122860105/11df2c57-96fc-48e1-b2a1-0896901c5b13\"\u003e\r\n\n\n### What did you expect to happen?\n\nTo see the charity the stat panel\n\n### Did this work before?\n\nYes, in previous version this issue wasn't there \n\n### How do we reproduce it?\n\nResizing a stat panel\n\n### Is the bug inside a dashboard panel?\n\nYes\n\n### Environment (with versions)?\n\nGrafana: 10.2.0\r\nOS: Ubuntu \r\nBrowser: all\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\n_No response_","labels":["type/bug","area/panel/stat"]},{"id":48158,"title":"Adding a member to a team causes PostgreSQL error with grafana v8.4.4","body":"**What happened**:\r\n\r\nI can't add a member to a team. grafana server responds with 500 error.\r\n\r\n**What you expected to happen**:\r\n\r\nI want to add a member to a team.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nselect a team, and try to add a member there\r\n\r\n**Anything else we need to know?**:\r\n\r\nThe issue is reported in the community forum too.\r\n- https://community.grafana.com/t/psql-error-if-adding-user-to-a-team/63705\r\n\r\nHere is logs on grafana server.\r\n```\r\nlogger=context t=2022-04-21T10:03:42.88+0000 lvl=eror msg=\"Failed to add Member to Team\" error=\"failed setting permissions for user 4 in team 4: pq: could not determine data type of parameter $1\" remote_addr=\"221.241.190.170, 34.120.248.143\"\r\nlogger=context t=2022-04-21T10:03:42.88+0000 lvl=eror msg=\"Request Completed\" method=POST path=/api/teams/4/members status=500 remote_addr=\"221.241.190.170, 34.120.248.143\" time_ms=23 size=42 referer=https://grafana.groove-x.io/org/teams/edit/4\r\n```\r\n\r\nand PostgreSQL server.\r\n\r\n```\r\n2022-04-21 10:03:42.880 UTC [1468552]: [2-1] db=postgres,user=postgres STATEMENT:  \r\n\tSELECT\r\n\t\tp.*,\r\n\t\t$1 AS resource_id,\r\n\t\tur.user_id AS user_id,\r\n\t\tu.login AS user_login,\r\n\t\tu.email AS user_email,\r\n\t\ttr.team_id AS team_id,\r\n\t\tt.name AS team,\r\n\t\tt.email AS team_email,\r\n\t\tr.name as role_name\r\n\tFROM permission p\r\n\t\tLEFT JOIN role r ON p.role_id = r.id\r\n\t\tLEFT JOIN team_role tr ON r.id = tr.role_id\r\n\t\tLEFT JOIN team t ON tr.team_id = t.id\r\n\t\tLEFT JOIN user_role ur ON r.id = ur.role_id\r\n\t\tLEFT JOIN \"user\" u ON ur.user_id = u.id\r\n\tWHERE p.id = $2\r\n2022-04-21 10:03:42.880 UTC [1468552]: [1-1] db=postgres,user=postgres ERROR:  could not determine data type of parameter $1\r\n```\r\n\r\n**Environment**:\r\n- Grafana version: v8.4.4\r\n- OS Grafana is installed on: GKE. grafana helm chart 6.16.11\r\n- User OS \u0026 Browser: Ubuntu 20.04, Brave 1.37.114 (Chromium: 100.0.4896.88)\r\n- Grafana plugins: we use gmail login\r\n\r\n**Other**:\r\nIt may be a migration related issue","labels":["type/bug","area/backend/db/postgres"]},{"id":53368,"title":"Error: Document's frame is sandboxed and the 'allow-scripts' permission is not set while redirect to prometheus page from grafana dashboard","body":"**What you expected to happen**:\r\nFrom dashboard, we have options to open Prometheus, alertmanager and Logviewer like below\r\n![image](https://user-images.githubusercontent.com/50236001/183363918-541b79f3-901d-477b-a2bd-a2d040063e88.png)\r\n\r\nRespective link url will be like this **http://localhost:3000/api/datasources/proxy/4/graph** from grafana page , for Prometheus link it will redirect to Prometheus page.\r\n![image](https://user-images.githubusercontent.com/50236001/183364506-0c02ff01-f260-4713-b152-0a9ca10d3567.png)\r\n\r\nIt is working fine in **7.5.*** version and it showing some warning in console but it is redirect properly and everything looks fine.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n   You can try with 8.5.3 version with some sample dashboard json with Prometheus section\r\n   \r\n**What happened**:\r\nWhen we tried the same functionality in version 8.5.3, we were not able to view the page and getting error in browser like tis \"You need to enable JavaScript to run this app.\"\r\n\r\n**\"Document's frame is sandboxed and the 'allow-scripts' permission is not set\"**\r\nIn console , we can see few restriction and authorization error like below :-\r\n![image](https://user-images.githubusercontent.com/50236001/183365248-47726e5b-c0e1-4d26-a570-21d7e35f9569.png)\r\n\r\nWe understood, this respective api's is deprecated from 9.0 version but its not working in 8.5.* also and getting above error.\r\n\r\n**Anything else we need to know?**:\r\n   Is there any way to quick fix by update proxy or by browsers extensions?\r\n   \r\n**Environment**:\r\nGrafana - 8.5.3\r\nOS - Window \r\n\r\n","labels":["area/dashboard","datasource/Prometheus","area/datasource/proxy","triage/needs-confirmation"]},{"id":53900,"title":"Query Editor: Query name should have a range limit","body":"**What happened**:\r\nIn the Loki Query Dashboard, query name doesn't have a range limit. It accepting **_N_** number of characters and updated. Long name was accepted and place above the disable/remove/duplicate query button. User not able to view those buttons.\r\n\r\n**What you expected to happen**:\r\nIn the Loki Query Dashboard, query name should have a range limit. It should not accept _**N**_ number of characters.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nStep 1: Go to the Loki Query Dashboard\r\nStep 2: Change the query name with a long paragraph.\r\nStep 3: Click Enter \r\n\r\n**Anything else we need to know?**:\r\n![image](https://user-images.githubusercontent.com/37366893/185422384-daee1380-2066-4a80-9eaa-a57edc6989b4.png)\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.7\r\n- User OS \u0026 Browser: Windows 10 \u0026 Google Chrome","labels":["type/ux","help wanted","beginner friendly","datasource/Loki","area/query-editor"]},{"id":63778,"title":"Resolved message does not work","body":"**What happened**:\r\n\r\nIn short: When i add custom \"Summary and annotations\" and populate a field using golang template (for example: \"Alert. Present value: {{ $values.C0 }}\" ), the resolved message isn't sent to Telegram-chat\r\n\r\n**What you expected to happen**:\r\n\r\nI was expecting to get firing/resolved message with the text \"Present value 'value of metric'\"\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n1. Create Telegram chat, Telegram bot.\r\n2. Create and set up contact point with the type \"Telegram\"\r\n3. Add notification policies for this contact point\r\n4. Create a panel with any metric (I used node_filesystem_free_bytes)\r\n5. Create alert rule for this panel. \r\n - You should add new summary with text \"Present value: {{ $values.C0 }}\" C0 - is value of yours metric.\r\n![image](https://user-images.githubusercontent.com/77787762/221373304-3846831c-a6be-4183-aaea-21c2604499f9.png)\r\n![image](https://user-images.githubusercontent.com/77787762/221373366-f1e2eced-0059-48bd-8f35-9ef6d782bf6e.png)\r\n6. Make the alert state 'Normal'. Then take up disk space on the server whose metric you are using for the alert to fire. It can be RAM memory or something else.\r\n7. Wait for a message with a firing signal, and then free up disk space (or something else). And you won't get a resolved message, but alert state will be \"Normal\".\r\n\r\n**Anything else we need to know?**:\r\n\r\nI can get resolved message if i use structure if-else (golang templates). For example: {{ if $values.C0 }}{{ $values.C0 }}{{ else }}no value{{ end }} \r\n\r\n**Environment**:\r\n- Grafana version: Version 9.3.6\r\n- Data source type \u0026 version: node_exporter, version 1.5.0 \r\n- OS Grafana is installed on: ubuntu 22.04\r\n- User OS \u0026 Browser: google chrome\r\n- Grafana plugins: no plugins\r\n- Others: \r\n","labels":["area/alerting","area/alerting/notifications","triage/needs-confirmation"]},{"id":89226,"title":"Bar Gauge: Vertical scroll bar obscures value","body":"### What happened?\n\nThere is insufficient padding to fit the series value on a horizontal `Bar gauge` chart\r\n\r\n![image](https://github.com/grafana/grafana/assets/381302/54610208-05cf-4827-9b3f-395f52828451)\r\n\r\nSame exact issue as reported in https://github.com/grafana/grafana/issues/32083\n\n### What did you expect to happen?\n\nI expect to see the series value numbers without needing to scroll right.\n\n### Did this work before?\n\nNot sure\n\n### How do we reproduce it?\n\nCreate any `Bar Gauge` widget.\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 11\r\nOS: Windows\r\nBrowser: Chrome\r\n\n\n### Grafana platform?\n\nOther\n\n### Datasource(s)?\n\n_No response_","labels":["area/panel/bargauge","triage/needs-confirmation"]},{"id":60612,"title":"The Grafana Alerting panel monitors data frequently with error","body":"My Grafana Alerting panel monitor data is often err, my webhook is receiving a large number of error messages, please tell me how to solve?\r\n![企业微信截图_85e8103a-56b1-48e6-8eb5-dcc10ad16a69](https://user-images.githubusercontent.com/49858956/208812937-aeb4011f-57c6-4798-a8c8-d98214a7b472.png)\r\n![企业微信截图_3ca49ee7-41b9-4fc9-b04e-1df18d6422d7](https://user-images.githubusercontent.com/49858956/208812945-994075bd-c9b7-4570-a7e4-2679c8ff7e9e.png)\r\n![企业微信截图_20ffadb6-e8d3-4cb8-aadf-872952e36ef3](https://user-images.githubusercontent.com/49858956/208812957-8debec52-9f72-4d0a-893c-e2e2f9e1818c.png)\r\n\r\n","labels":["area/alerting","bot/no new info"]},{"id":66028,"title":"Using an expression under a query that uses variables fails to encode variables","body":"**What happened**:\r\nUsing a math expression under a Zabbix query that uses template variables sends the raw variable in the query.\r\n\r\n**What you expected to happen**:\r\nThe query should be decoded and sent in the query instead of the raw $variable\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate a panel that uses a template variable.\r\nAdd an expression to that query.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.3\r\n- Data source type \u0026 version: Zabbix 4.2.10\r\n- OS Grafana is installed on: Linux\r\n- User OS \u0026 Browser: Mac OS / Chrome\r\n- Grafana plugins: Time Series\r\n- Others:\r\n\r\nWorking with no expression added, you can see the variables are decoded in the query request properly when the url isn't ?expression=true\r\n\r\n\r\n![working_example](https://user-images.githubusercontent.com/34378914/230092683-0092e570-9d99-4fbe-8df9-9a101d828678.gif)\r\n\r\nNon-Working, variables not decoded when the expression is added, url ?expression=ture\r\n\r\n![non-working](https://user-images.githubusercontent.com/34378914/230093458-accab917-a8c4-41ea-97d6-0f05fb47fbb9.gif)\r\n","labels":["area/dashboard/templating","needs more info","needs investigation","team/grafana-dashboards"]},{"id":47155,"title":"Unified Alerting: nil dereference in AlertManager when creating silence as anonymous","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nAttempted to create silence with Unified Alerting. Received an internal server error. Stacktrace from the logs towards the end of the issue.\r\n\r\nBackground info: The grafana instance was running with `[auth.anonymous]` enabled, I was using the anonymous \"user\".\r\n\r\n**What you expected to happen**:\r\n\r\nSilence is created successfully.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n- Run Grafana with `[auth.anonymous] enabled=true` in `grafana.ini`\r\n  - Unified alerting should be enabled (should be the default now)\r\n- Create silence in the Alerting tab\r\n\r\n**Anything else we need to know?**:\r\n\r\n- Failing line: https://github.com/prometheus/alertmanager/blob/v0.23.0/api/v2/compat.go#L87\r\n- CreatedBy field seems to be coming from here (not 100% sure, feel free to verify): https://github.com/grafana/grafana/blob/release-8.4.4/public/app/features/alerting/unified/components/silences/SilencesEditor.tsx#L84\r\n  - grafanaBootData.user.name was verified to be empty in the Developer Tools console in Chromium\r\n- Stacktrace:\r\n\r\n```\r\nlogger=context t=2022-03-24T15:10:20.3+0000 lvl=eror msg=\"Request error\" error=\"runtime error: invalid memory address or nil pointer dereference\" stack=\"/usr/local/go/src/runtime/panic.go:221 (0x44df86)\r\n/usr/local/go/src/runtime/signal_unix.go:735 (0x44df56)\r\n/opt/drone/gomodcache/[github.com/prometheus/alertmanager@v0.23.1-0.20211116083607-e2a10119aaf7/api/v2/compat.go:87](http://github.com/prometheus/alertmanager@v0.23.1-0.20211116083607-e2a10119aaf7/api/v2/compat.go:87) (0x173b8a9)\r\n/drone/src/pkg/services/ngalert/notifier/silences.go:78 (0x174c267)\r\n/drone/src/pkg/services/ngalert/api/api_alertmanager.go:137 (0x1c57a03)\r\n/drone/src/pkg/services/ngalert/api/forked_am.go:57 (0x1c62942)\r\n/drone/src/pkg/services/ngalert/api/generated_base_api_alertmanager.go:57 (0x1c6353a)\r\n/usr/local/go/src/reflect/value.go:556 (0x4df704)\r\n/usr/local/go/src/reflect/value.go:339 (0x4dec84)\r\n/drone/src/pkg/web/inject.go:159 (0xe26486)\r\n/drone/src/pkg/web/inject.go:119 (0xe260d4)\r\n/drone/src/pkg/services/ngalert/metrics/ngalert.go:286 (0x172b0f6)\r\n/usr/local/go/src/reflect/value.go:556 (0x4df704)\r\n/usr/local/go/src/reflect/value.go:339 (0x4dec84)\r\n/drone/src/pkg/web/inject.go:159 (0xe26486)\r\n/drone/src/pkg/web/inject.go:119 (0xe260d4)\r\n/drone/src/pkg/web/context.go:67 (0xe2540b)\r\n/drone/src/pkg/web/context.go:62 (0xe2d39a)\r\n/drone/src/pkg/web/macaron.go:155 (0xe2d38c)\r\n/usr/local/go/src/net/http/server.go:2047 (0x6d2d4e)\r\n/drone/src/pkg/middleware/csp.go:22 (0x1720832)\r\n/usr/local/go/src/reflect/value.go:556 (0x4df704)\r\n/usr/local/go/src/reflect/value.go:339 (0x4dec84)\r\n/drone/src/pkg/web/inject.go:159 (0xe26486)\r\n/drone/src/pkg/web/inject.go:119 (0xe260d4)\r\n/drone/src/pkg/web/context.go:67 (0xe2540b)\r\n/drone/src/pkg/web/context.go:62 (0xe2d39a)\r\n/drone/src/pkg/web/macaron.go:155 (0xe2d38c)\r\n/usr/local/go/src/net/http/server.go:2047 (0x6d2d4e)\r\n/drone/src/pkg/web/render.go:44 (0xe28146)\r\n/usr/local/go/src/reflect/value.go:556 (0x4df704)\r\n/usr/local/go/src/reflect/value.go:339 (0x4dec84)\r\n/drone/src/pkg/web/inject.go:159 (0xe26486)\r\n/drone/src/pkg/web/inject.go:119 (0xe260d4)\r\n/drone/src/pkg/web/context.go:67 (0xe2540b)\r\n/drone/src/pkg/web/context.go:62 (0xe2d39a)\r\n/drone/src/pkg/web/macaron.go:155 (0xe2d38c)\r\n/usr/local/go/src/net/http/server.go:2047 (0x6d2d4e)\r\n/drone/src/pkg/middleware/csrf.go:21 (0x1720c4f)\r\n/usr/local/go/src/reflect/value.go:556 (0x4df704)\r\n/usr/local/go/src/reflect/value.go:339 (0x4dec84)\r\n/drone/src/pkg/web/inject.go:159 (0xe26486)\r\n/drone/src/pkg/web/inject.go:119 (0xe260d4)\r\n/drone/src/pkg/web/context.go:67 (0xe2540b)\r\n/drone/src/pkg/web/context.go:62 (0x1723b4a)\r\n/drone/src/pkg/middleware/recovery.go:168 (0x1723b41)\r\n/drone/src/pkg/web/context.go:32 (0xe252fb)\r\n/drone/src/pkg/web/inject.go:139 (0xe261f4)\r\n/drone/src/pkg/web/inject.go:117 (0xe2611c)\r\n/drone/src/pkg/web/context.go:67 (0xe2540b)\r\n/drone/src/pkg/web/context.go:62 (0x1721904)\r\n/drone/src/pkg/middleware/logger.go:33 (0x17218ed)\r\n/usr/local/go/src/reflect/value.go:556 (0x4df704)\r\n/usr/local/go/src/reflect/value.go:339 (0x4dec84)\r\n/drone/src/pkg/web/inject.go:159 (0xe26486)\r\n/drone/src/pkg/web/inject.go:119 (0xe260d4)\r\n/drone/src/pkg/web/context.go:67 (0xe2540b)\r\n/drone/src/pkg/web/context.go:62 (0x172482f)\r\n/drone/src/pkg/middleware/request_metrics.go:60 (0x172481e)\r\n/usr/local/go/src/reflect/value.go:556 (0x4df704)\r\n/usr/local/go/src/reflect/value.go:339 (0x4dec84)\r\n/drone/src/pkg/web/inject.go:159 (0xe26486)\r\n/drone/src/pkg/web/inject.go:119 (0xe260d4)\r\n/drone/src/pkg/web/context.go:67 (0xe2540b)\r\n/drone/src/pkg/web/context.go:62 (0x1725fb9)\r\n/drone/src/pkg/middleware/request_tracing.go:60 (0x1725fa8)\r\n/usr/local/go/src/reflect/value.go:556 (0x4df704)\r\n/usr/local/go/src/reflect/value.go:339 (0x4dec84)\r\n/drone/src/pkg/web/inject.go:159 (0xe26486)\r\n/drone/src/pkg/web/inject.go:119 (0xe260d4)\r\n/drone/src/pkg/web/context.go:67 (0xe2540b)\r\n/drone/src/pkg/web/router.go:156 (0xe299bd)\r\n/drone/src/pkg/web/router.go:223 (0xe2a651)\r\n/drone/src/pkg/web/macaron.go:189 (0xe27a90)\r\n/usr/local/go/src/net/http/server.go:2879 (0x6d62ba)\r\n/usr/local/go/src/net/http/server.go:1930 (0x6d1e27)\r\n/usr/local/go/src/runtime/asm_amd64.s:1581 (0x46bf00)\r\n```\r\n\r\n**Environment**:\r\n- Grafana version: grafana/grafana-oss:8.4.4 docker image\r\n- Data source type \u0026 version: N/A (Alerting doesn't have DataSources)\r\n- OS Grafana is installed on: Ubuntu 20.04\r\n- User OS \u0026 Browser: Ubuntu 20.04, Chromium (~up-to-date)\r\n- Grafana plugins: N/A\r\n\r\n","labels":["type/bug","needs more info","area/alerting"]},{"id":73645,"title":"Transformations (Organize Fields): Hiding a field named `Time` hides all time typed fields","body":"### What happened?\r\n\r\nIf you use the _Organize Fields_ transformation to hide a field named `time` or `Time`, all _time_ type fields get hidden.\r\n\r\nThe problem seems to come from the field matcher that is also used by other transformations. For instance if you use the _Filter by Name_ transformation, you cannot hide a time type field if an existing `Time` named field is checked to be visible.\r\n\r\nIn short, the field name matcher seems to match _time_ type fields if the included/excluded field name is `time` or `Time`.\r\n\r\n### What did you expect to happen?\r\n\r\nI expect only the field named `Time` to be hidden. The other time fields should remain visible.\r\n\r\n### Did this work before?\r\n\r\nYes, up to 9.5.8 it worked fine\r\n\r\n### How do we reproduce it?\r\n\r\n\r\n**For Organize Field**\r\n1. Create a view that has at least two time type fields, with one that is named `time`\r\n2. Use the _Organize Field_ transformation to hide the `time` named field\r\n3. Result: All time typed fields get hidden\r\n\r\n**For Filter By Name**\r\n1. Create a view that has at least two time type fields, with one that is named `time`\r\n2. Use the _Filter By Name_ transformation, uncheck the time type field that is NOT named `time`\r\n3. Result: All time fields are kept (since the checkmark on `time` field matches all the time typed fields)\r\n\r\nHint: I use the _Add field from calculation_ to add a second time typed field to the data test.\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nHere's a JSON dashboard model on which I created views to reproduce the issue.\r\n\r\n\u003csummary\u003e\r\n\r\n\u003cdetails\u003e\r\n\r\n```json\r\n{\r\n  \"annotations\": {\r\n    \"list\": [\r\n      {\r\n        \"builtIn\": 1,\r\n        \"datasource\": {\r\n          \"type\": \"grafana\",\r\n          \"uid\": \"-- Grafana --\"\r\n        },\r\n        \"enable\": true,\r\n        \"hide\": true,\r\n        \"iconColor\": \"rgba(0, 211, 255, 1)\",\r\n        \"name\": \"Annotations \u0026 Alerts\",\r\n        \"type\": \"dashboard\"\r\n      }\r\n    ]\r\n  },\r\n  \"editable\": true,\r\n  \"fiscalYearStartMonth\": 0,\r\n  \"graphTooltip\": 0,\r\n  \"links\": [],\r\n  \"liveNow\": false,\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"description\": \"We have two time type fields\",\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"thresholds\"\r\n          },\r\n          \"custom\": {\r\n            \"align\": \"auto\",\r\n            \"cellOptions\": {\r\n              \"type\": \"auto\"\r\n            },\r\n            \"inspect\": false\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 8,\r\n        \"w\": 10,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 1,\r\n      \"options\": {\r\n        \"cellHeight\": \"sm\",\r\n        \"footer\": {\r\n          \"countRows\": false,\r\n          \"fields\": \"\",\r\n          \"reducer\": [\r\n            \"sum\"\r\n          ],\r\n          \"show\": false\r\n        },\r\n        \"showHeader\": true\r\n      },\r\n      \"pluginVersion\": \"10.0.3\",\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"randomWalk\",\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Original data, no hiding/filtering applied\",\r\n      \"transformations\": [\r\n        {\r\n          \"id\": \"calculateField\",\r\n          \"options\": {\r\n            \"alias\": \"Shifted Time\",\r\n            \"binary\": {\r\n              \"left\": \"time\",\r\n              \"reducer\": \"sum\",\r\n              \"right\": \"1000\"\r\n            },\r\n            \"mode\": \"binary\",\r\n            \"reduce\": {\r\n              \"reducer\": \"sum\"\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"id\": \"convertFieldType\",\r\n          \"options\": {\r\n            \"conversions\": [\r\n              {\r\n                \"destinationType\": \"time\",\r\n                \"targetField\": \"Shifted Time\"\r\n              }\r\n            ],\r\n            \"fields\": {}\r\n          }\r\n        },\r\n        {\r\n          \"id\": \"organize\",\r\n          \"options\": {\r\n            \"excludeByName\": {\r\n              \"time\": false\r\n            },\r\n            \"indexByName\": {},\r\n            \"renameByName\": {}\r\n          }\r\n        }\r\n      ],\r\n      \"type\": \"table\"\r\n    },\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"description\": \"As you can see the Shifted Time field also disapeared\",\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"thresholds\"\r\n          },\r\n          \"custom\": {\r\n            \"align\": \"auto\",\r\n            \"cellOptions\": {\r\n              \"type\": \"auto\"\r\n            },\r\n            \"inspect\": false\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 8,\r\n        \"w\": 8,\r\n        \"x\": 10,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"cellHeight\": \"sm\",\r\n        \"footer\": {\r\n          \"countRows\": false,\r\n          \"fields\": \"\",\r\n          \"reducer\": [\r\n            \"sum\"\r\n          ],\r\n          \"show\": false\r\n        },\r\n        \"showHeader\": true\r\n      },\r\n      \"pluginVersion\": \"10.0.3\",\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"randomWalk\",\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Hidding applied on the `Time` field only\",\r\n      \"transformations\": [\r\n        {\r\n          \"id\": \"calculateField\",\r\n          \"options\": {\r\n            \"alias\": \"Shifted Time\",\r\n            \"binary\": {\r\n              \"left\": \"time\",\r\n              \"reducer\": \"sum\",\r\n              \"right\": \"1000\"\r\n            },\r\n            \"mode\": \"binary\",\r\n            \"reduce\": {\r\n              \"reducer\": \"sum\"\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"id\": \"convertFieldType\",\r\n          \"options\": {\r\n            \"conversions\": [\r\n              {\r\n                \"destinationType\": \"time\",\r\n                \"targetField\": \"Shifted Time\"\r\n              }\r\n            ],\r\n            \"fields\": {}\r\n          }\r\n        },\r\n        {\r\n          \"id\": \"organize\",\r\n          \"options\": {\r\n            \"excludeByName\": {\r\n              \"time\": true\r\n            },\r\n            \"indexByName\": {},\r\n            \"renameByName\": {}\r\n          }\r\n        }\r\n      ],\r\n      \"type\": \"table\"\r\n    },\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"description\": \"Not working because all time fields are matched with the `time` name field\",\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"color\": {\r\n            \"mode\": \"thresholds\"\r\n          },\r\n          \"custom\": {\r\n            \"align\": \"auto\",\r\n            \"cellOptions\": {\r\n              \"type\": \"auto\"\r\n            },\r\n            \"inspect\": false\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 8,\r\n        \"w\": 10,\r\n        \"x\": 0,\r\n        \"y\": 8\r\n      },\r\n      \"id\": 3,\r\n      \"options\": {\r\n        \"cellHeight\": \"sm\",\r\n        \"footer\": {\r\n          \"countRows\": false,\r\n          \"fields\": \"\",\r\n          \"reducer\": [\r\n            \"sum\"\r\n          ],\r\n          \"show\": false\r\n        },\r\n        \"showHeader\": true\r\n      },\r\n      \"pluginVersion\": \"10.0.3\",\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"randomWalk\",\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"Trying to exclude \\\"Shifted time\\\" with FilterByName transform\",\r\n      \"transformations\": [\r\n        {\r\n          \"id\": \"calculateField\",\r\n          \"options\": {\r\n            \"alias\": \"Shifted Time\",\r\n            \"binary\": {\r\n              \"left\": \"time\",\r\n              \"reducer\": \"sum\",\r\n              \"right\": \"1000\"\r\n            },\r\n            \"mode\": \"binary\",\r\n            \"reduce\": {\r\n              \"reducer\": \"sum\"\r\n            }\r\n          }\r\n        },\r\n        {\r\n          \"id\": \"convertFieldType\",\r\n          \"options\": {\r\n            \"conversions\": [\r\n              {\r\n                \"destinationType\": \"time\",\r\n                \"targetField\": \"Shifted Time\"\r\n              }\r\n            ],\r\n            \"fields\": {}\r\n          }\r\n        },\r\n        {\r\n          \"id\": \"filterFieldsByName\",\r\n          \"options\": {\r\n            \"include\": {\r\n              \"names\": [\r\n                \"time\",\r\n                \"A-series\"\r\n              ]\r\n            }\r\n          }\r\n        }\r\n      ],\r\n      \"type\": \"table\"\r\n    }\r\n  ],\r\n  \"refresh\": \"\",\r\n  \"schemaVersion\": 38,\r\n  \"style\": \"dark\",\r\n  \"tags\": [],\r\n  \"templating\": {\r\n    \"list\": []\r\n  },\r\n  \"time\": {\r\n    \"from\": \"now-6h\",\r\n    \"to\": \"now\"\r\n  },\r\n  \"timepicker\": {},\r\n  \"timezone\": \"\",\r\n  \"title\": \"New dashboard\",\r\n  \"version\": 0,\r\n  \"weekStart\": \"\"\r\n}\r\n```\r\n\r\n\u003c/details\u003e\r\n\u003c/summary\u003e\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.0.3\r\nOS: Windows\r\nBrowser: Firefox\r\n\r\n\r\n### Grafana platform?\r\n\r\nKubernetes\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/transformations","triage/needs-confirmation"]},{"id":63709,"title":"${__user.name} variable doesn't work","body":"**What happened**:\r\nI'm trying to get tje user logged name using ${__user.name} but it doesn't work. I use a query type with mysql. So the variable's syntax is:\r\nSELECT  '${__user.name}'\r\n\r\n**What you expected to happen**:\r\nTo get the usar's name\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.6\r\n- Data source type \u0026 version: phpmyadmin 5.2.0\r\n- OS Grafana is installed on:  Windows\r\n- User OS \u0026 Browser: windows, chrome\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/dashboard/templating","needs more info","datasource/MySQL"]},{"id":53341,"title":"Alert stay's in \"firing/alerting\" state","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: I have set up alert rule where if the query value is above 0 then send alert. Alert is triggered, however the state of the alert stays in \"firing/alerting\" and will not go back to OK when whe query =0. \r\n\r\nAlert state will go back to the OK state only after editing the evaluation settings and saving the alert rule (without any changes)\r\n\r\n**What you expected to happen**: Alert state should be reset to OK state when there is no longer specification for alerting.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nSet up ElasticSearch Data source, and alert rule which will query, if some value is \u003e0 send alert to MS teams.\r\nEach time that value will be \u003e0 I would expect alert notification.\r\n**Anything else we need to know?**:\r\nWe want to upgread from Grafana v6.7.1 to 9.0.4 and this is blocking us. (in the version 6.7.1 is working as expected)\r\n**Environment**:\r\n- Grafana version: 9.0.4\r\n- Data source type \u0026 version: Elasticsearch v 8.3.2\r\n- OS Grafana is installed on: Red Hat Enterprise Linux release 8.6 (Ootpa\r\n- User OS \u0026 Browser: Windows 10, Google Chrome\r\n- Grafana plugins: NA\r\n- Others: \r\n","labels":["area/alerting","datasource/Elasticsearch","needs investigation"]},{"id":64761,"title":"InfluxDB Datasource Provisioning fails to fill in `database` in Grafana 9.4 when basicAuth is used???","body":"**What happened**:\r\n\r\nAutomatic provisioning of InfluxDB data source fails to properly fill in the `database` field under Grafana 9.4.3\r\n\r\n**What you expected to happen**: \r\n\r\nWorks in Grafana 9.3.8.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nI have the following file: `provisioning/datasources/influxdb.yaml`\r\n\r\n```\r\napiVersion: 1\r\n\r\ndatasources:\r\n  - name: InfluxDB\r\n    uid: datasource-influxdb\r\n    type: influxdb\r\n    access: proxy\r\n    url: ${VGS_INFLUXDB_URL}\r\n    basicAuth: true\r\n    basicAuthUser: ${VGS_INFLUXDB_USERNAME}\r\n    database: venus\r\n    secureJsonData:\r\n      basicAuthPassword: ${VGS_INFLUXDB_PASSWORD}\r\n```\r\n\r\nWhen I use that file in Grafana Docker Image 9.3.8, everything works as expected.\r\n\r\nWhen I upgrade to Grafana Docker Image 9.4.3, data source is provisioned, but `database` filed is ignored.\r\n\r\n**Anything else we need to know?**:\r\n\r\nNothing special, pretty standard docker setup. I think I may have discovered the bug after adding the `basicAuth`, `basicAuthUser`, and `basicAuthPassword` properties in InfluxDB provisioning file. I can not however confirm that. Looks like the bug is random.\r\n\r\nFull code to test it would be to clone:\r\n\r\n```\r\n$ git clone https://github.com/mman/venus-docker-grafana-images.git\r\n$ cd venus-docker-grafana-images\r\n$ git checkout venus-grafana-server-2.5\r\n$ docker compose -f docker-compose-playground.yaml up\r\n```\r\n\r\nAnd then connect to http://localhost:3000 and examine provisioned Grafana Datasources. Under 9.3.8 the InfluxDB datasource is provisioned correctly, under 9.4.3 it will lack the `database` field.\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.3\r\n- Data source type \u0026 version: InfluxDB\r\n- OS Grafana is installed on: Docker\r\n","labels":["datasource/InfluxDB","needs more info","area/provisioning","area/docker"]},{"id":53363,"title":"Variables - No way to go back to the variable list in dashboard settings. ","body":"\u003c!--\r\nPlease only use this template for submitting accessibility issues.\r\n\r\nThis is a new feature area for Grafana that we want to improve. We have long way to go\r\nto really improve accessibility and would like your help to know where to start.\r\n--\u003e\r\n\r\n**Steps to reproduce**: Open a dashboard. Go to Dashboard settings, click variables, click one variable. Now, try to go back to the variables list. There is no way to go back to the variables list. There is no back button inside the variable edit. If the user clicks the browser back button, user is taken back to thr General settings. If user clicks the arrow on the top left, user is taken back to the dashboard. \r\n\r\n**Actual Result**:\r\nThere is no way to go back to the variables list, without clicking into some other item on the settings, then clicking variables again. \r\n\r\nPlease consider adding a back button to go back from a variable edit screen to the variable list screen. \r\n\r\n**Relevant WCAG Criteria:** [#.#.# WCAG Criterion](link to https://www.w3.org/WAI/WCAG21/quickref/?versions=2.0)\r\n\r\n**Environment**: \r\n- Grafana version: 9.0.6\r\n- Data source type \u0026 version: InfluxDB 1.8\r\n- User OS \u0026 Browser: Windows. Firefox\r\n","labels":["type/bug","area/dashboard","area/navigation"]},{"id":44556,"title":"TypeError: Cannot read properties of undefined (reading 'LOG')","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**: I created a new dashboard with 2 variables 'process' and 'service'. I’m getting this error in Grafana, which prevents me from even modifying the query for the panel \r\n```\r\nTypeError: Cannot read properties of undefined (reading 'LOG')\r\n\r\n    at Lazy\r\n    at Suspense\r\n    at he\r\n```\r\n![image](https://user-images.githubusercontent.com/98545398/151407165-d85f6f5a-ce27-4780-b996-f07353087697.png)\r\n\r\nAfter some digging, I noticed that the error disappears and I can edit the query if either the name of the variable is changed to 'process2' or 'sub_process' OR if the 'process' variable is completely removed from the dashboard.\r\n\r\n**What you expected to happen**: Able to edit the query of the panel while keeping the 'process' variable\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: create a new dashboard with a varialbe named as 'process'\r\n\r\n**Anything else we need to know?**: \r\n\r\n**Environment**:\r\n- Grafana version: v8.3.1\r\n- Data source type \u0026 version: Prometheus 5.0.0\r\n- OS Grafana is installed on: \r\n- User OS \u0026 Browser: Unix \u0026 Google Chrome\r\n- Grafana plugins: Prometheus \r\n- Others:\r\n","labels":["needs more info","area/frontend","bot/no new info"]},{"id":85933,"title":"x-axis is truncated","body":"### What happened?\n\nThe x-axis should show hours 0 to 23 but it gets trucated at the current hour.\r\n\r\n![image](https://github.com/grafana/grafana/assets/12090617/4fa724ca-8521-4887-b847-a90b437e5112)\r\n\n\n### What did you expect to happen?\n\nThe x-axis should show hours 0 to 23 but it gets trucated at the current hour.\n\n### Did this work before?\n\nI'm sure I've seen it work once.\n\n### How do we reproduce it?\n\n1.\r\n2.\r\n3.\r\n\r\nPanel is attached.\n\n### Is the bug inside a dashboard panel?\n\n| Key | Value |\r\n|--|--|\r\n| Panel | timeseries @ 10.4.1 (d3ce857c0eb86f571ffa993a9cd8493b6f47b630) |\r\n| Grafana | 10.4.1 (d3ce857c0eb86f571ffa993a9cd8493b6f47b630) // Open Source |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"custom\": {\r\n            \"drawStyle\": \"line\",\r\n            \"lineInterpolation\": \"stepAfter\",\r\n            \"barAlignment\": 0,\r\n            \"lineWidth\": 2,\r\n            \"fillOpacity\": 0,\r\n            \"gradientMode\": \"none\",\r\n            \"spanNulls\": false,\r\n            \"insertNulls\": false,\r\n            \"showPoints\": \"auto\",\r\n            \"pointSize\": 5,\r\n            \"stacking\": {\r\n              \"mode\": \"none\",\r\n              \"group\": \"A\"\r\n            },\r\n            \"axisPlacement\": \"auto\",\r\n            \"axisLabel\": \"\",\r\n            \"axisColorMode\": \"text\",\r\n            \"axisBorderShow\": false,\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"axisCenteredZero\": false,\r\n            \"hideFrom\": {\r\n              \"tooltip\": false,\r\n              \"viz\": false,\r\n              \"legend\": false\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              },\r\n              {\r\n                \"color\": \"red\",\r\n                \"value\": 80\r\n              }\r\n            ]\r\n          }\r\n        },\r\n        \"overrides\": [\r\n          {\r\n            \"matcher\": {\r\n              \"id\": \"byName\",\r\n              \"options\": \"uq\"\r\n            },\r\n            \"properties\": [\r\n              {\r\n                \"id\": \"color\",\r\n                \"value\": {\r\n                  \"fixedColor\": \"light-blue\",\r\n                  \"mode\": \"fixed\"\r\n                }\r\n              },\r\n              {\r\n                \"id\": \"custom.fillBelowTo\",\r\n                \"value\": \"lq\"\r\n              }\r\n            ]\r\n          },\r\n          {\r\n            \"matcher\": {\r\n              \"id\": \"byName\",\r\n              \"options\": \"lq\"\r\n            },\r\n            \"properties\": [\r\n              {\r\n                \"id\": \"color\",\r\n                \"value\": {\r\n                  \"fixedColor\": \"light-blue\",\r\n                  \"mode\": \"fixed\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          {\r\n            \"matcher\": {\r\n              \"id\": \"byName\",\r\n              \"options\": \"generationv\"\r\n            },\r\n            \"properties\": [\r\n              {\r\n                \"id\": \"color\",\r\n                \"value\": {\r\n                  \"fixedColor\": \"light-blue\",\r\n                  \"mode\": \"fixed\"\r\n                }\r\n              }\r\n            ]\r\n          },\r\n          {\r\n            \"matcher\": {\r\n              \"id\": \"byName\",\r\n              \"options\": \"todayv\"\r\n            },\r\n            \"properties\": [\r\n              {\r\n                \"id\": \"color\",\r\n                \"value\": {\r\n                  \"fixedColor\": \"yellow\",\r\n                  \"mode\": \"fixed\"\r\n                }\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"hideTimeOverride\": true,\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"tooltip\": {\r\n          \"mode\": \"single\",\r\n          \"sort\": \"none\"\r\n        },\r\n        \"legend\": {\r\n          \"showLegend\": true,\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"calcs\": []\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"grafana\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"snapshot\",\r\n          \"snapshot\": [\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"meta\": {\r\n                  \"typeVersion\": [\r\n                    0,\r\n                    0\r\n                  ],\r\n                  \"executedQueryString\": \"import \\\"date\\\"\\r\\n\\r\\nmapToDay = (tables=\u003c-) =\u003e tables\\r\\n  |\u003e map(fn: (r) =\u003e ({r with\\r\\n    // We must override _start and _stop in case theyve been added by a previous |\u003erange.\\r\\n    _start : today(),\\r\\n    _stop: date.add(d: 1d, to: today()),\\r\\n    originalTime: r._time,\\r\\n\\t_time: date.add(d: duration(v: string(v: 60 * date.hour(t: r._time) + date.minute(t: r._time)) + \\\"m\\\"), to: today())\\r\\n\\t}))\\r\\n\\r\\ndata = from(bucket: \\\"solar\\\")\\r\\n  |\u003e range(start: -1mo, stop: date.add(d: 24h, to: today()))\\r\\n  |\u003e filter(fn: (r) =\u003e r[\\\"_measurement\\\"] == \\\"inverter\\\" and r[\\\"_field\\\"] == \\\"generation\\\")\\r\\n  |\u003e keep(columns: [\\\"_time\\\", \\\"_measurement\\\", \\\"_field\\\", \\\"_value\\\"])\\r\\n  |\u003e mapToDay()\\r\\n  |\u003esort(columns: [\\\"_time\\\"])\\r\\n\\r\\ndataToday = from(bucket: \\\"solar\\\")\\r\\n  |\u003e range(start: today(), stop: date.add(d: 24h, to: today()))\\r\\n  |\u003e filter(fn: (r) =\u003e r[\\\"_measurement\\\"] == \\\"inverter\\\" and r[\\\"_field\\\"] == \\\"generation\\\")\\r\\n  |\u003e aggregateWindow(every: 30m, fn: mean, createEmpty: false)\\r\\n  |\u003e map(fn: (r) =\u003e ({r with _field: \\\"today\\\"}))\\r\\n  |\u003esort(columns: [\\\"_time\\\"])\\r\\n  \\r\\ndMin = data |\u003e range(start: today(), stop: date.add(d: 1d, to: today()))\\r\\n|\u003e aggregateWindow(every: 30m, fn: (tables=\u003c-, column) =\u003e tables \\r\\n|\u003e quantile(q: 0.25, method: \\\"exact_selector\\\")) \\r\\n|\u003e map(fn: (r) =\u003e ({\\r\\n  _time: r._time,\\r\\n  _value: r._value,\\r\\n  _field: \\\"lq\\\"\\r\\n}))\\r\\n\\r\\nd = union( tables: [dataToday, data \\r\\n|\u003e range(start: today(), stop: date.add(d: 1d, to: today())) \\r\\n|\u003e aggregateWindow(every: 30m, fn: median) ])|\u003e map(fn: (r) =\u003e ({\\r\\n  _time: r._time,\\r\\n  _value: r._value,\\r\\n  _field: r._field + \\\"v\\\"\\r\\n}))\\r\\n\\r\\ndMax = data |\u003e range(start: today(), stop: date.add(d: 1d, to: today())) \\r\\n|\u003e aggregateWindow(every: 30m, fn: (tables=\u003c-, column) =\u003e tables \\r\\n|\u003e quantile(q: 0.75, method: \\\"exact_selector\\\")) \\r\\n|\u003e map(fn: (r) =\u003e ({\\r\\n  _time: r._time,\\r\\n  _value: r._value,\\r\\n  _field: \\\"uq\\\"\\r\\n}))\\r\\n\\r\\nunion(tables: [dMin, d, dMax]) |\u003e yield()\"\r\n                },\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"Time\",\r\n                    \"type\": \"time\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"time.Time\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"generationv\",\r\n                    \"type\": \"number\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"float64\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"labels\": {},\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    1712795400000,\r\n                    1712797200000,\r\n                    1712799000000,\r\n                    1712800800000,\r\n                    1712802600000,\r\n                    1712804400000,\r\n                    1712806200000,\r\n                    1712808000000,\r\n                    1712809800000,\r\n                    1712811600000,\r\n                    1712813400000,\r\n                    1712815200000,\r\n                    1712817000000,\r\n                    1712818800000,\r\n                    1712820600000,\r\n                    1712822400000,\r\n                    1712824200000,\r\n                    1712826000000,\r\n                    1712827800000,\r\n                    1712829600000,\r\n                    1712831400000,\r\n                    1712833200000,\r\n                    1712835000000,\r\n                    1712836800000,\r\n                    1712838600000,\r\n                    1712840400000,\r\n                    1712842200000,\r\n                    1712844000000,\r\n                    1712845800000,\r\n                    1712847600000,\r\n                    1712849400000,\r\n                    1712851200000,\r\n                    1712853000000,\r\n                    1712854800000,\r\n                    1712856600000,\r\n                    1712858400000,\r\n                    1712860200000,\r\n                    1712862000000,\r\n                    1712863800000,\r\n                    1712865600000,\r\n                    1712867400000,\r\n                    1712869200000,\r\n                    1712871000000,\r\n                    1712872800000,\r\n                    1712874600000,\r\n                    1712876400000,\r\n                    1712878200000,\r\n                    1712880000000\r\n                  ],\r\n                  [\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    12.5,\r\n                    32,\r\n                    88,\r\n                    314,\r\n                    461,\r\n                    557,\r\n                    796,\r\n                    986,\r\n                    1404,\r\n                    1551,\r\n                    1451,\r\n                    1464,\r\n                    1715,\r\n                    1491,\r\n                    1414,\r\n                    1416,\r\n                    1290,\r\n                    1111,\r\n                    995,\r\n                    756,\r\n                    602,\r\n                    443,\r\n                    314,\r\n                    196,\r\n                    82,\r\n                    35,\r\n                    20,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0\r\n                  ]\r\n                ]\r\n              }\r\n            },\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"Time\",\r\n                    \"type\": \"time\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"time.Time\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"lq\",\r\n                    \"type\": \"number\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"int64\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"labels\": {},\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    1712795400000,\r\n                    1712797200000,\r\n                    1712799000000,\r\n                    1712800800000,\r\n                    1712802600000,\r\n                    1712804400000,\r\n                    1712806200000,\r\n                    1712808000000,\r\n                    1712809800000,\r\n                    1712811600000,\r\n                    1712813400000,\r\n                    1712815200000,\r\n                    1712817000000,\r\n                    1712818800000,\r\n                    1712820600000,\r\n                    1712822400000,\r\n                    1712824200000,\r\n                    1712826000000,\r\n                    1712827800000,\r\n                    1712829600000,\r\n                    1712831400000,\r\n                    1712833200000,\r\n                    1712835000000,\r\n                    1712836800000,\r\n                    1712838600000,\r\n                    1712840400000,\r\n                    1712842200000,\r\n                    1712844000000,\r\n                    1712845800000,\r\n                    1712847600000,\r\n                    1712849400000,\r\n                    1712851200000,\r\n                    1712853000000,\r\n                    1712854800000,\r\n                    1712856600000,\r\n                    1712858400000,\r\n                    1712860200000,\r\n                    1712862000000,\r\n                    1712863800000,\r\n                    1712865600000,\r\n                    1712867400000,\r\n                    1712869200000,\r\n                    1712871000000,\r\n                    1712872800000,\r\n                    1712874600000,\r\n                    1712876400000,\r\n                    1712878200000,\r\n                    1712880000000\r\n                  ],\r\n                  [\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    15,\r\n                    40,\r\n                    94,\r\n                    175,\r\n                    321,\r\n                    432,\r\n                    506,\r\n                    549,\r\n                    640,\r\n                    879,\r\n                    867,\r\n                    875,\r\n                    838,\r\n                    761,\r\n                    826,\r\n                    806,\r\n                    855,\r\n                    693,\r\n                    456,\r\n                    330,\r\n                    295,\r\n                    205,\r\n                    102,\r\n                    44,\r\n                    28,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0\r\n                  ]\r\n                ]\r\n              }\r\n            },\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"Time\",\r\n                    \"type\": \"time\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"time.Time\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"todayv\",\r\n                    \"type\": \"number\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"float64\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"labels\": {},\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    1712795400000,\r\n                    1712797200000,\r\n                    1712799000000,\r\n                    1712800800000,\r\n                    1712802600000,\r\n                    1712804400000,\r\n                    1712806200000,\r\n                    1712808000000,\r\n                    1712809800000,\r\n                    1712811600000,\r\n                    1712813400000,\r\n                    1712815200000,\r\n                    1712817000000,\r\n                    1712818800000,\r\n                    1712820600000,\r\n                    1712822400000,\r\n                    1712824200000,\r\n                    1712826000000,\r\n                    1712827800000,\r\n                    1712829600000,\r\n                    1712831400000,\r\n                    1712833200000,\r\n                    1712835000000\r\n                  ],\r\n                  [\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    15.366666666666667,\r\n                    42.833333333333336,\r\n                    103.4,\r\n                    154.9,\r\n                    436.96666666666664,\r\n                    890.6,\r\n                    1736.2333333333333,\r\n                    1238.9666666666667,\r\n                    2300.766666666667,\r\n                    2199.4333333333334,\r\n                    4141.833333333333,\r\n                    5266,\r\n                    6163\r\n                  ]\r\n                ]\r\n              }\r\n            },\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"Time\",\r\n                    \"type\": \"time\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"time.Time\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"uq\",\r\n                    \"type\": \"number\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"int64\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"labels\": {},\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    1712795400000,\r\n                    1712797200000,\r\n                    1712799000000,\r\n                    1712800800000,\r\n                    1712802600000,\r\n                    1712804400000,\r\n                    1712806200000,\r\n                    1712808000000,\r\n                    1712809800000,\r\n                    1712811600000,\r\n                    1712813400000,\r\n                    1712815200000,\r\n                    1712817000000,\r\n                    1712818800000,\r\n                    1712820600000,\r\n                    1712822400000,\r\n                    1712824200000,\r\n                    1712826000000,\r\n                    1712827800000,\r\n                    1712829600000,\r\n                    1712831400000,\r\n                    1712833200000,\r\n                    1712835000000,\r\n                    1712836800000,\r\n                    1712838600000,\r\n                    1712840400000,\r\n                    1712842200000,\r\n                    1712844000000,\r\n                    1712845800000,\r\n                    1712847600000,\r\n                    1712849400000,\r\n                    1712851200000,\r\n                    1712853000000,\r\n                    1712854800000,\r\n                    1712856600000,\r\n                    1712858400000,\r\n                    1712860200000,\r\n                    1712862000000,\r\n                    1712863800000,\r\n                    1712865600000,\r\n                    1712867400000,\r\n                    1712869200000,\r\n                    1712871000000,\r\n                    1712872800000,\r\n                    1712874600000,\r\n                    1712876400000,\r\n                    1712878200000,\r\n                    1712880000000\r\n                  ],\r\n                  [\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    26,\r\n                    44,\r\n                    340,\r\n                    879,\r\n                    1397,\r\n                    1646,\r\n                    2535,\r\n                    2096,\r\n                    2383,\r\n                    2681,\r\n                    3277,\r\n                    3082,\r\n                    3336,\r\n                    3363,\r\n                    2546,\r\n                    3196,\r\n                    2635,\r\n                    1908,\r\n                    1324,\r\n                    1066,\r\n                    819,\r\n                    652,\r\n                    452,\r\n                    303,\r\n                    142,\r\n                    55,\r\n                    29,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0,\r\n                    0\r\n                  ]\r\n                ]\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      \"timeFrom\": \"now-0d/d\",\r\n      \"timeTo\": \"now-0d/d + 1d\",\r\n      \"title\": \"Reproduced with embedded data\",\r\n      \"type\": \"timeseries\"\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003etimeseries @ 10.4.1 (d3ce857c0eb86f571ffa993a9cd8493b6f47b630)\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003eA[influxdb]\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003e 4 frames, 8 fields, 167 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e10.4.1 (d3ce857c0eb86f571ffa993a9cd8493b6f47b630) // Open Source\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"title\": \"Original Panel JSON\",\r\n      \"type\": \"text\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 7\r\n      },\r\n      \"options\": {\r\n        \"content\": \"{\\n  \\\"datasource\\\": {\\n    \\\"type\\\": \\\"influxdb\\\",\\n    \\\"uid\\\": \\\"ddgt8stsji8sgb\\\"\\n  },\\n  \\\"fieldConfig\\\": {\\n    \\\"defaults\\\": {\\n      \\\"custom\\\": {\\n        \\\"drawStyle\\\": \\\"line\\\",\\n        \\\"lineInterpolation\\\": \\\"stepAfter\\\",\\n        \\\"barAlignment\\\": 0,\\n        \\\"lineWidth\\\": 2,\\n        \\\"fillOpacity\\\": 0,\\n        \\\"gradientMode\\\": \\\"none\\\",\\n        \\\"spanNulls\\\": false,\\n        \\\"insertNulls\\\": false,\\n        \\\"showPoints\\\": \\\"auto\\\",\\n        \\\"pointSize\\\": 5,\\n        \\\"stacking\\\": {\\n          \\\"mode\\\": \\\"none\\\",\\n          \\\"group\\\": \\\"A\\\"\\n        },\\n        \\\"axisPlacement\\\": \\\"auto\\\",\\n        \\\"axisLabel\\\": \\\"\\\",\\n        \\\"axisColorMode\\\": \\\"text\\\",\\n        \\\"axisBorderShow\\\": false,\\n        \\\"scaleDistribution\\\": {\\n          \\\"type\\\": \\\"linear\\\"\\n        },\\n        \\\"axisCenteredZero\\\": false,\\n        \\\"hideFrom\\\": {\\n          \\\"tooltip\\\": false,\\n          \\\"viz\\\": false,\\n          \\\"legend\\\": false\\n        },\\n        \\\"thresholdsStyle\\\": {\\n          \\\"mode\\\": \\\"off\\\"\\n        }\\n      },\\n      \\\"color\\\": {\\n        \\\"mode\\\": \\\"palette-classic\\\"\\n      },\\n      \\\"mappings\\\": [],\\n      \\\"thresholds\\\": {\\n        \\\"mode\\\": \\\"absolute\\\",\\n        \\\"steps\\\": [\\n          {\\n            \\\"color\\\": \\\"green\\\",\\n            \\\"value\\\": null\\n          },\\n          {\\n            \\\"color\\\": \\\"red\\\",\\n            \\\"value\\\": 80\\n          }\\n        ]\\n      }\\n    },\\n    \\\"overrides\\\": [\\n      {\\n        \\\"matcher\\\": {\\n          \\\"id\\\": \\\"byName\\\",\\n          \\\"options\\\": \\\"uq\\\"\\n        },\\n        \\\"properties\\\": [\\n          {\\n            \\\"id\\\": \\\"color\\\",\\n            \\\"value\\\": {\\n              \\\"fixedColor\\\": \\\"light-blue\\\",\\n              \\\"mode\\\": \\\"fixed\\\"\\n            }\\n          },\\n          {\\n            \\\"id\\\": \\\"custom.fillBelowTo\\\",\\n            \\\"value\\\": \\\"lq\\\"\\n          }\\n        ]\\n      },\\n      {\\n        \\\"matcher\\\": {\\n          \\\"id\\\": \\\"byName\\\",\\n          \\\"options\\\": \\\"lq\\\"\\n        },\\n        \\\"properties\\\": [\\n          {\\n            \\\"id\\\": \\\"color\\\",\\n            \\\"value\\\": {\\n              \\\"fixedColor\\\": \\\"light-blue\\\",\\n              \\\"mode\\\": \\\"fixed\\\"\\n            }\\n          }\\n        ]\\n      },\\n      {\\n        \\\"matcher\\\": {\\n          \\\"id\\\": \\\"byName\\\",\\n          \\\"options\\\": \\\"generationv\\\"\\n        },\\n        \\\"properties\\\": [\\n          {\\n            \\\"id\\\": \\\"color\\\",\\n            \\\"value\\\": {\\n              \\\"fixedColor\\\": \\\"light-blue\\\",\\n              \\\"mode\\\": \\\"fixed\\\"\\n            }\\n          }\\n        ]\\n      },\\n      {\\n        \\\"matcher\\\": {\\n          \\\"id\\\": \\\"byName\\\",\\n          \\\"options\\\": \\\"todayv\\\"\\n        },\\n        \\\"properties\\\": [\\n          {\\n            \\\"id\\\": \\\"color\\\",\\n            \\\"value\\\": {\\n              \\\"fixedColor\\\": \\\"yellow\\\",\\n              \\\"mode\\\": \\\"fixed\\\"\\n            }\\n          }\\n        ]\\n      }\\n    ]\\n  },\\n  \\\"gridPos\\\": {\\n    \\\"h\\\": 8,\\n    \\\"w\\\": 7,\\n    \\\"x\\\": 7,\\n    \\\"y\\\": 24\\n  },\\n  \\\"hideTimeOverride\\\": true,\\n  \\\"id\\\": 6,\\n  \\\"options\\\": {\\n    \\\"tooltip\\\": {\\n      \\\"mode\\\": \\\"single\\\",\\n      \\\"sort\\\": \\\"none\\\"\\n    },\\n    \\\"legend\\\": {\\n      \\\"showLegend\\\": true,\\n      \\\"displayMode\\\": \\\"list\\\",\\n      \\\"placement\\\": \\\"bottom\\\",\\n      \\\"calcs\\\": []\\n    }\\n  },\\n  \\\"targets\\\": [\\n    {\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"influxdb\\\",\\n        \\\"uid\\\": \\\"ddgt8stsji8sgb\\\"\\n      },\\n      \\\"query\\\": \\\"import \\\\\\\"date\\\\\\\"\\\\r\\\\n\\\\r\\\\nmapToDay = (tables=\u003c-) =\u003e tables\\\\r\\\\n  |\u003e map(fn: (r) =\u003e ({r with\\\\r\\\\n    // We must override _start and _stop in case theyve been added by a previous |\u003erange.\\\\r\\\\n    _start : today(),\\\\r\\\\n    _stop: date.add(d: 1d, to: today()),\\\\r\\\\n    originalTime: r._time,\\\\r\\\\n\\\\t_time: date.add(d: duration(v: string(v: 60 * date.hour(t: r._time) + date.minute(t: r._time)) + \\\\\\\"m\\\\\\\"), to: today())\\\\r\\\\n\\\\t}))\\\\r\\\\n\\\\r\\\\ndata = from(bucket: \\\\\\\"solar\\\\\\\")\\\\r\\\\n  |\u003e range(start: -1mo, stop: date.add(d: 24h, to: today()))\\\\r\\\\n  |\u003e filter(fn: (r) =\u003e r[\\\\\\\"_measurement\\\\\\\"] == \\\\\\\"inverter\\\\\\\" and r[\\\\\\\"_field\\\\\\\"] == \\\\\\\"generation\\\\\\\")\\\\r\\\\n  |\u003e keep(columns: [\\\\\\\"_time\\\\\\\", \\\\\\\"_measurement\\\\\\\", \\\\\\\"_field\\\\\\\", \\\\\\\"_value\\\\\\\"])\\\\r\\\\n  |\u003e mapToDay()\\\\r\\\\n  |\u003esort(columns: [\\\\\\\"_time\\\\\\\"])\\\\r\\\\n\\\\r\\\\ndataToday = from(bucket: \\\\\\\"solar\\\\\\\")\\\\r\\\\n  |\u003e range(start: today(), stop: date.add(d: 24h, to: today()))\\\\r\\\\n  |\u003e filter(fn: (r) =\u003e r[\\\\\\\"_measurement\\\\\\\"] == \\\\\\\"inverter\\\\\\\" and r[\\\\\\\"_field\\\\\\\"] == \\\\\\\"generation\\\\\\\")\\\\r\\\\n  |\u003e aggregateWindow(every: 30m, fn: mean, createEmpty: false)\\\\r\\\\n  |\u003e map(fn: (r) =\u003e ({r with _field: \\\\\\\"today\\\\\\\"}))\\\\r\\\\n  |\u003esort(columns: [\\\\\\\"_time\\\\\\\"])\\\\r\\\\n  \\\\r\\\\ndMin = data |\u003e range(start: today(), stop: date.add(d: 1d, to: today()))\\\\r\\\\n|\u003e aggregateWindow(every: 30m, fn: (tables=\u003c-, column) =\u003e tables \\\\r\\\\n|\u003e quantile(q: 0.25, method: \\\\\\\"exact_selector\\\\\\\")) \\\\r\\\\n|\u003e map(fn: (r) =\u003e ({\\\\r\\\\n  _time: r._time,\\\\r\\\\n  _value: r._value,\\\\r\\\\n  _field: \\\\\\\"lq\\\\\\\"\\\\r\\\\n}))\\\\r\\\\n\\\\r\\\\nd = union( tables: [dataToday, data \\\\r\\\\n|\u003e range(start: today(), stop: date.add(d: 1d, to: today())) \\\\r\\\\n|\u003e aggregateWindow(every: 30m, fn: median) ])|\u003e map(fn: (r) =\u003e ({\\\\r\\\\n  _time: r._time,\\\\r\\\\n  _value: r._value,\\\\r\\\\n  _field: r._field + \\\\\\\"v\\\\\\\"\\\\r\\\\n}))\\\\r\\\\n\\\\r\\\\ndMax = data |\u003e range(start: today(), stop: date.add(d: 1d, to: today())) \\\\r\\\\n|\u003e aggregateWindow(every: 30m, fn: (tables=\u003c-, column) =\u003e tables \\\\r\\\\n|\u003e quantile(q: 0.75, method: \\\\\\\"exact_selector\\\\\\\")) \\\\r\\\\n|\u003e map(fn: (r) =\u003e ({\\\\r\\\\n  _time: r._time,\\\\r\\\\n  _value: r._value,\\\\r\\\\n  _field: \\\\\\\"uq\\\\\\\"\\\\r\\\\n}))\\\\r\\\\n\\\\r\\\\nunion(tables: [dMin, d, dMax]) |\u003e yield()\\\",\\n      \\\"refId\\\": \\\"A\\\"\\n    }\\n  ],\\n  \\\"timeFrom\\\": \\\"now-0d/d\\\",\\n  \\\"timeTo\\\": \\\"now-0d/d + 1d\\\",\\n  \\\"title\\\": \\\"Generation by hour\\\",\\n  \\\"type\\\": \\\"timeseries\\\"\\n}\",\r\n        \"mode\": \"code\",\r\n        \"code\": {\r\n          \"language\": \"json\",\r\n          \"showLineNumbers\": true,\r\n          \"showMiniMap\": true\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: Generation by hour // 2024-04-11 12:02:03\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-timeseries\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"2024-04-09T11:02:03.750Z\",\r\n    \"to\": \"2024-04-12T22:59:59.999Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\n\n### Environment (with versions)?\n\nGrafana:\r\nOS:\r\nBrowser:\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\nInflixDB","labels":["area/panel/timeseries","triage/needs-confirmation"]},{"id":61654,"title":"Time Series inconsistent display between \"last 12 hours\" and \"last 24 hours\"","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nA timeserie chart does not display the expected content when switching from \"Last 12 hours\" to \"Last 24 hours\". Part of the serie is not displayed. \"Last 21 hours\" is ok but \"Last 22 hours\" fails, see screenshots below.\r\n\r\n**What you expected to happen**:\r\nI would expect the content of the \"Last 12 hours\" to be visible in the \"Last 24 hours\", scaled down by 2. Nothing in the query is filtering out part of the data.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nLast 12h:\r\n![image](https://user-images.githubusercontent.com/12449790/213117032-c945ed1a-2b84-437c-abe4-748ef9c53078.png)\r\n\r\nLast 20h:\r\n![image](https://user-images.githubusercontent.com/12449790/213117893-e249e77c-17b6-4618-9a38-67c1a28b414c.png)\r\n\r\nLast 21h:\r\n![image](https://user-images.githubusercontent.com/12449790/213118062-e5477521-97cc-457b-b216-c73c2e452ed4.png)\r\n\r\nLast 22h:\r\n![image](https://user-images.githubusercontent.com/12449790/213118029-1dbfcd10-6092-4051-818b-c00091bc9eb9.png)\r\n\r\nLast 24h:\r\n![image](https://user-images.githubusercontent.com/12449790/213117235-e7cb99e7-01e8-47f0-95d7-2ec802584fbd.png)\r\n\r\nData for \"last 24 h\" (is suspicious, missing samples from morning 18th, **could the issue be linked to InfluxDB plugin**?)\r\n![image](https://user-images.githubusercontent.com/12449790/213117758-31ffb07c-7b69-48c3-b0b2-c9e6e3fde091.png)\r\n\r\nData for last 12h (here I see the samples from morning 18th):\r\n![image](https://user-images.githubusercontent.com/12449790/213118350-bdc6309f-9627-4b14-a992-b19d9ded76d3.png)\r\n\r\nQuery:\r\nfrom(bucket: \"${CONST_BUCKET}\")\r\n  |\u003e range(start: v.timeRangeStart, stop: v.timeRangeStop)\r\n  |\u003e filter(fn: (r) =\u003e r[\"_measurement\"] == \"XXXXXXX\")\r\n  |\u003e filter(fn: (r) =\u003e r[\"_field\"] == \"value\")\r\n  |\u003e aggregateWindow(every: v.windowPeriod, fn: mean, createEmpty: false)\r\n  |\u003e yield(name: \"A\")\r\n\r\n`{\r\n  \"id\": 706,\r\n  \"gridPos\": {\r\n    \"h\": 4,\r\n    \"w\": 12,\r\n    \"x\": 12,\r\n    \"y\": 11\r\n  },\r\n  \"type\": \"timeseries\",\r\n  \"title\": \"XXXXXXXXXXXXX\",\r\n  \"transformations\": [\r\n    {\r\n      \"id\": \"concatenate\",\r\n      \"options\": {\r\n        \"frameNameLabel\": \"{E6516E3A-0F55-4A00-A938-C5B54ADB8F27}\",\r\n        \"frameNameMode\": \"label\"\r\n      }\r\n    }\r\n  ],\r\n  \"datasource\": {\r\n    \"type\": \"influxdb\",\r\n    \"uid\": \"${CONST_DATASOURCE}\"\r\n  },\r\n  \"pluginVersion\": \"9.1.4\",\r\n  \"description\": \"XXXXXXXXXXXXX\",\r\n  \"fieldConfig\": {\r\n    \"defaults\": {\r\n      \"custom\": {\r\n        \"drawStyle\": \"line\",\r\n        \"lineInterpolation\": \"smooth\",\r\n        \"barAlignment\": 0,\r\n        \"lineWidth\": 1,\r\n        \"fillOpacity\": 30,\r\n        \"gradientMode\": \"scheme\",\r\n        \"spanNulls\": true,\r\n        \"showPoints\": \"never\",\r\n        \"pointSize\": 5,\r\n        \"stacking\": {\r\n          \"mode\": \"none\",\r\n          \"group\": \"A\"\r\n        },\r\n        \"axisPlacement\": \"auto\",\r\n        \"axisLabel\": \"\",\r\n        \"axisColorMode\": \"text\",\r\n        \"scaleDistribution\": {\r\n          \"type\": \"linear\"\r\n        },\r\n        \"axisCenteredZero\": false,\r\n        \"hideFrom\": {\r\n          \"tooltip\": false,\r\n          \"viz\": false,\r\n          \"legend\": false\r\n        },\r\n        \"thresholdsStyle\": {\r\n          \"mode\": \"off\"\r\n        },\r\n        \"lineStyle\": {\r\n          \"fill\": \"solid\"\r\n        }\r\n      },\r\n      \"color\": {\r\n        \"mode\": \"thresholds\"\r\n      },\r\n      \"mappings\": [],\r\n      \"thresholds\": {\r\n        \"mode\": \"absolute\",\r\n        \"steps\": [\r\n          {\r\n            \"color\": \"green\",\r\n            \"value\": null\r\n          },\r\n          {\r\n            \"color\": \"#EAB839\",\r\n            \"value\": 600\r\n          },\r\n          {\r\n            \"color\": \"red\",\r\n            \"value\": 800\r\n          }\r\n        ]\r\n      },\r\n      \"unit\": \"none\"\r\n    },\r\n    \"overrides\": [\r\n      {\r\n        \"matcher\": {\r\n          \"id\": \"byType\",\r\n          \"options\": \"number\"\r\n        },\r\n        \"properties\": [\r\n          {\r\n            \"id\": \"displayName\",\r\n            \"value\": \"${RES_QueueSize}\"\r\n          }\r\n        ]\r\n      }\r\n    ]\r\n  },\r\n  \"options\": {\r\n    \"tooltip\": {\r\n      \"mode\": \"single\",\r\n      \"sort\": \"none\"\r\n    },\r\n    \"legend\": {\r\n      \"showLegend\": false,\r\n      \"displayMode\": \"list\",\r\n      \"placement\": \"bottom\",\r\n      \"calcs\": []\r\n    }\r\n  },\r\n  \"targets\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"influxdb\",\r\n        \"uid\": \"${CONST_DATASOURCE}\"\r\n      },\r\n      \"hide\": false,\r\n      \"query\": \"from(bucket: \\\"${CONST_BUCKET}\\\")\\r\\n  |\u003e range(start: v.timeRangeStart, stop: v.timeRangeStop)\\r\\n  |\u003e filter(fn: (r) =\u003e r[\\\"_measurement\\\"] == \\\"YYYYYYYYYYYYYYY\\\")\\r\\n  |\u003e filter(fn: (r) =\u003e r[\\\"_field\\\"] == \\\"value\\\")\\r\\n  |\u003e aggregateWindow(every: v.windowPeriod, fn: mean, createEmpty: false) |\u003e yield(name: \\\"A\\\")\",\r\n      \"queryType\": \"randomWalk\",\r\n      \"refId\": \"A\"\r\n    }\r\n  ]\r\n}`\r\n\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.2\r\n- Data source type \u0026 version: InfluxDB v2.5.1\r\n- OS Grafana is installed on: Windows\r\n- User OS \u0026 Browser: Chrome\r\n- Grafana plugins: None","labels":["datasource/InfluxDB","area/panel/timeseries"]},{"id":89617,"title":"Grafana: Webhook Failed Validation - upon sending message to Teams","body":"### What happened?\r\n\r\nWhen sending a mail to a Teams Chat, we get the message \"Failed to send alert.: send notification to Teams: webhook failed validation:\r\n\r\n![image](https://github.com/grafana/grafana/assets/4497972/2ea5f422-5018-46d3-bec7-d66ce0a0da1b)\r\n\r\nThe message is delivered fine in the Teams chat, however, Grafana insists that the message was not delivered due to this. In turn, it will try to resend the message at regular intervals\r\n\r\n### What did you expect to happen?\r\n\r\nSeeing the message was delivered correctly, there is probably an issue in the way the response codes are handled.\r\n\r\n### Did this work before?\r\n\r\nI hadn't tested this before, but it seems people have had this before:\r\nhttps://github.com/grafana/grafana/issues/60924\r\n\r\n### How do we reproduce it?\r\n\r\n1. Create a new webhook for a teams chat\r\n2. Create a new contact\r\n3. Send a test alert and observe\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 11.0.0, also happens on 11.1.0-180959\r\nOS: n/a -\u003e docker image \r\nBrowser: Any\r\n\r\n\r\n### Grafana platform?\r\n\r\nDocker\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["needs more info","area/alerting"]},{"id":64864,"title":"Evaluation of alert rules result not accurate","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWe configured an alert rule for monitoring success rate, but we have found several alert evaluation result not accurate\r\n #### Alert Query (PromQL)\r\n```\r\n(\r\n  sum (rate(dp_gateway_http_request_duration_seconds_count{environment_name=\"Production\", code !~\"5.*\", host=\"##TARGET GRAFANA NAME HERE##\"}[150s]) \u003e 0) by (host, region) \r\n  /\r\n  sum (rate(dp_gateway_http_request_duration_seconds_count{environment_name=\"Production\", type!~\"ExternalDependentApiRequest|DataSourcePluginApiRequest\", host=\"##TARGET GRAFANA NAME HERE##\"}[150s]) \u003e 0) by (host, region)\r\n)\r\n```\r\n ##### Alert Rule\r\n  . we evaluate every 15 mins and duration for 0 mins. \r\n  . Alert if avg() of query result in last 20 mins is below 0.99\r\n See figure below:\r\n![image](https://user-images.githubusercontent.com/106532917/220661795-4e15ddb7-d975-4221-8abd-0bc945541f12.png)\r\n##### False alerm time range:\r\n   . 2023-02-15 03:10:00 to 2023-02-15 03:31:40\r\n ##### Query Result table view for false alerm:\r\n   (3 requests actually happened during 2023-02-15 03:29:29 and 03:31:26, and all 3 requests successed):\r\n![image](https://user-images.githubusercontent.com/106532917/220663772-905ad1dd-4b83-436b-a5dd-806e9417ace0.png)\r\n![image](https://user-images.githubusercontent.com/106532917/220660283-ccb46e9e-8935-4457-9bce-db312a4a76ab.png)\r\n\r\n ##### False alert evaluation result:\r\n   0.9629\r\n\r\n**What you expected to happen**:\r\nBased on table view of query result for given time range, there were no null values and all of values were equal to 1, the avg() of query should be 1 rather than 0.9629, so alert should not be triggered.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.1.3.1\r\n- Data source type \u0026 version: promethues\r\n- OS Grafana is installed on: Linux\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["needs more info","area/alerting","triage/needs-confirmation"]},{"id":51506,"title":"Playlist prompting for Save the changes","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n![image](https://user-images.githubusercontent.com/108351798/176209022-17b2d9b1-8110-4125-8e2f-0e84e8897374.png)\r\n\r\n\r\n**What happened**: Created the playlist, on each change its prompting to save the changes.\r\n\r\n**What you expected to happen**: Next dashboard should be visible without prompting as its a playlist.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: create a playlist with multiple dashboards and run it as TV\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: Enterprose\r\n- Data source type \u0026 version: SQL Server\r\n- OS Grafana is installed on: Windows\r\n- User OS \u0026 Browser: Chrome\r\n- Grafana plugins: charts and state\r\n- Others:\r\n","labels":["type/bug","prio/high","area/playlist"]},{"id":57849,"title":"Labels on Time Series graph changes on auto-refresh","body":"Randomly on auto-refresh, the legend labels will change from 'Name' to '{name=\"Label Name\"}'. All series labels on the panel change. The graph used is a Time Series. When this happens, the gauge panel on the same dashboard does not change labels.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nI'm using an auto refreshing (1m) dashboard and most refreshes will have the correct label. Sometimes it's wrong. I don't see a correlation other than it happens on an auto-refresh cycle and after some undetermined amount of time it will change back.\r\n\r\n![image](https://user-images.githubusercontent.com/22228023/198738769-a12d5950-595f-46f6-acdd-8935b1192fcd.png)\r\n![image](https://user-images.githubusercontent.com/22228023/198738897-7edfd8fb-8e88-4769-be13-64f8b164b624.png)\r\n\r\n**Environment**:\r\n- Grafana version: v9.2.2 (78a3e64e4f)\r\n- Data source type \u0026 version: InfluxDB Cloud\r\n- OS Grafana is installed on: Debian\r\n- User OS \u0026 Browser: Win11/Edge\r\n","labels":["area/panel/common","bot/no new info"]},{"id":60283,"title":"NO DATA alert is not firing","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nNO DATA alert is not firing. Also when we click on preview or run queries, it shows below error in grafana.\r\n\r\n```\r\nTypeError: e.fields[0] is undefined\r\nni@http://13.234.207.176:3000/public/build/AlertingRuleForm.e842a62c48a9802c4c89.js:145:386 div de@http://13.234.207.176:3000/public/build/2754.c9252327f51106ea3a6d.js:2:92534 li@http://13.234.207.176:3000/public/build/AlertingRuleForm.e842a62c48a9802c4c89.js:252:158 div de@http://13.234.207.176:3000/public/build/2754.c9252327f51106ea3a6d.js:2:92534 fieldset d@http://13.234.207.176:3000/public/build/2352.d7c14cbd3dbda648a17f.js:1406:1760 div div o@http://13.234.207.176:3000/public/build/2352.d7c14cbd3dbda648a17f.js:6337:172 bo@http://13.234.207.176:3000/public/build/AlertingRuleForm.e842a62c48a9802c4c89.js:292:2635 div div div t@http://13.234.207.176:3000/public/build/2754.c9252327f51106ea3a6d.js:2:711589 p@http://13.234.207.176:3000/public/build/2352.d7c14cbd3dbda648a17f.js:424:3558 div form R@http://13.234.207.176:3000/public/build/2754.c9252327f51106ea3a6d.js:2:927681 Co@http://13.234.207.176:3000/public/build/AlertingRuleForm.e842a62c48a9802c4c89.js:292:5768 Ro@http://13.234.207.176:3000/public/build/AlertingRuleForm.e842a62c48a9802c4c89.js:313:67 div 37417/b.Contents@http://13.234.207.176:3000/public/build/2352.d7c14cbd3dbda648a17f.js:5801:2272 div div div t@http://13.234.207.176:3000/public/build/2754.c9252327f51106ea3a6d.js:2:711589 p@http://13.234.207.176:3000/public/build/2352.d7c14cbd3dbda648a17f.js:424:3558 div b@http://13.234.207.176:3000/public/build/2352.d7c14cbd3dbda648a17f.js:5801:1289 t@http://13.234.207.176:3000/public/build/9076.637f4fd32666ef6824c7.js:1:211 69419/Mo\u003c@http://13.234.207.176:3000/public/build/AlertingRuleForm.e842a62c48a9802c4c89.js:313:914 c@http://13.234.207.176:3000/public/build/2352.d7c14cbd3dbda648a17f.js:1207:301 u@http://13.234.207.176:3000/public/build/2352.d7c14cbd3dbda648a17f.js:1207:855 WithErrorBoundary Suspense c@http://13.234.207.176:3000/public/build/2352.d7c14cbd3dbda648a17f.js:1207:301 _c@http://13.234.207.176:3000/public/build/2352.d7c14cbd3dbda648a17f.js:8832:350 t@http://13.234.207.176:3000/public/build/2754.c9252327f51106ea3a6d.js:2:1060624 t@http://13.234.207.176:3000/public/build/2754.c9252327f51106ea3a6d.js:2:1062645 main Cd@http://13.234.207.176:3000/public/build/2352.d7c14cbd3dbda648a17f.js:8793:6823 t@http://13.234.207.176:3000/public/build/2754.c9252327f51106ea3a6d.js:2:1057242 div o@http://13.234.207.176:3000/public/build/2352.d7c14cbd3dbda648a17f.js:1996:4308 19175/t.KBarProvider@http://13.234.207.176:3000/public/build/2754.c9252327f51106ea3a6d.js:2:271053 l@http://13.234.207.176:3000/public/build/2352.d7c14cbd3dbda648a17f.js:6145:19549 c@http://13.234.207.176:3000/public/build/2352.d7c14cbd3dbda648a17f.js:1207:301 u@http://13.234.207.176:3000/public/build/2352.d7c14cbd3dbda648a17f.js:1207:855 l@http://13.234.207.176:3000/public/build/2754.c9252327f51106ea3a6d.js:2:1040274 bu@http://13.234.207.176:3000/public/build/2352.d7c14cbd3dbda648a17f.js:8845:115\r\n```\r\n\r\n**What you expected to happen**:\r\nAlerts should be sent without any errors. We should able to preview the alert in case of NO DATA.\r\nIn earlier version we haven't experienced this issue.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nUse below grafana docker images:\r\ngrafana/grafana:9.3.1-ubuntu\r\ngrafana/grafana:9.3.0-ubuntu\r\n\r\nConfigure alert which returns no data.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.1 and 9.3.0\r\n- Data source type \u0026 version: InfluxDb 2.0\r\n- OS Grafana is installed on: ubuntu 20.0\r\n- User OS \u0026 Browser: Windows - Forefox\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/bug","datasource/InfluxDB","area/alerting/evaluation","area/frontend"]},{"id":46680,"title":"Alerts broke on upgrade to 8.4.0+","body":"**What happened**:\r\nAlerts stopped working on 8.4.0+ with this very tiny error:\r\n`Execution Error: request handler error: plugin unavailable`\r\nTurned on debugging to get more information but none was given.\r\n\r\n**What you expected to happen**:\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nWe have slack + email notification channels set up, but other than that we just run very basic alerts.\r\n\r\n**Anything else we need to know?**:\r\nI have tested and the issue occurs when I upgrade to 8.4.0 and still exists in 8.4.3.\r\nWorkaround is downgrade to 8.3.7 where it works.\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.0+\r\n- Data source type \u0026 version: Prometheus\r\n- OS Grafana is installed on: Linux + docker\r\n- User OS \u0026 Browser: \r\n- Grafana plugins:\r\n- Others:\r\n","labels":["needs more info","area/alerting"]},{"id":67764,"title":"Password isn't load into Grafana datasources when using curl command","body":"### \n# What went wrong?\n\n\n**What happened**:\r\nI'm using Grafana v7.5.15 on an EC2 on AWS.\r\nI have data sources for Cloudera manager in a json file as following:\r\n{\r\n    \"name\": \"ClouderaManager\",\r\n    \"type\": \"foursquare-clouderamanager-datasource\",\r\n    \"access\": \"proxy\",\r\n    \"url\": \"https://\u003cHostIP\u003e:7183\",\r\n    \"user\": \"admin\",\r\n    \"secureJsonData\": {\r\n        \"password\": \"XXXXXXX\"\r\n    },\r\n    \"database\": \"\",\r\n    \"basicAuth\": true,\r\n    \"isDefault\": false,\r\n    \"jsonData\": {\r\n        \"cmAPIVersion\": \"v11+\",\r\n        \"keepCookies\": []\r\n    },\r\n    \"readOnly\": false\r\n}\r\n\r\nI load the datasources with following from ksh script with curl command as below:\r\ncurl -XPOST -H \"Content-Type: application/json\" -H \"Accept: application/json\" --data-binary \"$(cat \u003cCM JSON_FILE\u003e )\" ${GRAFANA_CONNECTION}/api/datasources 2\u003e/dev/null | ${JQ_TOOL} -r '.message'\r\n\r\nThe message from jq is \"Datasource added\"\r\nWhen I check in Grafana (http://\u003cGrafana IP\u003e:3000/api/datasources/384) I see password isnt load as u can see below:\r\n{\r\n\"id\": 384,\r\n\"uid\": \"n5cLXayVz\",\r\n\"orgId\": 2,\r\n\"name\": \"ClouderaManager\",\r\n\"type\": \"foursquare-clouderamanager-datasource\",\r\n\"typeLogoUrl\": \"\",\r\n\"access\": \"proxy\",\r\n\"url\": \"https://\u003cHostIP\u003e:7183/\",\r\n**\"password\": \"\",**\r\n\"user\": \"admin\",\r\n\"database\": \"\",\r\n\"basicAuth\": true,\r\n\"basicAuthUser\": \"\",\r\n\"basicAuthPassword\": \"\",\r\n\"withCredentials\": false,\r\n\"isDefault\": false,\r\n\"jsonData\": {\r\n\"cmAPIVersion\": \"v11+\",\r\n\"keepCookies\": []\r\n},\r\n\"secureJsonFields\": {\r\n\"password\": true\r\n},\r\n\"version\": 1,\r\n\"readOnly\": false\r\n}\r\n\r\n**What did you expect to happen**:\r\n\r\nPassword will populate in the data source.\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\nCreate json file with the data as above.\r\n\r\n**Step 2**:\r\nRun the curl command from a ksh script \r\n\r\n**Step 3**:\r\nCheck data source in the Grafana \n\n### \n# What Grafana version are you using?\n\n\nv7.5.15 \n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nNone\n\n### User's OS?\n\n_No response_\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n$ uname -s      \r\nLinux\r\n$ uname -r\r\n4.18.0-305.el8.x86_64\r\n$ uname -v\r\n#1 SMP Thu Apr 29 08:54:30 EDT 2021\r\n$ uname -m\r\nx86_64\r\n$ uname -p\r\nx86_64\r\n$ uname -i\r\nx86_64\r\n$ uname -o\r\nGNU/Linux\r\n$","labels":["needs more info","area/backend/api"]},{"id":86847,"title":"A11y: Screen reader is not narrating name of the options in ‘Select source’ dropdown.","body":"### What happened?\n\nScreen reader is just narrating as ‘select option x of x’ for the options.  \r\n\r\nhttps://github.com/grafana/grafana/assets/93735775/b689db0b-e8a0-43bf-bef8-cfe97728c990\r\n\r\n\n\n### What did you expect to happen?\n\nScreen reader should narrate name of the option along with position information, while navigating using up/down arrow keys. \n\n### Did this work before?\n\nNo\n\n### How do we reproduce it?\n\n1.Open the URL in edge browser [Grafana Play Home - Dashboards - Grafana](https://play.grafana.org/d/000000012/grafana-play-home?orgId=1). \r\n\r\n‘2.Grafana Play Home’ page will open. \r\n\r\n3.Navigate to ‘Dashboard’ link \u0026 select it. \r\n\r\n4.Navigate to any of the link present in table \u0026 activate it. \r\n\r\n5.Navigate to Menu (…) \u0026 activate it. \r\n\r\n6.Navigate to ‘Inspect’ \u0026 activate it. \r\n\r\n‘7.Inspect’ pane will open. \r\n\r\n8.Navigate to ‘JSON’ tab \u0026 select it. \r\n\r\n9.Navigate to ‘Select source’ dropdown \u0026 expand it using ‘Alt+Down arrow’. \r\n\r\n10.Navigate among the options with narrator using  up/down arrow keys. \r\n\r\n11.Observe the screen reader narration.\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: v11.1.0-69051 (9d44c8e8cf) \r\nOS: Version 24H2 (OS Build 26100.1) \r\nBrowser: Version 125.0.2506.0 (Official build) dev (64-bit) \r\n \n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["needs more info","area/frontend","area/grafana/ui","type/accessibility","effort/medium"]},{"id":84340,"title":"Dashboards: The share dialog for a dashboard is broken and always leads to the 'share dashboard' dialog","body":"### What happened?\n\nIf you want to share a dashboard the URL always contains the parameter to open the share dialog: `\u0026shareView=link`\n\n### What did you expect to happen?\n\nThe generated URL links to the dashboard, not the dialog\n\n### Did this work before?\n\nIt didn't stand out to me in the past but I can't tell for 100%\n\n### How do we reproduce it?\n\n1. Open a dashboard\r\n2. Click on share\r\n3. Inspect the generated URL and test it in another window\n\n### Is the bug inside a dashboard panel?\n\nAll dashboards.\n\n### Environment (with versions)?\n\nGrafana: v10.3.3 (252761264e)\r\nOS: MacOS 14.4\r\nBrowser: Firefox 123.0.1 (64 bit)\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\n_No response_","labels":["area/dashboard","triage/needs-confirmation"]},{"id":87071,"title":"Don't export current value of datasource type","body":"**What happened**:\r\n\r\nGrafana exports (`Export for sharing externally` feature) also current datasource:\r\n```\r\n...\r\n  \"templating\": {\r\n    \"list\": [\r\n      {\r\n        \"current\": {\r\n          \"selected\": false,\r\n          \"text\": \"my-cloudwatch-datasource\",\r\n          \"value\": \"my-cloudwatch-datasource\"\r\n        },\r\n        \"description\": null,\r\n        \"error\": null,\r\n        \"hide\": 0,\r\n        \"includeAll\": false,\r\n        \"label\": \"Datasource\",\r\n        \"multi\": false,\r\n        \"name\": \"datasource\",\r\n        \"options\": [],\r\n        \"query\": \"cloudwatch\",\r\n        \"queryValue\": \"hea\",\r\n        \"refresh\": 1,\r\n        \"regex\": \"\",\r\n        \"skipUrlSync\": false,\r\n        \"type\": \"datasource\"\r\n      },\r\n...\r\n```\r\n\r\n**What you expected to happen**:\r\n\r\nExported current datasource name very likely doesn't exist on another external Grafana instances + it exposes author's Grafana details (datasource name can have a sensitive name), so it should be omitted or parametrized:\r\n\r\n```\r\n...\r\n  \"templating\": {\r\n    \"list\": [\r\n      {\r\n        \"current\": {},\r\n        \"description\": null,\r\n        \"error\": null,\r\n        \"hide\": 0,\r\n        \"includeAll\": false,\r\n        \"label\": \"Datasource\",\r\n        \"multi\": false,\r\n        \"name\": \"datasource\",\r\n        \"options\": [],\r\n        \"query\": \"cloudwatch\",\r\n        \"queryValue\": \"hea\",\r\n        \"refresh\": 1,\r\n        \"regex\": \"\",\r\n        \"skipUrlSync\": false,\r\n        \"type\": \"datasource\"\r\n      },\r\n...\r\n```\r\n\r\n**Environment**:\r\n- Grafana version: 7.5.3\r\n- Data source type \u0026 version: NA\r\n- OS Grafana is installed on: NA\r\n- User OS \u0026 Browser: NA\r\n- Grafana plugins: NA\r\n- Others: NA\r\n\r\n_Originally posted by @jangaraj in https://github.com/grafana/grafana/discussions/38256_","labels":["area/dashboard","team/grafana-dashboards","team/grafana-sharing"]},{"id":80666,"title":"Dashbord import replace $DS_PROMETHEUS to hardcoded value when import via web ui but not when do it by code.","body":"### What happened?\r\n\r\nI use Grafana 9.1.5 provisioned by rancher-monitoring chart.\r\nThen I have a dashboard installed by chart by using gnetId: 11835 (redis).\r\nThen when I take the json of this dashboard and import it manually I notice odd bug.\r\nSo the dashbord has a reference to datasource by using variable: \"datasource\": \"${DS_PROMETHEUS}\"\r\nThen for the dashbord imported by gnetid all is fine and json looks like:\r\n![obraz](https://github.com/grafana/grafana/assets/128046745/2d3f9cfa-0a1b-4524-a82d-a14d4fec2a67)\r\nbut the same dashbord imported by web ui is change and has such form:\r\n![obraz](https://github.com/grafana/grafana/assets/128046745/09b94a07-eb51-4cd6-89b0-a4d8a49b8008)\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nDashboard import should work in the same way and not replace variable like ${DS_PROMETHEUS} to hardcoded datasource uid after import, so be optional.\r\n\r\n### Did this work before?\r\n\r\nYes in old days I believe.\r\n","labels":["area/dashboard","datasource/Prometheus","area/datasource","area/panel/data","triage/needs-confirmation","needs refinement","team/grafana-dashboards"]},{"id":64110,"title":"UI Freeze in Create Alertrule from this panel view","body":"**What happened**:\r\nAfter I clicked `Create alertrule from this panel` and try to change type of expression or remove an expression UI is getting freeze and I can't even close the browser tab.\r\nIt does not happen if I choose panel with other datasource (Tested on Google Cloud Monitoring) \r\n![image](https://user-images.githubusercontent.com/21225629/222681030-755d5909-05e3-40cc-ab4e-0b312c69cd18.png)\r\n\r\n\r\n**What you expected to happen**:\r\nChange or remove alert rule expression\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Open dashboard\r\n2. Go into Alert tab\r\n3. Clik 'Create alertrule from this panel'\r\n4. Get UI freeze\r\n\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.3\r\n- Data source type \u0026 version: Graphite 1.1.x\r\n- User OS \u0026 Browser: MacOS ventura 13.2.1, Chrome 110.0.5481.177\r\n\r\n","labels":["needs more info","area/alerting","area/frontend","area/datasource"]},{"id":69138,"title":"Stat panel Graph mode error","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\n![stat_panel_error](https://github.com/grafana/grafana/assets/2898361/e8a213db-ab81-488e-a477-ed5eedffcf35)\r\n\r\n\r\n**What did you expect to happen**:\r\n\r\nNormal rendering of Graph \r\n\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\n- Stat panel\r\n- Value only (no time field)\r\n- Graph mode: area\r\n- Unit: Percent 1-100\r\n\r\n**Step 2**:\r\n- Navigate to past date\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\ngrafana-10.1.0-118055pre\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n| Key | Value |\r\n|--|--|\r\n| Panel | stat @ 10.1.0-118674pre |\r\n| Grafana | 10.1.0-118674pre (fc858d982c) // Open Source |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              }\r\n            ]\r\n          },\r\n          \"color\": {\r\n            \"mode\": \"thresholds\"\r\n          },\r\n          \"unit\": \"percent\"\r\n        },\r\n        \"overrides\": []\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"reduceOptions\": {\r\n          \"values\": false,\r\n          \"calcs\": [\r\n            \"lastNotNull\"\r\n          ],\r\n          \"fields\": \"/^val$/\"\r\n        },\r\n        \"orientation\": \"auto\",\r\n        \"textMode\": \"value\",\r\n        \"colorMode\": \"value\",\r\n        \"graphMode\": \"area\",\r\n        \"justifyMode\": \"auto\",\r\n        \"text\": {}\r\n      },\r\n      \"pluginVersion\": \"10.1.0-118674pre\",\r\n      \"targets\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"grafana\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"snapshot\",\r\n          \"snapshot\": [\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"meta\": {\r\n                  \"typeVersion\": [\r\n                    0,\r\n                    0\r\n                  ],\r\n                  \"executedQueryString\": \"SELECT CuRatioExtract as val\\r\\n      --,IIF([CuRatioExtract]\u003c=85,'Yellow','White') as color\\r\\n  FROM ReplicationDB.RapidScada.vCnlDataPivotBoxRay\\r\\n  where cast([DateTime] AS DATE) between cast(Util.fConvertUnixToDateTime(1685296800000) as date) and cast(Util.fConvertUnixToDateTime(1685383199000) as date)\\r\\n  order by DATETIME\"\r\n                },\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"val\",\r\n                    \"type\": \"number\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"float64\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"config\": {}\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    93.99373457606472,\r\n                    93.95508265790696,\r\n                    93.6864904836435,\r\n                    93.45182454372743,\r\n                    92.48097153827304,\r\n                    93.0162484452704,\r\n                    93.38592208939318,\r\n                    93.64155133236935,\r\n                    93.63267033880973,\r\n                    93.62115044611652,\r\n                    93.62115044611652,\r\n                    93.77364259236754,\r\n                    94.02342325920526,\r\n                    94.18122343129527,\r\n                    94.42434682039763,\r\n                    94.68009538491523,\r\n                    94.9105577563688,\r\n                    94.35076358193446,\r\n                    94.35348597152729,\r\n                    93.83866886462789,\r\n                    93.97236748703315,\r\n                    94.09655851683289,\r\n                    94.3773286665914,\r\n                    94.40057931481964,\r\n                    94.22825782157595,\r\n                    94.41823717901637,\r\n                    94.66191572583429,\r\n                    94.48656195462478,\r\n                    93.98446858452158,\r\n                    94.26847554444842,\r\n                    93.55026833631484,\r\n                    93.30466135864377,\r\n                    93.21445251164918,\r\n                    93.09062064812892,\r\n                    93.19724291214098,\r\n                    92.95341498383404,\r\n                    93.01714957993335,\r\n                    93.7417618852757,\r\n                    93.88739127383514,\r\n                    93.53852841277899,\r\n                    93.09176763430375,\r\n                    92.9908088998489,\r\n                    92.99103545369887,\r\n                    92.95267552772658,\r\n                    93.43951524178672,\r\n                    93.81966173630983,\r\n                    93.32696794733954,\r\n                    93.27346292468941,\r\n                    93.44997042526381,\r\n                    93.33465905242787,\r\n                    93.17189452827314,\r\n                    93.64436764584876,\r\n                    93.54378293301755,\r\n                    93.78726571643297,\r\n                    93.9935444835284,\r\n                    93.88168938303727,\r\n                    93.76585516867749,\r\n                    93.82426638354167,\r\n                    93.59473724580293,\r\n                    92.64296321947776,\r\n                    92.63532534449625,\r\n                    93.14712660619908,\r\n                    93.5936075307797,\r\n                    93.41959386079581,\r\n                    93.24277045498658,\r\n                    93.00751174059076,\r\n                    93.22322145031052,\r\n                    92.98821652141892,\r\n                    93.00626057321413,\r\n                    93.5205279647326,\r\n                    93.97719051874547,\r\n                    93.95865517431554,\r\n                    93.72548236442016,\r\n                    93.6383442265795,\r\n                    94.1110035495321,\r\n                    93.92194970551938,\r\n                    93.55998408362865,\r\n                    93.21654863958257,\r\n                    92.7495155648388,\r\n                    92.26418210733462,\r\n                    91.96761444024148,\r\n                    92.2218622256967,\r\n                    92.72322923143146,\r\n                    92.72164108588188,\r\n                    92.67415044773796,\r\n                    92.97891175321166,\r\n                    93.33714321046531,\r\n                    92.96682532316193,\r\n                    92.71475336682661,\r\n                    93.19016333342981,\r\n                    93.54365759730692,\r\n                    93.92866727849152,\r\n                    93.37708742204482,\r\n                    92.80307585414413,\r\n                    92.80238072779512,\r\n                    91.8589687564984,\r\n                    91.9840001907578,\r\n                    92.2153425077038,\r\n                    92.15758110717104,\r\n                    91.96215997855928,\r\n                    92.40595335755302,\r\n                    92.71238107151419,\r\n                    92.49513920769084,\r\n                    92.419590847663,\r\n                    92.18996417780619,\r\n                    91.8583631429429,\r\n                    91.36724198989458,\r\n                    91.32512877901152,\r\n                    91.42310013352403,\r\n                    92.65322154200265,\r\n                    92.44437186836608,\r\n                    92.69717764721896,\r\n                    92.69717764721896,\r\n                    91.42278797156037,\r\n                    91.20363111202806,\r\n                    91.1955064957806,\r\n                    91.71548229844193,\r\n                    91.8643181025462,\r\n                    93.13991138609681,\r\n                    92.98326646225077,\r\n                    92.71487614541698,\r\n                    92.630971280127,\r\n                    92.28281866892274,\r\n                    92.18641130776463,\r\n                    92.35012051249525,\r\n                    91.3255359634657,\r\n                    91.15596201323191,\r\n                    91.68183350185373,\r\n                    91.70549638312922,\r\n                    91.56584522438182,\r\n                    91.3495549898504,\r\n                    91.26903006010033,\r\n                    91.53469173540236,\r\n                    91.66333191851956,\r\n                    91.66333191851956,\r\n                    91.34178755492987,\r\n                    91.61379547385553,\r\n                    91.90207925395902,\r\n                    91.11238368747044,\r\n                    91.11238368747044,\r\n                    91.2503700565202,\r\n                    90.47473491872654,\r\n                    90.4845869794317,\r\n                    91.00126068875026,\r\n                    91.13032820669348,\r\n                    90.28617892817546,\r\n                    89.86466004803191,\r\n                    89.54922292451776,\r\n                    89.55435938325287,\r\n                    90.42868210520857,\r\n                    89.13150926864844,\r\n                    87.80928735742556,\r\n                    88.14659462821301,\r\n                    90.34457993317562,\r\n                    92.66653864340772,\r\n                    92.66107311455833,\r\n                    92.24403469176283,\r\n                    92.15696404264129,\r\n                    92.43808463879184,\r\n                    92.5104279041603,\r\n                    91.95722488625853,\r\n                    92.35353679503648,\r\n                    92.35619691143185,\r\n                    92.35619691143185,\r\n                    91.9368059015445,\r\n                    91.517985599946,\r\n                    91.51730068817959,\r\n                    92.27980697679425,\r\n                    92.8895131983018,\r\n                    92.87775660223251,\r\n                    92.71640302219467,\r\n                    92.81044004054385,\r\n                    92.83077227897148,\r\n                    92.12249106736051,\r\n                    92.10908162975137,\r\n                    92.37831602477834,\r\n                    93.366001922898,\r\n                    94.0636032466855,\r\n                    94.38971242726602,\r\n                    94.74891713008311,\r\n                    94.63298405220264,\r\n                    94.38828805957519,\r\n                    94.32034807417787,\r\n                    94.25511730115774,\r\n                    94.02453739990048,\r\n                    94.1536601675248,\r\n                    94.26868713354698,\r\n                    93.82402414085044,\r\n                    93.59198036721051,\r\n                    93.81021509664727,\r\n                    93.07249100931169,\r\n                    93.29522670403836,\r\n                    93.24626335439032,\r\n                    92.79629012173464,\r\n                    92.5547540516095,\r\n                    93.51854815478667,\r\n                    93.21323308270676,\r\n                    93.9696155850403,\r\n                    94.60011622744486,\r\n                    93.6940511571487,\r\n                    93.70979219849228,\r\n                    93.72496234716506,\r\n                    93.94935283587178,\r\n                    93.98832111609184,\r\n                    94.02687450970468,\r\n                    94.03419108029102,\r\n                    93.93378315165415,\r\n                    93.83820091609128,\r\n                    93.8550266035497,\r\n                    94.29705738720708,\r\n                    93.82666094640264,\r\n                    94.29767847210661,\r\n                    94.71748746879749,\r\n                    94.83192646942264,\r\n                    94.89229709066723,\r\n                    94.38828130526153,\r\n                    93.93787758101658,\r\n                    93.73154287624673,\r\n                    94.1972572756239,\r\n                    94.37211531014431,\r\n                    93.92236792729254,\r\n                    93.7989212224593,\r\n                    94.26786305156004,\r\n                    94.23860004074128,\r\n                    94.21436868502614,\r\n                    94.44649664588198,\r\n                    94.49617518390889,\r\n                    94.26610535763082,\r\n                    93.77440911757915,\r\n                    93.49232227748148,\r\n                    93.73718235806321,\r\n                    93.96123329126542,\r\n                    94.19232062390525,\r\n                    94.19335313746883,\r\n                    94.31087670367256,\r\n                    94.24177237099128,\r\n                    93.66154724884179,\r\n                    93.09877331892282,\r\n                    93.1757763155414,\r\n                    93.43911235241403,\r\n                    93.41729801356468,\r\n                    92.88583646494752,\r\n                    93.02062128176696,\r\n                    93.15039348409759,\r\n                    93.24444960317277,\r\n                    93.46427693051393,\r\n                    93.58799743723561,\r\n                    93.50646805505576,\r\n                    93.0126550086523,\r\n                    92.56118549633908,\r\n                    92.69267309212482,\r\n                    92.86758432788298,\r\n                    93.18575122985087,\r\n                    93.51436274019679,\r\n                    93.58150170105468,\r\n                    93.06611823198652,\r\n                    93.28272178114409,\r\n                    93.78807922341674,\r\n                    93.73609141869876,\r\n                    92.72745815366191,\r\n                    92.96325760881334,\r\n                    92.95550723455275,\r\n                    92.71158281474669,\r\n                    92.7239712778766,\r\n                    92.73636921735239,\r\n                    92.78507222410477,\r\n                    92.96250063248866,\r\n                    93.13729301655867,\r\n                    93.6581012108737,\r\n                    94.1252214781068,\r\n                    94.17658479176761,\r\n                    93.71487659038799,\r\n                    93.67101775727403,\r\n                    93.5081909374474,\r\n                    93.52681012784731,\r\n                    93.88468723881942,\r\n                    94.11201857019722,\r\n                    94.18223184029728,\r\n                    95.07675879479793,\r\n                    94.37050370344096,\r\n                    93.33941259166384,\r\n                    93.70574598816141,\r\n                    94.26763139621013,\r\n                    94.49767792640816,\r\n                    94.52970825948694,\r\n                    94.75839475839477,\r\n                    94.75127716175814,\r\n                    94.05650912280491,\r\n                    94.07169648609639,\r\n                    94.76151180062716,\r\n                    94.84075151552179,\r\n                    94.91161948853667,\r\n                    94.46124981878185,\r\n                    93.98921301836747,\r\n                    94.23424427749512,\r\n                    94.47524435186669,\r\n                    94.47635563309494,\r\n                    94.69006100087239,\r\n                    94.88816352349171,\r\n                    94.44156517232443,\r\n                    94.30942869079325,\r\n                    94.3051126645923,\r\n                    94.28174046022927,\r\n                    94.14300182075775,\r\n                    94.02776265598068,\r\n                    94.02992023490789,\r\n                    94.02992023490789,\r\n                    94.00429594004298,\r\n                    94.00957612198913,\r\n                    93.913500771922,\r\n                    94.85100013607293,\r\n                    94.77599142076323,\r\n                    94.33993894924313,\r\n                    93.96932377645419,\r\n                    93.95429864889854,\r\n                    94.1969091069999,\r\n                    94.17908287064414,\r\n                    94.66566150549525,\r\n                    94.69438426976596,\r\n                    93.48568094520347,\r\n                    93.57232019972473,\r\n                    93.57166590227203,\r\n                    94.0495201998694,\r\n                    93.67801487990558,\r\n                    93.17034246493655,\r\n                    92.92118628127156,\r\n                    93.8758186468786,\r\n                    94.60608773892007,\r\n                    94.0424398030012,\r\n                    93.45744035850798,\r\n                    93.26486848572634,\r\n                    94.2313857221054,\r\n                    94.20904665231915,\r\n                    93.7176931977789,\r\n                    93.3577414480011,\r\n                    93.48293080217441,\r\n                    93.49140490115126,\r\n                    93.49950565029458,\r\n                    93.03287389358854,\r\n                    92.65474719368136,\r\n                    93.39430997384646,\r\n                    93.7529617341372,\r\n                    93.38885249550589,\r\n                    92.95756121861814,\r\n                    92.88456208425721,\r\n                    94.31237884242594,\r\n                    94.09752796907878,\r\n                    93.35707132524759,\r\n                    93.28394568191187,\r\n                    94.52493257460497,\r\n                    94.55485736528942,\r\n                    94.09924635087154,\r\n                    93.6156742670036,\r\n                    93.70688830815914,\r\n                    93.71226751570192,\r\n                    93.71226751570192,\r\n                    93.58332801316567,\r\n                    93.44412234110648,\r\n                    93.67282223465773,\r\n                    93.91702622923773,\r\n                    93.83024703293383,\r\n                    92.83547407586926,\r\n                    92.92954521257563,\r\n                    93.29392555808924,\r\n                    93.74568003363679,\r\n                    94.0672803573846,\r\n                    94.22143811462841,\r\n                    94.14573027154307,\r\n                    94.39044382902023,\r\n                    94.36034186249518,\r\n                    94.1148908256021,\r\n                    94.19425909244778,\r\n                    93.94267900072876,\r\n                    93.3416612226401,\r\n                    92.94390032543237,\r\n                    92.12649529737553,\r\n                    92.65052029031132,\r\n                    93.9217972547073,\r\n                    93.90472056429734,\r\n                    93.6562860438293,\r\n                    93.6562860438293,\r\n                    93.52992295411954,\r\n                    93.40260076819845,\r\n                    93.29147174153307,\r\n                    93.55039284228899,\r\n                    93.39653862182237,\r\n                    93.39653862182237,\r\n                    93.39653862182237,\r\n                    93.31867702833347,\r\n                    93.11502146706306,\r\n                    93.19306828287478,\r\n                    93.39529793927525,\r\n                    93.3959718126843,\r\n                    93.48591326906237,\r\n                    93.48382405852723,\r\n                    93.10023107115727,\r\n                    92.97432482409002,\r\n                    93.2017396221842,\r\n                    93.17712035410362,\r\n                    92.8164228250069,\r\n                    92.63940520446097,\r\n                    94.36274509803923,\r\n                    94.20373162159771,\r\n                    93.94836009249877,\r\n                    94.14647050506495,\r\n                    92.92019439574113,\r\n                    92.92019439574113,\r\n                    92.81887293488798,\r\n                    92.96724470134875,\r\n                    93.1836750483559,\r\n                    93.1475783913054,\r\n                    93.262017248422,\r\n                    93.74316130966882,\r\n                    94.11250621260092,\r\n                    94.15774448691147,\r\n                    93.42143258275985,\r\n                    93.38453715845532,\r\n                    92.89151626215725,\r\n                    92.39909403050692,\r\n                    92.27919091776418,\r\n                    92.3036576138459,\r\n                    92.45007551235845,\r\n                    93.63786643601692,\r\n                    93.62349799732979,\r\n                    93.15187509338115,\r\n                    93.24176908618365,\r\n                    92.7906146743573,\r\n                    92.39327764482361,\r\n                    92.44317498757982,\r\n                    93.13323237558599,\r\n                    93.12130034633587,\r\n                    92.89715397898689,\r\n                    93.02124664488272,\r\n                    92.79216067740931,\r\n                    92.82879217434589,\r\n                    93.32191065540913,\r\n                    93.76904361229897,\r\n                    93.70950166589688,\r\n                    92.35437220032856,\r\n                    92.26707888915247,\r\n                    92.71661948146642,\r\n                    92.77249600833007,\r\n                    92.8796098087658,\r\n                    92.96619189380108,\r\n                    92.95281410060812,\r\n                    92.95281410060812,\r\n                    92.91133787617487,\r\n                    94.05918408863756,\r\n                    94.01271274846177,\r\n                    93.84003727984197,\r\n                    93.73101585029782,\r\n                    93.75280894020847,\r\n                    91.89942927589195,\r\n                    91.79682898233108,\r\n                    91.33016375962991,\r\n                    90.88283828382838,\r\n                    90.66710605442823,\r\n                    90.4323408375696,\r\n                    90.18906557025149,\r\n                    89.95397894922272,\r\n                    89.97587256705062,\r\n                    89.73679353030076,\r\n                    89.6026876050933,\r\n                    88.6528702569097,\r\n                    88.59244528836464,\r\n                    88.50042060434701,\r\n                    88.38097398669088,\r\n                    87.81259901059981,\r\n                    87.06061702115974,\r\n                    87.0733631848194,\r\n                    88.57536511435657,\r\n                    88.51154201292705,\r\n                    88.20630064991552,\r\n                    88.11695644464353,\r\n                    88.25392729931056,\r\n                    89.47683262404075,\r\n                    89.52560000716787,\r\n                    89.81800881127245,\r\n                    90.08883445899632,\r\n                    90.72294275674905,\r\n                    91.37522211982264,\r\n                    91.43410690231187,\r\n                    91.44750986731194,\r\n                    91.42029479424045,\r\n                    91.6559084258542,\r\n                    91.6559084258542,\r\n                    91.89238126766978,\r\n                    92.11084712755599,\r\n                    92.09212601145902,\r\n                    92.57368884646122,\r\n                    92.51024963476281,\r\n                    92.75296821382143,\r\n                    92.6124577443147,\r\n                    93.08723179097942,\r\n                    93.16271083911298,\r\n                    93.65892948110937,\r\n                    93.65892948110937,\r\n                    93.62314317166852,\r\n                    93.49908646581027,\r\n                    93.30631459568185,\r\n                    93.48712920965035,\r\n                    93.7990969258366,\r\n                    93.48823073860267,\r\n                    93.11816143830634,\r\n                    92.94974941996612,\r\n                    93.96043995682287,\r\n                    93.71548685319695,\r\n                    93.19133949886572,\r\n                    93.28902749182511,\r\n                    93.36683604982035,\r\n                    93.46849212095754,\r\n                    93.57678725082461,\r\n                    93.57678725082461,\r\n                    93.23959880003638,\r\n                    92.97858501650533,\r\n                    92.4820147464154,\r\n                    92.46987059429259,\r\n                    92.69369231283939,\r\n                    92.4205466120344,\r\n                    92.14724087345654,\r\n                    92.28795219215219,\r\n                    92.69112918282494,\r\n                    92.99896411871083,\r\n                    92.76643709418384,\r\n                    92.72773580364472,\r\n                    93.22999348904152,\r\n                    93.62957266577028,\r\n                    93.6299270811202,\r\n                    93.36394247167091,\r\n                    93.36424290887864,\r\n                    93.09815136638908,\r\n                    93.09815136638908,\r\n                    93.3608321168167,\r\n                    93.72850072760143,\r\n                    93.88533662887541,\r\n                    93.62950357150854,\r\n                    93.62758875238728,\r\n                    93.35277788952811,\r\n                    93.19773035648205,\r\n                    92.91865159633755,\r\n                    92.89802541578389,\r\n                    92.89375157753035,\r\n                    92.88957897273134,\r\n                    92.967440064404,\r\n                    94.00926715256361,\r\n                    93.95716939711198,\r\n                    94.48195384038699,\r\n                    94.59171239273833,\r\n                    94.21162280086028,\r\n                    93.8244478892858,\r\n                    93.73763796149699,\r\n                    92.95189123735301,\r\n                    92.63376768503183,\r\n                    92.63376768503183,\r\n                    93.33771131787614,\r\n                    94.08123791102516,\r\n                    94.08123791102516,\r\n                    93.91206501354449,\r\n                    93.78241066298976,\r\n                    93.06598265985328,\r\n                    92.51512856424316,\r\n                    93.08419163928956,\r\n                    93.59806226401653,\r\n                    94.10790657165053,\r\n                    94.60562979970797,\r\n                    95.14625372620958,\r\n                    94.72697804626492,\r\n                    94.5620665898306,\r\n                    94.54642052966452,\r\n                    94.7697852666453,\r\n                    95.2098098247845\r\n                  ]\r\n                ]\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      \"title\": \"Reproduced with embedded data\",\r\n      \"transformations\": [\r\n        {\r\n          \"id\": \"configFromData\",\r\n          \"options\": {\r\n            \"configRefId\": \"A\",\r\n            \"mappings\": []\r\n          }\r\n        }\r\n      ],\r\n      \"type\": \"stat\"\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003estat @ 10.1.0-118674pre\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003eA[mssql]\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eTransform\u003c/th\u003e\\n      \u003ctd\u003econfigFromData\u003c/td\u003e\\n  \u003c/tr\u003e\\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003e 1 frames, 1 fields, 571 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e10.1.0-118674pre (fc858d982c) // Open Source\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"title\": \"Original Panel JSON\",\r\n      \"type\": \"text\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 7\r\n      },\r\n      \"options\": {\r\n        \"content\": \"{\\n  \\\"datasource\\\": {\\n    \\\"uid\\\": \\\"UvWXs3E4z\\\",\\n    \\\"type\\\": \\\"mssql\\\"\\n  },\\n  \\\"fieldConfig\\\": {\\n    \\\"defaults\\\": {\\n      \\\"mappings\\\": [],\\n      \\\"thresholds\\\": {\\n        \\\"mode\\\": \\\"absolute\\\",\\n        \\\"steps\\\": [\\n          {\\n            \\\"color\\\": \\\"green\\\",\\n            \\\"value\\\": null\\n          }\\n        ]\\n      },\\n      \\\"color\\\": {\\n        \\\"mode\\\": \\\"thresholds\\\"\\n      },\\n      \\\"unit\\\": \\\"percent\\\"\\n    },\\n    \\\"overrides\\\": []\\n  },\\n  \\\"gridPos\\\": {\\n    \\\"h\\\": 7,\\n    \\\"w\\\": 5,\\n    \\\"x\\\": 19,\\n    \\\"y\\\": 2.5\\n  },\\n  \\\"id\\\": 1,\\n  \\\"options\\\": {\\n    \\\"reduceOptions\\\": {\\n      \\\"values\\\": false,\\n      \\\"calcs\\\": [\\n        \\\"lastNotNull\\\"\\n      ],\\n      \\\"fields\\\": \\\"/^val$/\\\"\\n    },\\n    \\\"orientation\\\": \\\"auto\\\",\\n    \\\"textMode\\\": \\\"value\\\",\\n    \\\"colorMode\\\": \\\"value\\\",\\n    \\\"graphMode\\\": \\\"area\\\",\\n    \\\"justifyMode\\\": \\\"auto\\\",\\n    \\\"text\\\": {}\\n  },\\n  \\\"pluginVersion\\\": \\\"10.1.0-118674pre\\\",\\n  \\\"targets\\\": [\\n    {\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"mssql\\\",\\n        \\\"uid\\\": \\\"UvWXs3E4z\\\"\\n      },\\n      \\\"editorMode\\\": \\\"code\\\",\\n      \\\"format\\\": \\\"table\\\",\\n      \\\"rawQuery\\\": true,\\n      \\\"rawSql\\\": \\\"SELECT CuRatioExtract as val\\\\r\\\\n      --,IIF([CuRatioExtract]\u003c=85,'Yellow','White') as color\\\\r\\\\n  FROM ReplicationDB.RapidScada.vCnlDataPivotBoxRay\\\\r\\\\n  where cast([DateTime] AS DATE) between cast(Util.fConvertUnixToDateTime($__from) as date) and cast(Util.fConvertUnixToDateTime($__to) as date)\\\\r\\\\n  order by DATETIME\\\",\\n      \\\"refId\\\": \\\"A\\\",\\n      \\\"sql\\\": {\\n        \\\"columns\\\": [\\n          {\\n            \\\"parameters\\\": [],\\n            \\\"type\\\": \\\"function\\\"\\n          }\\n        ],\\n        \\\"groupBy\\\": [\\n          {\\n            \\\"property\\\": {\\n              \\\"type\\\": \\\"string\\\"\\n            },\\n            \\\"type\\\": \\\"groupBy\\\"\\n          }\\n        ],\\n        \\\"limit\\\": 50\\n      }\\n    }\\n  ],\\n  \\\"title\\\": \\\"Panel Title\\\",\\n  \\\"transformations\\\": [\\n    {\\n      \\\"id\\\": \\\"configFromData\\\",\\n      \\\"options\\\": {\\n        \\\"configRefId\\\": \\\"A\\\",\\n        \\\"mappings\\\": []\\n      }\\n    }\\n  ],\\n  \\\"type\\\": \\\"stat\\\"\\n}\",\r\n        \"mode\": \"code\",\r\n        \"code\": {\r\n          \"language\": \"json\",\r\n          \"showLineNumbers\": true,\r\n          \"showMiniMap\": true\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above (after transformations)\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      \"id\": 100,\r\n      \"title\": \"Data (before transformations)\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 24,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": false,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: Panel Title // 05/29/2023, 09:29:45 AM\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-stat\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"2023-05-28T18:00:00.000Z\",\r\n    \"to\": \"2023-05-29T17:59:59.000Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\r\n\r\n### Grafana Platform?\r\n\r\nNone\r\n\r\n### User's OS?\r\n\r\nWindows11\r\n\r\n### User's Browser?\r\n\r\nChrome 113\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\n_No response_\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["type/bug","area/panel/stat","triage/needs-confirmation"]},{"id":65872,"title":"Bar stacking breaks when a value gets positve and negative values ","body":"I have a panel with 3 values which should be stacked:\r\n- One is 100% of the time positive (green)\r\n- One is 100% of the time negative (yellow)\r\n- One can be both (red)\r\n\r\nAs long as a value is only positive or negative over the timespan, the stacking works fine.\r\nBut when a value has positive and negative values the stacking breaks.\r\nIn this case, one site completly disappears, only the numbers are still shown and the other site disables the stacking.\r\n\r\n- Grafana version: 9.3.6 and 9.4.7\r\n- Data source type \u0026 version: InfluxDB 1.8\r\n- OS Grafana is installed on: Ubuntu 22.04 with docker\r\n- User OS \u0026 Browser: Win11: Chrome, Firefox, Edge; Android: Chrome; IOS: Safari\r\n- Grafana plugins: none\r\n\r\nDay 03.04 is removed in the first picture, everything is fine.\r\nIn the second picture day 03.04 is enabled and the red value is -1.9 which leads to the problem.\r\n\r\n![1](https://user-images.githubusercontent.com/117187261/229593706-19ecefb7-4c4a-4899-86ae-89e727116de9.png)\r\n![2](https://user-images.githubusercontent.com/117187261/229593711-db4cb788-08f8-41d2-bb6c-110882ade64b.png)\r\n","labels":["type/bug","area/frontend","area/panel/timeseries","area/panel/barchart"]},{"id":65637,"title":"Data Source postgres database user name can't contain space","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:  \r\nGrafana shows plugin error when adding database and user with a space in user name\r\n\r\n**What you expected to happen**: \r\nData source would work\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: \r\nCreate postgres data source with user name containing a space\r\n\r\n**Anything else we need to know?**: \r\nLog shows that the first half of the user name is being cut off.\r\n\r\nPostgres user name being added: TEST USER\r\n\r\nlogger=tsdb.postgres t=2023-03-30T13:19:49.871393176Z level=error msg=\"Failed connecting to Postgres\" err=\"invalid option: \\\"USER'\\\"\"\r\nlogger=context userId=1 orgId=2 uname=admin t=2023-03-30T13:19:49.871518752Z level=error msg=\"Plugin health check failed\" error=\"failed to check plugin health: health check failed\" remote_addr=98.6.53.34 traceID=\r\n\r\nWhen I alter the user name in postgres to contain no spaces, it works without issue. Tested user in database manager with space and can connect to and browse database without issue. \r\n\r\n**Environment**:\r\n- Grafana version: 9.4.7\r\n- Data source type \u0026 version: Postgres 14\r\n- OS Grafana is installed on:  Ubuntu 22.04.2\r\n- User OS \u0026 Browser: WIndows Firefox\r\n- Grafana plugins: core only\r\n- Others:\r\n","labels":["datasource/Postgres","area/datasource"]},{"id":81692,"title":"GeoMap panel: Map is shown three times with Initial view (0,0) and zoom 1","body":"### What happened?\n\nGeoMap panel: Map is shown three times with Initial view (0,0) and zoom 1\r\nI'm using version Grafana v10.3.1 (00a22ff8b2)\r\n\r\n![image](https://github.com/grafana/grafana/assets/147585503/f8cf9049-7991-4647-b784-3c11b4733101)\r\n\n\n### What did you expect to happen?\n\nOnly shown once as in Grafana version 10.2.1\n\n### Did this work before?\n\nYes, worke fine/like expected\n\n### How do we reproduce it?\n\n1. Create panel with geomap and layer marker\r\n2.\r\n3.\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana:\r\nOS:\r\nBrowser:\r\n\n\n### Grafana platform?\n\nA downloaded binary\n\n### Datasource(s)?\n\n_No response_","labels":["area/panel/geomap"]},{"id":54742,"title":"Unable to get a unified alerting screenshot in Slack","body":"**What happened**:\r\nConfigured Grafana to create a screenshot for an alert via a Slack notification channel. I see however, no indication of this happening.\r\n\r\n**What you expected to happen**:\r\nThe Slack Alert, contains an image via an URL of my Grafana public http folder\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n- configure Grafana to use image renderer and confirm that it is working. In my case, I've confirmed this by creating a report\r\n- configure Grafana to make screenshots:\r\n\r\n```\r\ngrafana.ini:\r\n  external_image_storage:\r\n    provider: local\r\n  unified_alerting:\r\n    enabled: true\r\n    screenshots:\r\n      capture: true\r\n      max_concurrent_screenshots: 10\r\n      upload_external_image_storage: true\r\n  paths:\r\n    data: /tmp-grafana-data\r\n    temp_data_lifetime: 12h\r\n```\r\n\r\n- create an alert via a panel (which is a required) as per https://grafana.com/docs/grafana/latest/alerting/images-in-notifications/\r\n\r\n**Anything else we need to know?**:\r\n- I've enabled logs on debug mode and I have no indication of any errors or whatsoever. \r\n- I've tried to use ` {{.ImageURL}}` in the notification text body and that results in an empty string\r\n\r\n**Environment**:\r\n- Grafana version: v9.1.2 enterprise\r\n- Others: image-renderer:latest\r\n- On K8s\r\n\r\n\r\n","labels":["area/alerting","area/alerting/screenshots"]},{"id":53357,"title":"Can't edit/delete alert rules when data source deleted","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI removed a data source (InfluxDB 2) from Grafana then tried to edit/delete some alert rules with queries that used this data source. I found that the alert rules could not be edited or deleted, instead an error message appears: `Error: invalid rule specification at index [0]: failed to validate condition of alert rule System Load: invalid query C: data source not found: 000000001`. Query C does not exist in the GUI.\r\n\r\n**What you expected to happen**:\r\nI expected the alert rules to be able to be deleted regardless of data source availability.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Create a couple of alert rules with queries that use a specific data source.\r\n2. Remove the data source from Grafana.\r\n3. Try to edit or delete one of the alert rules. It will fail with the above error message.\r\n\r\n**Anything else we need to know?**:\r\nNo.\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.6\r\n- Data source type \u0026 version: InfluxDB 2 and Prometheus\r\n- OS Grafana is installed on: Alpine Linux 3.16\r\n- User OS \u0026 Browser: macOS Monterey 12.5\r\n- Grafana plugins: Renderer\r\n- Others: Grafana running in a Docker container on Docker Engine 20.10.16\r\n","labels":["type/bug","area/alerting","prio/medium","effort/medium"]},{"id":63021,"title":"${__value.time} is escaped in Bar Chart data links","body":"**What happened**:\r\nif your panel is of type Bar Chart and you configure a data link via field override, `${__value.time}` will be `$%7B__value.time:date%7D` instead of actual value.\r\nThis doesn't happen on the time series panels where it works correctly\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.6\r\n\r\n","labels":["area/dashboard/data-links","bot/no new info"]},{"id":65647,"title":"Alert created from REST API: Ability to review alert config from UI in read-only mode.","body":"Hi Grafana Team,\r\n\r\nI noticed for any alerts created from REST APIs \"Alertingprovisioning\" module, they can't be edited or alert config can't be viewed from UI. I understand why write access should be cut down in UI.\r\nBut as an enhancement, is it possible for atleast to make the alert config(queries etc) to be visible from UI , but just read-only ?\r\nright now we(and other) are finding it a bit hard to follow the alert config from UI for alerts created from REST API, maintaining the alert, config can only be done from API.\r\nNot fair for \"Anyone/everyone\" to call(GET) the api's to quickly review the alert config. might not be their cup of tea.\r\nThis all what we can see right now. But reviewing the alert config is important to us.\r\n\r\n![Screen Shot 2023-03-30 at 11 48 54 AM](https://user-images.githubusercontent.com/23487589/228936550-9294d895-b313-4b5d-82a1-8b1a2ebc1f86.png)\r\n","labels":["needs more info","area/alerting","area/frontend"]},{"id":83657,"title":"Data formatted as $ in Excel returns the dollar in the fieldimage is this issue related? When my data is formatted as $ in Excel I get the dollar in the field","body":"### What happened?\n\n![image](https://github.com/grafana/grafana/assets/1325158/0b7b85b3-3550-4800-9ddc-b6d4e8f2f122)\r\n\r\nWhen my data is formatted as $ in Excel I get the dollar in the field\r\n\r\n![image](https://github.com/grafana/grafana/assets/1325158/26fd0b1a-a49d-49ea-8e93-82e4f3a517a5)\r\n\n\n### What did you expect to happen?\n\nExpected the column to a be a whole number/decimal, and I can view it accurately in Excel. In the current mode I cannot sum up fields since the $value is a string not a decimal.\n\n### Did this work before?\n\nNever noticed this before\n\n### How do we reproduce it?\n\n1. Format the number as Unit Dollars\r\n![image](https://github.com/grafana/grafana/assets/1325158/20a35198-aca8-4a39-856a-3681dffe2909)\r\n2. Then export the data to excel\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: v10.2.2\r\nOS:\r\nBrowser: Chrome\r\n\n\n### Grafana platform?\n\nA downloaded binary\n\n### Datasource(s)?\n\nGoogle BigQuery","labels":["area/panel/table","area/panel/timeseries","triage/needs-confirmation","datasource/CSV"]},{"id":57802,"title":"Grafana alerts page - Prometheus alerts showing Health error","body":"Hi,\r\nWe are seeing error status in health of alerts in Grafana with message \"no query API server available\". Then after few seconds, it goes ok. it is happening like every refresh it seems. I don't see any error log in Grafana logs. Any idea why it's like this? Is it something to do with my Grafana configuration? Or is it in Prometheus datasource configuration?\r\n\r\n![image](https://user-images.githubusercontent.com/110811012/198523519-106985de-2c87-4cc6-9696-2233a657cfa8.png)\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9.1.1\r\n- Data source type \u0026 version: Prometheus\r\n- OS Grafana is installed on: Windows\r\n- User OS \u0026 Browser: Microsoft Chromium Edge\r\n\r\n","labels":["needs more info","area/alerting","needs investigation","pr/awaiting-info"]},{"id":58383,"title":"using nginx as a proxy does not work with Grafana 9.x.x","body":"When I install 9.2.2 or 9.2.1, I keep getting the error in the image, but when I install 8.5.9, it works fine. Besides, my load balancer configuration hasn't changed\r\nMy environment is centos7 and Google Chrome, using nginx as a proxy\r\n\r\n![image](https://user-images.githubusercontent.com/110534311/200450457-7be84b9c-762a-42f9-b28f-50c5fa89ccdd.png)\r\n","labels":["type/question","bot/no new info","area/configuration"]},{"id":57855,"title":"Inconsistent \"value\" name with multiple queries","body":"**What happened**:\nWith two prometheus queries returned as format Table, the collumn that has the queries values can be \"Value #QueryName\" or \"Value\" when one of the queries does not return any values. Changing that name breaks any reference that value might have in transformations or panel settings.\n\n**What you expected to happen**:\nOnce grafana might return more than one value, it should always use the \"Value #QueryName\" format, no matter of how many queries really returned any row.\n\n**How to reproduce it (as minimally and precisely as possible)**:\n- create two prometheus queries that returns values\n- create any transformation using one of the values\n- change one of the queries to not return any value (like adding \u003c0 for queries that always returns positive data)\n- check that the transformation is now broken (\"Value #A\" not found)\n\n**Anything else we need to know?**:\n\n**Environment**:\n- Grafana version: 9.2.1\n- Data source type \u0026 version: prometheus\n- OS Grafana is installed on: sles15sp4\n- User OS \u0026 Browser: chrome\n- Grafana plugins: any\n- Others:\n","labels":["prio/low","datasource/Prometheus","needs investigation","stale","area/transformations"]},{"id":72315,"title":"Prometheus datasource - Grafana v10.0.0 doesn't plot/show Prometheus exemplars in the timeseries chart","body":"### What happened?\r\n\r\nGrafana v10.0.0, when trying to plot Prometheus metrics with exemplars, we see exemplars in the panel json data for the time range selected, but it doesn't plot them in the timeseries chart. see below --\r\n\r\n![image](https://github.com/grafana/grafana/assets/10353076/08517b80-1f14-45c8-9a76-803970eeb1e6)\r\n\u003cdetails\u003e\r\n  \u003csummary\u003ebelow is the data panel json \u003c/summary\u003e\r\n```json\r\n{\r\n  \"state\": \"Done\",\r\n  \"series\": [\r\n    {\r\n      \"refId\": \"A\",\r\n      \"meta\": {\r\n        \"type\": \"timeseries-multi\",\r\n        \"typeVersion\": [\r\n          0,\r\n          1\r\n        ],\r\n        \"custom\": {\r\n          \"resultType\": \"matrix\"\r\n        },\r\n        \"executedQueryString\": \"Expr: histogram_quantile(0.95, sum(rate(exemplar_test_histogram_bucket[1m0s])) by (le))\\nStep: 15s\",\r\n        \"preferredVisualisationType\": \"graph\"\r\n      },\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"Time\",\r\n          \"type\": \"time\",\r\n          \"typeInfo\": {\r\n            \"frame\": \"time.Time\"\r\n          },\r\n          \"config\": {\r\n            \"interval\": 15000,\r\n            \"custom\": {\r\n              \"drawStyle\": \"line\",\r\n              \"lineInterpolation\": \"linear\",\r\n              \"barAlignment\": 0,\r\n              \"lineWidth\": 1,\r\n              \"fillOpacity\": 0,\r\n              \"gradientMode\": \"none\",\r\n              \"showPoints\": \"always\",\r\n              \"pointSize\": 5,\r\n              \"axisPlacement\": \"auto\",\r\n              \"axisColorMode\": \"text\",\r\n              \"axisCenteredZero\": false,\r\n              \"hideFrom\": {\r\n                \"tooltip\": false,\r\n                \"viz\": false,\r\n                \"legend\": false\r\n              },\r\n              \"thresholdsStyle\": {\r\n                \"mode\": \"off\"\r\n              }\r\n            },\r\n            \"color\": {\r\n              \"mode\": \"palette-classic\"\r\n            },\r\n            \"thresholds\": {\r\n              \"mode\": \"absolute\",\r\n              \"steps\": [\r\n                {\r\n                  \"color\": \"green\",\r\n                  \"value\": null\r\n                },\r\n                {\r\n                  \"color\": \"red\",\r\n                  \"value\": 80\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          \"values\": [\r\n            1690320930000,\r\n            1690320945000,\r\n            1690320960000,\r\n            1690320975000,\r\n            1690320990000,\r\n            1690321005000,\r\n            1690321020000,\r\n            1690321035000,\r\n            1690321050000,\r\n            1690321065000,\r\n            1690321080000,\r\n            1690321095000,\r\n            1690321110000,\r\n            1690321125000,\r\n            1690321140000,\r\n            1690321155000,\r\n            1690321170000,\r\n            1690321185000,\r\n            1690321200000,\r\n            1690321215000,\r\n            1690321230000,\r\n            1690321245000,\r\n            1690321260000,\r\n            1690321275000,\r\n            1690321290000,\r\n            1690321305000,\r\n            1690321320000,\r\n            1690321335000,\r\n            1690321350000,\r\n            1690321365000,\r\n            1690321380000,\r\n            1690321395000,\r\n            1690321410000,\r\n            1690321425000,\r\n            1690321440000,\r\n            1690321455000,\r\n            1690321470000,\r\n            1690321485000,\r\n            1690321500000,\r\n            1690321515000,\r\n            1690321530000,\r\n            1690321545000,\r\n            1690321560000,\r\n            1690321575000,\r\n            1690321590000,\r\n            1690321605000,\r\n            1690321620000,\r\n            1690321635000,\r\n            1690321650000,\r\n            1690321665000,\r\n            1690321680000,\r\n            1690321695000,\r\n            1690321710000,\r\n            1690321725000,\r\n            1690321740000,\r\n            1690321755000,\r\n            1690321770000,\r\n            1690321785000,\r\n            1690321800000,\r\n            1690321815000,\r\n            1690321830000\r\n          ],\r\n          \"entities\": {},\r\n          \"state\": {\r\n            \"scopedVars\": {\r\n              \"__dataContext\": \"Filtered out in JSON serialization\"\r\n            },\r\n            \"seriesIndex\": 0\r\n          }\r\n        },\r\n        {\r\n          \"name\": \"Value\",\r\n          \"type\": \"number\",\r\n          \"typeInfo\": {\r\n            \"frame\": \"float64\"\r\n          },\r\n          \"labels\": {},\r\n          \"config\": {\r\n            \"displayNameFromDS\": \"histogram_quantile(0.95, sum(rate(exemplar_test_histogram_bucket[1m0s])) by (le))\",\r\n            \"custom\": {\r\n              \"drawStyle\": \"line\",\r\n              \"lineInterpolation\": \"linear\",\r\n              \"barAlignment\": 0,\r\n              \"lineWidth\": 1,\r\n              \"fillOpacity\": 0,\r\n              \"gradientMode\": \"none\",\r\n              \"spanNulls\": false,\r\n              \"showPoints\": \"always\",\r\n              \"pointSize\": 5,\r\n              \"stacking\": {\r\n                \"mode\": \"normal\",\r\n                \"group\": \"A\"\r\n              },\r\n              \"axisPlacement\": \"auto\",\r\n              \"axisLabel\": \"\",\r\n              \"axisColorMode\": \"text\",\r\n              \"scaleDistribution\": {\r\n                \"type\": \"linear\"\r\n              },\r\n              \"axisCenteredZero\": false\r\n            },\r\n            \"min\": -5,\r\n            \"max\": 5,\r\n            \"mappings\": []\r\n          },\r\n          \"values\": [\r\n            1.575000000000002,\r\n            -0.01999999999999802,\r\n            0.7750000000000012,\r\n            0.7800000000000012,\r\n            0.7750000000000012,\r\n            0.580000000000002,\r\n            1.875000000000002,\r\n            1.880000000000002,\r\n            1.875000000000002,\r\n            -0.01999999999999802,\r\n            -0.42499999999999805,\r\n            1.280000000000002,\r\n            1.287500000000002,\r\n            1.290000000000002,\r\n            1.275000000000002,\r\n            0.890000000000001,\r\n            0.875000000000001,\r\n            0.6800000000000019,\r\n            1.275000000000002,\r\n            1.280000000000002,\r\n            1.275000000000002,\r\n            0.08000000000000199,\r\n            0.187500000000002,\r\n            0.9800000000000018,\r\n            0.9875000000000018,\r\n            0.9900000000000019,\r\n            0.9750000000000018,\r\n            1.380000000000002,\r\n            1.4750000000000019,\r\n            1.480000000000002,\r\n            1.4750000000000019,\r\n            -0.21999999999999803,\r\n            0.7750000000000012,\r\n            0.7800000000000012,\r\n            0.7750000000000012,\r\n            0.380000000000002,\r\n            0.375000000000002,\r\n            1.180000000000002,\r\n            1.4750000000000019,\r\n            1.480000000000002,\r\n            1.575000000000002,\r\n            1.580000000000002,\r\n            1.675000000000002,\r\n            1.680000000000002,\r\n            1.675000000000002,\r\n            0.28000000000000197,\r\n            -0.024999999999998038,\r\n            1.480000000000002,\r\n            1.4750000000000019,\r\n            1.480000000000002,\r\n            0.175000000000002,\r\n            0.08000000000000199,\r\n            1.275000000000002,\r\n            1.280000000000002,\r\n            1.275000000000002,\r\n            1.180000000000002,\r\n            1.175000000000002,\r\n            0.9800000000000018,\r\n            0.9750000000000018,\r\n            0.9850000000000019,\r\n            0.690000000000002\r\n          ],\r\n          \"entities\": {},\r\n          \"state\": {\r\n            \"multipleFrames\": false,\r\n            \"scopedVars\": {\r\n              \"__dataContext\": \"Filtered out in JSON serialization\"\r\n            },\r\n            \"seriesIndex\": 0,\r\n            \"range\": {\r\n              \"min\": -5,\r\n              \"max\": 5,\r\n              \"delta\": 10\r\n            }\r\n          }\r\n        }\r\n      ],\r\n      \"length\": 61\r\n    }\r\n  ],\r\n  \"annotations\": [\r\n    {\r\n      \"name\": \"exemplar\",\r\n      \"refId\": \"A\",\r\n      \"meta\": {\r\n        \"typeVersion\": [\r\n          0,\r\n          0\r\n        ],\r\n        \"custom\": {\r\n          \"resultType\": \"exemplar\"\r\n        },\r\n        \"executedQueryString\": \"Expr: histogram_quantile(0.95, sum(rate(exemplar_test_histogram_bucket[1m0s])) by (le))\\nStep: 15s\",\r\n        \"dataTopic\": \"annotations\"\r\n      },\r\n      \"fields\": [\r\n        {\r\n          \"name\": \"Time\",\r\n          \"type\": \"time\",\r\n          \"typeInfo\": {\r\n            \"frame\": \"time.Time\"\r\n          },\r\n          \"config\": {},\r\n          \"values\": [\r\n            1690319649156000000,\r\n            1690319859265000000,\r\n            1690319869275000000,\r\n            1690319889285000000,\r\n            1690319939318000000,\r\n            1690320029368000000,\r\n            1690320139436000000,\r\n            1690320159448000000,\r\n            1690320169457000000,\r\n            1690320209485000000,\r\n            1690320219494000000,\r\n            1690320299536000000,\r\n            1690320319548000000,\r\n            1690320349568000000,\r\n            1690320369580000000,\r\n            1690320399592000000,\r\n            1690320459609000000,\r\n            1690320479618000000,\r\n            1690320559648000000,\r\n            1690320609666000000,\r\n            1690320629677000000,\r\n            1690320659688000000,\r\n            1690320669689000000,\r\n            1690320729716000000,\r\n            1690320739725000000,\r\n            1690320749726000000,\r\n            1690320759726000000,\r\n            1690320779735000000,\r\n            1690320789736000000,\r\n            1690320799745000000,\r\n            1690320809748000000,\r\n            1690320819749000000,\r\n            1690320829758000000,\r\n            1690320839762000000,\r\n            1690320849762000000,\r\n            1690320879769000000,\r\n            1690320889776000000,\r\n            1690320899780000000,\r\n            1690320909781000000,\r\n            1690320919789000000,\r\n            1690320939794000000,\r\n            1690320949797000000,\r\n            1690320959802000000,\r\n            1690320969803000000,\r\n            1690320979804000000,\r\n            1690320989809000000,\r\n            1690320999809000000,\r\n            1690321009818000000,\r\n            1690321019823000000,\r\n            1690321029824000000,\r\n            1690321039833000000,\r\n            1690321049833000000,\r\n            1690321059833000000,\r\n            1690321069842000000,\r\n            1690321079847000000,\r\n            1690321089847000000,\r\n            1690321099855000000,\r\n            1690321109858000000,\r\n            1690321119858000000,\r\n            1690321129859000000,\r\n            1690321139864000000,\r\n            1690321149865000000,\r\n            1690321159872000000,\r\n            1690321169877000000,\r\n            1690321179878000000,\r\n            1690321189887000000,\r\n            1690321199891000000,\r\n            1690321209892000000,\r\n            1690321219896000000,\r\n            1690321229901000000,\r\n            1690321249910000000,\r\n            1690321259911000000,\r\n            1690321269912000000,\r\n            1690321279921000000,\r\n            1690321289926000000,\r\n            1690321299926000000,\r\n            1690321309935000000,\r\n            1690321319940000000,\r\n            1690321329940000000,\r\n            1690321339947000000,\r\n            1690321349952000000,\r\n            1690321369962000000,\r\n            1690321379967000000,\r\n            1690321389967000000,\r\n            1690321399967000000,\r\n            1690321409970000000,\r\n            1690321419971000000,\r\n            1690321429976000000,\r\n            1690321439979000000,\r\n            1690321449979000000,\r\n            1690321459985000000,\r\n            1690321469990000000,\r\n            1690321479991000000,\r\n            1690321489994000000,\r\n            1690321500000000000,\r\n            1690321510001000000,\r\n            1690321520008000000,\r\n            1690321530012000000,\r\n            1690321540013000000,\r\n            1690321550015000000,\r\n            1690321560020000000,\r\n            1690321570021000000,\r\n            1690321580026000000,\r\n            1690321590030000000,\r\n            1690321600031000000,\r\n            1690321610032000000,\r\n            1690321620036000000,\r\n            1690321630036000000,\r\n            1690321640045000000,\r\n            1690321650046000000,\r\n            1690321660047000000,\r\n            1690321670056000000,\r\n            1690321680060000000,\r\n            1690321690060000000,\r\n            1690321700061000000,\r\n            1690321710065000000,\r\n            1690321720065000000,\r\n            1690321730065000000,\r\n            1690321740067000000,\r\n            1690321750067000000,\r\n            1690321760072000000,\r\n            1690321770072000000,\r\n            1690321780073000000,\r\n            1690321790074000000\r\n          ],\r\n          \"entities\": {},\r\n          \"state\": null\r\n        },\r\n        {\r\n          \"name\": \"Value\",\r\n          \"type\": \"number\",\r\n          \"typeInfo\": {\r\n            \"frame\": \"float64\"\r\n          },\r\n          \"config\": {},\r\n          \"values\": [\r\n            -1.6386410778564344,\r\n            2.5302384433524066,\r\n            -1.3083029600213898,\r\n            -0.8575016736611518,\r\n            -2.1669240008520707,\r\n            1.314023802253438,\r\n            1.9898577208292023,\r\n            -2.230107839590404,\r\n            -2.4268851042997186,\r\n            -0.6665394936756008,\r\n            -1.513075503143817,\r\n            1.8166040600089386,\r\n            -1.2778355991869716,\r\n            -0.9905792101320999,\r\n            0.9792496363132315,\r\n            0.3799730494177619,\r\n            2.2609412603853936,\r\n            0.5122685761334964,\r\n            0.434367010889782,\r\n            -1.1731565432986832,\r\n            -1.0382280015778882,\r\n            0.8740668519377646,\r\n            1.4075539599599534,\r\n            0.10487991427502075,\r\n            1.1934255850447935,\r\n            -0.5633115412893916,\r\n            0.2602856015262628,\r\n            0.02397115908260805,\r\n            1.7520107705679084,\r\n            -1.471984829298286,\r\n            -0.47476787984587787,\r\n            1.0447325348506924,\r\n            -0.36113983428159835,\r\n            -1.7188716264391044,\r\n            0.6939493950845536,\r\n            1.2240623332259908,\r\n            1.5372446988976618,\r\n            -1.9568453288534284,\r\n            -0.11808060104393481,\r\n            -0.2277676353736174,\r\n            -0.05222793487664962,\r\n            0.7091288764617658,\r\n            -0.7237296314937762,\r\n            -0.6764458907928905,\r\n            0.5374176286706479,\r\n            -0.12750362788037375,\r\n            1.8962938509528675,\r\n            0.43216189500575347,\r\n            -0.07676664335069869,\r\n            -1.6619117946910487,\r\n            -0.4704977615634326,\r\n            -2.165433803872688,\r\n            -0.7715539550136234,\r\n            -1.6390695640234532,\r\n            1.2934314350020415,\r\n            0.37088860124371215,\r\n            1.252947828255797,\r\n            0.8169532785872725,\r\n            -0.4305130175194609,\r\n            0.8028870721107064,\r\n            -0.49171727741157856,\r\n            -0.0339160729930138,\r\n            0.09310434316964106,\r\n            0.6954055262075935,\r\n            -1.0831289512428808,\r\n            1.286412349131083,\r\n            -0.9378064450095147,\r\n            -0.40607482701729425,\r\n            0.09866076421855041,\r\n            -0.36335290160290057,\r\n            0.14701460938920213,\r\n            0.9189094332681773,\r\n            0.11279561771459085,\r\n            0.9637954478849488,\r\n            -0.0826764208965759,\r\n            0.57936287175405,\r\n            -0.9342591460817554,\r\n            1.3356409182798639,\r\n            -0.053732844117076684,\r\n            1.4451749896846686,\r\n            -0.7214326043874442,\r\n            -0.9762817781113649,\r\n            -0.2793881732992205,\r\n            -1.8563411313998144,\r\n            0.7408055046337917,\r\n            -0.5799203532819692,\r\n            -0.7129723604944614,\r\n            0.29037983248746674,\r\n            0.3021373548131654,\r\n            -2.1332671668411556,\r\n            -0.20946670404018297,\r\n            1.1117190383859539,\r\n            -0.44149212620857964,\r\n            1.4071858950692646,\r\n            -0.319580921043235,\r\n            0.9788142136474671,\r\n            1.5040024724520102,\r\n            -0.718196610000945,\r\n            -1.4984426192966893,\r\n            1.6427417967661164,\r\n            0.2981156027151899,\r\n            -1.826283001804709,\r\n            -0.02069275294038231,\r\n            -1.0461446937034022,\r\n            -2.3583665341168443,\r\n            -1.3563410975095058,\r\n            1.4840245472507219,\r\n            0.16813910559942205,\r\n            -1.0112797453604008,\r\n            0.004600536407718403,\r\n            -0.08143414108485889,\r\n            -0.8821225837654865,\r\n            -0.3867738612735607,\r\n            0.29468734022014376,\r\n            1.221925105402491,\r\n            -0.7854314763630386,\r\n            1.1722358680271947,\r\n            0.13437777060446568,\r\n            -0.45672026157532375,\r\n            0.07275273837744312,\r\n            0.1511480780663501,\r\n            0.9341967062189179,\r\n            0.672304214404626,\r\n            -1.0927137499922757\r\n          ],\r\n          \"entities\": {},\r\n          \"state\": null\r\n        },\r\n        {\r\n          \"name\": \"__name__\",\r\n          \"type\": \"string\",\r\n          \"typeInfo\": {\r\n            \"frame\": \"string\"\r\n          },\r\n          \"config\": {},\r\n          \"values\": [\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\",\r\n            \"exemplar_test_histogram_bucket\"\r\n          ],\r\n          \"entities\": {},\r\n          \"state\": null\r\n        },\r\n        {\r\n          \"name\": \"cluster\",\r\n          \"type\": \"string\",\r\n          \"typeInfo\": {\r\n            \"frame\": \"string\"\r\n          },\r\n          \"config\": {},\r\n          \"values\": [\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\",\r\n            \"vishwa-e-3\"\r\n          ],\r\n          \"entities\": {},\r\n          \"state\": null\r\n        },\r\n        {\r\n          \"name\": \"dim1\",\r\n          \"type\": \"string\",\r\n          \"typeInfo\": {\r\n            \"frame\": \"string\"\r\n          },\r\n          \"config\": {},\r\n          \"values\": [\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\",\r\n            \"e\"\r\n          ],\r\n          \"entities\": {},\r\n          \"state\": null\r\n        },\r\n        {\r\n          \"name\": \"dim2\",\r\n          \"type\": \"string\",\r\n          \"typeInfo\": {\r\n            \"frame\": \"string\"\r\n          },\r\n          \"config\": {},\r\n          \"values\": [\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\",\r\n            \"f\"\r\n          ],\r\n          \"entities\": {},\r\n          \"state\": null\r\n        },\r\n        {\r\n          \"name\": \"instance\",\r\n          \"type\": \"string\",\r\n          \"typeInfo\": {\r\n            \"frame\": \"string\"\r\n          },\r\n          \"config\": {},\r\n          \"values\": [\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\",\r\n            \"localhost:2113\"\r\n          ],\r\n          \"entities\": {},\r\n          \"state\": null\r\n        },\r\n        {\r\n          \"name\": \"job\",\r\n          \"type\": \"string\",\r\n          \"typeInfo\": {\r\n            \"frame\": \"string\"\r\n          },\r\n          \"config\": {},\r\n          \"values\": [\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\",\r\n            \"vishwa-exemplars\"\r\n          ],\r\n          \"entities\": {},\r\n          \"state\": null\r\n        },\r\n        {\r\n          \"name\": \"le\",\r\n          \"type\": \"string\",\r\n          \"typeInfo\": {\r\n            \"frame\": \"string\"\r\n          },\r\n          \"config\": {},\r\n          \"values\": [\r\n            \"-1.599999999999999\",\r\n            \"2.600000000000003\",\r\n            \"-1.299999999999998\",\r\n            \"-0.799999999999998\",\r\n            \"-2.099999999999999\",\r\n            \"1.400000000000002\",\r\n            \"2.000000000000002\",\r\n            \"-2.199999999999999\",\r\n            \"-2.399999999999999\",\r\n            \"-0.599999999999998\",\r\n            \"-1.499999999999999\",\r\n            \"1.900000000000002\",\r\n            \"-1.199999999999998\",\r\n            \"-0.899999999999998\",\r\n            \"1.000000000000002\",\r\n            \"0.400000000000002\",\r\n            \"2.300000000000002\",\r\n            \"0.600000000000002\",\r\n            \"0.500000000000002\",\r\n            \"-1.099999999999998\",\r\n            \"-0.999999999999998\",\r\n            \"0.900000000000001\",\r\n            \"1.500000000000002\",\r\n            \"0.200000000000002\",\r\n            \"1.200000000000002\",\r\n            \"-0.499999999999998\",\r\n            \"0.300000000000002\",\r\n            \"0.100000000000002\",\r\n            \"1.800000000000002\",\r\n            \"-1.399999999999999\",\r\n            \"-0.399999999999998\",\r\n            \"1.100000000000002\",\r\n            \"-0.299999999999998\",\r\n            \"-1.699999999999999\",\r\n            \"0.700000000000002\",\r\n            \"1.300000000000002\",\r\n            \"1.600000000000002\",\r\n            \"-1.899999999999999\",\r\n            \"-0.099999999999998\",\r\n            \"-0.199999999999998\",\r\n            \"0.000000000000002\",\r\n            \"0.800000000000001\",\r\n            \"-0.699999999999998\",\r\n            \"-0.599999999999998\",\r\n            \"0.600000000000002\",\r\n            \"-0.099999999999998\",\r\n            \"1.900000000000002\",\r\n            \"0.500000000000002\",\r\n            \"0.000000000000002\",\r\n            \"-1.599999999999999\",\r\n            \"-0.399999999999998\",\r\n            \"-2.099999999999999\",\r\n            \"-0.699999999999998\",\r\n            \"-1.599999999999999\",\r\n            \"1.300000000000002\",\r\n            \"0.400000000000002\",\r\n            \"1.300000000000002\",\r\n            \"0.900000000000001\",\r\n            \"-0.399999999999998\",\r\n            \"0.900000000000001\",\r\n            \"-0.399999999999998\",\r\n            \"0.000000000000002\",\r\n            \"0.100000000000002\",\r\n            \"0.700000000000002\",\r\n            \"-0.999999999999998\",\r\n            \"1.300000000000002\",\r\n            \"-0.899999999999998\",\r\n            \"-0.399999999999998\",\r\n            \"0.100000000000002\",\r\n            \"-0.299999999999998\",\r\n            \"0.200000000000002\",\r\n            \"1.000000000000002\",\r\n            \"0.200000000000002\",\r\n            \"1.000000000000002\",\r\n            \"0.000000000000002\",\r\n            \"0.600000000000002\",\r\n            \"-0.899999999999998\",\r\n            \"1.400000000000002\",\r\n            \"0.000000000000002\",\r\n            \"1.500000000000002\",\r\n            \"-0.699999999999998\",\r\n            \"-0.899999999999998\",\r\n            \"-0.199999999999998\",\r\n            \"-1.799999999999999\",\r\n            \"0.800000000000001\",\r\n            \"-0.499999999999998\",\r\n            \"-0.699999999999998\",\r\n            \"0.300000000000002\",\r\n            \"0.400000000000002\",\r\n            \"-2.099999999999999\",\r\n            \"-0.199999999999998\",\r\n            \"1.200000000000002\",\r\n            \"-0.399999999999998\",\r\n            \"1.500000000000002\",\r\n            \"-0.299999999999998\",\r\n            \"1.000000000000002\",\r\n            \"1.600000000000002\",\r\n            \"-0.699999999999998\",\r\n            \"-1.399999999999999\",\r\n            \"1.700000000000002\",\r\n            \"0.300000000000002\",\r\n            \"-1.799999999999999\",\r\n            \"0.000000000000002\",\r\n            \"-0.999999999999998\",\r\n            \"-2.299999999999999\",\r\n            \"-1.299999999999998\",\r\n            \"1.500000000000002\",\r\n            \"0.200000000000002\",\r\n            \"-0.999999999999998\",\r\n            \"0.100000000000002\",\r\n            \"0.000000000000002\",\r\n            \"-0.799999999999998\",\r\n            \"-0.299999999999998\",\r\n            \"0.300000000000002\",\r\n            \"1.300000000000002\",\r\n            \"-0.699999999999998\",\r\n            \"1.200000000000002\",\r\n            \"0.200000000000002\",\r\n            \"-0.399999999999998\",\r\n            \"0.100000000000002\",\r\n            \"0.200000000000002\",\r\n            \"1.000000000000002\",\r\n            \"0.700000000000002\",\r\n            \"-0.999999999999998\"\r\n          ],\r\n          \"entities\": {},\r\n          \"state\": null\r\n        },\r\n        {\r\n          \"name\": \"mytraceid\",\r\n          \"type\": \"string\",\r\n          \"typeInfo\": {\r\n            \"frame\": \"string\"\r\n          },\r\n          \"config\": {},\r\n          \"values\": [\r\n            \"49703\",\r\n            \"67425\",\r\n            \"31515\",\r\n            \"3410\",\r\n            \"69271\",\r\n            \"1528\",\r\n            \"61602\",\r\n            \"77578\",\r\n            \"67822\",\r\n            \"90440\",\r\n            \"93162\",\r\n            \"94162\",\r\n            \"56756\",\r\n            \"21092\",\r\n            \"25320\",\r\n            \"16611\",\r\n            \"38795\",\r\n            \"78996\",\r\n            \"71757\",\r\n            \"71215\",\r\n            \"38662\",\r\n            \"96443\",\r\n            \"32390\",\r\n            \"57293\",\r\n            \"29648\",\r\n            \"27420\",\r\n            \"70371\",\r\n            \"98682\",\r\n            \"76592\",\r\n            \"24231\",\r\n            \"60855\",\r\n            \"65343\",\r\n            \"55166\",\r\n            \"99867\",\r\n            \"77008\",\r\n            \"91874\",\r\n            \"66537\",\r\n            \"54467\",\r\n            \"74658\",\r\n            \"43546\",\r\n            \"91657\",\r\n            \"56039\",\r\n            \"18146\",\r\n            \"10928\",\r\n            \"84926\",\r\n            \"77412\",\r\n            \"19105\",\r\n            \"34698\",\r\n            \"69430\",\r\n            \"1128\",\r\n            \"46861\",\r\n            \"77418\",\r\n            \"47871\",\r\n            \"38240\",\r\n            \"59081\",\r\n            \"27276\",\r\n            \"21466\",\r\n            \"67695\",\r\n            \"44834\",\r\n            \"34267\",\r\n            \"22175\",\r\n            \"53380\",\r\n            \"78265\",\r\n            \"72884\",\r\n            \"49023\",\r\n            \"9673\",\r\n            \"79253\",\r\n            \"5527\",\r\n            \"75048\",\r\n            \"19731\",\r\n            \"68531\",\r\n            \"82677\",\r\n            \"63654\",\r\n            \"44330\",\r\n            \"64187\",\r\n            \"60604\",\r\n            \"98193\",\r\n            \"68956\",\r\n            \"922\",\r\n            \"96494\",\r\n            \"48999\",\r\n            \"27759\",\r\n            \"47124\",\r\n            \"88853\",\r\n            \"58475\",\r\n            \"28089\",\r\n            \"38339\",\r\n            \"83131\",\r\n            \"56985\",\r\n            \"34203\",\r\n            \"57092\",\r\n            \"95275\",\r\n            \"41262\",\r\n            \"47807\",\r\n            \"12205\",\r\n            \"42474\",\r\n            \"1723\",\r\n            \"3922\",\r\n            \"27574\",\r\n            \"30\",\r\n            \"49914\",\r\n            \"7650\",\r\n            \"99277\",\r\n            \"40671\",\r\n            \"28198\",\r\n            \"98879\",\r\n            \"94721\",\r\n            \"69326\",\r\n            \"33921\",\r\n            \"89301\",\r\n            \"99488\",\r\n            \"78374\",\r\n            \"78140\",\r\n            \"65596\",\r\n            \"30075\",\r\n            \"86872\",\r\n            \"15214\",\r\n            \"60325\",\r\n            \"9921\",\r\n            \"97063\",\r\n            \"46487\",\r\n            \"58223\",\r\n            \"79026\",\r\n            \"9200\"\r\n          ],\r\n          \"entities\": {},\r\n          \"state\": null\r\n        }\r\n      ],\r\n      \"length\": 124\r\n    }\r\n  ],\r\n  \"request\": {\r\n    \"app\": \"panel-editor\",\r\n    \"requestId\": \"Q122\",\r\n    \"timezone\": \"browser\",\r\n    \"panelId\": 1,\r\n    \"dashboardUID\": \"e24d151e-e977-4578-b01f-f91f81c15274\",\r\n    \"publicDashboardAccessToken\": \"\",\r\n    \"range\": {\r\n      \"from\": \"2023-07-25T21:35:34.474Z\",\r\n      \"to\": \"2023-07-25T21:50:34.474Z\",\r\n      \"raw\": {\r\n        \"from\": \"now-15m\",\r\n        \"to\": \"now\"\r\n      }\r\n    },\r\n    \"timeInfo\": \"\",\r\n    \"interval\": \"15s\",\r\n    \"intervalMs\": 15000,\r\n    \"targets\": [\r\n      {\r\n        \"datasource\": {\r\n          \"type\": \"prometheus\",\r\n          \"uid\": \"RN_1KmBnk\"\r\n        },\r\n        \"editorMode\": \"code\",\r\n        \"exemplar\": true,\r\n        \"expr\": \"histogram_quantile(0.95, sum(rate(exemplar_test_histogram_bucket[$__rate_interval])) by (le))\",\r\n        \"instant\": false,\r\n        \"legendFormat\": \"__auto\",\r\n        \"range\": true,\r\n        \"refId\": \"A\"\r\n      }\r\n    ],\r\n    \"maxDataPoints\": 1889,\r\n    \"scopedVars\": {\r\n      \"__interval\": {\r\n        \"text\": \"15s\",\r\n        \"value\": \"15s\"\r\n      },\r\n      \"__interval_ms\": {\r\n        \"text\": \"15000\",\r\n        \"value\": 15000\r\n      }\r\n    },\r\n    \"startTime\": 1690321834474,\r\n    \"endTime\": 1690321835396\r\n  },\r\n  \"timings\": {\r\n    \"dataProcessingTime\": 0\r\n  },\r\n  \"structureRev\": 2\r\n}\r\n```\r\n\u003c/details\u003e\r\n\r\n### What did you expect to happen?\r\n\r\nexemplars to be charted\r\n\r\n### Did this work before?\r\n\r\ndont know\r\n\r\n### How do we reproduce it?\r\n\r\nby querying prometheus metrics with exemplars\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: v10.0.0\r\nOS: windows\r\nBrowser: microsoft edge\r\n\r\n\r\n### Grafana platform?\r\n\r\nA downloaded binary\r\n\r\n### Datasource(s)?\r\n\r\nPrometheus","labels":["datasource/Prometheus","stale","area/panel/timeseries","triage/needs-confirmation"]},{"id":69710,"title":"Loosing API Annotations after restarting Grafana k8s deployment with database","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\n  - Whenever I restart the grafana deployment, I loose the annotation.\r\n\r\n**What did you expect to happen**:\r\n\r\n  - I expected for the annotation to persist in the database.\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\n- Open Grafana and create a service account along with a token.\r\n\r\n**Step 2**:\r\n\r\n- Use below curl request to create an annotation for a specific dashboard:\r\n\r\ncurl -X POST \\\r\n  -H \"Content-Type: application/json\" \\\r\n  -H \"Authorization: Bearer \u003cAPIToken\u003e\" \\\r\n  -d '{\r\n    \"dashboardUID\": \"xxxx\",\r\n    \"panelId\": x,\r\n    \"text\": \"Annotation Description\"\r\n  }' \\\r\n  https://\u003cgrafana-URL\u003e/api/annotations\r\n\r\n\r\n**Step 3**:\r\n\r\nIn the defaults.ini add an RDS MySQL connection.\r\n\r\n**Step 4**:\r\n\r\nConnect to the database and check for the added annotation in the annotations table. (I am able to see it there)\r\n\r\n**Step 5**:\r\n\r\nRestart the Grafana deployment and the annotation will disappear from database.\r\n\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\nhelm.sh/chart=grafana-6.56.5\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\r\n\r\n### Grafana Platform?\r\n\r\nKubernetes\r\n\r\n### User's OS?\r\n\r\n_No response_\r\n\r\n### User's Browser?\r\n\r\n_No response_\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\n_No response_\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["area/annotations","area/backend","triage/needs-confirmation"]},{"id":68171,"title":"Ms Teams contact point integration returns 413 Request Entity Too Large when the alerting message contains several alerts.","body":"### \n# What went wrong?\n\n\n**What happened**:\r\nWe had an incident that generated a lot of error logs, which in turn triggered sending notifications to our contact points. The email was sent correctly, however the msteam integration returned Http error 413 Request Entity Too Large.\r\n\r\n**What did you expect to happen**:\r\nEither for the alert to be chunked or for it to send only what the limit of the message allows.\r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Add an alerting rule that will capture a lot of messages.\r\n\r\n**Step 2**:\r\n\r\n- Have it trigger sending to MS Teams.\r\n\r\n**Step 3**:\r\n\r\n- Wait for it to try and send, and you will receive the 413 Http error.\r\n\n\n### \n# What Grafana version are you using?\n\n\nv9.4.3\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\n_No response_\n\n### Grafana Platform?\n\nKubernetes\n\n### User's OS?\n\n_No response_\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["area/alerting/notifications","bot/no new info"]},{"id":75763,"title":"Search: Keypresses lost when typing quickly in slow browser","body":"### What happened?\n\nWhen using the search bar up top on a slow computer, keypresses are often lost when searching. I've not encountered this anywhere else in the Grafana UI. So I might type `dashboard`, but the search input will receive `dabrd` in extreme cases. This is extremely annoying because there's no fuzzy search.\n\n### What did you expect to happen?\n\nI expect no characters to be lost.\n\n### Did this work before?\n\nIt worked without issues when we were on Grafana 8.4, but after upgrading to 10+ with the new search, the issue appeared.\n\n### How do we reproduce it?\n\n1. Have low powered machine\r\n2. Type quickly into search\r\n3. See characters being lost\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.x (seen on 10.0 as well as two other 10.x releases)\r\nOS: Windows 10\r\nBrowser: Chrome\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\n_No response_","labels":["type/bug","area/search"]},{"id":64692,"title":"Error type for locked database points to datasource as the problem","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nGetting datasource error alerts:\r\n![image](https://user-images.githubusercontent.com/8493275/224737570-071d5cdc-ec8f-4c28-a5b6-133cf9426a21.png)\r\n\r\n\r\n**What you expected to happen**:\r\n\r\nThe issue here is this shows a `DatasourceError` error type, but it is not a data source error. Please create a new exception type that implies the Grafana database and not the data source. Maybe a new error type like `GrafanaDatabaseLockedError` or something as it points people in the direction of a data source as the problem.\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.6\r\n- Data source type \u0026 version: Victoria Metrics / Prometheus\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/bug","area/backend/config","area/alerting","area/backend/db/sqlite"]},{"id":64595,"title":"Grafana 9.4 dashboard provisioning not working","body":"After upgrade on Grafana 9.4.x   provisioning of dashboards doesn't working.\r\n\r\nI get this error\r\n\r\n`logger=provisioning t=2023-03-10T11:44:26.104835139+01:00 level=error msg=\"Failed to provision dashboard\" error=\"Failed to provision dashboards: failed to provision config bare_metal_servers_2: UNIQUE constraint failed: dashboard.org_id, dashboard.folder_id, dashboard.title\"\r\nlogger=server t=2023-03-10T11:44:26.104947224+01:00 level=error msg=\"Stopped background service\" service=*provisioning.ProvisioningServiceImpl reason=\"Failed to provision dashboards: failed to provision config bare_metal_servers_2: UNIQUE constraint failed: dashboard.org_id, dashboard.folder_id, dashboard.title\"\r\nlogger=ticker t=2023-03-10T11:44:26.105017023+01:00 level=info msg=stopped last_tick=2023-03-10T11:44:20+01:00\r\nlogger=tracing t=2023-03-10T11:44:26.105187299+01:00 level=info msg=\"Closing tracing\"\r\n`\r\n\r\nI have lot of provisoning dashboards. For example, configuration of two of them:\r\n\r\n```\r\ncat /etc/grafana/provisioning/dashboards/bare_metal_servers_2.yaml \r\napiVersion: 1\r\n\r\nproviders:\r\n - name: 'bare_metal_servers_2'\r\n   orgId: 2\r\n   folder: 'bare_metal_servers'\r\n   type: 'file'\r\n   updateIntervalSeconds: 30\r\n   options:\r\n     path: /var/lib/grafana/dashboards/bare_metal_servers_2/\r\n\r\n```\r\n\r\n\r\n```\r\ncat /etc/grafana/provisioning/dashboards/bare_metal_servers_3.yaml \r\n\r\napiVersion: 1\r\n\r\nproviders:\r\n - name: 'bare_metal_servers_3'\r\n   orgId: 3\r\n   folder: 'bare_metal_servers'\r\n   type: 'file'\r\n   updateIntervalSeconds: 30\r\n   options:\r\n     path: /var/lib/grafana/dashboards/bare_metal_servers_3/\r\n\r\n```\r\n\r\n\r\nOn the version 9.3.8 the provisioning works. I didn't find that the provisioning of dashboards changed in version 9.4.x. It's feature or bug?\r\n\r\n\r\n\r\n","labels":["type/bug","prio/high","area/dashboard","area/provisioning"]},{"id":49704,"title":"Table Panel, horizontal scroll bar disappeared","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nWhen enable paging, on Table Panel, the horizontal scroll bar, in the footer of table, disappeared.\r\n\r\n**What you expected to happen**:\r\n\r\nThe horizontal scroll bar remain visible\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nUse a table with many column\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.5.3 OSS\r\n- Data source type \u0026 version: OpenSearch 1.1.2\r\n- OS Grafana is installed on: RedHat 8.3\r\n- User OS \u0026 Browser: Windows 10, Chrome and Firefox\r\n- Grafana plugins:\r\n- Others:\r\n![Cattura1](https://user-images.githubusercontent.com/66841577/170498896-31d62bc0-2191-449d-8fa2-6a6c8bfc4f93.PNG)\r\n\r\n![Cattura2](https://user-images.githubusercontent.com/66841577/170499145-b2fd6bdb-a224-4a4a-93af-0b6b267a6bd8.PNG)\r\n\r\n","labels":["needs more info","area/panel/table"]},{"id":66087,"title":"Non-blank value for UID required by Alerting Provisioning HTTP API for removing default contact point","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nTrying to provision contact points from source code configurations and cleaning up anything users may have created to ensure consistency from code to instance.\r\n\r\n**What you expected to happen**:\r\n\r\nWe expect to be able to delete the default contact point after updating the root notification policy to a different contact point. However, the UID of the default contact point is blank, and the API needs a non-blank one. \r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nStep 1: Update the root notification policy to a non-default contact point.\r\n\r\nStep 2: List the contact-points\r\n\r\n```\r\ncurl https://admin:pwd@grafana-hostname.companyname.com/api/v1/provisioning/contact-points\r\n\r\n    {\r\n        \"uid\": \"\",\r\n        \"name\": \"email receiver\",\r\n        \"type\": \"email\",\r\n        \"settings\": {\r\n            \"addresses\": \"\\u003cexample@email.com\\u003e\"\r\n        },\r\n        \"disableResolveMessage\": false\r\n    }\r\n```    \r\nStep 3: remove the Contact point with a blank UID.\r\n\r\n```\r\ncurl -X DELETE https://admin:pwd@grafana-hostname.companyname.com/api/v1/provisioning/contact-points/\r\n{\"message\":\"Not found\"}\r\n```\r\nNote that the documentation mentioned a UID is required at the end of the URL, after \"contact-points/{UID}\" and we can't provide it as it's blank.\r\n\r\n**Anything else we need to know?**:\r\n\r\nThe change request is here in the Pull Request:\r\nhttps://github.com/grafana/grafana/pull/66089\r\n\r\n**Environment**: Not applicable\r\n- Grafana version: Grafana enterprise 9.4.7 \r\n- Data source type \u0026 version: Not applicable\r\n- OS Grafana is installed on: Not applicable\r\n- User OS \u0026 Browser: Not applicable\r\n- Grafana plugins: Not applicable\r\n- Others: Not applicable\r\n","labels":["area/alerting"]},{"id":71182,"title":"ServeFromSubPath: infinite redirect","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n  - Getting infinite redirect loop when loading Grafana from sub path\r\n\r\n`ERR_TOO_MANY_REDIRECTS`\r\n\r\nWhen I revert [this commit](57701fd2f28f95f545569e6173b90050dc0e2913) it works fine.\r\n\r\n**What did you expect to happen**:\r\n\r\n  - Grafana load\r\n\r\nThis worked in v9 but does not work in v10.\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\nStart grafana via docker compose with following variables:\r\n\r\n```\r\n      GF_LIVE_ALLOWED_ORIGINS: https://*my.domain.com\r\n      GF_SERVER_ROOT_URL: https://sth.my.domain.com/grafana/\r\n      GF_SERVER_SERVE_FROM_SUB_PATH: \"true\"\r\n```\r\n\r\n**Step 2**:\r\n\r\n- Load grafana from subpath (https://sth.my.domain.com/grafana/) as it gives infinite redirect loop\r\n\n\n### \n# What Grafana version are you using?\n\n\n57701fd2f28f95f545569e6173b90050dc0e2913\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\n_No response_\n\n### Grafana Platform?\n\nDocker\n\n### User's OS?\n\nMacos, Linux\n\n### User's Browser?\n\nChrome\n\n### Is this a Regression?\n\nYes\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["needs more info","area/backend"]},{"id":77050,"title":"Core: Go panic/SIGSEGV","body":"### What happened?\n\n```\r\nlogger=ngalert.multiorg.alertmanager t=2023-10-24T13:40:41.924703616Z level=error msg=\"unable to create Alertmanager for org\" org=1 error=\"error writing file notifications: open /var/lib/grafana/alerting/1/notifications: permission denied\"\r\nlogger=cli t=2023-10-24T13:40:41.931976009Z level=error msg=\"Critical error\" reason=\"runtime error: invalid memory address or nil pointer dereference\" stackTrace=\"goroutine 1 [running]:\\nruntime/debug.Stack()\\n\\truntime/debug/stack.go:24 +0x65\\ngithub.com/grafana/grafana/pkg/cmd/grafana-server/commands.RunServer.func3()\\n\\tgithub.com/grafana/grafana/pkg/cmd/grafana-server/commands/cli.go:181 +0x9c\\npanic({0x98e5e0, 0x9621f80})\\n\\truntime/panic.go:890 +0x263\\ngithub.com/grafana/grafana/pkg/services/ngalert/notifier.(*Alertmanager).ApplyConfig(0x0, {0x1f0f808, 0xc0015c4120}, 0xc000a0e910)\\n\\tgithub.com/grafana/grafana/pkg/services/ngalert/notifier/alertmanager.go:233 +0x11b\\ngithub.com/grafana/grafana/pkg/services/ngalert/notifier.(*MultiOrgAlertmanager).SyncAlertmanagersForOrgs(0xc0013cef00, {0x1f0f808, 0xc0015c4120}, {0xc001438868, 0x1, 0x1f170c0?})\\n\\tgithub.com/grafana/grafana/pkg/services/ngalert/notifier/multiorg_alertmanager.go:239 +0x77f\\ngithub.com/grafana/grafana/pkg/services/ngalert/notifier.(*MultiOrgAlertmanager).LoadAndSyncAlertmanagersForOrgs(0xc0013cef00, {0x1f0f808, 0xc0015c4120})\\n\\tgithub.com/grafana/grafana/pkg/services/ngalert/notifier/multiorg_alertmanager.go:171 +0xd8\\ngithub.com/grafana/grafana/pkg/services/ngalert.(*AlertNG).init(0xc0015b1040)\\n\\tgithub.com/grafana/grafana/pkg/services/ngalert/ngalert.go:170 +0x305\\ngithub.com/grafana/grafana/pkg/services/ngalert.ProvideService(_, {_, _}, {_, _}, {_, _}, {_, _}, {0x1f326a0, ...}, ...)\\n\\tgithub.com/grafana/grafana/pkg/services/ngalert/ngalert.go:103 +0x5c9\\ngithub.com/grafana/grafana/pkg/server.Initialize({{0x7fff0966ad4c, 0x18}, {0x7fff0966ad30, 0x12}, {0xc00117e180, 0x6, 0x6}}, {{0x0, 0x0}, {0x0, ...}, ...}, ...)\\n\\tgithub.com/grafana/grafana/pkg/server/wire_gen.go:481 +0x4e4e\\ngithub.com/grafana/grafana/pkg/cmd/grafana-server/commands.RunServer({{0x1eb3db0, 0x6}, {0x1eb51d8, 0xa}, {0x1eb3da8, 0x4}, {0x1eb51c8, 0xa}, 0xc0006d8300})\\n\\tgithub.com/grafana/grafana/pkg/cmd/grafana-server/commands/cli.go:228 +0xfea\\ngithub.com/grafana/grafana/pkg/cmd/grafana-server/commands.ServerCommand.func1(0xc0010bfb10?)\\n\\tgithub.com/grafana/grafana/pkg/cmd/grafana-server/commands/cli.go:97 +0xc5\\ngithub.com/urfave/cli/v2.(*Command).Run(0xc0010dd8c0, 0xc0006d8300, {0xc000740e10, 0x9, 0x9})\\n\\tgithub.com/urfave/cli/v2@v2.25.0/command.go:273 +0x9eb\\ngithub.com/urfave/cli/v2.(*Command).Run(0xc0010ddb80, 0xc0006d80c0, {0xc0001a6000, 0xa, 0xa})\\n\\tgithub.com/urfave/cli/v2@v2.25.0/command.go:266 +0xc4d\\ngithub.com/urfave/cli/v2.(*App).RunContext(0xc0009f9860, {0x1f0f7d0?, 0xc0001a8000}, {0xc0001a6000, 0xa, 0xa})\\n\\tgithub.com/urfave/cli/v2@v2.25.0/app.go:332 +0x616\\ngithub.com/urfave/cli/v2.(*App).Run(...)\\n\\tgithub.com/urfave/cli/v2@v2.25.0/app.go:309\\nmain.main()\\n\\tgithub.com/grafana/grafana/pkg/cmd/grafana/main.go:39 +0x285\\n\"\r\npanic: runtime error: invalid memory address or nil pointer dereference [recovered]\r\n\tpanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x71d12db]\r\n\r\ngoroutine 1 [running]:\r\ngithub.com/grafana/grafana/pkg/cmd/grafana-server/commands.RunServer.func3()\r\n\tgithub.com/grafana/grafana/pkg/cmd/grafana-server/commands/cli.go:182 +0x17e\r\npanic({0x98e5e0, 0x9621f80})\r\n\truntime/panic.go:890 +0x263\r\ngithub.com/grafana/grafana/pkg/services/ngalert/notifier.(*Alertmanager).ApplyConfig(0x0, {0x1f0f808, 0xc0015c4120}, 0xc000a0e910)\r\n\tgithub.com/grafana/grafana/pkg/services/ngalert/notifier/alertmanager.go:233 +0x11b\r\ngithub.com/grafana/grafana/pkg/services/ngalert/notifier.(*MultiOrgAlertmanager).SyncAlertmanagersForOrgs(0xc0013cef00, {0x1f0f808, 0xc0015c4120}, {0xc001438868, 0x1, 0x1f170c0?})\r\n\tgithub.com/grafana/grafana/pkg/services/ngalert/notifier/multiorg_alertmanager.go:239 +0x77f\r\ngithub.com/grafana/grafana/pkg/services/ngalert/notifier.(*MultiOrgAlertmanager).LoadAndSyncAlertmanagersForOrgs(0xc0013cef00, {0x1f0f808, 0xc0015c4120})\r\n\tgithub.com/grafana/grafana/pkg/services/ngalert/notifier/multiorg_alertmanager.go:171 +0xd8\r\ngithub.com/grafana/grafana/pkg/services/ngalert.(*AlertNG).init(0xc0015b1040)\r\n\tgithub.com/grafana/grafana/pkg/services/ngalert/ngalert.go:170 +0x305\r\ngithub.com/grafana/grafana/pkg/services/ngalert.ProvideService(_, {_, _}, {_, _}, {_, _}, {_, _}, {0x1f326a0, ...}, ...)\r\n\tgithub.com/grafana/grafana/pkg/services/ngalert/ngalert.go:103 +0x5c9\r\ngithub.com/grafana/grafana/pkg/server.Initialize({{0x7fff0966ad4c, 0x18}, {0x7fff0966ad30, 0x12}, {0xc00117e180, 0x6, 0x6}}, {{0x0, 0x0}, {0x0, ...}, ...}, ...)\r\n\tgithub.com/grafana/grafana/pkg/server/wire_gen.go:481 +0x4e4e\r\ngithub.com/grafana/grafana/pkg/cmd/grafana-server/commands.RunServer({{0x1eb3db0, 0x6}, {0x1eb51d8, 0xa}, {0x1eb3da8, 0x4}, {0x1eb51c8, 0xa}, 0xc0006d8300})\r\n\tgithub.com/grafana/grafana/pkg/cmd/grafana-server/commands/cli.go:228 +0xfea\r\ngithub.com/grafana/grafana/pkg/cmd/grafana-server/commands.ServerCommand.func1(0xc0010bfb10?)\r\n\tgithub.com/grafana/grafana/pkg/cmd/grafana-server/commands/cli.go:97 +0xc5\r\ngithub.com/urfave/cli/v2.(*Command).Run(0xc0010dd8c0, 0xc0006d8300, {0xc000740e10, 0x9, 0x9})\r\n\tgithub.com/urfave/cli/v2@v2.25.0/command.go:273 +0x9eb\r\ngithub.com/urfave/cli/v2.(*Command).Run(0xc0010ddb80, 0xc0006d80c0, {0xc0001a6000, 0xa, 0xa})\r\n\tgithub.com/urfave/cli/v2@v2.25.0/command.go:266 +0xc4d\r\ngithub.com/urfave/cli/v2.(*App).RunContext(0xc0009f9860, {0x1f0f7d0?, 0xc0001a8000}, {0xc0001a6000, 0xa, 0xa})\r\n\tgithub.com/urfave/cli/v2@v2.25.0/app.go:332 +0x616\r\ngithub.com/urfave/cli/v2.(*App).Run(...)\r\n\tgithub.com/urfave/cli/v2@v2.25.0/app.go:309\r\nmain.main()\r\n\tgithub.com/grafana/grafana/pkg/cmd/grafana/main.go:39 +0x285\r\n```\n\n### What did you expect to happen?\n\nGrafana should launch\n\n### Did this work before?\n\nThis worked until I moved Docker volumes.\n\n### How do we reproduce it?\n\n1. Make a new volume for grafana data\r\n2. Make temp container with any OS (such as alpine) with both old and new volumes mounted\r\n3. `cp -r /src/* /dest`\r\n4. Use new container with grafana\n\n### Is the bug inside a dashboard panel?\n\nNo\n\n### Environment (with versions)?\n\nGrafana: 10.2.0\r\nOS: Ubuntu 22/04\r\nBrowser: N/A\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\nPrometheus","labels":["area/backend"]},{"id":88875,"title":"Grafana Label Values: not matching metrics and label filters","body":"### What happened?\n\n[Uploading Video 6-06 at 15.19.webm…]()\r\n\r\nthe label values in a dashboard does not match metrics and label filters\n\n### What did you expect to happen?\n\nthe label values should change according to the metric and label filters specified. but it doesnt.\n\n### Did this work before?\n\nOn 10.4.3 i was able to select label values according to metric and label filters\n\n### How do we reproduce it?\n\n1. on a dahsboard click on dashboard settings\r\n2. click on variables tab\r\n3. click on new variable\r\n4. Data source = Prometheus\r\n5. select \"Label Values\" as Query type\r\n6. select a label, check \"preview of values\"\r\n7. select a metric, the \"preview of values\" remains unchanged\r\n8. type a wrong metric name, \"preview of values\" remains unchanged\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 11.0.0\r\nOS: CentOS 8\r\nBrowser: Google Chrome Version 125.0.6422.112 (Official Build) (64-bit)\r\n\n\n### Grafana platform?\n\nI don't know\n\n### Datasource(s)?\n\nPrometheus","labels":["type/bug","area/dashboard/templating","needs more info","datasource/Prometheus","area/configuration"]},{"id":49469,"title":"Grafana short URL throws a 404 for some random links","body":"**What happened**:\r\n- When creating a short URL and clicking the *COPY* button on the overlay window, the URL does not gets copied. This issue is persistence and happens almost everytime\r\n- On visiting the short URL (created) for a dashboard, Grafana throws a 404. For example for the link https://my.domain.com/grafana/goto/EBI_cRw7z?orgId=1 we get below page\r\n\r\n![Screenshot 2022-05-24 at 09 37 47](https://user-images.githubusercontent.com/34666636/169978927-60ff2edf-1d71-46b2-92f6-ccdcd132a688.png)\r\n\r\nEnable trace for logs does not give any meaningful information as to why this is a 404\r\n```bash\r\nt=2022-05-24T10:05:13+0200 lvl=info msg=\"Request Completed\" logger=context userId=0 orgId=0 uname= method=GET path=/goto/EBI_cRw7z status=302 remote_addr=aa.bb.cc.dd time_ms=1 size=37 referer=\r\n```\r\nOnly thing I can note here is the field `userId` is set to `0` whereas the user which I used to login has `userId=224`. We have provisioned grafana to use LDAP authentication and no dashboard cam be accessed without authentication. So, I would expected to see my userId(224 and not 0) in the logs. This does happen when I view a working short URL.\r\n\r\nFor example, when visiting the URL at `https://my.domain.com/grafana/goto/BcyVdju7k?orgId=1`, in the logs I can see\r\n```bash\r\nt=2022-05-24T10:13:14+0200 lvl=info msg=\"Request Completed\" logger=context userId=224 orgId=1 uname=\"John, Doe\" method=GET path=/goto/BcyVdju7k status=302 remote_addr=aa.bb.cc.dd time_ms=56 size=142 referer=\r\n```\r\n\r\nAfter checking the database, the short URL is not available in DB. But we definitely created one and made no changes to DB. So, perhaps the issue is when saving the short URL?\r\n```sql\r\nSELECT * FROM SHORT_URL WHERE UID = 'BcyVdju7k'; -- returns one entry\r\nSELECT * FROM SHORT_URL WHERE UID = 'EBI_cRw7z'; -- returns no entry\r\n```\r\n\r\n\r\n**What you expected to happen**:\r\nThe link for short URL should work and take me to the actual dashboard with all the filters (time and variables) applied.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nThe issue happens randomly for few URLs. We continue to look for steps for reproducing this but have not found a way yet.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: _Grafana (OSS) v8.3.2 (afb9e8e5f3)_\r\n- Data source type \u0026 version:\r\n  - ElasticSearch\r\n  - InfluxDB\r\n  - Prometheus\r\n- OS Grafana is installed on: _Oracle Linux Server v6.10_\r\n- User OS \u0026 Browser: _MacOS/ Windows and Chrome/Safari/Firefox_\r\n- Grafana plugins: _The list of installed plugins is given below. We don't suspect the issue is to do with any specific plugin._\r\n  - Alert list\r\n  - Annotation list\r\n  - Azure monitor\r\n  - Bar chart\r\n  - Bar gauge\r\n  - Candlestick\r\n  - Cloudwatch\r\n  - Dashboard list\r\n  - Elastic Search\r\n  - Gauge\r\n  - Geomap\r\n  - Getting started\r\n  - Google cloud monitoring\r\n  - Graph (old)\r\n  - Graphite\r\n  - Heatmap\r\n  - Histogram\r\n  - InfluxDB\r\n  - Jaegar\r\n  - Logs\r\n  - Loki\r\n  - Microsoft SQL server\r\n  - MySQL\r\n  - News\r\n  - Node graph\r\n  - OpenTSDB\r\n  - Pie Chart\r\n  - Plugin List\r\n  - PostgreSQL\r\n  - Prometheus\r\n  - Stat\r\n  - Stat timeline\r\n  - Status (history)\r\n  - Table\r\n  - Table (old)\r\n  - Temp\r\n  - Testdata DB\r\n  - Text\r\n  - Time series\r\n  - Welcome\r\n  - Zipkin\r\n- Grafana Persistence: _We use MySQL for persistence. MySQL v8.0.12 (Community edition)_\r\n","labels":["needs more info","area/auth/ldap","area/dashboard/links"]},{"id":44009,"title":"External snapshots don't delete on the external snapshot grafana instance","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWhen you use an external snapshot instance, and delete a snapshot (from the normal grafana instance), the snapshot (on the external instance) is not deleted.\r\n\r\n**What you expected to happen**:\r\nThe snapshot should be delete on both the local instance and the external instance.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nHave 2 grafana instances, set up external snapshots, create dashboard, snapshot dashboard, view on external, delete from local, view on external again (is still there)\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**: \r\n- Grafana version: 8.3.3\r\n- Data source type \u0026 version: Grafana test datasource (with random timeseries)\r\n- OS Grafana is installed on: Docker container / k8s\r\n- User OS \u0026 Browser: Firefox/Chrome\r\n- Grafana plugins: None\r\n- Others:\r\n","labels":["needs more info","area/dashboard/snapshot"]},{"id":72310,"title":"Alerting: No image seems to be sent with an alert","body":"### What happened?\r\n\r\nWhen sending a test alert or a real alert, no image is sent/generated. The alert is sent successfully (on Discord in my case) but the image does not seem to be generated at any point. I tried via the plugin by building a custom Docker image or with a container with the image \"grafana/grafana-image-renderer\" but without success.\r\n\r\nI think my configuration is ok, when I try to generate an image by selecting \"Share\" on a panel and then clicking on \"Direct link rendered image\", an image is generated correctly. I followed the documentation to configure this system. \r\n![image](https://github.com/grafana/grafana/assets/24718500/00ab9017-e923-4744-8443-2f8a0b859b42)\r\n\r\n- Docker Compose :\r\n![image](https://github.com/grafana/grafana/assets/24718500/8d6dc709-3443-4d00-b2dc-f70abeb61673)\r\n\r\n- Test Alert : \r\n![image](https://github.com/grafana/grafana/assets/24718500/e13d513f-4118-4522-b49e-2029efce3f81)\r\n\r\n- Result with a test alert: \r\n\u003cimg width=\"704\" alt=\"image\" src=\"https://github.com/grafana/grafana/assets/24718500/9323a5f6-7b80-477b-b6bf-7eb97f2598bb\"\u003e\r\n\r\n- Docker log : \r\n![image](https://github.com/grafana/grafana/assets/24718500/5e16b100-0627-427d-9ccb-b46a5b0f3ee0)\r\n\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nAn image of the panel is supposed to be sent with the alert.\r\n\r\n### Did this work before?\r\n\r\nI've just started using Grafana, and this is the first time I've tried to set up this system. So I can't answer this question.\r\n\r\n### How do we reproduce it?\r\n\r\n1. Create a contact point in \"Alerting\" (I tested with Discord \u0026 Pushover).\r\n2. Try to send a test notification.\r\n3. See that no image is sent to the contact point.\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: v10.0.2\r\nOS: Docker on Ubuntu 20.04.6 with WSL \r\nBrowser: Chrome / Brave\r\n\r\n\r\n### Grafana platform?\r\n\r\nDocker\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/alerting/notifications","area/alerting/screenshots"]},{"id":58290,"title":"Config: Datasources url is not honoring root_url when using sub-path","body":"**What happened**:\r\nWhen navigating to /datasources page the datasources components being generated aren't honoring the root_url\r\nThis isn't immediately noticeable, as the javascript intercepts the request if you click it.\r\nHowever, if you Ctrl/Cmd + Click the link (or \"copy the link\", or open the source in developer tools) you see the URLs generated for the datasources are not honouring the root_url setting.\r\n\r\n\r\n**What you expected to happen**:\r\nI expect the same behaviour as the /plugins which generates the list of plugins with correct urls (i.e. honouring root_url).\r\nInstead of all links starting with /datasources, I expect links to honour root_url/datasources\r\nIn the below case, this would mean root_url/grafana/datasources and not root_url/grafana\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nIf using the container just use the env vars:\r\nGF_SERVER_ROOT_URL=%(protocol)s://%(domain)s/grafana\"\r\nGF_SERVE_FROM_SUB_PATH=true\r\nMy datasources are pre-provisioned with a datasources.yml file in /etc/grafana/provisioning\r\n\r\n**Anything else we need to know?**:\r\nI believe this is something to do with\r\nLine 74 of DataSourcesList (in main - current commit 3f654b932abbd82532c58850fa0126ac23533be1)\r\n              \u003cCard href={dataSourcesRoutes.Edit.replace(/:uid/gi, dataSource.uid)}\u003e\r\nhttps://github.com/grafana/grafana/blob/bdb8fe3b025f8f5eb11d85f8287901e73ac4b35b/public/app/features/datasources/components/DataSourcesList.tsx#L74\r\n\r\nI currently have a lot to handle but, if this is the bug source, I could probably pick this up in the beginning of 12/2022. \r\nI am more versed in VueJS than React however, so feel free to pick it up\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.3 (docker tag)\r\n- Data source type \u0026 version: All\r\n- OS Grafana is installed on: Official Docker image\r\n- User OS \u0026 Browser: Windows + firefox + chrome\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/bug","area/backend/config","area/backend"]},{"id":65695,"title":"Canvas Panel: Add image with dashboard variables","body":"Dear grafana community,\r\n\r\nunfortunately, it is not possible atm to add to a rectangle with dynamic background-image URL to a Canvas panel.\r\n\r\n[Screenshot](https://i.ibb.co/9bpSfm4/Canvas-Screen.png)\r\n\r\nTest link for dynamic image generation: https://dummyimage.com/600x400/000/fff\u0026text=${grafanaVar}\r\n\r\nReproduce:\r\n1. create a canvas panel.\r\n2. add a rectangle, and go to `background \u003e image \u003e source: fixed`\r\n3. try to add a dynamic URL with a dashboard variable.\r\n\r\ncheers,\r\nyulipumal\r\n","labels":["bot/no new info","area/panel/canvas"]},{"id":45459,"title":"valueString webhook body is empty","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n**What happened**:\r\nWe set up an ngalert webhook and processing the webhook calls.\r\n`fired` event: `valueString` is always empty\r\n`resolved` event: `valueString` is sometimes empty, sometimes filled. Circumstances unclear.\r\n\r\n\r\n**What you expected to happen**:\r\nvalueString should not be empty in `firing` event\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n\r\n![screencapture](https://user-images.githubusercontent.com/6129115/154251758-c76aa288-89e6-4351-8734-901a9b235b0f.png)\r\n\r\n```js\r\n{\r\n  receiver: 'Telegram default',\r\n  status: 'firing',\r\n  alerts: [\r\n    {\r\n      status: 'firing',\r\n      labels: {\r\n        alertname: '************** fails alert',\r\n        rule_uid: 'YTSsr3-7k'\r\n      },\r\n      annotations: {},\r\n      startsAt: '2022-02-16T10:45:32.088827563Z',\r\n      endsAt: '0001-01-01T00:00:00Z',\r\n      generatorURL: 'https://grafana.local/alerting/YTSsr3-7k/edit',\r\n      fingerprint: 'b566c0d7267af169',\r\n      silenceURL: 'https://grafana.local/alerting/silence/new?alertmanager=grafana\u0026matchers=alertname%3DUnblocked+minion+fails+alert%2Crule_uid%3DYTSsr3-7k',\r\n      dashboardURL: 'https://grafana.local/d/SoBr6vTmk',\r\n      panelURL: 'https://grafana.local/d/SoBr6vTmk?viewPanel=7',\r\n      valueString: ''\r\n    }\r\n  ],\r\n  groupLabels: {\r\n    __alert_rule_uid__: 'YTSsr3-7k',\r\n    alertname: '************** fails alert',\r\n    rule_uid: 'YTSsr3-7k'\r\n  },\r\n  commonLabels: { alertname: '************** fails alert', rule_uid: 'YTSsr3-7k' },\r\n  commonAnnotations: {},\r\n  externalURL: 'https://grafana.local/',\r\n  version: '1',\r\n  groupKey: '{}:{__alert_rule_uid__=\"YTSsr3-7k\", alertname=\"************** fails alert\", rule_uid=\"YTSsr3-7k\"}',\r\n  truncatedAlerts: 0,\r\n  orgId: 1,\r\n  title: '[FIRING:1] ************** fails alert YTSsr3-7k YTSsr3-7k ',\r\n  state: 'alerting',\r\n  message: '**Firing**\\n' +\r\n    '\\n' +\r\n    'Value: [no value]\\n' +\r\n    'Labels:\\n' +\r\n    ' - alertname = ************** fails alert\\n' +\r\n    ' - rule_uid = YTSsr3-7k\\n' +\r\n    'Annotations:\\n' +\r\n    'Source: https://grafana.local/alerting/YTSsr3-7k/edit\\n' +\r\n    'Silence: https://grafana.local/alerting/silence/new?alertmanager=grafana\u0026matchers=alertname%3DUnblocked+minion+fails+alert%2Crule_uid%3DYTSsr3-7k\\n' +\r\n    'Dashboard: https://grafana.local/d/SoBr6vTmk\\n' +\r\n    'Panel: https://grafana.local/d/SoBr6vTmk?viewPanel=7\\n'\r\n}\r\n```\r\n```js\r\n{\r\n  receiver: 'Telegram default',\r\n  status: 'resolved',\r\n  alerts: [\r\n    {\r\n      status: 'resolved',\r\n      labels: {\r\n        alertname: '************** fails alert',\r\n        rule_uid: 'YTSsr3-7k'\r\n      },\r\n      annotations: {},\r\n      startsAt: '2022-02-16T10:45:32.088827563Z',\r\n      endsAt: '2022-02-16T10:48:02.088827563Z',\r\n      generatorURL: 'https://grafana.local/alerting/YTSsr3-7k/edit',\r\n      fingerprint: 'b566c0d7267af169',\r\n      silenceURL: 'https://grafana.local/alerting/silence/new?alertmanager=grafana\u0026matchers=alertname%3DUnblocked+minion+fails+alert%2Crule_uid%3DYTSsr3-7k',\r\n      dashboardURL: 'https://grafana.local/d/SoBr6vTmk',\r\n      panelURL: 'https://grafana.local/d/SoBr6vTmk?viewPanel=7',\r\n      valueString: ''\r\n    }\r\n  ],\r\n  groupLabels: {\r\n    __alert_rule_uid__: 'YTSsr3-7k',\r\n    alertname: '************** fails alert',\r\n    rule_uid: 'YTSsr3-7k'\r\n  },\r\n  commonLabels: { alertname: '************** fails alert', rule_uid: 'YTSsr3-7k' },\r\n  commonAnnotations: {},\r\n  externalURL: 'https://grafana.local/',\r\n  version: '1',\r\n  groupKey: '{}:{__alert_rule_uid__=\"YTSsr3-7k\", alertname=\"************** fails alert\", rule_uid=\"YTSsr3-7k\"}',\r\n  truncatedAlerts: 0,\r\n  orgId: 1,\r\n  title: '[RESOLVED] ************** fails alert YTSsr3-7k YTSsr3-7k ',\r\n  state: 'ok',\r\n  message: '**Resolved**\\n' +\r\n    '\\n' +\r\n    'Value: [no value]\\n' +\r\n    'Labels:\\n' +\r\n    ' - alertname = ************** fails alert\\n' +\r\n    ' - rule_uid = YTSsr3-7k\\n' +\r\n    'Annotations:\\n' +\r\n    'Source: https://grafana.local/alerting/YTSsr3-7k/edit\\n' +\r\n    'Silence: https://grafana.local/alerting/silence/new?alertmanager=grafana\u0026matchers=alertname%3DUnblocked+minion+fails+alert%2Crule_uid%3DYTSsr3-7k\\n' +\r\n    'Dashboard: https://grafana.local/d/SoBr6vTmk\\n' +\r\n    'Panel: https://grafana.local/d/SoBr6vTmk?viewPanel=7\\n'\r\n}\r\n```\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.6\r\n- Data source type \u0026 version: InfluxDB 1.8.10\r\n- OS Grafana is installed on: Ubuntu 20.04\r\n- User OS \u0026 Browser: Manjaro, Chrome\r\n- Grafana plugins: -\r\n- Others: -\r\n","labels":["type/bug","prio/high","area/alerting/notifications"]},{"id":56167,"title":"Repeat by variable not working correctly when series name cointains: space or double quotes or point characters","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWhen you use a variable that contains period, double quote, or space characters and use it as a repeat variable, the content of the panel is not filtered correctly.\r\n\r\n**What you expected to happen**:\r\nThe panels must show the correct data\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nPut this in OpenSearch:\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861202-1\"} }\r\n{\"field1\":9861202,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST_TEST1\",\"field3\":100}\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861203-1\"} }\r\n{\"field1\":9861203,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST_TEST1\",\"field3\":101}\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861204-1\"} }\r\n{\"field1\":9861204,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST_TEST1\",\"field3\":101}\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861205-1\"} }\r\n{\"field1\":9861205,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST_TEST2\",\"field3\":100}\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861206-1\"} }\r\n{\"field1\":9861206,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST_TEST2\",\"field3\":101}\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861207-1\"} }\r\n{\"field1\":9861207,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST_TEST2\",\"field3\":101}\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861208-1\"} }\r\n{\"field1\":9861208,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST_TEST3\",\"field3\":100}\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861209-1\"} }\r\n{\"field1\":9861209,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST_TEST3\",\"field3\":101}\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861210-1\"} }\r\n{\"field1\":9861210,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST_TEST3\",\"field3\":101}\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861212-1\"} }\r\n{\"field1\":9861212,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST-TEST1\",\"field3\":100}\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861213-1\"} }\r\n{\"field1\":9861213,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST-TEST1\",\"field3\":101}\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861214-1\"} }\r\n{\"field1\":9861214,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST-TEST1\",\"field3\":101}\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861215-1\"} }\r\n{\"field1\":9861215,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST-TEST2\",\"field3\":100}\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861216-1\"} }\r\n{\"field1\":9861216,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST-TEST2\",\"field3\":101}\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861217-1\"} }\r\n{\"field1\":9861217,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST-TEST2\",\"field3\":101}\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861218-1\"} }\r\n{\"field1\":9861218,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST-TEST3\",\"field3\":100}\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861219-1\"} }\r\n{\"field1\":9861219,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST-TEST3\",\"field3\":101}\r\n{ \"index\":{\"_index\":\"test\",\"_id\":\"9861220-1\"} }\r\n{\"field1\":9861220,\"timestamp\":\"2022-10-02T15:15:00.000Z\",\"field2\":\"TEST-TEST3\",\"field3\":101}\r\n\r\nCreate a datasource to this index\r\n\r\nCreate a new dashboard\r\n\r\nCreate a new variable with field2 name and this query:  {\"find\": \"terms\", \"field\": \"field2.keyword\"}\r\nFor this variable set \"Multi-value\" and \"Include All option\"\r\n\r\nAdd a new table panel whith:\r\nQuery Lucene: field2:$field2\r\nMetric: Raw Data\r\n\r\nIn Panel options -\u003e Repeat options select field2\r\n\r\nSave \u0026 Refresh dashboard\r\n\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.1.2\r\n- Data source type \u0026 version: OpenSearch 2.0.0\r\n- OS Grafana is installed on: Linux Red Hat 8.3.1-5\r\n- User OS \u0026 Browser: Windows 10 \u0026 Chrome\r\n- Grafana plugins:\r\n- Others:\r\n![Repeat](https://user-images.githubusercontent.com/66841577/193562376-ea5b7a67-51a4-4fb3-a60c-c159dfef7e29.PNG)\r\n","labels":["area/dashboard/templating"]},{"id":43827,"title":"Pie Chart returning no data when label value is a template variable containing dots in its value","body":"**What happened**:\r\n\r\nNo data points shown\r\n\r\n**What you expected to happen**:\r\n\r\nData points to be shown\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n1. Create a dashbaord\r\n2. Add a template variable to the dashboard, e.g. name \"version\" and select the value \"1.0.0\"\r\n3. Add a pie chart that uses this template variable\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.3\r\n- Data source type \u0026 version: prometheus\r\n- OS Grafana is installed on: /\r\n- User OS \u0026 Browser: n/a (not a display issue, reproducable by the queries sent to the backend)\r\n- Grafana plugins: none\r\n- Others: /\r\n\r\n**Additional details**\r\n\r\nIf I enter the same query directly into prometheus, as well as inside the explore tab in Grafana, data points are returned: `sum by (khaleesi_health, khaleesi_service) (khaleesi_health{khaleesi_gate=\\\"core\\\", khaleesi_version=\\\"1.0.0\\\"})`\r\n\r\nHere's the paste from the query inspector (I've redacted parts of the response frames for brevity):\r\n\r\n```\r\n{\r\n  \"request\": {\r\n    \"url\": \"api/ds/query\",\r\n    \"method\": \"POST\",\r\n    \"data\": {\r\n      \"queries\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"key\": \"Q-354e1303-07bb-447f-9b01-cdb03de91147-0\",\r\n          \"instant\": true,\r\n          \"range\": true,\r\n          \"exemplar\": true,\r\n          \"expr\": \"sum by (khaleesi_health, khaleesi_service) (khaleesi_health{khaleesi_gate=\\\"core\\\", khaleesi_version=\\\"1.0.0\\\"})\",\r\n          \"datasource\": {\r\n            \"uid\": \"P6F0A6C85A60BC510\",\r\n            \"type\": \"prometheus\"\r\n          },\r\n          \"queryType\": \"timeSeriesQuery\",\r\n          \"requestId\": \"Q-354e1303-07bb-447f-9b01-cdb03de91147-0A\",\r\n          \"utcOffsetSec\": 3600,\r\n          \"legendFormat\": \"\",\r\n          \"interval\": \"\",\r\n          \"datasourceId\": 1,\r\n          \"intervalMs\": 15000,\r\n          \"maxDataPoints\": 1488\r\n        }\r\n      ],\r\n      \"range\": {\r\n        \"from\": \"2022-01-08T11:48:43.469Z\",\r\n        \"to\": \"2022-01-08T12:48:43.469Z\",\r\n        \"raw\": {\r\n          \"from\": \"now-1h\",\r\n          \"to\": \"now\"\r\n        }\r\n      },\r\n      \"from\": \"1641642523469\",\r\n      \"to\": \"1641646123469\"\r\n    },\r\n    \"hideFromInspector\": false\r\n  },\r\n  \"response\": {\r\n    \"results\": {\r\n      \"A\": {\r\n        \"frames\": [\r\n          {\r\n            \"schema\": {\r\n              \"name\": \"{khaleesi_health=\\\"dead\\\", khaleesi_service=\\\"backgate\\\"}\",\r\n              \"refId\": \"A\",\r\n              \"meta\": {\r\n                \"custom\": {\r\n                  \"resultType\": \"matrix\"\r\n                }\r\n              },\r\n              \"fields\": [\r\n                {\r\n                  \"name\": \"Time\",\r\n                  \"type\": \"time\",\r\n                  \"typeInfo\": {\r\n                    \"frame\": \"time.Time\"\r\n                  }\r\n                },\r\n                {\r\n                  \"name\": \"Value\",\r\n                  \"type\": \"number\",\r\n                  \"typeInfo\": {\r\n                    \"frame\": \"float64\",\r\n                    \"nullable\": true\r\n                  },\r\n                  \"labels\": {\r\n                    \"khaleesi_health\": \"dead\",\r\n                    \"khaleesi_service\": \"backgate\"\r\n                  },\r\n                  \"config\": {\r\n                    \"displayNameFromDS\": \"{khaleesi_health=\\\"dead\\\", khaleesi_service=\\\"backgate\\\"}\"\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            \"data\": {\r\n              \"values\": [\r\n                [\r\n                  1641642510000,\r\n                  \u003credacted for brevity\u003e\r\n                  1641646110000\r\n                ],\r\n                [\r\n                  0,\r\n                  \u003credacted for brevity\u003e\r\n                  0\r\n                ]\r\n              ]\r\n            }\r\n          },\r\n          \u003credacted for brevity\u003e\r\n          {\r\n            \"schema\": {\r\n              \"name\": \"exemplar\",\r\n              \"refId\": \"A\",\r\n              \"meta\": {\r\n                \"custom\": {\r\n                  \"resultType\": \"exemplar\"\r\n                }\r\n              },\r\n              \"fields\": [\r\n                {\r\n                  \"name\": \"Time\",\r\n                  \"type\": \"time\",\r\n                  \"typeInfo\": {\r\n                    \"frame\": \"time.Time\"\r\n                  }\r\n                },\r\n                {\r\n                  \"name\": \"Value\",\r\n                  \"type\": \"number\",\r\n                  \"typeInfo\": {\r\n                    \"frame\": \"float64\"\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            \"data\": {\r\n              \"values\": [\r\n                [],\r\n                []\r\n              ]\r\n            }\r\n          }\r\n        ],\r\n        \"refId\": \"A\"\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n\r\nThe query inspector for the pie chart, however, receives an empty result. The query I entered is `sum by (khaleesi_health) (khaleesi_health{khaleesi_gate=\"core\", khaleesi_service=\"backgate\", khaleesi_version=\"$version\"})`, with `$version` having the value `1.0.0`, same as in my manual query in the explore tab. The query produced by the chart is `sum by (khaleesi_health) (khaleesi_health{khaleesi_gate=\\\"core\\\", khaleesi_service=\\\"backgate\\\", khaleesi_version=\\\"1\\\\\\\\.0\\\\\\\\.0\\\"})`\r\n\r\nHere's the complete paste from the query inspector:\r\n\r\n```\r\n{\r\n  \"request\": {\r\n    \"url\": \"api/ds/query\",\r\n    \"method\": \"POST\",\r\n    \"data\": {\r\n      \"queries\": [\r\n        {\r\n          \"expr\": \"sum by (khaleesi_health) (khaleesi_health{khaleesi_gate=\\\"core\\\", khaleesi_service=\\\"backgate\\\", khaleesi_version=\\\"1\\\\\\\\.0\\\\\\\\.0\\\"})\",\r\n          \"legendFormat\": \"{{khaleesi_health}}\",\r\n          \"interval\": \"\",\r\n          \"exemplar\": false,\r\n          \"datasource\": {\r\n            \"type\": \"prometheus\",\r\n            \"uid\": \"P6F0A6C85A60BC510\"\r\n          },\r\n          \"instant\": true,\r\n          \"refId\": \"A\",\r\n          \"queryType\": \"timeSeriesQuery\",\r\n          \"requestId\": \"4A\",\r\n          \"utcOffsetSec\": 3600,\r\n          \"datasourceId\": 1,\r\n          \"intervalMs\": 15000,\r\n          \"maxDataPoints\": 1104\r\n        }\r\n      ],\r\n      \"range\": {\r\n        \"from\": \"2022-01-08T12:37:24.120Z\",\r\n        \"to\": \"2022-01-08T12:42:24.121Z\",\r\n        \"raw\": {\r\n          \"from\": \"now-5m\",\r\n          \"to\": \"now\"\r\n        }\r\n      },\r\n      \"from\": \"1641645444120\",\r\n      \"to\": \"1641645744121\"\r\n    },\r\n    \"hideFromInspector\": false\r\n  },\r\n  \"response\": {\r\n    \"results\": {\r\n      \"A\": {\r\n        \"frames\": [],\r\n        \"refId\": \"A\"\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nNotes:\r\n* The query produced by the pie chart inserts some backslashes in front of the dots that are not present in the query I entered manually\r\n* Similar queries for pie charts, in which the template variable value does not contain any dots, work perfectly fine\r\n* I strongly suspect that there is some escaping introduced by the template variable that messes up stuff\r\n","labels":["area/dashboard/templating","needs more info","datasource/Prometheus"]},{"id":79121,"title":"Dashboards: Removing expressions does not automatically refetch query","body":"### What happened?\n\nAfter removing an expression from a panel the query did not reran until I either click refresh or hit apply\n\n### What did you expect to happen?\n\nFor the queries on the panel to be re-ran after expressions are removed so that the chart gets updated properly without the expression\n\n### Did this work before?\n\nNA\n\n### How do we reproduce it?\n\n1. Open a panel from dashboard in edit mode and add an expression query.\r\n\r\n2. After the chart get updated, click remove button of the expression query.\r\n\r\n\r\n3. You will find the chart does not get updated after clicking the remove button.\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 9.5.13 \u0026 10.2.1 \r\nOS: Windows\r\nBrowser: Edge\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\nWas able to repro across multiple","labels":["triage/needs-confirmation","area/dashboards/panel"]},{"id":56994,"title":"Grafana Login Timeout (v9.2.0)","body":"**What happened**:\r\nUpgraded to v9.2.0\r\n\r\n**What you expected to happen**:\r\nNo change in login / timeout behavior.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nAfter upgrading to v9.2.0 Grafana will log out of the active user account in approximately 60 seconds.\r\n\r\n**Anything else we need to know?**:\r\nI did review the Grafana setting and preferences and did not see any option to increase the timeout length, or to set it to infinite. \r\n\r\n**Environment**:\r\n- Grafana version: 9.2.0\r\n- Data source type \u0026 version: InfluxDB\r\n- OS Grafana is installed on: Raspberry Pi 10 (32-bit)\r\n- User OS \u0026 Browser: Mac OSX / Chrome\r\n- Grafana plugins: Telegraf\r\n- Others: NA\r\n","labels":["type/bug","area/auth"]},{"id":45412,"title":"Unified Alerting: Internal alertmanager missing","body":"**What happened**:\r\nTrying to configure alert groups. According to documentation there should be a dropdown where the built in alert managers named \"Grafana\" should be. There is none.\r\n\r\n**What you expected to happen**:\r\nTo be able to select the built in alert manager.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nEnabled unified_alerting and disable legacy alerting in grafana.ini. Restart. Follow documentation - become confused.\r\n\r\n**Anything else we need to know?**:\r\nHave I misunderstood everything?\r\n\r\n![Konfuuuuzed](https://user-images.githubusercontent.com/10235454/154112076-9d258030-61bb-4ba4-823b-2572a30c14c8.png)\r\n![contact](https://user-images.githubusercontent.com/10235454/154116510-b9b81dd4-a135-4f91-8730-56361130603d.png)\r\n![rules](https://user-images.githubusercontent.com/10235454/154116750-c1b11b03-e49a-4967-901c-a52dae9eec65.png)\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.6\r\n- Data source type \u0026 version: Prometheus 2.33+\r\n- OS Grafana is installed on: Ubuntu 20.04 x64 HWE\r\n- User OS \u0026 Browser: Chrome Windows x64 98.0.4758.82\r\n- Grafana plugins: None\r\n- Others:\r\n\r\nLogs:\r\n```\r\nt=2022-02-15T20:25:21+0000 lvl=info msg=\"Path Home\" logger=settings path=/usr/share/grafana\r\nt=2022-02-15T20:25:21+0000 lvl=info msg=\"Path Data\" logger=settings path=/var/lib/grafana\r\nt=2022-02-15T20:25:21+0000 lvl=info msg=\"Path Logs\" logger=settings path=/var/log/grafana\r\nt=2022-02-15T20:25:21+0000 lvl=info msg=\"Path Plugins\" logger=settings path=/var/lib/grafana/plugins\r\nt=2022-02-15T20:25:21+0000 lvl=info msg=\"Path Provisioning\" logger=settings path=/etc/grafana/provisioning\r\nt=2022-02-15T20:25:21+0000 lvl=info msg=\"App mode production\" logger=settings\r\nt=2022-02-15T20:25:21+0000 lvl=info msg=\"Connecting to DB\" logger=sqlstore dbtype=sqlite3\r\nt=2022-02-15T20:25:21+0000 lvl=warn msg=\"SQLite database file has broader permissions than it should\" logger=sqlstore path=/var/lib/grafana/grafana.db mode=-rw-r--r-- expected=-rw-r-----\r\nt=2022-02-15T20:25:21+0000 lvl=info msg=\"Starting DB migrations\" logger=migrator\r\nt=2022-02-15T20:25:21+0000 lvl=info msg=\"migrations completed\" logger=migrator performed=0 skipped=377 duration=5.224095ms\r\nt=2022-02-15T20:25:21+0000 lvl=info msg=\"Initialising plugins\" logger=plugin.manager\r\nt=2022-02-15T20:25:21+0000 lvl=info msg=\"Plugin registered\" logger=plugin.manager pluginId=input\r\nt=2022-02-15T20:25:21+0000 lvl=info msg=\"Plugin registered\" logger=plugin.manager pluginId=grafana-piechart-panel\r\nt=2022-02-15T20:25:21+0000 lvl=info msg=\"Plugin registered\" logger=plugin.manager pluginId=grafana-worldmap-panel\r\nt=2022-02-15T20:25:21+0000 lvl=info msg=\"Live Push Gateway initialization\" logger=live.push_http\r\nt=2022-02-15T20:25:21+0000 lvl=info msg=\"HTTP Server Listen\" logger=http.server address=[::]:3000 protocol=http subUrl=/grafana socket=\r\nt=2022-02-15T20:25:21+0000 lvl=info msg=\"warming cache for startup\" logger=ngalert\r\nt=2022-02-15T20:25:21+0000 lvl=info msg=\"starting MultiOrg Alertmanager\" logger=ngalert.multiorg.alertmanager\r\nt=2022-02-15T20:25:23+0000 lvl=info msg=\"Request Completed\" logger=context userId=21 orgId=1 uname=daniel.sandberg method=GET path=/api/live/ws status=0 remote_addr=10.10.250.64 time_ms=7 size=0 referer=\r\nt=2022-02-15T20:26:12+0000 lvl=eror msg=\"unexpected content type from upstream. expected YAML, got text/html; charset=utf-8\" logger=context userId=21 orgId=1 uname=daniel.sandberg error=\"unexpected content type from upstream. expected YAML, got text/html; charset=utf-8\" remote_addr=10.10.250.64\r\n```\r\n\r\n**UPDATE**\r\nBy enabling \"alpha plugins\" and adding a dummy alertmanager I can now see the both the dummy and the built in Grafana alert manager. I can still not do any grouping or filtering or anything - \"No options found\".","labels":["area/alerting","needs investigation"]},{"id":44417,"title":"Undesired zoom while annotating","body":"**What happened**: While creating and annotation (https://grafana.com/docs/grafana/latest/dashboards/annotations/#adding-annotations) Grafana also perfroms an unwanted zoom\r\n\r\n**What you expected to happen**: Do not zoom on annotation boundaries, only trigger the annotation text box\r\n![Peek 2022-01-25 11-51](https://user-images.githubusercontent.com/76566850/150964208-85994911-d63c-4667-8007-9687b76cc60c.gif)\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: just add an annotation\r\n\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.3, 8.3.4\r\n- Data source type \u0026 version: Influx \r\n- OS Grafana is installed on: Linux \r\n- User OS \u0026 Browser: Linux/Windows; Chrome\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/bug","area/annotations","area/frontend","area/panel/timeseries"]},{"id":63490,"title":"grafana text edit panel toggle not visible","body":"I am not sure if this is related, but I am not able to view the text edit toggle button when editing panels.\r\n\r\nThis is a new Grafana install running in the following environment:\r\n\r\nUbuntu\r\nDocker\r\nGrafana v9.3.6\r\n\r\nGrafana is sat behind NGINX reverse proxy\r\n\r\nI have looked everywhere and came across this which I am not sure is related https://github.com/grafana/grafana/issues/18037\r\n\r\nI am using influxdb2 as the datasource and queries running in flux against this datasource.\r\n\r\nI have tried in different browsers and pretty much exhausted by debugging and hence raising on here with a hope to get this resolved.\r\n","labels":["area/dashboard","bot/no new info"]},{"id":44095,"title":"Grafana only connects some dots, when Time series panel is collapsed.","body":"**What happened**:\r\nWhen analysing our data using the Timeseries plugin, some dots will only connect, when the plugin configuration panel is collapsed\r\n\r\n**What you expected to happen**:\r\nDots should always be connected.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nThis is the .har file of the request:\r\nhttps://gist.github.com/Scarjit/29602ec8e21b482096a3d27b350835ee\r\n\r\nand the raw json response:\r\nhttps://gist.github.com/Scarjit/f38aeb00b5652faa7b7cfedf54cf3a5d\r\n\r\n![chrome_bSeEMaj0aK](https://user-images.githubusercontent.com/6317420/149757313-a9693357-b87a-4693-bcb0-9a8cfdd971b2.gif)\r\n\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: v8.13 (a61f38238c)\r\n- Data source type \u0026 version: [umh-datasource](https://github.com/united-manufacturing-hub/united-manufacturing-hub-datasource)\r\n- OS Grafana is installed on: \r\n  - Base OS: k3OS v0.22.2-k3s2r0\r\n  - Kubernetes Version: v1.22.2+k3s2\r\n- User OS \u0026 Browser: \r\n  - OS: Windows 11 (21H2) [OS Build 22000.434)\r\n  - Browser: Chrome v97.0.4692.71 x64 \r\n- Grafana plugins:\r\n  - ACE.SVG\r\n  - Alert list\r\n  - Annotations list\r\n  - Azure Monitor\r\n  - Bar chart\r\n  - Bar gauge\r\n  - [Button Panel](https://github.com/united-manufacturing-hub/umh-factoryinput-panel)\r\n  - [Button Panel](https://grafana.com/grafana/plugins/cloudspout-button-panel/)\r\n  - CloudWatch\r\n  - Dashboard list\r\n  - Discrete\r\n  - Dynamic text\r\n  - Elasticsearch\r\n  - FlowCharting\r\n  - Gauge\r\n  - Geomap\r\n  - Getting Started\r\n  - Google Cloud Monitoring\r\n  - Graph (old)\r\n  - Graphite\r\n  - Heatmap\r\n  - Histogram\r\n  - InfluxDB\r\n  - Jaeger\r\n  - Logs\r\n  - Loki\r\n  - Microsoft SQL Server\r\n  - MySQL\r\n  - News\r\n  - Node Graph\r\n  - OpenTSDB\r\n  - Pareto  Chart\r\n  - Pie Chart (old)\r\n  - Pie Chart\r\n  - Plugin list\r\n  - PostgreSQL\r\n  - Prometheus\r\n  - Stat\r\n  - State timeline\r\n  - Status history\r\n  - Table\r\n  - Table (old)\r\n  - Tempo\r\n  - TestData DB\r\n  - Text\r\n  - Time series\r\n  - Timepicker Button Panel\r\n  - UMH Datasource\r\n  - Untimely\r\n  - Welcome\r\n  - Worldmap Panel\r\n  - Zipkin\r\n- Others:\r\n","labels":["bot/no new info","area/panel/timeseries"]},{"id":80897,"title":"Visual artifacts on Time series charts with stacked bars","body":"### What happened?\n\nThere is a visual artifact on the time series charts with bars (Graph style) and stacked series (normal stack) that causes some bars with an actual value of 0 to be drawn higher on the Y-axis.\r\n\r\nLet's take a look at my Optimal Viewport Percent chart, this is a chart that displays approximately 1600 data points.\r\n\r\n![image](https://github.com/grafana/grafana/assets/4516478/bc8872f3-3501-473f-997a-11783469abe4)\r\n\r\n\r\nAs you can see there are a bunch of yellows bars that lead to believe that there are some suboptimal resolutions. However in reality, this corresponds to data points that return 0% for both optimal and subtopmal resolutions. Let's zoom in on the first group of yellow bars:\r\n\r\n![image](https://github.com/grafana/grafana/assets/4516478/73390628-35fc-4812-8f60-013e08143f71)\r\n\r\nNow we can see that this bunch of data points with 0% values are correctly represented. At this point Grafana is dealing with approximately 160 data points. The following is a sample of the represented values\r\n\r\n![image](https://github.com/grafana/grafana/assets/4516478/f4a133e6-5aac-4c08-a587-8815889779e0)\r\n\r\nSuboptimal (yellow bars) is always 0%\r\n\r\nGoing back to the original results set, I noticed that maximizing the chart reduces the amount of visual artifacts but they are still present:\r\n\r\n![image](https://github.com/grafana/grafana/assets/4516478/0e0781d7-1605-4b1c-a3ac-fbe20da60562)\r\n\r\nAll of this leads me to think that this is an issue only present with a \"significantly large\" amount of results not being properly rendered by Grafana.\n\n### What did you expect to happen?\n\nYellow bars should be displayed as small dots at the bottom of the Y axis or not even being drawn at all.\n\n### Did this work before?\n\nnot that I'm aware\n\n### How do we reproduce it?\n\n1. Create a time series charts with bars and stacked series (Normal)\r\n2.  Display two columns of results that share same timestamp and one of the columns always reports 0\r\n\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: CE 9.4.7\r\nOS: Ubuntu 23.10\r\nBrowser: Firefox 119.0.1\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nJSON API: https://grafana.com/grafana/plugins/marcusolsson-json-datasource/","labels":["area/panel/timeseries"]},{"id":60565,"title":"Stat plugin threshold colouring not working","body":"**What happened**:\r\nThreshold colours not being applied to stat panel when using negative numbers.\r\n\r\n**What you expected to happen**:\r\nColourings should be applied in a negative direction for negative numbers rather than a positive one (I'll try and describe this in a better way below).\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nSetup a stat that you can connect to some data that ranges in value from negative to positive values. Apply thresholds at 0, a positive number and a negative number.\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.0\r\n- Data source type \u0026 version: Influxdb 2.6.0\r\n- OS Grafana is installed on: Ubuntu 22.04.1 LTS\r\n- User OS \u0026 Browser: Windows 11 22H2 build 22621.963, Brave 1.46.144\r\n- Grafana plugins: \r\n- Others:\r\n\r\n\r\nI have a sensor that is calculating a trend value for temperature values. I'd like to have coloured thresholds to indicate an increase over a certain amount and a decrease below a certain amount. So I have these thresholds:\r\n\r\n- 0.6 - Green\r\n- 0 - White\r\n- -0.06 - Yellow\r\n- Base - White\r\n\r\nThis is trying to mimic the following:\r\n- Between -0.059 and +0.59 it should be white\r\n- Equal or greater than +0.6 should be green\r\n- Equal or greater than (or is it less than for a negative number?) -0.06 should be yellow.\r\n\r\nHere's what I am seeing:\r\n- +0.6 = Green (correct)\r\n- +0.01 = White (correct)\r\n- 0 = White or yellow. It seems to decide randomly, I guess there is rounding at play here.\r\n- -0.03 = Yellow (wrong)\r\n- -0.05 = Yellow (wrong)\r\n- -0.07 = White (wrong)\r\n- -0.08 = White (wrong)\r\n- -0.10 = White (wrong)\r\n\r\nIt seems the threshold of -0.06 is looking for values the wrong side of the threshold i.e. its looking to colour the text yellow between -0.06 and 0, rather than -0.06 and -0.09\r\n\r\n","labels":["datasource/InfluxDB","needs investigation","area/panel/stat","os/windows"]},{"id":82514,"title":"Time Series Chart: relative time range changes to dashboard time range","body":"### What happened?\n\nI have a dashboard that displays my OpenDTU data over the last 12 hours. I also included a chart visualizing the yield per day over the last year in the lower right with a relative time range of 1y. This works fine when loading the dashboard but after time (around 1m) the time range of the x-axis changes from the fixed 1y to the 12h set in the dashboard.\r\n\r\n![grafana-range-reset](https://github.com/grafana/grafana/assets/915117/9bb219cb-73a4-4af5-bc9f-6614f46c958c)\r\n\n\n### What did you expect to happen?\n\nThe relative time range should always stay on the configured 1y value.\n\n### Did this work before?\n\nAFAIR this has happened since I created the chart.\n\n### How do we reproduce it?\n\n1. Create chart with relative time range of 1y\r\n2. Wait until the chart resets to the range set on the dashboard\n\n### Is the bug inside a dashboard panel?\n\n| Key | Value |\r\n|--|--|\r\n| Panel | timeseries @ 10.3.1 (00a22ff8b28550d593ec369ba3da1b25780f0a4a) |\r\n| Grafana | 10.3.1 (00a22ff8b28550d593ec369ba3da1b25780f0a4a) // Open Source |\r\n\u003cdetails\u003e\u003csummary\u003ePanel debug snapshot dashboard\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"panels\": [\r\n    {\r\n      \"datasource\": {\r\n        \"type\": \"grafana\",\r\n        \"uid\": \"grafana\"\r\n      },\r\n      \"description\": \"\",\r\n      \"fieldConfig\": {\r\n        \"defaults\": {\r\n          \"custom\": {\r\n            \"drawStyle\": \"bars\",\r\n            \"lineInterpolation\": \"linear\",\r\n            \"barAlignment\": 0,\r\n            \"lineWidth\": 0,\r\n            \"fillOpacity\": 100,\r\n            \"gradientMode\": \"none\",\r\n            \"spanNulls\": false,\r\n            \"insertNulls\": false,\r\n            \"showPoints\": \"auto\",\r\n            \"pointSize\": 5,\r\n            \"stacking\": {\r\n              \"mode\": \"none\",\r\n              \"group\": \"A\"\r\n            },\r\n            \"axisPlacement\": \"auto\",\r\n            \"axisLabel\": \"\",\r\n            \"axisColorMode\": \"text\",\r\n            \"axisBorderShow\": false,\r\n            \"scaleDistribution\": {\r\n              \"type\": \"linear\"\r\n            },\r\n            \"axisCenteredZero\": false,\r\n            \"hideFrom\": {\r\n              \"tooltip\": false,\r\n              \"viz\": false,\r\n              \"legend\": false\r\n            },\r\n            \"thresholdsStyle\": {\r\n              \"mode\": \"off\"\r\n            }\r\n          },\r\n          \"unitScale\": true,\r\n          \"color\": {\r\n            \"mode\": \"palette-classic\"\r\n          },\r\n          \"mappings\": [],\r\n          \"thresholds\": {\r\n            \"mode\": \"absolute\",\r\n            \"steps\": [\r\n              {\r\n                \"color\": \"green\",\r\n                \"value\": null\r\n              }\r\n            ]\r\n          },\r\n          \"min\": 0,\r\n          \"unit\": \"watth\"\r\n        },\r\n        \"overrides\": [\r\n          {\r\n            \"matcher\": {\r\n              \"id\": \"byName\",\r\n              \"options\": \"Energie gesamt\"\r\n            },\r\n            \"properties\": [\r\n              {\r\n                \"id\": \"custom.drawStyle\",\r\n                \"value\": \"line\"\r\n              },\r\n              {\r\n                \"id\": \"unit\",\r\n                \"value\": \"kwatth\"\r\n              },\r\n              {\r\n                \"id\": \"custom.fillOpacity\",\r\n                \"value\": 0\r\n              },\r\n              {\r\n                \"id\": \"custom.lineWidth\",\r\n                \"value\": 2\r\n              }\r\n            ]\r\n          }\r\n        ]\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 2,\r\n      \"options\": {\r\n        \"tooltip\": {\r\n          \"mode\": \"multi\",\r\n          \"sort\": \"none\"\r\n        },\r\n        \"legend\": {\r\n          \"showLegend\": true,\r\n          \"displayMode\": \"list\",\r\n          \"placement\": \"bottom\",\r\n          \"calcs\": [\r\n            \"lastNotNull\",\r\n            \"min\",\r\n            \"max\",\r\n            \"mean\"\r\n          ]\r\n        }\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"grafana\",\r\n            \"uid\": \"grafana\"\r\n          },\r\n          \"queryType\": \"snapshot\",\r\n          \"snapshot\": [\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"A\",\r\n                \"meta\": {\r\n                  \"typeVersion\": [\r\n                    0,\r\n                    0\r\n                  ],\r\n                  \"preferredVisualisationType\": \"graph\",\r\n                  \"executedQueryString\": \"SELECT max(\\\"value\\\") FROM \\\"mqtt_consumer\\\" WHERE \\\"topic\\\" = 'solar/114182126084/0/yieldday' AND time \u003e= 1676451728513ms and time \u003c= 1707987728513ms GROUP BY time(1d) fill(null) ORDER BY time ASC\"\r\n                },\r\n                \"name\": \"Energie\",\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"Time\",\r\n                    \"type\": \"time\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"time.Time\"\r\n                    },\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"Value\",\r\n                    \"type\": \"number\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"float64\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"config\": {\r\n                      \"displayNameFromDS\": \"Energie\"\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    1676419200000,\r\n                    1676505600000,\r\n                    1676592000000,\r\n                    1676678400000,\r\n                    1676764800000,\r\n                    1676851200000,\r\n                    1676937600000,\r\n                    1677024000000,\r\n                    1677110400000,\r\n                    1677196800000,\r\n                    1677283200000,\r\n                    1677369600000,\r\n                    1677456000000,\r\n                    1677542400000,\r\n                    1677628800000,\r\n                    1677715200000,\r\n                    1677801600000,\r\n                    1677888000000,\r\n                    1677974400000,\r\n                    1678060800000,\r\n                    1678147200000,\r\n                    1678233600000,\r\n                    1678320000000,\r\n                    1678406400000,\r\n                    1678492800000,\r\n                    1678579200000,\r\n                    1678665600000,\r\n                    1678752000000,\r\n                    1678838400000,\r\n                    1678924800000,\r\n                    1679011200000,\r\n                    1679097600000,\r\n                    1679184000000,\r\n                    1679270400000,\r\n                    1679356800000,\r\n                    1679443200000,\r\n                    1679529600000,\r\n                    1679616000000,\r\n                    1679702400000,\r\n                    1679788800000,\r\n                    1679875200000,\r\n                    1679961600000,\r\n                    1680048000000,\r\n                    1680134400000,\r\n                    1680220800000,\r\n                    1680307200000,\r\n                    1680393600000,\r\n                    1680480000000,\r\n                    1680566400000,\r\n                    1680652800000,\r\n                    1680739200000,\r\n                    1680825600000,\r\n                    1680912000000,\r\n                    1680998400000,\r\n                    1681084800000,\r\n                    1681171200000,\r\n                    1681257600000,\r\n                    1681344000000,\r\n                    1681430400000,\r\n                    1681516800000,\r\n                    1681603200000,\r\n                    1681689600000,\r\n                    1681776000000,\r\n                    1681862400000,\r\n                    1681948800000,\r\n                    1682035200000,\r\n                    1682121600000,\r\n                    1682208000000,\r\n                    1682294400000,\r\n                    1682380800000,\r\n                    1682467200000,\r\n                    1682553600000,\r\n                    1682640000000,\r\n                    1682726400000,\r\n                    1682812800000,\r\n                    1682899200000,\r\n                    1682985600000,\r\n                    1683072000000,\r\n                    1683158400000,\r\n                    1683244800000,\r\n                    1683331200000,\r\n                    1683417600000,\r\n                    1683504000000,\r\n                    1683590400000,\r\n                    1683676800000,\r\n                    1683763200000,\r\n                    1683849600000,\r\n                    1683936000000,\r\n                    1684022400000,\r\n                    1684108800000,\r\n                    1684195200000,\r\n                    1684281600000,\r\n                    1684368000000,\r\n                    1684454400000,\r\n                    1684540800000,\r\n                    1684627200000,\r\n                    1684713600000,\r\n                    1684800000000,\r\n                    1684886400000,\r\n                    1684972800000,\r\n                    1685059200000,\r\n                    1685145600000,\r\n                    1685232000000,\r\n                    1685318400000,\r\n                    1685404800000,\r\n                    1685491200000,\r\n                    1685577600000,\r\n                    1685664000000,\r\n                    1685750400000,\r\n                    1685836800000,\r\n                    1685923200000,\r\n                    1686009600000,\r\n                    1686096000000,\r\n                    1686182400000,\r\n                    1686268800000,\r\n                    1686355200000,\r\n                    1686441600000,\r\n                    1686528000000,\r\n                    1686614400000,\r\n                    1686700800000,\r\n                    1686787200000,\r\n                    1686873600000,\r\n                    1686960000000,\r\n                    1687046400000,\r\n                    1687132800000,\r\n                    1687219200000,\r\n                    1687305600000,\r\n                    1687392000000,\r\n                    1687478400000,\r\n                    1687564800000,\r\n                    1687651200000,\r\n                    1687737600000,\r\n                    1687824000000,\r\n                    1687910400000,\r\n                    1687996800000,\r\n                    1688083200000,\r\n                    1688169600000,\r\n                    1688256000000,\r\n                    1688342400000,\r\n                    1688428800000,\r\n                    1688515200000,\r\n                    1688601600000,\r\n                    1688688000000,\r\n                    1688774400000,\r\n                    1688860800000,\r\n                    1688947200000,\r\n                    1689033600000,\r\n                    1689120000000,\r\n                    1689206400000,\r\n                    1689292800000,\r\n                    1689379200000,\r\n                    1689465600000,\r\n                    1689552000000,\r\n                    1689638400000,\r\n                    1689724800000,\r\n                    1689811200000,\r\n                    1689897600000,\r\n                    1689984000000,\r\n                    1690070400000,\r\n                    1690156800000,\r\n                    1690243200000,\r\n                    1690329600000,\r\n                    1690416000000,\r\n                    1690502400000,\r\n                    1690588800000,\r\n                    1690675200000,\r\n                    1690761600000,\r\n                    1690848000000,\r\n                    1690934400000,\r\n                    1691020800000,\r\n                    1691107200000,\r\n                    1691193600000,\r\n                    1691280000000,\r\n                    1691366400000,\r\n                    1691452800000,\r\n                    1691539200000,\r\n                    1691625600000,\r\n                    1691712000000,\r\n                    1691798400000,\r\n                    1691884800000,\r\n                    1691971200000,\r\n                    1692057600000,\r\n                    1692144000000,\r\n                    1692230400000,\r\n                    1692316800000,\r\n                    1692403200000,\r\n                    1692489600000,\r\n                    1692576000000,\r\n                    1692662400000,\r\n                    1692748800000,\r\n                    1692835200000,\r\n                    1692921600000,\r\n                    1693008000000,\r\n                    1693094400000,\r\n                    1693180800000,\r\n                    1693267200000,\r\n                    1693353600000,\r\n                    1693440000000,\r\n                    1693526400000,\r\n                    1693612800000,\r\n                    1693699200000,\r\n                    1693785600000,\r\n                    1693872000000,\r\n                    1693958400000,\r\n                    1694044800000,\r\n                    1694131200000,\r\n                    1694217600000,\r\n                    1694304000000,\r\n                    1694390400000,\r\n                    1694476800000,\r\n                    1694563200000,\r\n                    1694649600000,\r\n                    1694736000000,\r\n                    1694822400000,\r\n                    1694908800000,\r\n                    1694995200000,\r\n                    1695081600000,\r\n                    1695168000000,\r\n                    1695254400000,\r\n                    1695340800000,\r\n                    1695427200000,\r\n                    1695513600000,\r\n                    1695600000000,\r\n                    1695686400000,\r\n                    1695772800000,\r\n                    1695859200000,\r\n                    1695945600000,\r\n                    1696032000000,\r\n                    1696118400000,\r\n                    1696204800000,\r\n                    1696291200000,\r\n                    1696377600000,\r\n                    1696464000000,\r\n                    1696550400000,\r\n                    1696636800000,\r\n                    1696723200000,\r\n                    1696809600000,\r\n                    1696896000000,\r\n                    1696982400000,\r\n                    1697068800000,\r\n                    1697155200000,\r\n                    1697241600000,\r\n                    1697328000000,\r\n                    1697414400000,\r\n                    1697500800000,\r\n                    1697587200000,\r\n                    1697673600000,\r\n                    1697760000000,\r\n                    1697846400000,\r\n                    1697932800000,\r\n                    1698019200000,\r\n                    1698105600000,\r\n                    1698192000000,\r\n                    1698278400000,\r\n                    1698364800000,\r\n                    1698451200000,\r\n                    1698537600000,\r\n                    1698624000000,\r\n                    1698710400000,\r\n                    1698796800000,\r\n                    1698883200000,\r\n                    1698969600000,\r\n                    1699056000000,\r\n                    1699142400000,\r\n                    1699228800000,\r\n                    1699315200000,\r\n                    1699401600000,\r\n                    1699488000000,\r\n                    1699574400000,\r\n                    1699660800000,\r\n                    1699747200000,\r\n                    1699833600000,\r\n                    1699920000000,\r\n                    1700006400000,\r\n                    1700092800000,\r\n                    1700179200000,\r\n                    1700265600000,\r\n                    1700352000000,\r\n                    1700438400000,\r\n                    1700524800000,\r\n                    1700611200000,\r\n                    1700697600000,\r\n                    1700784000000,\r\n                    1700870400000,\r\n                    1700956800000,\r\n                    1701043200000,\r\n                    1701129600000,\r\n                    1701216000000,\r\n                    1701302400000,\r\n                    1701388800000,\r\n                    1701475200000,\r\n                    1701561600000,\r\n                    1701648000000,\r\n                    1701734400000,\r\n                    1701820800000,\r\n                    1701907200000,\r\n                    1701993600000,\r\n                    1702080000000,\r\n                    1702166400000,\r\n                    1702252800000,\r\n                    1702339200000,\r\n                    1702425600000,\r\n                    1702512000000,\r\n                    1702598400000,\r\n                    1702684800000,\r\n                    1702771200000,\r\n                    1702857600000,\r\n                    1702944000000,\r\n                    1703030400000,\r\n                    1703116800000,\r\n                    1703203200000,\r\n                    1703289600000,\r\n                    1703376000000,\r\n                    1703462400000,\r\n                    1703548800000,\r\n                    1703635200000,\r\n                    1703721600000,\r\n                    1703808000000,\r\n                    1703894400000,\r\n                    1703980800000,\r\n                    1704067200000,\r\n                    1704153600000,\r\n                    1704240000000,\r\n                    1704326400000,\r\n                    1704412800000,\r\n                    1704499200000,\r\n                    1704585600000,\r\n                    1704672000000,\r\n                    1704758400000,\r\n                    1704844800000,\r\n                    1704931200000,\r\n                    1705017600000,\r\n                    1705104000000,\r\n                    1705190400000,\r\n                    1705276800000,\r\n                    1705363200000,\r\n                    1705449600000,\r\n                    1705536000000,\r\n                    1705622400000,\r\n                    1705708800000,\r\n                    1705795200000,\r\n                    1705881600000,\r\n                    1705968000000,\r\n                    1706054400000,\r\n                    1706140800000,\r\n                    1706227200000,\r\n                    1706313600000,\r\n                    1706400000000,\r\n                    1706486400000,\r\n                    1706572800000,\r\n                    1706659200000,\r\n                    1706745600000,\r\n                    1706832000000,\r\n                    1706918400000,\r\n                    1707004800000,\r\n                    1707091200000,\r\n                    1707177600000,\r\n                    1707264000000,\r\n                    1707350400000,\r\n                    1707436800000,\r\n                    1707523200000,\r\n                    1707609600000,\r\n                    1707696000000,\r\n                    1707782400000,\r\n                    1707868800000,\r\n                    1707955200000\r\n                  ],\r\n                  [\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    3169,\r\n                    3230,\r\n                    502,\r\n                    612,\r\n                    1269,\r\n                    1061,\r\n                    292,\r\n                    849,\r\n                    1084,\r\n                    1879,\r\n                    790,\r\n                    538,\r\n                    1246,\r\n                    2089,\r\n                    3015,\r\n                    1692,\r\n                    2916,\r\n                    1255,\r\n                    1907,\r\n                    911,\r\n                    2183,\r\n                    1305,\r\n                    1622,\r\n                    2660,\r\n                    null,\r\n                    2731,\r\n                    null,\r\n                    1913,\r\n                    1510,\r\n                    1857,\r\n                    873,\r\n                    931,\r\n                    4206,\r\n                    4524,\r\n                    4440,\r\n                    3045,\r\n                    744,\r\n                    1678,\r\n                    3053,\r\n                    3441,\r\n                    2837,\r\n                    868,\r\n                    2149,\r\n                    4466,\r\n                    2365,\r\n                    1320,\r\n                    1397,\r\n                    1922,\r\n                    2848,\r\n                    2609,\r\n                    4057,\r\n                    2744,\r\n                    2416,\r\n                    2098,\r\n                    2174,\r\n                    3631,\r\n                    4257,\r\n                    1602,\r\n                    1524,\r\n                    4688,\r\n                    3275,\r\n                    2901,\r\n                    5000,\r\n                    4574,\r\n                    3650,\r\n                    3411,\r\n                    2856,\r\n                    1258,\r\n                    1117,\r\n                    2647,\r\n                    1451,\r\n                    1381,\r\n                    3594,\r\n                    3400,\r\n                    3695,\r\n                    2614,\r\n                    3810,\r\n                    5016,\r\n                    3846,\r\n                    3706,\r\n                    3657,\r\n                    3616,\r\n                    1798,\r\n                    3240,\r\n                    4753,\r\n                    4700,\r\n                    4906,\r\n                    4915,\r\n                    4723,\r\n                    4865,\r\n                    4979,\r\n                    4785,\r\n                    4650,\r\n                    4320,\r\n                    4891,\r\n                    4612,\r\n                    3643,\r\n                    3986,\r\n                    3639,\r\n                    4224,\r\n                    4212,\r\n                    4241,\r\n                    4077,\r\n                    4266,\r\n                    3817,\r\n                    3544,\r\n                    3304,\r\n                    3510,\r\n                    3247,\r\n                    2769,\r\n                    2894,\r\n                    3739,\r\n                    3628,\r\n                    4055,\r\n                    4368,\r\n                    4783,\r\n                    4223,\r\n                    2666,\r\n                    2319,\r\n                    2792,\r\n                    2631,\r\n                    1400,\r\n                    4031,\r\n                    3362,\r\n                    4208,\r\n                    3587,\r\n                    4961,\r\n                    4848,\r\n                    3925,\r\n                    4068,\r\n                    3778,\r\n                    4307,\r\n                    4211,\r\n                    3770,\r\n                    3585,\r\n                    1587,\r\n                    4468,\r\n                    3889,\r\n                    4628,\r\n                    3021,\r\n                    2916,\r\n                    2044,\r\n                    3582,\r\n                    1645,\r\n                    2701,\r\n                    1590,\r\n                    2721,\r\n                    534,\r\n                    2032,\r\n                    2791,\r\n                    2470,\r\n                    1761,\r\n                    3122,\r\n                    954,\r\n                    1302,\r\n                    2492,\r\n                    3001,\r\n                    1445,\r\n                    2124,\r\n                    2943,\r\n                    2902,\r\n                    4333,\r\n                    4304,\r\n                    2159,\r\n                    2738,\r\n                    2284,\r\n                    1972,\r\n                    2685,\r\n                    4015,\r\n                    4262,\r\n                    2001,\r\n                    4053,\r\n                    4016,\r\n                    3923,\r\n                    4190,\r\n                    1884,\r\n                    2102,\r\n                    1839,\r\n                    null,\r\n                    1605,\r\n                    1909,\r\n                    2841,\r\n                    2882,\r\n                    1232,\r\n                    3525,\r\n                    2742,\r\n                    4042,\r\n                    3976,\r\n                    3977,\r\n                    3915,\r\n                    3860,\r\n                    3713,\r\n                    3546,\r\n                    3574,\r\n                    3183,\r\n                    1864,\r\n                    3287,\r\n                    3689,\r\n                    3235,\r\n                    2904,\r\n                    1194,\r\n                    3231,\r\n                    2642,\r\n                    1310,\r\n                    2611,\r\n                    2769,\r\n                    3485,\r\n                    3507,\r\n                    3446,\r\n                    3160,\r\n                    2879,\r\n                    1723,\r\n                    2483,\r\n                    3197,\r\n                    2946,\r\n                    844,\r\n                    2632,\r\n                    1151,\r\n                    2241,\r\n                    1799,\r\n                    1655,\r\n                    1042,\r\n                    2335,\r\n                    2550,\r\n                    401,\r\n                    1724,\r\n                    2433,\r\n                    1593,\r\n                    1966,\r\n                    1603,\r\n                    1440,\r\n                    450,\r\n                    482,\r\n                    1804,\r\n                    527,\r\n                    651,\r\n                    308,\r\n                    127,\r\n                    762,\r\n                    670,\r\n                    398,\r\n                    323,\r\n                    540,\r\n                    1012,\r\n                    606,\r\n                    338,\r\n                    712,\r\n                    397,\r\n                    529,\r\n                    830,\r\n                    601,\r\n                    564,\r\n                    151,\r\n                    453,\r\n                    639,\r\n                    357,\r\n                    73,\r\n                    277,\r\n                    846,\r\n                    229,\r\n                    338,\r\n                    153,\r\n                    877,\r\n                    681,\r\n                    659,\r\n                    1081,\r\n                    363,\r\n                    598,\r\n                    548,\r\n                    386,\r\n                    51,\r\n                    429,\r\n                    379,\r\n                    285,\r\n                    178,\r\n                    240,\r\n                    1087,\r\n                    105,\r\n                    24,\r\n                    108,\r\n                    155,\r\n                    89,\r\n                    157,\r\n                    458,\r\n                    468,\r\n                    104,\r\n                    604,\r\n                    196,\r\n                    301,\r\n                    577,\r\n                    140,\r\n                    211,\r\n                    135,\r\n                    608,\r\n                    135,\r\n                    172,\r\n                    211,\r\n                    129,\r\n                    68,\r\n                    503,\r\n                    226,\r\n                    865,\r\n                    201,\r\n                    441,\r\n                    142,\r\n                    387,\r\n                    94,\r\n                    624,\r\n                    516,\r\n                    403,\r\n                    182,\r\n                    214,\r\n                    654,\r\n                    1257,\r\n                    1017,\r\n                    1222,\r\n                    242,\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    null,\r\n                    120,\r\n                    352,\r\n                    1219,\r\n                    457,\r\n                    792,\r\n                    133,\r\n                    893,\r\n                    714,\r\n                    1203,\r\n                    427,\r\n                    1689,\r\n                    1643,\r\n                    1482,\r\n                    637,\r\n                    758,\r\n                    1429,\r\n                    1424,\r\n                    501,\r\n                    337,\r\n                    1866,\r\n                    280,\r\n                    176,\r\n                    229,\r\n                    314,\r\n                    623,\r\n                    593,\r\n                    807,\r\n                    1743,\r\n                    382,\r\n                    81\r\n                  ]\r\n                ]\r\n              }\r\n            },\r\n            {\r\n              \"schema\": {\r\n                \"refId\": \"B\",\r\n                \"meta\": {\r\n                  \"typeVersion\": [\r\n                    0,\r\n                    0\r\n                  ],\r\n                  \"preferredVisualisationType\": \"graph\",\r\n                  \"executedQueryString\": \"SELECT max(\\\"value\\\") FROM \\\"mqtt_consumer\\\" WHERE \\\"topic\\\"::tag = 'solar/114182126084/0/yieldtotal' AND time \u003e= 1676451728513ms and time \u003c= 1707987728513ms GROUP BY time(1d) fill(none) ORDER BY time ASC\"\r\n                },\r\n                \"name\": \"Energie gesamt\",\r\n                \"fields\": [\r\n                  {\r\n                    \"name\": \"Time\",\r\n                    \"type\": \"time\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"time.Time\"\r\n                    },\r\n                    \"config\": {}\r\n                  },\r\n                  {\r\n                    \"name\": \"Value\",\r\n                    \"type\": \"number\",\r\n                    \"typeInfo\": {\r\n                      \"frame\": \"float64\",\r\n                      \"nullable\": true\r\n                    },\r\n                    \"config\": {\r\n                      \"displayNameFromDS\": \"Energie gesamt\"\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"data\": {\r\n                \"values\": [\r\n                  [\r\n                    1677715200000,\r\n                    1677801600000,\r\n                    1677888000000,\r\n                    1677974400000,\r\n                    1678060800000,\r\n                    1678147200000,\r\n                    1678233600000,\r\n                    1678320000000,\r\n                    1678406400000,\r\n                    1678492800000,\r\n                    1678579200000,\r\n                    1678665600000,\r\n                    1678752000000,\r\n                    1678838400000,\r\n                    1678924800000,\r\n                    1679011200000,\r\n                    1679097600000,\r\n                    1679184000000,\r\n                    1679270400000,\r\n                    1679356800000,\r\n                    1679443200000,\r\n                    1679529600000,\r\n                    1679616000000,\r\n                    1679702400000,\r\n                    1679875200000,\r\n                    1680048000000,\r\n                    1680134400000,\r\n                    1680220800000,\r\n                    1680307200000,\r\n                    1680393600000,\r\n                    1680480000000,\r\n                    1680566400000,\r\n                    1680652800000,\r\n                    1680739200000,\r\n                    1680825600000,\r\n                    1680912000000,\r\n                    1680998400000,\r\n                    1681084800000,\r\n                    1681171200000,\r\n                    1681257600000,\r\n                    1681344000000,\r\n                    1681430400000,\r\n                    1681516800000,\r\n                    1681603200000,\r\n                    1681689600000,\r\n                    1681776000000,\r\n                    1681862400000,\r\n                    1681948800000,\r\n                    1682035200000,\r\n                    1682121600000,\r\n                    1682208000000,\r\n                    1682294400000,\r\n                    1682380800000,\r\n                    1682467200000,\r\n                    1682553600000,\r\n                    1682640000000,\r\n                    1682726400000,\r\n                    1682812800000,\r\n                    1682899200000,\r\n                    1682985600000,\r\n                    1683072000000,\r\n                    1683158400000,\r\n                    1683244800000,\r\n                    1683331200000,\r\n                    1683417600000,\r\n                    1683504000000,\r\n                    1683590400000,\r\n                    1683676800000,\r\n                    1683763200000,\r\n                    1683849600000,\r\n                    1683936000000,\r\n                    1684022400000,\r\n                    1684108800000,\r\n                    1684195200000,\r\n                    1684281600000,\r\n                    1684368000000,\r\n                    1684454400000,\r\n                    1684540800000,\r\n                    1684627200000,\r\n                    1684713600000,\r\n                    1684800000000,\r\n                    1684886400000,\r\n                    1684972800000,\r\n                    1685059200000,\r\n                    1685145600000,\r\n                    1685232000000,\r\n                    1685318400000,\r\n                    1685404800000,\r\n                    1685491200000,\r\n                    1685577600000,\r\n                    1685664000000,\r\n                    1685750400000,\r\n                    1685836800000,\r\n                    1685923200000,\r\n                    1686009600000,\r\n                    1686096000000,\r\n                    1686182400000,\r\n                    1686268800000,\r\n                    1686355200000,\r\n                    1686441600000,\r\n                    1686528000000,\r\n                    1686614400000,\r\n                    1686700800000,\r\n                    1686787200000,\r\n                    1686873600000,\r\n                    1686960000000,\r\n                    1687046400000,\r\n                    1687132800000,\r\n                    1687219200000,\r\n                    1687305600000,\r\n                    1687392000000,\r\n                    1687478400000,\r\n                    1687564800000,\r\n                    1687651200000,\r\n                    1687737600000,\r\n                    1687824000000,\r\n                    1687910400000,\r\n                    1687996800000,\r\n                    1688083200000,\r\n                    1688169600000,\r\n                    1688256000000,\r\n                    1688342400000,\r\n                    1688428800000,\r\n                    1688515200000,\r\n                    1688601600000,\r\n                    1688688000000,\r\n                    1688774400000,\r\n                    1688860800000,\r\n                    1688947200000,\r\n                    1689033600000,\r\n                    1689120000000,\r\n                    1689206400000,\r\n                    1689292800000,\r\n                    1689379200000,\r\n                    1689465600000,\r\n                    1689552000000,\r\n                    1689638400000,\r\n                    1689724800000,\r\n                    1689811200000,\r\n                    1689897600000,\r\n                    1689984000000,\r\n                    1690070400000,\r\n                    1690156800000,\r\n                    1690243200000,\r\n                    1690329600000,\r\n                    1690416000000,\r\n                    1690502400000,\r\n                    1690588800000,\r\n                    1690675200000,\r\n                    1690761600000,\r\n                    1690848000000,\r\n                    1690934400000,\r\n                    1691020800000,\r\n                    1691107200000,\r\n                    1691193600000,\r\n                    1691280000000,\r\n                    1691366400000,\r\n                    1691452800000,\r\n                    1691539200000,\r\n                    1691625600000,\r\n                    1691712000000,\r\n                    1691798400000,\r\n                    1691884800000,\r\n                    1691971200000,\r\n                    1692057600000,\r\n                    1692144000000,\r\n                    1692230400000,\r\n                    1692316800000,\r\n                    1692403200000,\r\n                    1692489600000,\r\n                    1692576000000,\r\n                    1692662400000,\r\n                    1692748800000,\r\n                    1692835200000,\r\n                    1692921600000,\r\n                    1693008000000,\r\n                    1693180800000,\r\n                    1693267200000,\r\n                    1693353600000,\r\n                    1693440000000,\r\n                    1693526400000,\r\n                    1693612800000,\r\n                    1693699200000,\r\n                    1693785600000,\r\n                    1693872000000,\r\n                    1693958400000,\r\n                    1694044800000,\r\n                    1694131200000,\r\n                    1694217600000,\r\n                    1694304000000,\r\n                    1694390400000,\r\n                    1694476800000,\r\n                    1694563200000,\r\n                    1694649600000,\r\n                    1694736000000,\r\n                    1694822400000,\r\n                    1694908800000,\r\n                    1694995200000,\r\n                    1695081600000,\r\n                    1695168000000,\r\n                    1695254400000,\r\n                    1695340800000,\r\n                    1695427200000,\r\n                    1695513600000,\r\n                    1695600000000,\r\n                    1695686400000,\r\n                    1695772800000,\r\n                    1695859200000,\r\n                    1695945600000,\r\n                    1696032000000,\r\n                    1696118400000,\r\n                    1696204800000,\r\n                    1696291200000,\r\n                    1696377600000,\r\n                    1696464000000,\r\n                    1696550400000,\r\n                    1696636800000,\r\n                    1696723200000,\r\n                    1696809600000,\r\n                    1696896000000,\r\n                    1696982400000,\r\n                    1697068800000,\r\n                    1697155200000,\r\n                    1697241600000,\r\n                    1697328000000,\r\n                    1697414400000,\r\n                    1697500800000,\r\n                    1697587200000,\r\n                    1697673600000,\r\n                    1697760000000,\r\n                    1697846400000,\r\n                    1697932800000,\r\n                    1698019200000,\r\n                    1698105600000,\r\n                    1698192000000,\r\n                    1698278400000,\r\n                    1698364800000,\r\n                    1698451200000,\r\n                    1698537600000,\r\n                    1698624000000,\r\n                    1698710400000,\r\n                    1698796800000,\r\n                    1698883200000,\r\n                    1698969600000,\r\n                    1699056000000,\r\n                    1699142400000,\r\n                    1699228800000,\r\n                    1699315200000,\r\n                    1699401600000,\r\n                    1699488000000,\r\n                    1699574400000,\r\n                    1699660800000,\r\n                    1699747200000,\r\n                    1699833600000,\r\n                    1699920000000,\r\n                    1700006400000,\r\n                    1700092800000,\r\n                    1700179200000,\r\n                    1700265600000,\r\n                    1700352000000,\r\n                    1700438400000,\r\n                    1700524800000,\r\n                    1700611200000,\r\n                    1700697600000,\r\n                    1700784000000,\r\n                    1700870400000,\r\n                    1700956800000,\r\n                    1701043200000,\r\n                    1701129600000,\r\n                    1701216000000,\r\n                    1701302400000,\r\n                    1701388800000,\r\n                    1701475200000,\r\n                    1701561600000,\r\n                    1701648000000,\r\n                    1701734400000,\r\n                    1701820800000,\r\n                    1701907200000,\r\n                    1701993600000,\r\n                    1702080000000,\r\n                    1702166400000,\r\n                    1702252800000,\r\n                    1702339200000,\r\n                    1702425600000,\r\n                    1702512000000,\r\n                    1702598400000,\r\n                    1702684800000,\r\n                    1702771200000,\r\n                    1702857600000,\r\n                    1702944000000,\r\n                    1703030400000,\r\n                    1703116800000,\r\n                    1703203200000,\r\n                    1703289600000,\r\n                    1703376000000,\r\n                    1703462400000,\r\n                    1703548800000,\r\n                    1703635200000,\r\n                    1703721600000,\r\n                    1703808000000,\r\n                    1703894400000,\r\n                    1703980800000,\r\n                    1704067200000,\r\n                    1704153600000,\r\n                    1704240000000,\r\n                    1704326400000,\r\n                    1704412800000,\r\n                    1704499200000,\r\n                    1704585600000,\r\n                    1704672000000,\r\n                    1704758400000,\r\n                    1704844800000,\r\n                    1704931200000,\r\n                    1705017600000,\r\n                    1705449600000,\r\n                    1705536000000,\r\n                    1705622400000,\r\n                    1705708800000,\r\n                    1705795200000,\r\n                    1705881600000,\r\n                    1705968000000,\r\n                    1706054400000,\r\n                    1706140800000,\r\n                    1706227200000,\r\n                    1706313600000,\r\n                    1706400000000,\r\n                    1706486400000,\r\n                    1706572800000,\r\n                    1706659200000,\r\n                    1706745600000,\r\n                    1706832000000,\r\n                    1706918400000,\r\n                    1707004800000,\r\n                    1707091200000,\r\n                    1707177600000,\r\n                    1707264000000,\r\n                    1707350400000,\r\n                    1707436800000,\r\n                    1707523200000,\r\n                    1707609600000,\r\n                    1707696000000,\r\n                    1707782400000,\r\n                    1707868800000,\r\n                    1707955200000\r\n                  ],\r\n                  [\r\n                    84.92,\r\n                    88.15,\r\n                    88.65,\r\n                    89.27,\r\n                    90.54,\r\n                    91.6,\r\n                    91.89,\r\n                    92.74,\r\n                    93.82,\r\n                    95.7,\r\n                    96.49,\r\n                    97.03,\r\n                    98.27,\r\n                    100.36,\r\n                    103.38,\r\n                    105.07,\r\n                    107.99,\r\n                    109.24,\r\n                    111.148,\r\n                    112.059,\r\n                    114.242,\r\n                    115.547,\r\n                    117.169,\r\n                    119.829,\r\n                    124.029,\r\n                    130.158,\r\n                    131.668,\r\n                    133.525,\r\n                    134.398,\r\n                    135.329,\r\n                    139.535,\r\n                    144.059,\r\n                    148.499,\r\n                    151.544,\r\n                    152.288,\r\n                    153.966,\r\n                    157.019,\r\n                    160.46,\r\n                    163.297,\r\n                    164.165,\r\n                    166.314,\r\n                    170.78,\r\n                    173.145,\r\n                    174.465,\r\n                    175.862,\r\n                    177.783,\r\n                    180.631,\r\n                    183.24,\r\n                    187.299,\r\n                    190.043,\r\n                    192.459,\r\n                    194.557,\r\n                    196.731,\r\n                    200.362,\r\n                    204.619,\r\n                    206.221,\r\n                    207.745,\r\n                    212.433,\r\n                    215.708,\r\n                    218.609,\r\n                    223.609,\r\n                    228.183,\r\n                    231.833,\r\n                    235.244,\r\n                    238.1,\r\n                    239.358,\r\n                    240.475,\r\n                    243.122,\r\n                    244.573,\r\n                    245.954,\r\n                    249.548,\r\n                    252.948,\r\n                    256.643,\r\n                    259.257,\r\n                    263.067,\r\n                    268.083,\r\n                    271.929,\r\n                    275.635,\r\n                    279.292,\r\n                    282.908,\r\n                    284.706,\r\n                    287.946,\r\n                    292.699,\r\n                    297.399,\r\n                    302.305,\r\n                    307.22,\r\n                    311.943,\r\n                    316.808,\r\n                    321.787,\r\n                    326.572,\r\n                    331.222,\r\n                    335.542,\r\n                    340.433,\r\n                    345.045,\r\n                    348.69,\r\n                    352.676,\r\n                    356.315,\r\n                    360.539,\r\n                    364.751,\r\n                    368.992,\r\n                    373.069,\r\n                    377.335,\r\n                    381.152,\r\n                    384.696,\r\n                    388,\r\n                    391.51,\r\n                    394.757,\r\n                    397.526,\r\n                    400.42,\r\n                    404.159,\r\n                    407.787,\r\n                    411.842,\r\n                    416.21,\r\n                    420.993,\r\n                    425.216,\r\n                    427.882,\r\n                    430.201,\r\n                    432.993,\r\n                    435.624,\r\n                    437.024,\r\n                    441.055,\r\n                    444.417,\r\n                    448.625,\r\n                    452.212,\r\n                    457.173,\r\n                    462.021,\r\n                    465.946,\r\n                    470.014,\r\n                    473.792,\r\n                    478.099,\r\n                    482.31,\r\n                    486.08,\r\n                    489.665,\r\n                    491.252,\r\n                    495.72,\r\n                    499.609,\r\n                    504.237,\r\n                    507.258,\r\n                    510.174,\r\n                    512.218,\r\n                    515.8,\r\n                    517.445,\r\n                    520.146,\r\n                    521.736,\r\n                    524.457,\r\n                    524.991,\r\n                    527.023,\r\n                    529.814,\r\n                    532.284,\r\n                    534.045,\r\n                    537.167,\r\n                    538.121,\r\n                    539.423,\r\n                    541.915,\r\n                    544.916,\r\n                    546.361,\r\n                    548.485,\r\n                    551.428,\r\n                    554.33,\r\n                    558.663,\r\n                    562.967,\r\n                    565.126,\r\n                    567.864,\r\n                    570.148,\r\n                    572.12,\r\n                    574.805,\r\n                    578.82,\r\n                    583.082,\r\n                    585.083,\r\n                    589.136,\r\n                    593.152,\r\n                    597.075,\r\n                    601.265,\r\n                    603.151,\r\n                    605.253,\r\n                    607.092,\r\n                    612.097,\r\n                    614.006,\r\n                    616.847,\r\n                    619.729,\r\n                    620.961,\r\n                    624.486,\r\n                    627.228,\r\n                    631.27,\r\n                    635.246,\r\n                    639.223,\r\n                    643.138,\r\n                    646.998,\r\n                    650.711,\r\n                    654.257,\r\n                    657.831,\r\n                    661.014,\r\n                    662.878,\r\n                    666.165,\r\n                    669.854,\r\n                    673.089,\r\n                    675.993,\r\n                    677.187,\r\n                    680.418,\r\n                    683.06,\r\n                    684.37,\r\n                    686.981,\r\n                    689.75,\r\n                    693.235,\r\n                    696.742,\r\n                    700.188,\r\n                    703.348,\r\n                    706.227,\r\n                    707.95,\r\n                    710.433,\r\n                    713.63,\r\n                    716.576,\r\n                    717.42,\r\n                    720.052,\r\n                    721.203,\r\n                    723.444,\r\n                    725.243,\r\n                    726.898,\r\n                    727.94,\r\n                    730.275,\r\n                    732.825,\r\n                    733.226,\r\n                    734.95,\r\n                    737.383,\r\n                    738.976,\r\n                    740.942,\r\n                    742.545,\r\n                    743.985,\r\n                    744.435,\r\n                    744.917,\r\n                    746.721,\r\n                    747.248,\r\n                    747.899,\r\n                    748.207,\r\n                    748.334,\r\n                    749.096,\r\n                    749.766,\r\n                    750.164,\r\n                    750.487,\r\n                    751.027,\r\n                    752.039,\r\n                    752.645,\r\n                    752.983,\r\n                    753.695,\r\n                    754.092,\r\n                    754.621,\r\n                    755.451,\r\n                    756.052,\r\n                    756.616,\r\n                    756.767,\r\n                    757.22,\r\n                    757.859,\r\n                    758.216,\r\n                    758.289,\r\n                    758.566,\r\n                    759.412,\r\n                    759.641,\r\n                    759.979,\r\n                    760.132,\r\n                    761.009,\r\n                    761.69,\r\n                    762.349,\r\n                    763.43,\r\n                    763.793,\r\n                    764.391,\r\n                    764.939,\r\n                    765.325,\r\n                    765.376,\r\n                    765.805,\r\n                    766.184,\r\n                    766.469,\r\n                    766.647,\r\n                    766.909,\r\n                    767.996,\r\n                    768.101,\r\n                    768.125,\r\n                    768.233,\r\n                    768.388,\r\n                    768.477,\r\n                    768.634,\r\n                    769.092,\r\n                    769.56,\r\n                    769.664,\r\n                    770.268,\r\n                    770.464,\r\n                    770.765,\r\n                    771.342,\r\n                    771.482,\r\n                    771.693,\r\n                    771.828,\r\n                    772.436,\r\n                    772.571,\r\n                    772.743,\r\n                    772.953,\r\n                    773.082,\r\n                    773.15,\r\n                    773.653,\r\n                    773.879,\r\n                    774.744,\r\n                    774.945,\r\n                    775.386,\r\n                    775.528,\r\n                    775.915,\r\n                    776.009,\r\n                    776.633,\r\n                    777.149,\r\n                    777.552,\r\n                    777.734,\r\n                    777.948,\r\n                    778.602,\r\n                    779.859,\r\n                    780.876,\r\n                    782.098,\r\n                    782.34,\r\n                    784.212,\r\n                    784.564,\r\n                    785.783,\r\n                    786.24,\r\n                    787.032,\r\n                    787.165,\r\n                    788.058,\r\n                    788.772,\r\n                    789.975,\r\n                    790.402,\r\n                    792.091,\r\n                    793.734,\r\n                    795.216,\r\n                    795.853,\r\n                    796.611,\r\n                    798.04,\r\n                    799.464,\r\n                    799.965,\r\n                    800.302,\r\n                    802.168,\r\n                    802.448,\r\n                    802.624,\r\n                    802.853,\r\n                    803.167,\r\n                    803.79,\r\n                    804.383,\r\n                    805.19,\r\n                    806.933,\r\n                    807.315,\r\n                    807.396\r\n                  ]\r\n                ]\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ],\r\n      \"timeFrom\": \"1y\",\r\n      \"title\": \"Reproduced with embedded data\",\r\n      \"type\": \"timeseries\"\r\n    },\r\n    {\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 5,\r\n      \"options\": {\r\n        \"content\": \"\u003ctable width=\\\"100%\\\"\u003e\\n    \u003ctr\u003e\\n      \u003cth width=\\\"2%\\\"\u003ePanel\u003c/th\u003e\\n      \u003ctd \u003etimeseries @ 10.3.1 (00a22ff8b28550d593ec369ba3da1b25780f0a4a)\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \u003ctr\u003e\\n      \u003cth\u003eQueries\u003c/th\u003e\\n      \u003ctd\u003eA[influxdb], B[influxdb]\u003c/td\u003e\\n    \u003c/tr\u003e\\n    \\n    \u003ctr\u003e\u003cth\u003eData\u003c/th\u003e\u003ctd\u003e 2 frames, 4 fields, 710 rows \u003c/td\u003e\u003c/tr\u003e\\n    \\n    \u003ctr\u003e\\n      \u003cth\u003eGrafana\u003c/th\u003e\\n      \u003ctd\u003e10.3.1 (00a22ff8b28550d593ec369ba3da1b25780f0a4a) // Open Source\u003c/td\u003e\\n    \u003c/tr\u003e\\n  \u003c/table\u003e\",\r\n        \"mode\": \"html\"\r\n      },\r\n      \"title\": \"Debug info\",\r\n      \"type\": \"text\"\r\n    },\r\n    {\r\n      \"id\": 6,\r\n      \"title\": \"Original Panel JSON\",\r\n      \"type\": \"text\",\r\n      \"gridPos\": {\r\n        \"h\": 13,\r\n        \"w\": 9,\r\n        \"x\": 15,\r\n        \"y\": 7\r\n      },\r\n      \"options\": {\r\n        \"content\": \"{\\n  \\\"datasource\\\": {\\n    \\\"type\\\": \\\"influxdb\\\",\\n    \\\"uid\\\": \\\"7JmJLax4k\\\"\\n  },\\n  \\\"description\\\": \\\"\\\",\\n  \\\"fieldConfig\\\": {\\n    \\\"defaults\\\": {\\n      \\\"custom\\\": {\\n        \\\"drawStyle\\\": \\\"bars\\\",\\n        \\\"lineInterpolation\\\": \\\"linear\\\",\\n        \\\"barAlignment\\\": 0,\\n        \\\"lineWidth\\\": 0,\\n        \\\"fillOpacity\\\": 100,\\n        \\\"gradientMode\\\": \\\"none\\\",\\n        \\\"spanNulls\\\": false,\\n        \\\"insertNulls\\\": false,\\n        \\\"showPoints\\\": \\\"auto\\\",\\n        \\\"pointSize\\\": 5,\\n        \\\"stacking\\\": {\\n          \\\"mode\\\": \\\"none\\\",\\n          \\\"group\\\": \\\"A\\\"\\n        },\\n        \\\"axisPlacement\\\": \\\"auto\\\",\\n        \\\"axisLabel\\\": \\\"\\\",\\n        \\\"axisColorMode\\\": \\\"text\\\",\\n        \\\"axisBorderShow\\\": false,\\n        \\\"scaleDistribution\\\": {\\n          \\\"type\\\": \\\"linear\\\"\\n        },\\n        \\\"axisCenteredZero\\\": false,\\n        \\\"hideFrom\\\": {\\n          \\\"tooltip\\\": false,\\n          \\\"viz\\\": false,\\n          \\\"legend\\\": false\\n        },\\n        \\\"thresholdsStyle\\\": {\\n          \\\"mode\\\": \\\"off\\\"\\n        }\\n      },\\n      \\\"unitScale\\\": true,\\n      \\\"color\\\": {\\n        \\\"mode\\\": \\\"palette-classic\\\"\\n      },\\n      \\\"mappings\\\": [],\\n      \\\"thresholds\\\": {\\n        \\\"mode\\\": \\\"absolute\\\",\\n        \\\"steps\\\": [\\n          {\\n            \\\"color\\\": \\\"green\\\",\\n            \\\"value\\\": null\\n          }\\n        ]\\n      },\\n      \\\"min\\\": 0,\\n      \\\"unit\\\": \\\"watth\\\"\\n    },\\n    \\\"overrides\\\": [\\n      {\\n        \\\"matcher\\\": {\\n          \\\"id\\\": \\\"byName\\\",\\n          \\\"options\\\": \\\"Energie gesamt\\\"\\n        },\\n        \\\"properties\\\": [\\n          {\\n            \\\"id\\\": \\\"custom.drawStyle\\\",\\n            \\\"value\\\": \\\"line\\\"\\n          },\\n          {\\n            \\\"id\\\": \\\"unit\\\",\\n            \\\"value\\\": \\\"kwatth\\\"\\n          },\\n          {\\n            \\\"id\\\": \\\"custom.fillOpacity\\\",\\n            \\\"value\\\": 0\\n          },\\n          {\\n            \\\"id\\\": \\\"custom.lineWidth\\\",\\n            \\\"value\\\": 2\\n          }\\n        ]\\n      }\\n    ]\\n  },\\n  \\\"gridPos\\\": {\\n    \\\"h\\\": 10,\\n    \\\"w\\\": 14,\\n    \\\"x\\\": 10,\\n    \\\"y\\\": 20\\n  },\\n  \\\"id\\\": 33,\\n  \\\"options\\\": {\\n    \\\"tooltip\\\": {\\n      \\\"mode\\\": \\\"multi\\\",\\n      \\\"sort\\\": \\\"none\\\"\\n    },\\n    \\\"legend\\\": {\\n      \\\"showLegend\\\": true,\\n      \\\"displayMode\\\": \\\"list\\\",\\n      \\\"placement\\\": \\\"bottom\\\",\\n      \\\"calcs\\\": [\\n        \\\"lastNotNull\\\",\\n        \\\"min\\\",\\n        \\\"max\\\",\\n        \\\"mean\\\"\\n      ]\\n    }\\n  },\\n  \\\"targets\\\": [\\n    {\\n      \\\"alias\\\": \\\"Energie\\\",\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"influxdb\\\",\\n        \\\"uid\\\": \\\"7JmJLax4k\\\"\\n      },\\n      \\\"groupBy\\\": [\\n        {\\n          \\\"params\\\": [\\n            \\\"1d\\\"\\n          ],\\n          \\\"type\\\": \\\"time\\\"\\n        },\\n        {\\n          \\\"params\\\": [\\n            \\\"null\\\"\\n          ],\\n          \\\"type\\\": \\\"fill\\\"\\n        }\\n      ],\\n      \\\"hide\\\": false,\\n      \\\"measurement\\\": \\\"mqtt_consumer\\\",\\n      \\\"orderByTime\\\": \\\"ASC\\\",\\n      \\\"policy\\\": \\\"default\\\",\\n      \\\"refId\\\": \\\"A\\\",\\n      \\\"resultFormat\\\": \\\"time_series\\\",\\n      \\\"select\\\": [\\n        [\\n          {\\n            \\\"params\\\": [\\n              \\\"value\\\"\\n            ],\\n            \\\"type\\\": \\\"field\\\"\\n          },\\n          {\\n            \\\"params\\\": [],\\n            \\\"type\\\": \\\"max\\\"\\n          }\\n        ]\\n      ],\\n      \\\"tags\\\": [\\n        {\\n          \\\"key\\\": \\\"topic\\\",\\n          \\\"operator\\\": \\\"=\\\",\\n          \\\"value\\\": \\\"solar/114182126084/0/yieldday\\\"\\n        }\\n      ]\\n    },\\n    {\\n      \\\"alias\\\": \\\"Energie gesamt\\\",\\n      \\\"datasource\\\": {\\n        \\\"type\\\": \\\"influxdb\\\",\\n        \\\"uid\\\": \\\"7JmJLax4k\\\"\\n      },\\n      \\\"groupBy\\\": [\\n        {\\n          \\\"params\\\": [\\n            \\\"1d\\\"\\n          ],\\n          \\\"type\\\": \\\"time\\\"\\n        },\\n        {\\n          \\\"params\\\": [\\n            \\\"none\\\"\\n          ],\\n          \\\"type\\\": \\\"fill\\\"\\n        }\\n      ],\\n      \\\"hide\\\": false,\\n      \\\"measurement\\\": \\\"mqtt_consumer\\\",\\n      \\\"orderByTime\\\": \\\"ASC\\\",\\n      \\\"policy\\\": \\\"default\\\",\\n      \\\"refId\\\": \\\"B\\\",\\n      \\\"resultFormat\\\": \\\"time_series\\\",\\n      \\\"select\\\": [\\n        [\\n          {\\n            \\\"params\\\": [\\n              \\\"value\\\"\\n            ],\\n            \\\"type\\\": \\\"field\\\"\\n          },\\n          {\\n            \\\"params\\\": [],\\n            \\\"type\\\": \\\"max\\\"\\n          }\\n        ]\\n      ],\\n      \\\"tags\\\": [\\n        {\\n          \\\"key\\\": \\\"topic::tag\\\",\\n          \\\"operator\\\": \\\"=\\\",\\n          \\\"value\\\": \\\"solar/114182126084/0/yieldtotal\\\"\\n        }\\n      ]\\n    }\\n  ],\\n  \\\"timeFrom\\\": \\\"1y\\\",\\n  \\\"title\\\": \\\"Produktion pro Tag\\\",\\n  \\\"type\\\": \\\"timeseries\\\"\\n}\",\r\n        \"mode\": \"code\",\r\n        \"code\": {\r\n          \"language\": \"json\",\r\n          \"showLineNumbers\": true,\r\n          \"showMiniMap\": true\r\n        }\r\n      }\r\n    },\r\n    {\r\n      \"id\": 3,\r\n      \"title\": \"Data from panel above\",\r\n      \"type\": \"table\",\r\n      \"datasource\": {\r\n        \"type\": \"datasource\",\r\n        \"uid\": \"-- Dashboard --\"\r\n      },\r\n      \"gridPos\": {\r\n        \"h\": 7,\r\n        \"w\": 15,\r\n        \"x\": 0,\r\n        \"y\": 13\r\n      },\r\n      \"options\": {\r\n        \"showTypeIcons\": true\r\n      },\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"type\": \"datasource\",\r\n            \"uid\": \"-- Dashboard --\"\r\n          },\r\n          \"panelId\": 2,\r\n          \"withTransforms\": true,\r\n          \"refId\": \"A\"\r\n        }\r\n      ]\r\n    }\r\n  ],\r\n  \"schemaVersion\": 37,\r\n  \"title\": \"Debug: Produktion pro Tag // 2024-02-15 10:28:56\",\r\n  \"tags\": [\r\n    \"debug\",\r\n    \"debug-timeseries\"\r\n  ],\r\n  \"time\": {\r\n    \"from\": \"2024-02-14T21:28:56.601Z\",\r\n    \"to\": \"2024-02-15T09:28:56.601Z\"\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\n\n### Environment (with versions)?\n\nGrafana: 10.3.1\r\nOS: Debian 12.5\r\nBrowser: Firefox 122.0.1 and Chromium 121.0.6167.160\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\nInfluxDB 2.7.5","labels":["area/dashboard","team/grafana-dashboards"]},{"id":63375,"title":"Heatmap row order flips","body":"**What happened**:\r\nWe are using a Heatmap with Timeseries Buckets. These buckets on the y-axis need to be in a particular order (1 at the top and 50 at the bottom). We use the \"Reverse Order\" feature. On occasion, especially after editing the heatmap or changing time ranges, the order will flip to 50 at the top and 1 at the bottom. A refresh will typically fix the order, but it is in a production environment and we are getting complaints.\r\n\r\n**What you expected to happen**:\r\nThe order to remain 1 to 50 from top to bottom\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate a heatmap, use time series buckets, enable \"revers order\", edit the heatmap, see if the rows flip order.\r\n\r\n**Anything else we need to know?**:\r\nI am using Amazon Managed Grafana\r\n\r\n**Environment**:\r\n- Grafana version: v8.4.7\r\n- Data source type \u0026 version: Amazon Timestream\r\n- OS Grafana is installed on: Amazon Managed (most likely Linux)\r\n- User OS \u0026 Browser: Windows 10 and Google Chrome\r\n- Grafana plugins: \r\n- Others:\r\n","labels":["needs more info","area/panel/heatmap"]},{"id":59868,"title":"Alerting: Provisioning: Bug: issue with provisioning directory picking up exported rules","body":"**What happened**:\r\nThe alerting provisioning as described in the [documentation](https://grafana.com/docs/grafana/latest/alerting/set-up/provision-alerting-resources/file-provisioning/) does not work with JSON files.\r\n\r\n**What you expected to happen**:\r\nJSON data exported from the API and placed into a file gets populated in the UI.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Get alert JSON via API `/api/v1/provisioning/alert-rules/{UID}`.\r\n2. Place it into the provisioning directory: `/etc/grafana/provisioning/alerting/`.\r\n3. Configure Grafana:\r\n```\r\n[paths]\r\n...\r\nprovisioning = /etc/grafana/provisioning\r\n...\r\n[unified_alerting]\r\nenabled = true\r\n...\r\n```\r\n4. Restart Grafana\r\n5. The rule is not marked as \"provisioned\" in the UI.\r\n6. If I rename the rule in the JSON file, the alert with the new name does not appear in the UI.\r\n\r\n**Anything else we need to know?**:\r\nI added these rules when I was using Grafana 7.x, later I updated to 8 and now to 9.3.\r\nI have these rules (legacy-style) in the Alert tab of some panels. These panels are on dashboards that are provisioned from files.\r\n\r\nI would be happy to keep using the same approach, but provisioning alerts from the dashboard files does not work anymore (i.e. they can be changed in the UI and after I restart Grafana, those changes are not reset).\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.0\r\n- Data source type \u0026 version: prometheus\r\n- OS Grafana is installed on: Linux\r\n- User OS \u0026 Browser: Chrome\r\n- Grafana plugins: N/A\r\n- Others: N/A\r\n","labels":["area/alerting","triage/needs-confirmation"]},{"id":47000,"title":" grafana can not show the memory usage","body":"I can not see the memory usage and CPU information\r\n![image](https://user-images.githubusercontent.com/68895932/160557854-368dc187-bba6-471a-bb25-956628a8746b.png)\r\nbut the prometheus is OK\r\n![image](https://user-images.githubusercontent.com/68895932/160558117-49deeed3-c906-4327-95ad-fba5ea896495.png)\r\n\r\nThank you very much if any advance!!!\r\n","labels":["type/question","area/dashboard","needs more info","area/panel/gauge"]},{"id":71108,"title":"Alerting: The message template is behaving strangely with migration 9.2.5 to 9.4.10","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\n\r\n  - I recently updated my version of Graphana from 9.2.5 to 9.4.10. After that, alarm messages that were working fine before started behaving strangely.\r\n\r\n**What did you expect to happen**:\r\n\r\n  - Here's my alert rule's configuration:\r\n\r\nA:\r\n```promql\r\nsum(aws_networkelb_healthy_host_count_minimum) by (load_balancer)\r\n```\r\nB:\r\nConditions: WHEN max() OF A IS BELOW 1\r\n\r\nFor an alert rule created in the previous 9.2.5, it works like this:\r\n\r\nYou can see the results of expression B in the alert rule.\r\n\u003cimg width=\"1000\" alt=\"normal-1\" src=\"https://github.com/grafana/grafana/assets/32067275/f9f3e04f-0765-4171-b6db-7a32ae5bef51\"\u003e\r\n\r\nYou can see that the values in B are mapped to the names of the values in the load_balancer that A's aggregation was based on.\r\n\u003cimg width=\"1000\" alt=\"normal-2\" src=\"https://github.com/grafana/grafana/assets/32067275/6ee9e27b-ceb6-453e-b3cf-833c61257134\"\u003e\r\n\r\nHowever, after 9.4.10, alert rules created with the same alert rule configuration behave as follows.\r\n\r\nYou can see the results of expression B in the alert rule.\r\n\u003cimg width=\"1000\" alt=\"abnormal-1\" src=\"https://github.com/grafana/grafana/assets/32067275/cb7a82b7-fa01-4cd6-be5e-95e5da9a1df5\"\u003e\r\n\r\nHowever, as in 9.2.5, the values in B do not map to the values in the load_balancer.\r\n\u003cimg width=\"1000\" alt=\"abnormal-2\" src=\"https://github.com/grafana/grafana/assets/32067275/5b6230f9-8b27-4219-a559-5867cbd7cc26\"\u003e\r\n\r\n\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\n- make alert rule in grafana 9.2.5 (I call this \"alert rule A\")\r\n\r\n**Step 2**:\r\n\r\n- upgrade grafana version 9.4.10\r\n\r\n**Step 3**:\r\n\r\n- make alert rule in grafana 9.4.10 with same configuration \"alert rule A\" (I call this \"alert rule B\")\r\n\r\n**Step 4**:\r\n\r\n- check your contact point output, \"alert rule A\" will behave as it did in 9.2.5, even when updated to 9.4.10. However, you can see that \"alert rule B\" has strange templating behavior even though it has the same configuration.\r\n\r\nI noticed that the response in \"alert rule A\" has a \"metric\" in the \"valueString\" field, but alert rule B does not. Is this an issue caused by a version difference?\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\nv9.4.10 (migrate from v9.2.5)\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\n_No response_\r\n\r\n### Grafana Platform?\r\n\r\nKubernetes\r\n\r\n### User's OS?\r\n\r\nmac os ventura 13.1(22C65)\r\n\r\n### User's Browser?\r\n\r\ngoogle chrome  v114.0.5735.198 (x86_64)\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\nprometheus / thanos\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["needs more info","area/alerting"]},{"id":44452,"title":"Grafana on Openhabian suddenly stops loading from most of my computers and browsers","body":"Hi to everyone,\r\n\r\nYesterday I’ve just found out that my Grafana on OpenHabian not working anymore, when trying to connect on Grafana, it says:\r\n\" If you’re seeing this Grafana has failed to load its application files\"\r\n![grafana](https://user-images.githubusercontent.com/97183706/151050391-5f545249-3d88-4bca-ae1f-72b2d73f0a29.JPG)\r\n\r\nHowever, after few hours of debbuging, reinstalling Grafana and even set up a complete new OpenHabian installation with Grafana (no customization at all, just clean install of Debian 11 and latest OpenHabian with menu driven Grafana and InfluxDB installation) I found out that same error happens when trying to access that new installation.\r\n\r\nInvestigating further, I found out that I can access Grafana with my mobile phone when using Samsung browser. Also I can access Grafana from my other PC, but only with Chrome.\r\n\r\nSo, I have my PC on which Grafana cannot be loaded from some reason (it worked for two years without problems until few days ago):\r\nWindows 10 Pro 12H2, with latest updates and browsers\r\nBrowsers: Chrome, Edge, Firefox - nothing works\r\n\r\nOn my other PC, same OS and browser versions, only Chrome works.\r\n\r\nFrom mobile phone (Redmi Note 10S), Chrome not working, Samsung browser works.\r\nOld mobile phone (Samsung J5), Chrome works OK\r\n\r\nSome other virtual Windows 10 Pro (20H2) machine: Edge and Chrome not working\r\n\r\nI am totaly confused and don’t know why on some devices and even same browsers works and other not.\r\nIt is obvious that Grafana service working OK, but problem is related to client that is accessing Grafana.\r\n\r\nAny clue from anyone?\r\n\r\nPlatform information:\r\nHardware: Qnap TS-453D/Intel Celeron J4125/ Virtual machine\r\nOS: Debian 10.11\r\nJava Runtime Environment: OpenJDK Runtime Environment Zulu11.52+13-CA (build 11.0.13+8-LTS)\r\nopenHAB version: 3.2.0 (OpenHabian)\r\nGrafana version: 8.3.4\r\n\r\nThanks.\r\n\r\n\r\n","labels":["needs more info","needs investigation","area/frontend","bot/no new info"]},{"id":54441,"title":"Plugins Catalog: Unable to filter plugins using special characters","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nPlugin having name as \"Graph (old)\" was not shown in the list as soon as the search string had \"(\" character\r\n\r\n**What you expected to happen**:\r\nIt should show \"Graph (old)\" plugin\r\n\r\n**Environment**:\r\n- Grafana version: v9.0.2\r\n\r\n","labels":["needs more info","area/search"]},{"id":80347,"title":"Alerting: provisioning of alerting aren't protected from changes","body":"### What happened?\r\n\r\nProvisioned policies and contact-points can be modified via `/alerting/admin`\r\n\r\n### What did you expect to happen?\r\n\r\nEditing and saving of configuration in `/alerting/admin` page should be blocked from modifications if there any provisioned alerting resources like policies, contact-points and notification templates exist - it not fully works this way.\r\n\r\n- Resetting to defaults also should be blocked, but in practice, it doesn't.\r\n- Contact-points aren't protected from changes\r\n\r\n\r\nResetting could be allowed ONLY if it will re-apply all provisioned resources before ending \"reset process\", but now the reset button just resets all settings to real Grafana defaults.\r\n\r\n### Did this work before?\r\n\r\nNope\r\n\r\n### How do we reproduce it?\r\n\r\n1. Provision alerting (policies and contact-points)\r\n2. Check that you can't modify policies as they provisioned\r\n3. Check that you can't modify contact-points as they provisioned (but it's doesn't work and you will get modified they provisioned contact-point)\r\n4. Reset settings in Alerting Admin\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nNo\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.1.5\r\nOS: any\r\nBrowser: any\r\n\r\n\r\n### Grafana platform?\r\n\r\nKubernetes\r\n\r\n### Datasource(s)?\r\n\r\nN/A","labels":["area/alerting"]},{"id":65761,"title":"Value always zero in stat panel when using transformation data from another panel with dashboard as data source","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nIn order to reduce the number of queries i want to use the output of a transformation from another overview time series panel as data source in a `stat` panel. The data curve is displayed correctly but the value (using `Last *` calculation option and choosing the required transformation field).\r\nWhen using non-transformation values with the same method, the value is displayed correctly, only when using a transformation as source i get always zero as text display, even though the current value is no zero:\r\n\r\n![Stat Panel](https://user-images.githubusercontent.com/79222544/229368143-91886e3c-8cc2-48ff-ba66-2c7dda7e82f4.gif)\r\n\r\n**What you expected to happen**:\r\nThe last non-zero value is displayed correctly, similar to when using a non-transformation value as source.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate a  time series panel with two queries.\r\nAdd a binary transformation to add the two query values.\r\nUse the added value in another stat panel as dashboard data source.\r\n\r\n**Anything else we need to know?**:\r\nIn the data inspector the data from the value \"PV Gesamt\" can clearly be seen to be non-zero:\r\n\r\n![Inspect](https://user-images.githubusercontent.com/79222544/229368430-35b8b831-2b1c-4fa9-abf2-dea79450ddae.gif)\r\n\r\nIn the overview panel the non-transform values can be seen with correct data, the transformation result \"PV Gesamt\" and some others are displayed as zero (the displayed values are not the same as in the inspect due to the time delay when taking the screen shots, the values can be found in the table at time 19:07:00):\r\n\r\n![Overview Panel](https://user-images.githubusercontent.com/79222544/229368227-62670ff7-a004-48c0-a6fc-5215f30b2e6e.gif)\r\n\r\n\r\n\r\n**Environment**:\r\n- Grafana version: v9.4.3\r\n- Data source type \u0026 version: InfluxdB 1.8.10\r\n- OS Grafana is installed on: Raspbian Bullseye, Kernel 6.1.19-v8+\r\n- User OS \u0026 Browser: Windows 10, Firefox 111.0.1\r\n- Grafana plugins: Sun\u0026Moon\r\n- Others:\r\n","labels":["area/panel/stat","area/transformations","triage/needs-confirmation"]},{"id":64308,"title":"Thresholds not applying to columns with mixed data types","body":"**Upgraded from 8.0.6 to 9.4.3**:\r\n\r\n**Previously Each cell within each threshold changed to the relevant colour for the columns 1/7 - 1/6.\r\nE.g. \u003c=79 - Red, 80-84 - Orange, \u003e85 - Green**:\r\n\r\n**Create Columns with mixed data types and apply number thresholds**:\r\n\r\n**This worked in 8.* but not in 9.* **:\r\n\r\n**Environment**:\r\n- Grafana version:9.4.3\r\n- Data source type \u0026 version:SQL Server\r\n- OS Grafana is installed on: WIndows 2016\r\n- User OS \u0026 Browser: Chrome / Edge\r\n- Grafana plugins: Table\r\n- Others:\r\n\u003cimg width=\"679\" alt=\"image\" src=\"https://user-images.githubusercontent.com/12542746/223420048-00bc7300-6c29-46d6-834a-9258f69c222f.png\"\u003e\r\n\u003cimg width=\"159\" alt=\"image\" src=\"https://user-images.githubusercontent.com/12542746/223420206-d639a3cc-f3f1-4630-ad32-da113d50ecbe.png\"\u003e\r\n\u003cimg width=\"158\" alt=\"image\" src=\"https://user-images.githubusercontent.com/12542746/223420286-1d02b5e1-88e5-47a0-bea7-0d8d3baabecf.png\"\u003e\r\n\u003cimg width=\"158\" alt=\"image\" src=\"https://user-images.githubusercontent.com/12542746/223420337-e8dc6975-f141-4bb4-9a96-6d3b689afaec.png\"\u003e\r\n","labels":["area/panel/table"]},{"id":60636,"title":"Prometheus datasource Alert rules can't be loaded","body":"**What happened**:\r\nAfter upgrading to 9.2.4 from 8.5.13, Prometheus data source alert rules can't be loaded anymore, main Alerting UI shows an errors like this:\r\n\r\n```\r\nErrors loading rules\r\nFailed to load the data source configuration for [***](https://***.com/datasources/edit/B3U37jc4k): \u003chtml\u003e\u003cbody\u003e\u003ch1\u003e403 Forbidden\u003c/h1\u003e Request forbidden by administrative rules. \u003c/body\u003e\u003c/html\u003e ; Forbidden\r\n```\r\n\r\nAlso, browser console shows 403 returned for endpoint: {grafana_url}/api/datasources/proxy/1/api/v1/status/buildinfo\r\n\r\n**What you expected to happen**:\r\n\r\nAlerting page can load alerting rules for Prometheus data source.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n* Create a Prometheus datasource as usual, with enabling the option `Manage alerts via Alerting UI`.\r\n* Then go to Alerting main page, and see that alerting rules can't be loaded from Prometheus datasource.\r\n\r\n**Anything else we need to know?**:\r\nPossibly related to this issue: https://github.com/grafana/grafana/issues/60135\r\n\r\nLeaving the `Alertmanager data source` field empty is probably causing this issue. This used to work before, possibly it was using the internal alertmanager of Grafana before, and now that option is not in the list so it's not clear what's the proper configuration for it.\r\n\r\nDatasource configuration:\r\n\r\n```\r\n[{\r\n\t\"id\": 1,\r\n\t\"uid\": \"B3U37jc4k\",\r\n\t\"orgId\": 3,\r\n\t\"name\": \"***\",\r\n\t\"type\": \"prometheus\",\r\n\t\"typeName\": \"Prometheus\",\r\n\t\"typeLogoUrl\": \"public/app/plugins/datasource/prometheus/img/prometheus_logo.svg\",\r\n\t\"access\": \"proxy\",\r\n\t\"url\": \"https://*****\",\r\n\t\"user\": \"\",\r\n\t\"database\": \"\",\r\n\t\"basicAuth\": true,\r\n\t\"isDefault\": false,\r\n\t\"jsonData\": {\r\n\t\t\"alertmanagerUid\": \"_5ooNC54k\",\r\n\t\t\"httpMethod\": \"POST\",\r\n\t\t\"tlsAuthWithCACert\": false,\r\n\t\t\"tlsSkipVerify\": false\r\n\t},\r\n\t\"readOnly\": false\r\n}]\r\n```\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.4\r\n- Data source type \u0026 version: Prometheus\r\n- OS Grafana is installed on: Fedora 35\r\n- User OS \u0026 Browser: Chrome 108.0.5359.94\r\n- Grafana plugins: Prometheus\r\n- Others:\r\n","labels":["area/alerting","area/backend/api","datasource/Prometheus","triage/needs-confirmation"]},{"id":63357,"title":"When saving dashboard a lot of changes would be adding \"null\"","body":"**What happened**:\r\n\r\nSometimes when I leave a dashboard grafana will ask me - Are you sure you want to leave? There are unsaved changes. However, I have not made any changes. When I look at the tab for changes I can see that suddenly there are some useless changes:\r\n\r\n\u003cimg width=\"166\" alt=\"image\" src=\"https://user-images.githubusercontent.com/8693064/218992227-3ded2e45-fb8e-4d51-88c4-8eb07c7a4827.png\"\u003e\r\n\r\nAnd if that was the only case I would just add them and forget about them. But after some refreshes, it wants to remove them again. \r\n\r\nWe have migrated to using the Time Series (new graph) panel.\r\n\r\n**What you expected to happen**:\r\n\r\nNot to forcefully add/remove `null` values\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n I do not have a specific way, sometimes it happens, sometimes it does not.\r\n\r\n**Anything else we need to know?**:\r\n\r\nI am an administrator with full rights on the service\r\n\r\n![grafana null](https://user-images.githubusercontent.com/8693064/218992941-dc5ea2f5-b33b-4d8f-9840-fa4411cd34a4.png)\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.6\r\n- OS Grafana is installed on: docker\r\n- User OS \u0026 Browser: chrome 107 on win10\r\n","labels":["area/dashboard","bot/no new info"]},{"id":59348,"title":"No data interpreted as error with ADX time series","body":"1. Create an Alert Rule with a query returning no data (but otherwise valid), e.g. based on time frame condition.\r\n```kusto\r\ngrafana\r\n| make-series Value=avg(Value) on Time from $__timeFrom to $__timeTo step 1min by TagName\r\n| project-rename Timestamp=Time\r\n```\r\n2. Set state on no data to Alerting.\r\n\u003cimg width=\"370\" alt=\"image\" src=\"https://user-images.githubusercontent.com/4903007/204121003-928b1165-e1cc-454c-92ef-98d2f007e456.png\"\u003e\r\n3. Check rule state\r\n\r\n### Expected\r\nFiring\r\n\r\n### Actual\r\nNormal\r\n\r\n\u003cimg width=\"995\" alt=\"image\" src=\"https://user-images.githubusercontent.com/4903007/204121204-c4f27d09-ae45-48f6-ba8f-97426e5a8aff.png\"\u003e\r\n\r\nError also can be seen in rule edit mode:\r\n\r\n\u003cimg width=\"1178\" alt=\"image\" src=\"https://user-images.githubusercontent.com/4903007/204121331-96236a8a-4dff-437f-9b8c-028ca5caaeaa.png\"\u003e\r\n\r\n\r\n### Environment\r\n- Grafana version: Cloud\r\n- Data source type \u0026 version: Azure Data Explorer v4.1.6\r\n- OS Grafana is installed on: N/A\r\n- User OS \u0026 Browser: MacOS, Chrome\r\n- Grafana plugins: Azure Data Explorer v4.1.6","labels":["effort/small","area/alerting/evaluation","datasource/Azure","timefix"]},{"id":63057,"title":"Item scroll missing","body":"**What happened**:\r\nFor example on the explore window ( [explore](https://play.grafana-zabbix.org/explore?orgId=2\u0026left=%7B%22datasource%22%3A%22000000005%22%2C%22queries%22%3A%5B%7B%22refId%22%3A%22A%22%2C%22resultFormat%22%3A%22time_series%22%2C%22itemTag%22%3A%7B%22filter%22%3A%22Application%3A+Network+interfaces%22%7D%2C%22queryType%22%3A%220%22%2C%22group%22%3A%7B%22filter%22%3A%22Backend%22%7D%2C%22host%22%3A%7B%22filter%22%3A%22backend03%22%7D%2C%22application%22%3A%7B%22filter%22%3A%22%22%7D%2C%22item%22%3A%7B%22filter%22%3A%22%22%7D%2C%22functions%22%3A%5B%5D%2C%22triggers%22%3A%7B%22count%22%3Atrue%2C%22minSeverity%22%3A3%2C%22acknowledged%22%3A2%7D%2C%22trigger%22%3A%7B%22filter%22%3A%22%22%7D%2C%22tags%22%3A%7B%22filter%22%3A%22%22%7D%2C%22proxy%22%3A%7B%22filter%22%3A%22%22%7D%2C%22options%22%3A%7B%22showDisabledItems%22%3Afalse%2C%22skipEmptyValues%22%3Afalse%2C%22disableDataAlignment%22%3Afalse%2C%22useZabbixValueMapping%22%3Afalse%7D%2C%22table%22%3A%7B%22skipEmptyValues%22%3Afalse%7D%7D%5D%2C%22range%22%3A%7B%22from%22%3A%22now-1h%22%2C%22to%22%3A%22now%22%7D%7D) ) in the \"item\" seccion I have a lot of items that doesn't show completly, if I search for them from the top of my mind, they are there, but I don't have them all in a list with an scroll bar on the side to manually look for them.\r\n\r\n**What you expected to happen**:\r\nWhen I want to search for an Item it should have an scrollbar to look all of them instead of just guessing names.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nSame as in first question.\r\n\r\n**Anything else we need to know?**:\r\nIt was working before around v7ish, I am not sure if it is a problem with the zabbix plugin or grafana itself.\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.6\r\n- Data source type \u0026 version: Grafana-Zabbix Plugin - 4.2.10 \r\n- OS Grafana is installed on: Ubuntu 22\r\n- User OS \u0026 Browser: Windows / Firefox, Chrome, etc.\r\n- Grafana plugins: Grafana-Zabbix Plugin - 4.2.10 \r\n- Others:\r\n","labels":[]},{"id":73858,"title":"Impossible to enter label value queries for dashboard variables","body":"### What happened?\r\n\r\nA recent Grafana Cloud update changed the UX of dashboard variable label value queries, which made it next to impossible to create them due to timeouts. Specifically, the old UX allowed us to enter the label query pretty much manually; the only option in the new UX is using the query builder and it takes forever to load and times out most of the time trying to do that for us. I'll try to attach a screen recording but trying to select an option from \"Metric\" dropdown results in a spinning wheel that takes forever to finish if at all and typing a known metrics name there doesn't work at all - it won't take it until the spinning wheel is done. To make matters worse, the query/spinning wheel is terminate the moment I switch the windows so I'm stuck staring at the screen until it almost inevitably times out.\r\n\r\nI asked about this in [Grafana slack](https://grafana.slack.com/archives/C0Y4TLW74/p1692042036900509) and using Series query was mentioned as a possible alternative. It indeed helps a little (as in - it makes it at least physically possible to create a label values query for a variable) but is still a pain. That is, Grafana toggles back to “Label values” UI the moment you hit tab/enter/change the screen etc, with no way of going back to the series query. I.e., you’ll need to start over from scratch if you don’t type your query exactly right. It’s better than nothing but still rather inconvenient and is a significant regression compared to the old UX.\r\n\r\n### What did you expect to happen?\r\n\r\nI expect to be able to create dashboard variable label values query without major pain\r\n\r\n### Did this work before?\r\n\r\nYes. I don't remember the version it worked in; the first version I know it got broken in is v10.2.0-59422pre (25690811) but I can't guarantee that was the first ever version to break this.\r\n\r\n### How do we reproduce it?\r\n\r\n1. Screen recording is attached but, generally, just try to create a dashboard variable label query with a slowish thanos data source\r\n\r\n\r\nhttps://github.com/grafana/grafana/assets/147591/f11ee5dc-4025-4b87-9b17-adb27fdb928b\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nNot exactly, it's inside dashboard's Configuration-\u003eVariables screen\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: v10.2.0-59585pre (24978eff)\r\nOS: OSX\r\nBrowser: Firefox\r\n\r\n\r\n### Grafana platform?\r\n\r\nI use Grafana Cloud\r\n\r\n### Datasource(s)?\r\n\r\nthanos","labels":["needs more info","area/frontend","area/datasource/frontend","area/frontend/library-variables"]},{"id":65038,"title":"With DataSourceVariableSupport, Query Editor not displaying error messages and access Panel Data","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nUsing Datasource query editor for variable query support, by extending DataSourceVariableSupport, and adding it in `this.variables` of the datasource.ts. The query editor is working fine, but is not able to use the `Panel Data`, which is a part of `QueryEditorProps`. This works fine in Explore, but not in Variable Query Editor. Also, the error messages sent from backend are not being displayed\r\n\r\n**What you expected to happen**:\r\n\r\nVariable Query Editor is not displaying error messages sent by response. The Error messages should be displayed as Popover Alerts whenever the query failed. Also, the `Panel Data` (data)  from  `QueryEditorProps` should also be accessible inside the Default Datasource Query Editor, so that Frame response, Loading State etc can also be accessed\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n- Add DataSourceVariableSupport to your datasource\r\n- Run the queries and see if the expected error message is being displayed.\r\n\r\n**Anything else we need to know?**:\r\n\r\nLooks like response Panel Data is not being populated inside query editor in VariableQuerySupport\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.3\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser:\r\n- Grafana plugins: \r\n- Others:\r\n\r\n```[tasklist]\r\n\r\n```","labels":["area/dashboard/templating","needs more info","area/plugins","triage/needs-confirmation"]},{"id":72081,"title":"Using Prometheus query builder model. when the number of metrics is too large, the page is slow to load.","body":"### What happened?\r\n\r\nHi, When the number of metrics reaches a certain threshold (e.g., 200,000),  the API response becomes slow, resulting in a poor user experience.\r\n\r\n![image](https://github.com/grafana/grafana/assets/63951257/fd3a4235-e6a6-46fa-adcf-c77e2720a442)\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nI hope the page can respond quickly，improve the user experience.\r\n\r\n\r\n\r\n\r\n\r\n\r\n### Did this work before?\r\n\r\nIn the previous version (9.1.6), I disabled this feature due to the large number of metrics. However, it seems that the latest version（10.0.2） no longer supports disabling it.\r\n\r\n### How do we reproduce it?\r\n\r\n1. When the number of metrics is exceptionally large\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: v10.0.2\r\nOS: Mac\r\nBrowser: chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nKubernetes\r\n\r\n### Datasource(s)?\r\n\r\nPrometheus","labels":["area/backend/api","datasource/Prometheus","bot/no new info"]},{"id":60645,"title":"Grafana directory listing ignores maxDataPoints","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nWhen consuming `-- Grafana --` datasource with `List public files` query, results are always limited to 100.\r\n\r\nI tried putting a higher and lower `maxDataPoints` limit, both gets ignored and 100 is used in place.\r\n\r\n**What you expected to happen**:\r\n\r\n`maxDataPoints` should be value should be respected.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n1. Create a new dashboard.\r\n2. Choose `-- Grafana --` datasource.\r\n3. For query type choose `List public files`.\r\n4. As `Path` put `img/icons/unicons`.\r\n\r\n**Anything else we need to know?**:\r\n\r\nJust for context, my plan was to use Grafana's icons for a custom plugin I'm currently developing (just the way GeoMap does for markers). That's how I noticed I was only getting the first 100 icons.\r\n\r\nThis issue impacts all plugins currently relying on Grafana's directory listing.\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.5\r\n- Data source type \u0026 version: Grafana\r\n- OS Grafana is installed on: Using docker official image\r\n- User OS \u0026 Browser: Mac OS, chrome\r\n\r\n","labels":["area/dashboard","triage/needs-confirmation","datasource/Grafana"]},{"id":64899,"title":"Auto-refresh triggers zoom refresh when zoom-in is performed","body":"\r\n**What happened**:\r\nGrafana 9.4.3\r\n\r\nThe geomap when zooming in , will reset whenever refresh is performed. Is there a way to prevent it from happening ?\r\n\r\n**What you expected to happen**:\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nHave inbound data in a geomap widget in a dashboard.\r\nRefresh interval set at 10 seconds\r\nZoom in on map \r\nWait for refresh rate\r\nZoom will reset to overhead in widget.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.3\r\n- Data source type \u0026 version: postgresql\r\n- OS Grafana is installed on: Redhat 8.x\r\n- User OS \u0026 Browser: Edge\r\n- Grafana plugins: geomap\r\n- Others:\r\n","labels":["area/panel/geomap","triage/needs-confirmation","area/dashboards/panel"]},{"id":75231,"title":"Adhoc Filters - Enter key doesn't work on custom text entry","body":"\u003c!--\r\nPlease only use this template for submitting accessibility issues.\r\n\r\nThis is a new feature area for Grafana that we want to improve. We have long way to go\r\nto really improve accessibility and would like your help to know where to start.\r\n--\u003e\r\n\r\n**Steps to reproduce**:\r\nHave a dashboard with an adhoc filter and attempt to use the regex comparison operator \"=~\". When typing a custom value that isn't in the dropdown, press the enter key to submit your query.\r\n\r\n**Actual Result**:\r\nEnter key does nothing and I'm left focused on the text input field for the adhoc filter.\r\nI have to click outside of the text field for my query to be submitted.\r\n\r\n**Expected Result**:\r\nPressing enter submits my adhoc filter, and triggers a query to view my requested data.\r\n\r\n**Relevant WCAG Criteria:** [#.#.# WCAG Criterion](link to https://www.w3.org/WAI/WCAG21/quickref/?versions=2.0)\r\nMaybe https://www.w3.org/WAI/WCAG21/quickref/?versions=2.0#keyboard-accessible\r\n\r\n(Not sure if bug or accessibility issue)\r\n\r\n**Environment**:\r\n- Grafana version: 10.1.2\r\n- Data source type \u0026 version: Elasticsearch\r\n- User OS \u0026 Browser: Edge 117.0.2045.36 64Bit\r\n- Others:\r\n","labels":["area/dashboard","area/query-editor","triage/needs-confirmation","team/grafana-dashboards"]},{"id":64805,"title":"duplicated ALERTs in HA setup on VM - AWS EC2 ASG (auto scaling groups) - AWS Timestream","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nGrafana Alerts are duplicated despite the Grafana is configured to use HA Alerting.\r\n\r\n**What you expected to happen**:\r\nNo duplicates should happen for HA Alerting Grafana setup.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n1. We use AWS EC2 to run Grafana servers. EC2 under ASG (auto-scaling groups).\r\n* on each boot, the EC2 instance gets the info about 'peers' and loads the local IP addresses into GF_UNIFIED_ALERTING_HA_* variables that are passed into `/etc/sysconfig/grafana-server`\r\n```\r\nGF_UNIFIED_ALERTING_ENABLED=true\r\nGF_UNIFIED_ALERTING_HA_PUSH_PULL_INTERVAL=200ms\r\nGF_UNIFIED_ALERTING_HA_PEERS='10.10.10.2:9094,10.10.10.1:9094'\r\nGF_UNIFIED_ALERTING_HA_LISTEN_ADDRESS='10.10.10.1:9094'\r\nGF_UNIFIED_ALERTING_HA_ADVERTISE_ADDRESS='10.10.10.1:9094'\r\n```\r\n2. We use **AWS Timestream** as the **datasource** for dashboards and alerts. Here is the example of the query:\r\n```sql\r\nSELECT\r\n    ID,\r\n    device_name as DEVICE,\r\n    CREATE_TIME_SERIES(\r\n        time,\r\n        (\r\n            CASE\r\n                WHEN upper(measure_value :: varchar) = 'UNEXPECTED' THEN 1\r\n                ELSE 0\r\n            END\r\n        )\r\n    ) as Value\r\nFROM\r\n    $ __database.$ __table\r\nWHERE\r\n    $ __timeFilter\r\n    AND measure_name = '$__measure'\r\nGROUP BY\r\n    device_name,\r\n    ID\r\n```\r\nThis query awaits for a status 'UNEXPECTED' to appear, and if it appears, it reports 1, otherwise 0. (As there is no string alerts supported by Grafana)\r\n*Spoiler*: the issue happens for all the queries and all the alerts we have. It's NOT caused by **this** specific query for sure.\r\n* we use Reduce and Math expressions in alert setup. Alert condition is Math ($B \u003e= 1) .\r\n\r\n3. Our alerts are being *duplicated* despite it seems that the HA configuration is OK.\r\n* alert status history - has duplicates\r\n\u003cimg width=\"702\" alt=\"image\" src=\"https://user-images.githubusercontent.com/26290616/225297676-d434433c-5a6a-496a-ab03-8eb7374ff13d.png\"\u003e\r\n\r\n* alert notifications - has duplicates\r\n\u003cimg width=\"482\" alt=\"image\" src=\"https://user-images.githubusercontent.com/26290616/225293456-6aa187dd-e9b2-465e-8e91-0a1e0d2dfea7.png\"\u003e\r\n\r\n**Anything else we need to know?**:\r\n* the issue does not happen when there is only ONE EC2 instance of Grafana server, thus we think it's the HA setup issue or some bug.\r\n* we've tried changing the HA config in multiple ways and made many tests with no luck\r\n* during the tests in the past we've observed the **missingseries** status in the history, but with the latest config - not anymore\r\n\r\n**Environment**:\r\n- Grafana version: OSS v9.4.3\r\n- Data source type \u0026 version: AWS Timestream\r\n- OS Grafana is installed on: amazon linux 2\r\n\r\n\r\nWe are not sure if it's a configuration issue or some bug - thus we would appreciate any help or advice on the matter. \r\nThank you.","labels":["area/alerting","triage/needs-confirmation"]},{"id":51846,"title":"Loki Datasource streaming: Dropping labels, used in `=~` filter","body":"**What happened**:\r\nWhile processing response from Loki in live mode for request `{level=~\"INFO|WARN\"}` all `level` labels are replaced with `\"INFO|WARN\"`\r\nWhile debugging network traffic, all series have correct labels ( `level=\"INFO\"` or `level=\"WARN\"`) , so the problem is seems to be in transformation of Loki response to DataQueryResponseData\r\n\r\n**What you expected to happen**:\r\n\r\nExpected that label will be actual, like in normal (non-streaming) request\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nJust send query with liveStreaming: true and regular expression with any label, and check results\r\n\r\n**Environment**:\r\n- Grafana version:  8.3.4\r\n","labels":["type/bug","needs more info","datasource/Loki","bot/no new info","area/logs","component/logql"]},{"id":46888,"title":"Broken notification policies after enabling unified alerting","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nEnabling unified alerting triggered migration during which a unique `rule_uid` was added for each end every alert rule. Automatically generated notification policies try to match those alert rules by `rule_uid` label but the value is wrapped with quotes, which breaks the entire chain, thus not sending any notifications for migrated alerts.\r\n\r\nEdit: looks like those quotes are simply escaped when saved to database. I think migration process should not wrap notification policy matchers.\r\n\r\n**What you expected to happen**:\r\n\r\nNotification policies are properly matching automatically generated alert rules.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nTrigger migration by enabling unified alerting in grafana config and starting the server.\r\nCreate notification policy matching `rule_uid` value wrapped in quotes (or use a migrated one)\r\n![asd](https://user-images.githubusercontent.com/12582893/159727615-1dd36d71-a748-4f6f-96d0-ace768d55a86.png)\r\nConfirm that no alert is matched by notification policy and therefore no message is sent to a contact point of your choice.\r\n\r\n**Anything else we need to know?**:\r\n\r\nWe can, and probably will, edit those manually and fix our policies, but I wonder if that's actually a bug or something we might have overlooked/misconfigured.\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.1\r\n- Data source type \u0026 version: irrelevant\r\n- OS Grafana is installed on: centos 7.8.2003\r\n- User OS \u0026 Browser: irrelevant?\r\n- Grafana plugins: irrelevant?\r\n- Others:\r\n","labels":["area/alerting/notifications","needs investigation"]},{"id":69172,"title":"Alerting UI: Existing Label values fails to pre-populate when accessing the alert rule via a panel","body":"### \r\n# What went wrong?\r\n\r\n\r\n**What happened**:\r\nCustom labels are not being populated with previous values when navigating to the alert via a panel link. Refreshing the alert rule page causes the values to appear.\r\n\r\n**What did you expect to happen**:\r\nPrevious values are present when you select the dropdown box.\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\nOpen Grafana and navigate to a dashboard/panel with an alert-rule attached to it. Ensure the alert has custom labels.\r\n\r\n**Step 2**:\r\nTry to select a different value for a label, you will find only the current value or the option to create an entirely new value\r\n\r\n**Step 3**:\r\nRefresh the page and you will now find existing values are selectable from the dropdown box. ** This does not happen if you go to the rule directly via the alert-rules section **\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\nGrafana: 9.4.9 and 9.5.3\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\r\n\r\n### Grafana Platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### User's OS?\r\n\r\nMacOS Ventura\r\n\r\n### User's Browser?\r\n\r\nFirefox, Chrome\r\n\r\n### Is this a Regression?\r\n\r\nNone\r\n\r\n### Are Datasources involved?\r\n\r\n_No response_\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["type/bug","effort/small","area/alerting","prio/medium","area/frontend"]},{"id":61754,"title":"grafana-cli w/ k8s: not honoring GF_PATHS_CONFIG envvar","body":"**What happened**:\r\ngrafana-cli is not honoring the `GF_PATHS_CONFIG` environment variable to load configuration, this causes unexpected updates to the sqllite database when not configured to use it. \r\n\r\n**What you expected to happen**:\r\nThe grafana-cli should honor the `GF_PATHS_CONFIG` environment variable so that it works as expected when deployed via kubernetes / docker-compose with the environment variable set.\r\n\r\n```\r\ngrafana-cli --config $GF_PATHS_CONFIG admin reset-admin-password *********\r\nINFO [01-19|11:32:18] Starting Grafana                         logger=settings version= commit= branch= compiled=1970-01-01T00:00:00Z\r\nINFO [01-19|11:32:18] Config loaded from                       logger=settings file=/usr/share/grafana/conf/defaults.ini\r\nINFO [01-19|11:32:18] Config loaded from                       logger=settings file=/etc/grafana/grafana.ini\r\n```\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n- Run the container with a configuration file mounted and `GF_PATHS_CONFIG` set to the mounted config file\r\n- export `GF_LOG_LEVEL=debug`\r\n- run the grafana-cli admin reset-admin-password '\u003cnew-password\u003e'\r\n\r\n```\r\ngrafana-cli admin reset-admin-password *********\r\nINFO [01-19|11:28:33] Starting Grafana                         logger=settings version= commit= branch= compiled=1970-01-01T00:00:00Z\r\nINFO [01-19|11:28:33] Config loaded from                       logger=settings file=/usr/share/grafana/conf/defaults.ini\r\nINFO [01-19|11:28:33] Config overridden from Environment variable logger=settings var=\"GF_PATHS_DATA=/var/lib/grafana/\"\r\nINFO [01-19|11:28:33] Config overridden from Environment variable logger=settings var=\"GF_PATHS_LOGS=/var/log/grafana\"\r\nINFO [01-19|11:28:33] Config overridden from Environment variable logger=settings var=\"GF_PATHS_PLUGINS=/var/lib/grafana/plugins\"\r\nINFO [01-19|11:28:33] Config overridden from Environment variable logger=settings var=\"GF_PATHS_PROVISIONING=/etc/grafana/provisioning\"\r\nINFO [01-19|11:28:33] Config overridden from Environment variable logger=settings var=\"GF_SECURITY_ADMIN_USER=admin\"\r\nINFO [01-19|11:28:33] Config overridden from Environment variable logger=settings var=\"GF_SECURITY_ADMIN_PASSWORD=*********\"\r\nINFO [01-19|11:28:33] Config overridden from Environment variable logger=settings var=\"GF_LOG_LEVEL=debug\"\r\nINFO [01-19|11:28:33] Config overridden from Environment variable logger=settings var=\"GF_RENDERING_SERVER_URL=http://omitted:8081/render\"\r\nINFO [01-19|11:28:33] Config overridden from Environment variable logger=settings var=\"GF_RENDERING_CALLBACK_URL=http://omitted:80/\"\r\nINFO [01-19|11:28:33] Path Home                                logger=settings path=/usr/share/grafana\r\nINFO [01-19|11:28:33] Path Data                                logger=settings path=/var/lib/grafana/\r\nINFO [01-19|11:28:33] Path Logs                                logger=settings path=/var/log/grafana\r\nINFO [01-19|11:28:33] Path Plugins                             logger=settings path=/var/lib/grafana/plugins\r\nINFO [01-19|11:28:33] Path Provisioning                        logger=settings path=/etc/grafana/provisioning\r\nINFO [01-19|11:28:33] App mode production                      logger=settings\r\nINFO [01-19|11:28:33] Connecting to DB                         logger=sqlstore dbtype=sqlite3\r\n```\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**: kubernetes\r\n- Grafana version: 9.2.5\r\n- Data source type \u0026 version: n/a\r\n- OS Grafana is installed on: offical docker image from helm chart\r\n- User OS \u0026 Browser: n/a\r\n- Grafana plugins: n/a\r\n- Others: n/a\r\n","labels":["area/grafana-cli","area/configuration"]},{"id":45639,"title":"Cannot run grafana with mysql configured as group replication cluster","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI have a MySQL cluster with group replication, when I start the grafana with the `primary` MySQL server as the backend, I get the below error:\r\n```\r\nlogger=migrator t=2022-02-19T15:05:09.95+0000 lvl=eror msg=\"Executing migration failed\" id=\"copy alert_rule_tag v1 to v2\" error=\"Error 3098: The table does not comply with the requirements by an external plugin.\"\r\nlogger=migrator t=2022-02-19T15:05:09.95+0000 lvl=eror msg=\"Exec failed\" error=\"Error 3098: The table does not comply with the requirements by an external plugin.\" sql=\"INSERT INTO `alert_rule_tag` (`alert_id`\\n, `tag_id`) SELECT `alert_id`\\n, `tag_id` FROM `alert_rule_tag_v1`\"\r\nFailed to start grafana. error: migration failed (id = copy alert_rule_tag v1 to v2): Error 3098: The table does not comply with the requirements by an external plugin.\r\nmigration failed (id = copy alert_rule_tag v1 to v2): Error 3098: The table does not comply with the requirements by an external plugin.\r\n```\r\n\r\n**What you expected to happen**:\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Create MySQL group replication\r\n2. use the cluster as grafana backend\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.1-ubuntu\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on: kubernetes\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["prio/low","area/backend","needs investigation","area/backend/db/migration","effort/medium"]},{"id":43882,"title":"Navigation on permission page of dashboards is not proper","body":"**What happened:**\r\nWhen we click on link \"Inherited from folder folder-name\" on dashboard permissions from viewer role(permission given to viewer as admin), it navigates to folder permissions tab even though the viewer doesn't have admin access to that folder. \r\n\r\n**What you expected to happen:**\r\nNavigation should be proper\r\n\r\n**How to reproduce it (as minimally and precisely as possible):**\r\n\r\n1) Login to grafana with admin role\r\n2) Give admin access to viewer role for a dashboard not for the folder in which dashboard is present\r\n3) Login with above viewer role and navigate to the dashboard settings permission page\r\n4) Click on \"Inherited from folder folder-name\" on dashboard permissions\r\n![linkonpermissions](https://user-images.githubusercontent.com/47292531/148888958-4617fd38-8115-415b-b270-f2f2d85363c0.JPG)\r\n5) User lands on folder permissions page eventhough the user does not have admin permissions for that folder\r\n![folderspe](https://user-images.githubusercontent.com/47292531/148889699-45a3824c-63e2-43e4-9f73-519b208fdeef.JPG)\r\n\r\n\r\n\r\nGrafana version: 7.5.2\r\nUser OS \u0026 Browser: Chrome\r\n","labels":["needs more info","area/security","area/permissions"]},{"id":76224,"title":"Interface theme is always Light regardless Interface theme settings","body":"### What happened?\n\nWhen I change Interface theme to System Preference or Dark, theme change to Dark.\r\nAfter saving (button Save), theme always return to Light.\r\nThis is only in one organization, in others I can change and also save interface to Dark. \n\n### What did you expect to happen?\n\nAfter saving, interface theme should stay Dark, if I've choose Dark or System Preference. \n\n### Did this work before?\n\nYes, but it is not dependant of Grafana version.\n\n### How do we reproduce it?\n\n1. Go to Default Preferences\r\n2. Choose Interface theme Dark or System preference (if system theme is dark)\r\n3. Choose Save\r\n4. in my case in one organization theme always returns to Light\r\n\n\n### Is the bug inside a dashboard panel?\n\nNo, it seems it is on organization level\n\n### Environment (with versions)?\n\nGrafana: Grafana v10.2.0-139518 (28c0fb1cfd) - the same is in older versions\r\nOS: Windows 10\r\nBrowser: Chrome (latest) - the same is in Edge\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\nInfluxDB","labels":["area/ui/theme","bot/no new info","triage/needs-confirmation"]},{"id":65418,"title":"iPhone SE: Graphs disappear after refresh","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWe experience an issue while opening our Grafana dashboards using an iPhone SE.\r\n\r\nSome of the graphs are disappearing while refreshing.\r\nI can`t reproduce it with any other device and it seems to occur since we updated to this Grafana version.\r\n\r\n**What you expected to happen**:\r\nWe expect graphs not disappearing while refreshing.\r\n![image](https://user-images.githubusercontent.com/129160577/228179385-84ab07f4-765f-4014-b642-c0bf9102bcff.png)\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n![image](https://user-images.githubusercontent.com/129160577/228179299-f23bd1c6-3f75-46db-a4c5-9fef46bc78d4.png)\r\n![image](https://user-images.githubusercontent.com/129160577/228179344-fd315f0e-ae6c-48fb-8085-f41ff55b740c.png)\r\n\r\n**Anything else we need to know?**:\r\nCommunity Issue Link:\r\nhttps://community.grafana.com/t/iphone-se-graphs-disappear-after-refresh/80861\r\nLog:\r\n[logtime1.txt](https://github.com/grafana/grafana/files/11087239/logtime1.txt)\r\n\r\n\r\n**Environment**:\r\n- Grafana version: V9.3.2 (21c1d14e91)\r\n- User OS \u0026 Browser: iPhone SE, Safari/ Chrome\r\n","labels":["area/dashboard","area/mobile-support","team/grafana-dashboards"]},{"id":81198,"title":"Grafana Alerting: Alerts duplicate causing multiple alerts and resolution messages","body":"### What happened?\n\nHey everyone, I’m looking for some advice.\r\n\r\nI get multiple notification for the same alert. I've tried recreating the alert with just the query and very basic settings but the same issue persisted. At one point I was getting 4 alerts but usually it's just 2. \r\n\r\nI have a loki alert that looks for the word “failed” in logs. It’s got a 30 minute window to look (the job runs every 30 min)\r\nthis is the query\r\ncount_over_time({instance=\"prod-backend\", app=\"patientCache\"} |= `Failed`[5m])\r\nthe history shows the duplication\r\n\r\n![image](https://github.com/grafana/grafana/assets/103214468/8c85d9d4-9497-42c6-9f92-25034c671040)\r\n\n\n### What did you expect to happen?\n\nI expect that when you configure one alert, show preview and it says firing, that the alert would just appear once, not multiple times and also it's not grouped for those multiple, like others firing alerts would\n\n### Did this work before?\n\nI'm not sure\n\n### How do we reproduce it?\n\n1. Deploy grafana with helm chart on kubernetes (chart v7.0.3)\r\n2. Create Loki alert\r\n3. Multiple alerts\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: helm chart on k8s (7.0.3)\r\nOS: N/A\r\nBrowser: N/A\r\n\n\n### Grafana platform?\n\nKubernetes\n\n### Datasource(s)?\n\nloki","labels":["needs more info","area/alerting","datasource/Loki","triage/pending"]},{"id":79046,"title":"alert list does not allow variable use in datasource selection","body":"### What happened?\n\nWhen entering a datasource on an alertlist visualization for a dashboard that can utilize mulitple datasources, a configured variable is not accepted. Entering a specific datasource functions as expected.\r\n\r\n\n\n### What did you expect to happen?\n\nknown variable configuration would allow datasource to be dynamically selected from a datasource pull-down configured on the dashboard.\n\n### Did this work before?\n\nunknown. first attempt\n\n### How do we reproduce it?\n\n1. Create prometheus datasource(s)\r\n2. Create a dashboard-specific variable to select from the available prometheus datasources\r\n3. Create an alertlist visualization \r\n4. Attempt to enter the ${datasource} variable created on the dashboard within the datasource field\r\n\n\n### Is the bug inside a dashboard panel?\n\nyes\n\n### Environment (with versions)?\n\nGrafana:10.1.5\r\nOS: win11 (enduser)\r\nBrowser: firefox\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\nprometheus, but doesn't appear to be datasource-specific","labels":["area/panel/alertlist"]},{"id":68384,"title":"Navigation: Breadcrumbs do not update when navigating between two dashboards with the same name","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n- In the new UI, when navigating from a dashboard to another dashboard **named the same but in an another folder**, the breadcrumb isn't refresh so it display the wrong folder\r\n  \r\n**What did you expect to happen**:\r\n\r\n  - The breadcrumb is refreshed after each navigation and show the current folder\r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Open Grafana and go a dashboard called \"X\" in the folder \"A\"\r\n\r\n**Step 2**:\r\n\r\n- The breadcrumb shows *Dashboard \u003e A \u003e X*\r\n- Go a dashboard  named \"X\" in the folder \"B\"\r\n\r\n**Step 3**:\r\n\r\n- The breadcrumb always shows *Dashboard \u003e A \u003e X*\r\n- Go a dashboard named \"Y\" in the folder \"B\"\r\n\r\n**Step 4**:\r\n\r\n- The breadcrumb shows *Dashboard \u003e B \u003e Y*\r\n- Return to  dashboard named \"X\" in the folder \"B\"\r\n\r\n**Step 5**:\r\n\r\n- The breadcrumb always shows *Dashboard \u003e B \u003e X*\r\n\r\n\n\n### \n# What Grafana version are you using?\n\n\nv9.5.2\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nKubernetes\n\n### User's OS?\n\nMacOS Venture 13.3.1\n\n### User's Browser?\n\nArc Browser (Chromium)\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\nScreen recording of the bug : \r\n\r\nhttps://github.com/grafana/grafana/assets/27202456/f4228263-50f6-4262-947b-b75465415433\r\n\r\n","labels":["type/bug","area/dashboard/folders","area/navigation"]},{"id":62479,"title":"No data on a stat panel when displaying 'Time' instead of value itself (Public dashboard)","body":"**What happened**:\r\nI'm trying to make a public dashboard where my neighbors can see if there is electricity in the building and when there is no electricity. Everything is ok except one moment: I would like to display the timestamp of the last value I've got from my sensor. I got it displaying on original grafana dashboard when I'm logged in, but it doesn't work on a public dashboard as anonymous user.\r\n\r\n![image](https://user-images.githubusercontent.com/5503131/215503664-508ef4a9-c124-4af5-a120-9d33de929a71.png)\r\nFYI: There is no problem when displaying the value itself by using this query, but when I'm selecting 'Time' in 'Fields' - I've got 'no data' displaying on the panel\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/5503131/215503456-86650fcb-227b-4c6f-9cdd-7a7e943e8ade.png)\r\nhow it's looking when I'm logged in (non public dashboard view)\r\n\r\n![image](https://user-images.githubusercontent.com/5503131/215503539-ab360d05-9339-4db1-86d9-84be1f0b0931.png)\r\nand this is what I got when seeing it as public dashboard\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.6\r\n- Data source type \u0026 version: InfluxDB 1.8.10\r\n- OS Grafana is installed on: \r\n- User OS \u0026 Browser: \r\n- Grafana plugins: \r\n- Others:\r\n","labels":["area/dashboard","area/public-dashboards"]},{"id":81853,"title":"Geomap:","body":"\u003c!-- Please only use this template for submitting feature requests --\u003e\r\n\r\n**Why is this needed**:\r\nIf there is a lot of data it is tiring to search for one value from everything displayed in the tooltip.\r\n\r\n\r\n**What would you like to be added**:\r\n\r\nI want the tooltip to display only one field from my geojson of my personal choice.\r\n\r\n\r\n**Who is this feature for?**\r\n\r\n[Add information on what kind of user the feature is for.]\r\n","labels":["area/panel/edit","area/panel/geomap","triage/needs-confirmation","area/dashboards/panel"]},{"id":81401,"title":"10.2.3 -\u003e 11.1.3 increase CPU usage (from ~40% to 90-150% for grafana)","body":"### What happened?\r\n\r\nOS: Debian 8.11\r\nGrafana version: 10.3.1 (was 10.2.3 prior)\r\n\r\nIve noticed a near doubling of cpu usage for the grafana process (~ 40% to ~80% constant), with the only change being i updated from 10.2.3 to 10.3.1.  (see graph below please).  \r\n\r\nI do have 3x larger dashboards being displayed 24/7 , each with ~45sec refresh interval set (this is the same case as was on 10.2.3)\r\n\r\nI do keep deep stats on my VMs (thanks to grafana!)  , and it does seem that along with the increase in CPU, there has been a large increase in Writes by grafana (kB-wr/sec).\r\n\r\n(log level has always been set to level warn,  I did try setting it to debug temporarily and did not see anything in those debug logs relevant, imo)\r\n\r\nI have searched around and found that a sTrace It's frequently requested for debugging,  so that info is below, along with some charts.\r\n\r\nPlease let me know what additional info i can provide to help with this.\r\n\r\nthanks\r\n(LOVE GRAFANA!)\r\n\r\n\r\nEDIT:i should add these relevant entries from my grafana.ini: \r\n```\r\n[metrics]\r\nenabled = disable\r\n\r\n[log]\r\nmode = file\r\nlevel = warn\r\n;level = debug\r\n``` \r\n\r\n![image](https://github.com/grafana/grafana/assets/60830628/e1c81468-eaaa-4370-8eaa-07f1c0a5e805)\r\n\r\n![image](https://github.com/grafana/grafana/assets/60830628/e38ef177-9ff8-430d-9bac-0407ab189ea7)\r\n\r\n\r\nstrace output (not sure if i ran this correctly,  but 25773 is grafana's PID  , and i let it run for about 20sec before CTRL + C):\r\n\r\n```\r\nroot@XX:~# lsb_release -a\r\nNo LSB modules are available.\r\nDistributor ID: Debian\r\nDescription:    Debian GNU/Linux 8.11 (jessie)\r\nRelease:        8.11\r\nCodename:       jessie\r\n\r\nroot@XX:~# strace -cfp 25773\r\nProcess 25773 attached with 28 threads\r\nProcess 37724 attached\r\nProcess 37809 attached\r\n\r\n... ( SEVERAL of these i have clipped ) ...\r\n\r\nProcess 39626 detached\r\nProcess 39627 detached\r\n% time     seconds  usecs/call     calls    errors syscall\r\n------ ----------- ----------- --------- --------- ----------------\r\n 57.28   92.894565        6271     14813         2 nanosleep\r\n 39.74   64.445202         122    529209     10954 futex\r\n  1.32    2.146384           4    485015           pread\r\n  0.82    1.322054         421      3144           epoll_pwait\r\n  0.63    1.026297         369      2781      2056 stat\r\n  0.05    0.088023         125       704           lstat\r\n  0.04    0.072108           1     55147           sched_yield\r\n  0.04    0.058263          37      1565           fstat\r\n  0.03    0.044295          58       758           getpid\r\n  0.03    0.041635          40      1052       423 read\r\n  0.00    0.007234           8       912           setsockopt\r\n  0.00    0.004433           1      3206           munmap\r\n  0.00    0.004000           6       719         1 write\r\n  0.00    0.004000           7       557        16 rt_sigreturn\r\n  0.00    0.002611           1      4149           mmap\r\n  0.00    0.002533           9       295           close\r\n  0.00    0.000210           1       272           pwrite\r\n  0.00    0.000141           0      1099           madvise\r\n  0.00    0.000000           0       164           open\r\n  0.00    0.000000           0        50           mprotect\r\n  0.00    0.000000           0        23           brk\r\n  0.00    0.000000           0       300           rt_sigprocmask\r\n  0.00    0.000000           0         2           writev\r\n  0.00    0.000000           0         4           mremap\r\n  0.00    0.000000           0        14           socket\r\n  0.00    0.000000           0        14        14 connect\r\n  0.00    0.000000           0       228           getsockname\r\n  0.00    0.000000           0        13           getpeername\r\n  0.00    0.000000           0        13           getsockopt\r\n  0.00    0.000000           0        50           clone\r\n  0.00    0.000000           0      1937           fcntl\r\n  0.00    0.000000           0        78           fsync\r\n  0.00    0.000000           0        26           unlink\r\n  0.00    0.000000           0        26           fchmod\r\n  0.00    0.000000           0        26           geteuid\r\n  0.00    0.000000           0       100           sigaltstack\r\n  0.00    0.000000           0        50           gettid\r\n  0.00    0.000000           0         1           restart_syscall\r\n  0.00    0.000000           0       430         1 epoll_ctl\r\n  0.00    0.000000           0       556           tgkill\r\n  0.00    0.000000           0         1           openat\r\n  0.00    0.000000           0       359       143 accept4\r\n------ ----------- ----------- --------- --------- ----------------\r\n100.00  162.163988\r\n\r\n```\r\n\r\n\r\n\r\n### What did you expect to happen?\r\n\r\nsimilar cpu usage on 10.3.1  as was the case on 10.2.3\r\n\r\n### Did this work before?\r\n\r\ndid not see this issue on 10.2.3\r\n\r\n### How do we reproduce it?\r\n\r\nSee post above (i just updated from 10.2.3 -\u003e 10.3.1\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.3.1\r\nOS: Debian 8.11\r\nBrowser:\r\n\r\n\r\n### Grafana platform?\r\n\r\nA downloaded binary\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/backend","triage/needs-confirmation"]},{"id":64798,"title":"Alerting: Contact points, custom templates, notification policies disappeared after alert rule editing","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nContact points, Custom templates and Notification policies \"disappeared\"\r\n**What you expected to happen**:\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nNot sure.\r\nI was editing multiple alert rules (approx 40 alerts, not at the same time, one after another). I received multiple times some errors stating the database is locked and was forced to sign in again (admin account). After I finished editing the alerts, when I checked the tabs of Contact Points and Notification Policies, they're empty....\r\nLast email per the Contact Points, Notification Policies, custom alert templates was received at ~10:48, I noticed the missing info at ~11:15.\r\nHow I edited alert rules: right click on the edit button, open in new tab, do the edit, click save, wait for the rule updated message, close tab, go to next rule and repeat...\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.3\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on: Ubuntu 22.04\r\n- User OS \u0026 Browser: Win 10 Pro, Edge \r\n- Grafana plugins:\r\n- Others:\r\n","labels":["needs more info","area/backend/config","area/backend/db/sqlite"]},{"id":51607,"title":"Grafana Table showing Duplicate Data","body":"Hello Everyone,\r\n\r\nNot sure if anyone has experienced this before - But since i am using Table plugin on Grafana with Google Cloud Monitoring as a Data source - The number of records right after appliying SeriestoRow Transformation gets duplicate - Now i can use “Group by” at the later stage but as soon the data flow gets huge in quantity its causing impact on Load time - and the multiplication of per record is as follows:\r\n          * After SeriestoRow Transformation every record gets multiplied by 2\r\n          \r\n![Duplicate Data when adding Transformation](https://user-images.githubusercontent.com/4076563/176565379-fb3282d1-a5b8-4a01-8909-7c15b299d073.gif)\r\n\r\n- Questions should be posted to: https://community.grafana.com/t/grafana-table-populating-duplicate-data-when-using-transforms-resulting-in-longer-load-time-and-even-crash-at-times/67947\r\n\r\n\r\n**What happened**: After SeriestoRow Transformation every record gets multiplied by 2 using Table Plugin\r\n\r\n**What you expected to happen**: Should not Multiply\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**: Use Google Cloud Monitoring , Table Plugin along with Series to Row Transformation\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**: \r\n- Grafana version: 8.5.1\r\n- Data source type \u0026 version: Google Cloud Monitoring \u0026 Not sure of version\r\n- OS Grafana is installed on: Linux\r\n- User OS \u0026 Browser: Windows \u0026 Chrome\r\n- Grafana plugins: Table Panel\r\n- Others: As it seems as soon  as Series to Rows transformation is applied it creates duplicate rows but one row with the \"Value\" to be 0.00333 while the other row will be \"0\"\r\n![image](https://user-images.githubusercontent.com/4076563/176568175-9293211e-d932-4307-9cd8-976bf9d5cd73.png)\r\n\r\n\r\n**Note: In the Gif image you might see different times but essentially it's only supposed to have 2 rows and not 4 - Similar thing is being experienced where in other cases the rows generated by series to row transformation are more than just 4 - i've seen them going as high as 10 where each row was multiplied by 5**\r\n\r\n","labels":["needs more info","datasource/CloudWatch"]},{"id":43977,"title":"Table timestamp timezone issues with v.8.3","body":"This still appears to be an issue in 8.3.  I am experiencing the same results as @junior466.\r\nBrowser and server are both EST(-5) but timestamps are showing UTC.\r\nIf I set Grafana to UTC then everything is off +10 even worse.\r\nIt only seems to pertain to tables, as time series graphs show the correct EST times.\r\nThis solution corrected the issue for my filebeats collectors\r\nhttps://community.grafana.com/t/elasticsearch-timestamp-in-utc-but-grafana-is-interpreting-it-as-est/26912\r\n![grafana-graylog-timestamps-filebeats](https://user-images.githubusercontent.com/1520484/149190864-2d9859f2-eaf5-4b36-a2bd-112f30a898d5.png)\r\nBut syslogs from fluentd/gelf are still showing UTC.\r\n![grafana-graylog-timestamps-fluentd](https://user-images.githubusercontent.com/1520484/149190974-e06848a3-1da1-4483-8f25-3b3906b436ba.png)\r\nAny thoughts?\r\n\r\n_Originally posted by @Fosten in https://github.com/grafana/grafana/issues/21890#issuecomment-1011290754_","labels":["needs more info","area/dashboard/timezone","area/panel/table","bot/no new info"]},{"id":63180,"title":"Explore: Display properties not updating correctly","body":"**What happened**:\r\nA custom datasource backend plugin we're developing has the option to include display properties for a field such as the unit. This can be toggled with a switch in the query editor. When using this in a dashboard the resulting graph will include/exclude these display properties depending on if the switch is toggled or not. But when we try this in explore it will keep the display properties of the first successful query.\r\n\r\n**What you expected to happen**:\r\nExplore should also update the display properties correctly like in a dashboard.\r\n\r\n**Screenshots and query results**:\r\n\r\n\u003cdetails\u003e\r\n  \u003csummary\u003eQuery result with display properties\u003c/summary\u003e\r\n\r\n```json\r\n    {\r\n      \"request\": {\r\n        \"url\": \"api/ds/query\",\r\n        \"method\": \"POST\",\r\n        \"data\": {\r\n          \"queries\": [\r\n            {\r\n              \"refId\": \"A\",\r\n              \"datasource\": {\r\n                \"type\": \"factry-historian-datasource\",\r\n                \"uid\": \"PFgEj8A4k\"\r\n              },\r\n              \"tabIndex\": 1,\r\n              \"selectedAssetPath\": \"a5b19cd0-971e-11ed-87e2-0242c0a86004\",\r\n              \"selectedAssetProperties\": [\r\n                \"temperature\"\r\n              ],\r\n              \"queryType\": \"MeasurementQuery\",\r\n              \"query\": {\r\n                \"Database\": \"7b6af020-971e-11ed-b21d-0242c0a86004\",\r\n                \"Options\": {\r\n                  \"GroupBy\": [\r\n                    \"status\"\r\n                  ],\r\n                  \"Aggregation\": {\r\n                    \"Name\": \"mean\",\r\n                    \"Period\": \"\"\r\n                  },\r\n                  \"IncludeLastKnownPoint\": false,\r\n                  \"UseEngineeringSpecs\": true\r\n                },\r\n                \"Measurements\": [\r\n                  \"9464d1fe-971e-11ed-b21d-0242c0a86004\"\r\n                ]\r\n              },\r\n              \"selectedMeasurement\": \"event calc\",\r\n              \"key\": \"Q-e15be4b8-9041-4245-bca1-a118493e0161-0\",\r\n              \"datasourceId\": 1,\r\n              \"intervalMs\": 2000,\r\n              \"maxDataPoints\": 1863\r\n            }\r\n          ],\r\n          \"range\": {\r\n            \"from\": \"2023-02-09T09:16:40.284Z\",\r\n            \"to\": \"2023-02-09T10:16:40.284Z\",\r\n            \"raw\": {\r\n              \"from\": \"now-1h\",\r\n              \"to\": \"now\"\r\n            }\r\n          },\r\n          \"from\": \"1675934200284\",\r\n          \"to\": \"1675937800284\"\r\n        },\r\n        \"hideFromInspector\": false\r\n      },\r\n      \"response\": {\r\n        \"results\": {\r\n          \"A\": {\r\n            \"status\": 500,\r\n            \"frames\": [\r\n              {\r\n                \"schema\": {\r\n                  \"name\": \"event calc\",\r\n                  \"refId\": \"A\",\r\n                  \"fields\": [\r\n                    {\r\n                      \"name\": \"time\",\r\n                      \"type\": \"time\",\r\n                      \"typeInfo\": {\r\n                        \"frame\": \"time.Time\"\r\n                      },\r\n                      \"labels\": {}\r\n                    },\r\n                    {\r\n                      \"name\": \"event calc\",\r\n                      \"type\": \"number\",\r\n                      \"typeInfo\": {\r\n                        \"frame\": \"float64\",\r\n                        \"nullable\": true\r\n                      },\r\n                      \"labels\": {\r\n                        \"status\": \"Good\"\r\n                      },\r\n                      \"config\": {\r\n                        \"unit\": \"example unit\",\r\n                        \"min\": 0,\r\n                        \"max\": 10,\r\n                        \"thresholds\": {\r\n                          \"mode\": \"absolute\",\r\n                          \"steps\": [\r\n                            {\r\n                              \"value\": 0,\r\n                              \"color\": \"red\"\r\n                            },\r\n                            {\r\n                              \"value\": 3,\r\n                              \"color\": \"green\"\r\n                            },\r\n                            {\r\n                              \"value\": 7,\r\n                              \"color\": \"red\"\r\n                            }\r\n                          ]\r\n                        }\r\n                      }\r\n                    }\r\n                  ]\r\n                },\r\n                \"data\": {\r\n                  \"values\": [\r\n                    [\r\n                      1675934232000,\r\n                      1675934292000,\r\n                      1675934352000,\r\n                      1675934412000,\r\n                      1675934472000,\r\n                      1675934532000,\r\n                      1675934592000,\r\n                      1675934652000,\r\n                      1675934712000,\r\n                      1675934772000,\r\n                      1675934832000,\r\n                      1675934892000,\r\n                      1675934952000,\r\n                      1675935012000,\r\n                      1675935072000,\r\n                      1675935132000,\r\n                      1675935192000,\r\n                      1675935252000,\r\n                      1675935312000,\r\n                      1675935372000,\r\n                      1675935432000,\r\n                      1675935492000,\r\n                      1675935552000,\r\n                      1675935612000,\r\n                      1675935672000,\r\n                      1675935732000,\r\n                      1675935792000,\r\n                      1675935852000,\r\n                      1675935912000,\r\n                      1675935972000,\r\n                      1675936032000,\r\n                      1675936092000,\r\n                      1675936152000,\r\n                      1675936212000,\r\n                      1675936272000,\r\n                      1675936332000,\r\n                      1675936392000,\r\n                      1675936452000,\r\n                      1675936512000,\r\n                      1675936572000,\r\n                      1675936632000,\r\n                      1675936692000,\r\n                      1675936752000,\r\n                      1675936812000,\r\n                      1675936872000,\r\n                      1675936932000,\r\n                      1675936992000,\r\n                      1675937052000,\r\n                      1675937112000,\r\n                      1675937172000,\r\n                      1675937232000,\r\n                      1675937292000,\r\n                      1675937352000,\r\n                      1675937412000,\r\n                      1675937472000,\r\n                      1675937532000,\r\n                      1675937592000,\r\n                      1675937652000,\r\n                      1675937712000,\r\n                      1675937772000\r\n                    ],\r\n                    [\r\n                      6.174328386839722,\r\n                      1.2580985878126125,\r\n                      3.272514081816778,\r\n                      5.841896358970258,\r\n                      6.620752536487444,\r\n                      2.553167321165432,\r\n                      1.9472422358165464,\r\n                      6.214035448633065,\r\n                      0.11871759191552657,\r\n                      9.388688289062037,\r\n                      4.074707594362225,\r\n                      3.93488260554558,\r\n                      3.4666440485019665,\r\n                      4.828007217384198,\r\n                      0.9077632447596845,\r\n                      2.4540592210062773,\r\n                      4.620994537574854,\r\n                      1.3843463042032422,\r\n                      9.879060142735181,\r\n                      3.5261078726009885,\r\n                      2.0569159006742064,\r\n                      8.814202270136727,\r\n                      9.897810913530385,\r\n                      6.906075631459824,\r\n                      4.1333958937245345,\r\n                      6.483176532827026,\r\n                      1.9504100054801938,\r\n                      8.767513539693196,\r\n                      3.2670955954444776,\r\n                      2.4113498015355272,\r\n                      8.438147941624608,\r\n                      5.974279268302469,\r\n                      3.0761128246979434,\r\n                      2.025714654696579,\r\n                      0.022491268229470375,\r\n                      6.428263647682243,\r\n                      8.09422185731123,\r\n                      9.446682403977203,\r\n                      2.057912445009221,\r\n                      5.545552006292617,\r\n                      7.122438860469638,\r\n                      2.8465144889160134,\r\n                      2.377911470876745,\r\n                      4.95653206388728,\r\n                      4.4756391816834435,\r\n                      9.408587770841658,\r\n                      2.6944960601605694,\r\n                      5.8078115945578945,\r\n                      1.364465188821198,\r\n                      4.832046937461517,\r\n                      5.540463217169905,\r\n                      8.028833117902947,\r\n                      8.686111836554353,\r\n                      3.6934655876731446,\r\n                      0.37645229783252676,\r\n                      9.779941943978777,\r\n                      7.492975433353125,\r\n                      0.04676750633384678,\r\n                      6.327663829291229,\r\n                      6.109530840674756\r\n                    ]\r\n                  ]\r\n                }\r\n              }\r\n            ],\r\n            \"refId\": \"A\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n```\r\n\u003c/details\u003e\r\n\r\n![with-display-properties](https://user-images.githubusercontent.com/90846062/217787331-36962233-41e4-43ec-ab3b-b864b7ee9ec5.png)\r\n\r\n\r\n\u003cdetails\u003e\r\n  \u003csummary\u003eQuery result without display properties\u003c/summary\u003e\r\n\r\n```json\r\n{\r\n  \"request\": {\r\n    \"url\": \"api/ds/query\",\r\n    \"method\": \"POST\",\r\n    \"data\": {\r\n      \"queries\": [\r\n        {\r\n          \"refId\": \"A\",\r\n          \"datasource\": {\r\n            \"type\": \"factry-historian-datasource\",\r\n            \"uid\": \"PFgEj8A4k\"\r\n          },\r\n          \"tabIndex\": 1,\r\n          \"selectedAssetPath\": \"a5b19cd0-971e-11ed-87e2-0242c0a86004\",\r\n          \"selectedAssetProperties\": [\r\n            \"temperature\"\r\n          ],\r\n          \"queryType\": \"MeasurementQuery\",\r\n          \"query\": {\r\n            \"Database\": \"7b6af020-971e-11ed-b21d-0242c0a86004\",\r\n            \"Options\": {\r\n              \"GroupBy\": [\r\n                \"status\"\r\n              ],\r\n              \"Aggregation\": {\r\n                \"Name\": \"mean\",\r\n                \"Period\": \"\"\r\n              },\r\n              \"IncludeLastKnownPoint\": false,\r\n              \"UseEngineeringSpecs\": false\r\n            },\r\n            \"Measurements\": [\r\n              \"9464d1fe-971e-11ed-b21d-0242c0a86004\"\r\n            ]\r\n          },\r\n          \"selectedMeasurement\": \"event calc\",\r\n          \"key\": \"Q-e15be4b8-9041-4245-bca1-a118493e0161-0\",\r\n          \"datasourceId\": 1,\r\n          \"intervalMs\": 2000,\r\n          \"maxDataPoints\": 1863\r\n        }\r\n      ],\r\n      \"range\": {\r\n        \"from\": \"2023-02-09T09:24:01.750Z\",\r\n        \"to\": \"2023-02-09T10:24:01.750Z\",\r\n        \"raw\": {\r\n          \"from\": \"now-1h\",\r\n          \"to\": \"now\"\r\n        }\r\n      },\r\n      \"from\": \"1675934641750\",\r\n      \"to\": \"1675938241750\"\r\n    },\r\n    \"hideFromInspector\": false\r\n  },\r\n  \"response\": {\r\n    \"results\": {\r\n      \"A\": {\r\n        \"status\": 500,\r\n        \"frames\": [\r\n          {\r\n            \"schema\": {\r\n              \"name\": \"event calc\",\r\n              \"refId\": \"A\",\r\n              \"fields\": [\r\n                {\r\n                  \"name\": \"time\",\r\n                  \"type\": \"time\",\r\n                  \"typeInfo\": {\r\n                    \"frame\": \"time.Time\"\r\n                  },\r\n                  \"labels\": {}\r\n                },\r\n                {\r\n                  \"name\": \"event calc\",\r\n                  \"type\": \"number\",\r\n                  \"typeInfo\": {\r\n                    \"frame\": \"float64\",\r\n                    \"nullable\": true\r\n                  },\r\n                  \"labels\": {\r\n                    \"status\": \"Good\"\r\n                  },\r\n                  \"config\": {\r\n                    \"unit\": \"none\"\r\n                  }\r\n                }\r\n              ]\r\n            },\r\n            \"data\": {\r\n              \"values\": [\r\n                [\r\n                  1675934653000,\r\n                  1675934713000,\r\n                  1675934773000,\r\n                  1675934833000,\r\n                  1675934893000,\r\n                  1675934953000,\r\n                  1675935013000,\r\n                  1675935073000,\r\n                  1675935133000,\r\n                  1675935193000,\r\n                  1675935253000,\r\n                  1675935313000,\r\n                  1675935373000,\r\n                  1675935433000,\r\n                  1675935493000,\r\n                  1675935553000,\r\n                  1675935613000,\r\n                  1675935673000,\r\n                  1675935733000,\r\n                  1675935793000,\r\n                  1675935853000,\r\n                  1675935913000,\r\n                  1675935973000,\r\n                  1675936033000,\r\n                  1675936093000,\r\n                  1675936153000,\r\n                  1675936213000,\r\n                  1675936273000,\r\n                  1675936333000,\r\n                  1675936393000,\r\n                  1675936453000,\r\n                  1675936513000,\r\n                  1675936573000,\r\n                  1675936633000,\r\n                  1675936693000,\r\n                  1675936753000,\r\n                  1675936813000,\r\n                  1675936873000,\r\n                  1675936933000,\r\n                  1675936993000,\r\n                  1675937053000,\r\n                  1675937113000,\r\n                  1675937173000,\r\n                  1675937233000,\r\n                  1675937293000,\r\n                  1675937353000,\r\n                  1675937413000,\r\n                  1675937473000,\r\n                  1675937533000,\r\n                  1675937593000,\r\n                  1675937653000,\r\n                  1675937713000,\r\n                  1675937773000,\r\n                  1675937833000,\r\n                  1675937893000,\r\n                  1675937953000,\r\n                  1675938013000,\r\n                  1675938073000,\r\n                  1675938133000,\r\n                  1675938193000\r\n                ],\r\n                [\r\n                  6.214035448633065,\r\n                  0.11871759191552657,\r\n                  9.388688289062037,\r\n                  4.074707594362225,\r\n                  3.93488260554558,\r\n                  3.4666440485019665,\r\n                  4.828007217384198,\r\n                  0.9077632447596845,\r\n                  2.4540592210062773,\r\n                  4.620994537574854,\r\n                  1.3843463042032422,\r\n                  9.879060142735181,\r\n                  3.5261078726009885,\r\n                  2.0569159006742064,\r\n                  8.814202270136727,\r\n                  9.897810913530385,\r\n                  6.906075631459824,\r\n                  4.1333958937245345,\r\n                  6.483176532827026,\r\n                  1.9504100054801938,\r\n                  8.767513539693196,\r\n                  3.2670955954444776,\r\n                  2.4113498015355272,\r\n                  8.438147941624608,\r\n                  5.974279268302469,\r\n                  3.0761128246979434,\r\n                  2.025714654696579,\r\n                  0.022491268229470375,\r\n                  6.428263647682243,\r\n                  8.09422185731123,\r\n                  9.446682403977203,\r\n                  2.057912445009221,\r\n                  5.545552006292617,\r\n                  7.122438860469638,\r\n                  2.8465144889160134,\r\n                  2.377911470876745,\r\n                  4.95653206388728,\r\n                  4.4756391816834435,\r\n                  9.408587770841658,\r\n                  2.6944960601605694,\r\n                  5.8078115945578945,\r\n                  1.364465188821198,\r\n                  4.832046937461517,\r\n                  5.540463217169905,\r\n                  8.028833117902947,\r\n                  8.686111836554353,\r\n                  3.6934655876731446,\r\n                  0.37645229783252676,\r\n                  9.779941943978777,\r\n                  7.492975433353125,\r\n                  0.04676750633384678,\r\n                  6.327663829291229,\r\n                  6.109530840674756,\r\n                  4.110732328417548,\r\n                  7.504466461701048,\r\n                  3.703693466846016,\r\n                  8.024262339331441,\r\n                  5.801528030296966,\r\n                  7.157833173613069,\r\n                  7.491048234648435\r\n                ]\r\n              ]\r\n            }\r\n          }\r\n        ],\r\n        \"refId\": \"A\"\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\u003c/details\u003e\r\n\r\n![without-display-properties](https://user-images.githubusercontent.com/90846062/217787407-b984e7f5-a493-4979-a0f7-9ddbd56e0c93.png)\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.6\r\n","labels":["needs more info","area/explore"]},{"id":49024,"title":"Continuous X-Axis Time rescaling of Live Measurement Data","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n**What happened**:\r\nContinuous X-Axis Time rescaling of Live Measurement Data.\r\n\r\n![grafana_dashboard_scale_err](https://user-images.githubusercontent.com/12041081/168639923-448a4df4-edde-449c-86da-ce0f442a5b72.gif)\r\n\r\n\r\n\r\n**What you expected to happen**:\r\nStop it from rescaling.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Use Live Measurements Query Type that are not to fast like this test one\r\n![Screenshot from 2022-05-16 18-23-40](https://user-images.githubusercontent.com/12041081/168639972-ad19b7b3-fa43-43a0-9b5c-995f33668115.png)\r\n\r\n\r\n2. Use the Refresh live dashboard option\r\n![Screenshot from 2022-05-16 18-20-20](https://user-images.githubusercontent.com/12041081/168639509-525c6d51-6529-4631-baac-1d88857e2c6a.png)\r\n\r\n3. Have multiple pannels (that uses now() in querry?)before the Live Measurements panel on the dashboard stacked such that the Live Measurement panel is not visible on side-loading. In other words one need to scroll down a bit before the Live Measurement panel is visible\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version:\r\n-- 8.5.2 (official docker image)\r\n- Data source type \u0026 version:\r\n-- Grafana Live-Measurement / InfluxDBv2 \r\n- OS Grafana is installed on:\r\n--  Docker container grafana/grafana:8.5.2 on debian 11 host\r\n- User OS \u0026 Browser:\r\n-- Tested on Linux( Firefox 100 \u0026 Chrome 101) and on Android (Firefox 100)\r\n- Grafana plugins:\r\n-- Time series - Native Plugin \r\n\r\n","labels":["needs more info","area/live"]},{"id":64618,"title":"SimpleJson datasource does not indicate the provisioned state of ","body":"**What happened**:\r\nI successfully provisioned a SimpleJson datasource, but the datasource configuration display does not indicate the correct setting for skipTLSVerify.\r\n\r\n**What you expected to happen**:\r\nI expected the skipTLSVerify to indicate 'True'.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nCreate yaml file for datasource, set tlsSkipVerify to True.\r\n\r\n**Anything else we need to know?**:\r\nDatasource works without TLS, as expected.  This appears to be a problem with display of the flag.\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.6\r\n- Data source type \u0026 version: SimpleJson 1.4.2\r\n- OS Grafana is installed on: Windows 10\r\n- User OS \u0026 Browser: Windows 10\r\n- Grafana plugins: SimpleJson\r\n- Others:None\r\n\u003cimg width=\"728\" alt=\"Screen Shot 2023-03-10 at 9 49 02 AM\" src=\"https://user-images.githubusercontent.com/290178/224349399-3101cd28-5c93-4f6a-9010-dea21c4c80eb.png\"\u003e\r\n\u003cimg width=\"570\" alt=\"Screen Shot 2023-03-10 at 9 51 07 AM\" src=\"https://user-images.githubusercontent.com/290178/224349418-6af4a7b1-5eca-4745-90e4-8add945d9083.png\"\u003e\r\n","labels":["area/plugins","area/provisioning","triage/needs-confirmation"]},{"id":65503,"title":"In the panel variable settings, select tempo as the data source, and there is no option for query","body":"\u003c!--\r\nPlease only use this template for submitting accessibility issues.\r\n\r\nThis is a new feature area for Grafana that we want to improve. We have long way to go\r\nto really improve accessibility and would like your help to know where to start.\r\n--\u003e\r\n\r\n**Steps to reproduce**:\r\n\u003cimg width=\"616\" alt=\"image\" src=\"https://user-images.githubusercontent.com/116276614/228438487-a2e0ec04-8e8c-4b68-9db4-88ac829b9324.png\"\u003e\r\n\r\n**Expected Result**\r\nHope to add a function similar to Promethues\r\n\u003cimg width=\"703\" alt=\"image\" src=\"https://user-images.githubusercontent.com/116276614/228438721-e8cff9a3-d10d-422e-9bc4-110c1ffb0c3f.png\"\u003e\r\n\r\n\r\n**Relevant WCAG Criteria:** [#.#.# WCAG Criterion](link to https://www.w3.org/WAI/WCAG21/quickref/?versions=2.0)\r\n\r\n**Environment**:\r\n- Grafana version: 9.4.7\r\n- Data source type \u0026 version: tempo\r\n- User OS \u0026 Browser: chrome\r\n- Others:\r\n","labels":["area/dashboard/templating","datasource/Tempo","triage/needs-confirmation"]},{"id":59259,"title":"\"Dashboard has been changed by someone else\" message when importing dashboard","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWhen trying to import a template dashboard, there is an error message shown: \"Dashboard has been changed by someone else\".\r\n![f1526f54-c2e6-4a70-93af-665ec47c7f22](https://user-images.githubusercontent.com/63325084/203636418-7850d3d1-304f-4de9-b77f-f1c7e086c1e5.jpg)\r\n\r\n**What you expected to happen**:\r\nTemplate dashboards should be properly imported.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version:\r\n- Data source type \u0026 version:\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser:\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["area/dashboard/import","area/datasource","bot/no new info"]},{"id":82177,"title":"Tool tip is unusable when there are too many series in a panel","body":"### What happened?\n\n![Screenshot_20240208_172209](https://github.com/grafana/grafana/assets/2118079/c109a8e5-99e4-4dd0-acce-a7c2a7e267c2)\r\n\r\ni have a graph with many series (more than the tooltip can hold) the result is not usable\n\n### What did you expect to happen?\n\nto have a way to see all values\n\n### Did this work before?\n\ndon't know\n\n### How do we reproduce it?\n\n1. create a graph with many series\r\n2.\r\n3.\r\n\n\n### Is the bug inside a dashboard panel?\n\n![image](https://github.com/grafana/grafana/assets/2118079/90f62334-79cf-472c-8dbc-204c0ee5312c)\r\n\n\n### Environment (with versions)?\n\nGrafana: 10.2.1\r\nOS: Docker container\r\nBrowser: chrome\r\n\n\n### Grafana platform?\n\nDocker\n\n### Datasource(s)?\n\n_No response_","labels":["area/tooltip"]},{"id":78168,"title":"Current org is forgotten upon re-login","body":"### What happened?\n\nSeperate issue as requested in https://github.com/grafana/grafana/issues/77803#issuecomment-1805511495. See also https://github.com/grafana/grafana/issues/77803#issuecomment-1805312917\r\n\r\nCurrent org is forgotten upon re-login. Grafana does not remember the selected organization when logging out and logging back in.\n\n### What did you expect to happen?\n\nGrafana remembers the current organization even accross logins.\n\n### Did this work before?\n\nYes, somewhere \u003c 10.x.x\n\n### How do we reproduce it?\n\n1. Select `orgid != 1`\r\n2. Log out\r\n3. Log in\r\n4. Observe `orgid=1`\r\n\n\n### Is the bug inside a dashboard panel?\n\nNo\n\n### Environment (with versions)?\n\nGrafana: v10.2.1\r\nOS: Debian 12 Bookworm\r\nBrowser: Firefox 120.0 (64-bit)\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\n_No response_","labels":["area/auth","area/frontend/login","triage/needs-confirmation"]},{"id":61588,"title":"Logs Volume Coloring not happening only for Verbose and Information","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nIn the Grafana Loki viewer, only the log level Information and Verbose and not being colored in the \"Logs volume\" section.\r\nBut in the details, it is getting colored appropriately. \r\n![image](https://user-images.githubusercontent.com/79205065/212762584-91507ebb-6451-4bde-ba29-b0e23bfdf6d8.png)\r\n\r\n**What you expected to happen**:\r\n\r\nI expected the same coloring scheme to be applied in the logs volume section\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n1. Generate logs using serilog\r\n2. Ingest using OpenTelemetry \r\n3. Export to Loki endpoint \r\n\r\n**Anything else we need to know?**:\r\n\r\nI am trying to ingest logs using Open Telemetry exported for Loki, and logs are being generated using Serilog\r\n\r\n**Environment**:\r\n- Grafana version: v9.3.2\r\n- Data source type \u0026 version: \r\n- OS Grafana is installed on: Podman Container\r\n- User OS \u0026 Browser: Windows 10, Chrome\r\n- Grafana plugins: NA \r\n- Others: NA\r\n","labels":["area/explore","datasource/Loki","area/logs"]},{"id":75252,"title":"runtime error: invalid memory address or nil pointer dereference","body":"### What happened?\n\nAfter upgrading Grafana to v10.1.2 via apt, visit `/login` show error `runtime error: invalid memory address or nil pointer dereference`.\r\nThis error exists in both grafana and grafana-enterprise. Downgrading to v10.0.3 temporarily solves this issue.\r\n\r\nFull log:\r\n```\r\nlogger=context userId=0 orgId=0 uname= t=2023-09-22T00:22:02.942031906+08:00 level=error msg=\"Request error\" error=\"runtime error: invalid memory address or nil pointer dereference\" stack=\"runtime/panic.go:260 (0x50f7fbc)\\nruntime/signal_unix.go:841 (0x50f7f8c)\\ngithub.com/grafana/grafana/pkg/api/index.go:99 (0x7702a31)\\ngithub.com/grafana/grafana/pkg/api/login.go:94 (0x770416b)\\ngithub.com/grafana/grafana/pkg/api/response/web_hack.go:40 (0x615cb15)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/web/macaron.go:134 (0x6150354)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/extensions/ratelimiting/ratelimiting.go:54 (0x9476d9a)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/web/macaron.go:140 (0x61503fb)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/web/macaron.go:140 (0x61503fb)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/web/macaron.go:140 (0x61503fb)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/services/contexthandler/contexthandler.go:252 (0x68af5d9)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/web/macaron.go:140 (0x61503fb)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/web/macaron.go:140 (0x61503fb)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/web/macaron.go:140 (0x61503fb)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/web/macaron.go:140 (0x61503fb)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/web/macaron.go:140 (0x61503fb)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/web/render.go:44 (0x6150f35)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/web/macaron.go:140 (0x61503fb)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/web/macaron.go:140 (0x61503fb)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/web/macaron.go:140 (0x61503fb)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/web/macaron.go:140 (0x61503fb)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/middleware/csrf/csrf.go:66 (0x6edaa05)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/middleware/recovery.go:171 (0x68bbc41)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/middleware/gziper.go:68 (0x68bf85c)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/middleware/loggermw/logger.go:71 (0x6edbaf7)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/middleware/request_metrics.go:59 (0x68bcb69)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/middleware/request_tracing.go:88 (0x68be49a)\\nnet/http/server.go:2122 (0x545dc0e)\\ngithub.com/grafana/grafana/pkg/web/context.go:52 (0x614eb3d)\\ngithub.com/grafana/grafana/pkg/web/router.go:155 (0x6152589)\\ngithub.com/grafana/grafana/pkg/web/router.go:211 (0x61530f5)\\ngithub.com/grafana/grafana/pkg/web/macaron.go:166 (0x6150870)\\nnet/http/server.go:2936 (0x5460d55)\\nnet/http/server.go:1995 (0x545c731)\\nruntime/asm_amd64.s:1598 (0x5118180)\\n\"\r\nlogger=context userId=0 orgId=0 uname= t=2023-09-22T00:22:02.943734948+08:00 level=error msg=\"Request Completed\" method=GET path=/login status=500 remote_addr=10.0.114.3 time_ms=11 duration=11.224609ms size=4395 referer= handler=/login\r\n```\n\n### What did you expect to happen?\n\nUsers can login as normal\n\n### Did this work before?\n\nYes, on Grafana v10.0.3\n\n### How do we reproduce it?\n\n1. Installing v10.1.2\r\n2. navigate to `/login`\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.1.2\r\nOS: Debian GNU/Linux 12 (bookworm), Linux 6.5.3-x64v3-xanmod1\r\nBrowser: iPadOS Safari 16.6\r\n\n\n### Grafana platform?\n\nA package manager (APT, YUM, BREW, etc.)\n\n### Datasource(s)?\n\n_No response_","labels":["area/backend","triage/needs-confirmation"]},{"id":49897,"title":"Transformers orderFieldsTransformer sort function change the input dataframe","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nIn `packages/grafana-data/src/transformations/transformers/order.ts` file, \r\n`return fields.sort(..)` change the input data.\r\n\r\nhttps://github.com/grafana/grafana/blob/277a83215c1e20ff8c93768f93edf92d60deee5f/packages/grafana-data/src/transformations/transformers/order.ts#L46-L56\r\n\r\n**What you expected to happen**:\r\n\r\nkeey function `transformDataFrame` pure\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nUse `OrganizeFields transfomer`, change fields order,  then disable the organizeFields transfomer, fields order is still\r\n\r\n\r\n**Sloution**\r\n```ts\r\nreturn fields.map(item=\u003eitem).sort(...)\r\n```","labels":["type/bug","effort/small","prio/medium","area/transformations","good first issue"]},{"id":44712,"title":"XY Chart not respecting MIN MAX","body":"Grafana 8\r\n\r\nThe XY Chart (alpha) does not respect set max and min override values for axis:\r\n![image](https://user-images.githubusercontent.com/12225528/151979025-043ce635-e42c-41a7-8ef8-d4518e0812ff.png)\r\nOr am I doing something Wrong here?\r\n","labels":["type/bug","area/panel/xychart"]},{"id":68299,"title":"How to include current timestamp in Email subject line","body":"### \r\n# What went wrong?\r\n\r\n\r\nHi\r\n\r\nIm trying to include the current timestamp or incident start time in email subject line so that each email is received as separate mail instead of mail thread.\r\n\r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\nThe template that i tried.\r\n```\r\n{{ define “email.subject” }}\r\n{{ .Status | toUpper }} - {{ .CommonLabels.alertname }} {{ .Alerts.Firing.StartsAt.Format “Monday, 2 January 2006 at 3:04PM” }}\r\n{{ end }}\r\n```\r\n\r\nSubject that I see: I’m getting only the “FIRING - TestAlert”\r\n\r\nThis `{{ .Alerts.Firing.StartsAt.Format “Monday, 2 January 2006 at 3:04PM” }}` part of the template is just returning empty in actual mail subject alert.\r\n\r\nAny help in this would be appreciated. Is there any another option to send each email as separate one.\r\n\r\n\r\nGrafana version: v9.4.3\r\nOS: Ubuntu 20.04","labels":["area/alerting"]},{"id":71178,"title":"Alerts changes don't refresh with sidecar","body":"### \r\n# What went wrong?\r\n\r\n\r\nAfter adding changes to the config map with alerts I don't see the changes in grafana:\r\n1. I have PVC for var/lib/grafana folder\r\n2. I am using sidecar to reload alerts http://localhost:3000/api/admin/provisioning/alerting/reload\r\n3. Everything works for dashboards\r\n  - \r\n\r\nI except to see refreshed alerts\r\n\r\n  - \r\n\r\n\r\n### \r\n# How do we reproduce it?\r\n\r\n\r\n**Step 1**:\r\n\r\n- I am using kubectl apply -f configmap_alerts.yaml\r\n\r\n**Step 2**:\r\n\r\n- Changes are on cluster in config map but not in grafana\r\n\r\n\r\n\r\n\r\n### \r\n# What Grafana version are you using?\r\n\r\n\r\n9.5.5\r\n\r\n### \r\n## Optional Questions:\r\n\r\n### Is the bug inside a Dashboard Panel?\r\n\r\n\r\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\r\n\r\n### Grafana Platform?\r\n\r\nKubernetes\r\n\r\n### User's OS?\r\n\r\nWindows 11\r\n\r\n### User's Browser?\r\n\r\nChrome\r\n\r\n### Is this a Regression?\r\n\r\nNo\r\n\r\n### Are Datasources involved?\r\n\r\n_No response_\r\n\r\n### Anything else to add?\r\n\r\n\r\n_No response_","labels":["needs more info","area/alerting","triage/needs-confirmation"]},{"id":71062,"title":"Grafana integrated ntopng","body":"Grafana version 10.0.1\r\n```\r\n[root@LogFlow ~]# grafana-cli -v\r\ngrafana version 10.0.1\r\n[root@LogFlow ~]#\r\n```\r\nntopng Plugins 1.0.1\r\n```\r\n[root@LogFlow plugins]# ls\r\nalexanderzobnin-zabbix-app            ntop-ntopng-datasource\r\nalexanderzobnin-zabbix-app-4.3.1.zip  ntop-ntopng-datasource-1.0.1.zip\r\n[root@LogFlow plugins]#\r\n```\r\nGrafana failed to select the ntopng data source for display, the network is reachable\r\n![image](https://github.com/grafana/grafana/assets/121689365/0058c07e-8608-4f49-825f-a039205dae94)\r\nCan I implement referencing the data stream of ntopng to Grafana presentation\r\n![image](https://github.com/grafana/grafana/assets/121689365/2c3da345-3388-48d8-ba49-4f08c9337ec0)\r\n\r\n\r\n\r\n","labels":["area/plugins","triage/needs-confirmation"]},{"id":46908,"title":"Docs: Missing option in datasource api to control alerting section","body":"**What happened**:\r\n\r\nWould like to provision datasource from json as in [this documentation](https://github.com/grafana/grafana/blob/main/docs/sources/datasources/prometheus.md) to setup alerting section\r\n\r\n**What you expected to happen**:\r\n\r\nAn option to set Alerting section\r\n\r\n![image](https://user-images.githubusercontent.com/64681762/159851837-6b1d169f-7fda-4d9f-8e19-e0b3b2f71a77.png)\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\nUpload datasource yaml file during deployment\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.4\r\n- Data source type \u0026 version: prometheus and loki\r\n- OS Grafana is installed on: Ubuntu 20.04\r\n- User OS \u0026 Browser: Ubuntu 20.04, Chrome\r\n- Grafana plugins: N/A\r\n- Others: N/A\r\n","labels":["type/docs","needs investigation","area/datasource"]},{"id":77325,"title":"Dashboards: Import Breaks Datasource Targets into String Array","body":"### What happened?\r\n\r\nOn Import of a Dashboard created with Grafana 8.3.4 (https://github.com/adriankumpf/teslamate/blob/master/grafana/dashboards/statistics.json) into Grafana 10.2.0 something seems to break the model code resulting in a broken query editor\r\n\r\n![grafik](https://github.com/grafana/grafana/assets/2990373/79aa5327-adec-46d3-85bf-b5c7d6282dec)\r\n\r\n```json\r\n  \"panels\": [\r\n    {\r\n      \"collapsed\": false,\r\n      \"datasource\": \"TeslaMate\",\r\n      \"gridPos\": {\r\n        \"h\": 1,\r\n        \"w\": 24,\r\n        \"x\": 0,\r\n        \"y\": 0\r\n      },\r\n      \"id\": 4,\r\n      \"panels\": [],\r\n      \"repeat\": \"car_id\",\r\n      \"targets\": [\r\n        {\r\n          \"datasource\": {\r\n            \"0\": \"T\",\r\n            \"1\": \"e\",\r\n            \"2\": \"s\",\r\n            \"3\": \"l\",\r\n            \"4\": \"a\",\r\n            \"5\": \"M\",\r\n            \"6\": \"a\",\r\n            \"7\": \"t\",\r\n            \"8\": \"e\"\r\n          },\r\n          \"refId\": \"A\"\r\n        }\r\n      ],\r\n      \"title\": \"$car_id\",\r\n      \"type\": \"row\"\r\n    },\r\n```\r\n\r\n### What did you expect to happen?\r\n\r\nThe query editor should work just fine\r\n\r\n### Did this work before?\r\n\r\nyes\r\n\r\n### How do we reproduce it?\r\n\r\n1. Import Dashboard from here: https://github.com/adriankumpf/teslamate/blob/master/grafana/dashboards/statistics.json\r\n2. Open the Panel config of the Table, see broken Query Editor\r\n3. Check Json Model (Line 62+, Line 518+, Line 556+, Line 593+) - that looks broken\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nHappens with different panels, therefore seems to be a generic / migration related issue\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.2.0\r\nOS: Win 11\r\nBrowser: Firefox\r\n\r\n\r\n### Grafana platform?\r\n\r\nA package manager (APT, YUM, BREW, etc.)\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/dashboard","triage/needs-confirmation","team/grafana-dashboards"]},{"id":47835,"title":"grafana-cli plugins ls only shows restart grafana message when invoked","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWhen invoking ```grafana-cli plugins ls``` the only output gotten is ```\"Please restart Grafana after installing plugins. Refer to Grafana documentation for instructions if necessary.\"```\r\n\r\n**What you expected to happen**:\r\nGet a list of installed plugins\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\nPlugins directory is set to default in grafana.ini. No overrides\r\n\r\n**Environment**:\r\n- Grafana version: 8.4.6\r\n- Data source type \u0026 version: Prometheus version 2.15.2+ds (branch: debian/sid, revision: 2.15.2+ds-2)\r\n- OS Grafana is installed on: Ubuntu 20.04\r\n- User OS \u0026 Browser: Windows 10 - Chrome\r\n- Grafana plugins: grafana-image-renderer\r\n- Others:\r\n","labels":["type/bug","area/plugins","area/grafana-cli"]},{"id":63544,"title":"timeshift on graphs","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nGrafana dashboard miss 1 hour of data in time series\r\n\r\n**What you expected to happen**:\r\nDashboard displays all data in the given time range.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\ninstall Grafana RPI 9.3.6 on a Raspberry Pi with Raspbian 11 bullseye and MariaDB server 10.5.15.\r\nset timezone on raspbian to CET (UTC+1)\r\nSet timezone in MariaDB to \"System\"\r\nPush data into a appropriate table using UTC Timestamps\r\nCreate a Dashboard reading that data and select any time range to display.\r\nIf you select less or equal an hour, no data gets displayed at all.\r\nIf you select more than an hour, always the first hour on the time series will not be displayed:\r\n![image](https://user-images.githubusercontent.com/14196051/220562314-0eb5986a-616d-49d1-9418-f3e2f71f6e52.png)\r\nExample from a temperature sensor.\r\n\r\n**Anything else we need to know?**:\r\nRegardless of the time settings in the browser (CET/UTC), the gap stays.\r\n\r\n**Environment**:\r\n- Grafana version: 9.3.6\r\n- Data source type \u0026 version: MYSQL (MariaDB 10.5.15)\r\n- OS Grafana is installed on: Raspbian 11 bullseye\r\n- User OS \u0026 Browser: Windows 10; Chrome\r\n- Grafana plugins: None\r\n- Others: \r\nUploading query (data is provided by a SDR reader -utctimestamp is the essential column.\r\n```\r\nThisQuery=\"insert into \"$dbtable\" (utctimestamp,devicename,devicevalue,deviceunit,zone,battery,devicechannel,deviceid) values (\"\r\nThisQuery+=\"'$(date --utc '+%Y-%m-%d %H:%M:%S')'\"\r\nThisQuery+=\",'$SNAME'\"\r\nThisQuery+=\",'$SVALUE'\"\r\nThisQuery+=\",'$SUNIT'\"\r\nThisQuery+=\",'$SZONE'\"\r\nThisQuery+=\",'$SBATT'\"\r\nThisQuery+=\",'$SCHAN'\"\r\nThisQuery+=\",'$SID'\"\r\nThisQuery+=\");\"\r\n```\r\nGrafana Query (assume $Sensor as 'Außen'):\r\n```\r\nSELECT\r\n  utctimestamp AS \"time\",\r\n  devicevalue AS \"Temperatur\"\r\nFROM sensordata\r\nWHERE\r\n  $__timeFilter(utctimestamp) AND\r\n  zone = '$Sensor' AND\r\n  deviceunit = \"°C\"\r\nORDER BY utctimestamp;\r\n```\r\nTesting results by manual query:\r\n```\r\nSELECT   utctimestamp AS \"time\",   devicevalue AS \"Temperatur\" FROM sensordata WHERE   utctimestamp \u003e= convert_tz(date_sub(now(), interval 3 hour),'+01:00','+00:00') AND   zone = 'Außen' AND   deviceunit = \"°C\" ORDER BY utctimestamp desc;\r\n+---------------------+------------+\r\n| time                | Temperatur |\r\n+---------------------+------------+\r\n| 2023-02-22 08:11:15 |        6.2 |\r\n| 2023-02-22 08:10:36 |        6.1 |\r\n| 2023-02-22 08:10:01 |        6.1 |\r\n| 2023-02-22 08:09:21 |        6.1 |\r\n| 2023-02-22 08:08:44 |        6.1 |\r\n| 2023-02-22 08:08:22 |        6.1 |\r\n| 2023-02-22 08:07:35 |          6 |\r\n| 2023-02-22 08:07:00 |          6 |\r\n| 2023-02-22 08:06:30 |          6 |\r\n| 2023-02-22 08:05:50 |          6 |\r\n[snip]\r\n| 2023-02-22 05:17:39 |        4.3 |\r\n| 2023-02-22 05:17:06 |        4.3 |\r\n| 2023-02-22 05:16:31 |        4.3 |\r\n| 2023-02-22 05:15:59 |        4.3 |\r\n| 2023-02-22 05:15:19 |        4.3 |\r\n| 2023-02-22 05:14:45 |        4.3 |\r\n| 2023-02-22 05:14:10 |        4.3 |\r\n| 2023-02-22 05:13:35 |        4.3 |\r\n| 2023-02-22 05:12:59 |        4.3 |\r\n| 2023-02-22 05:12:26 |        4.3 |\r\n| 2023-02-22 05:11:51 |        4.2 |\r\n+---------------------+------------+\r\n```\r\nResult returns 3 hours of data, starting 05:11am to 08:11am, but Grafana Dashboard displays only 07:11am to 09:11am (translated in CET).\r\n\r\n","labels":["area/dashboard","needs more info","datasource/MySQL"]},{"id":79807,"title":"Potential security issue when using google oauth","body":"### What happened?\r\n\r\nhttps://trufflesecurity.com/blog/google-oauth-is-broken-sort-of/\r\n\r\ncame across this on HN, checked a bunch of stuff we use and found that I could login to our Grafana instance with an email with `+something`, like the article states.\r\n\r\nHere is a PR in my fork: https://github.com/AeroNotix/grafana/pull/1/files which I believe (but didn't test) will solve the issue\r\n\r\n### What did you expect to happen?\r\n\r\nNon-organizational accounts, even with the same \"email domain\" are not logged in\r\n\r\n### Did this work before?\r\n\r\nDunno lol\r\n\r\n### How do we reproduce it?\r\n\r\n1. Enable google oauth\r\n2. Set allowed_domains\r\n3. Create a non-organization user, but using the organizations domain (e.g. foobar+something@orgdomain.com)\r\n4. Login to grafana\r\n5. See that you are logged in\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana:\r\nOS:\r\nBrowser:\r\n\r\n\r\n### Grafana platform?\r\n\r\nNone\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/security","area/auth/oauth","triage/needs-confirmation"]},{"id":53585,"title":"Sorts the numbers wrong","body":"It just sorts the numbers wrong and that's it.\r\nThis issue we saw on panel \"Heatmap\" or \"Heatmap (new)v9.0.5\".\r\nAfter pressing bottom refresh in grafana we saw different sort number \r\n\r\n**Screenshots**\r\n\r\n![Screenshot 2022-08-11 at 14 23 11](https://user-images.githubusercontent.com/56085856/184122874-d316c108-3943-482a-9769-2feaf4f58dca.png)\r\nor\r\n![Screenshot 2022-08-11 at 14 23 05](https://user-images.githubusercontent.com/56085856/184122890-0471d501-8137-491d-b011-306a1bdf4546.png)\r\n\r\n**Query**\r\n\r\nIf I use something like this\r\n```\r\nsort(sum(rate(slurp_requests_duration_seconds_bucket[$__rate_interval])) by (le))\r\n```\r\n```\r\nsort_by_label((sum(slurp_requests_duration_seconds_bucket) by (le)), \"le\")\r\n```\r\n![Screenshot 2022-08-11 at 14 25 02](https://user-images.githubusercontent.com/56085856/184123150-87a02e2d-a458-4d2b-9f69-a02605b31179.png)\r\n\r\n**Version**\r\nVictoria metrics - v1.78.0\r\nGrafana (Tested on)\r\n- v9.0.2 \r\n- v9.0.5\r\n- v9.1.0beta1","labels":["area/panel/heatmap","bot/no new info"]},{"id":46347,"title":"Alerting: Don't allow users to create alert rules against frontend-only datasources","body":"Hello \r\n\r\n**What happened**:\r\nI get a API error when I want to create a new alert rule,\r\n\r\nThe following error appears in the WEB UI interface:\r\n![创建告警规则错误1](https://user-images.githubusercontent.com/18669928/157397943-8b42e1e9-8ec2-48d8-ab1b-31260bbf289a.png)\r\n![image](https://user-images.githubusercontent.com/18669928/157399324-75cb72a6-46f4-4b0b-9e4b-41f0591750e8.png)\r\n\r\n\r\nThe following error appears in the  Grafana log:\r\n`\r\nt=2022-03-09T15:34:53+0800 lvl=eror msg=\"API error\" logger=context userId=1 orgId=1 uname=admin error=\"Failed to evaluate queries and expressions: failed to execute conditions: plugin unavailable\" remote_addr=xx.xxx.xxx.xxx\r\nt=2022-03-09T15:34:53+0800 lvl=info msg=\"Request Completed\" logger=context userId=1 orgId=1 uname=admin method=POST path=/api/v1/eval status=400 remote_addr=xx.xxx.xxx.xxx time_ms=3 size=23 referer=\"https://mygrafana/grafana/alerting/8EzcRQLnk/edit?returnTo=%2Falerting%2Flist\"\r\n`\r\n\r\nIt works fine when using Explorer\r\n![image](https://user-images.githubusercontent.com/18669928/157398604-f46efbcb-f781-4ee0-95e2-f988e9ec54ba.png)\r\n\r\n\r\n**What you expected to happen**:\r\ncreate a normal alert rule\r\n\r\n\r\n**Environment**:\r\n- Grafana version: v8.3.4\r\n- Data source type \u0026 version: JSON plugin \u0026 0.4.1\r\n- plugins link: https://grafana.com/grafana/plugins/simpod-json-datasource/\r\n- OS Grafana is installed on: Centos 7\r\n- User OS \u0026 Browser:  windows10 \u0026 Chrome/96.0.4664.110\r\n\r\nThanks in advance","labels":["type/bug","needs more info","area/alerting","area/frontend"]},{"id":45973,"title":"Unified alerts: Errors in grafana logs after upgrade and alert state histroy does not work","body":"\r\n\r\n\r\n\r\n\r\n**What happened**:\r\nUpgraded Grafana from v8.3.0 to v8.4.1 and logfiles was flooded with the following errors:\r\n` lvl=eror msg=\"unexpected content type from upstream. expected YAML, got text/html; charset=utf-8\" error=\"unexpected content type from upstream. expected YAML, got text/html; charset=utf-8\"`\r\n\r\n**What you expected to happen**:\r\nBe able to use the newest grafana features such as alert state history, it keeps staying empty\r\n![image](https://user-images.githubusercontent.com/55841916/155973805-526e782c-eb1c-4345-a759-b165449a837c.png)\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1. Simply opening alerts page, the errors are thrown in the logs. \r\n2. Cannot open the alert state history \r\n\r\n**Environment**:\r\n- Grafana version:  v8.4.1\r\n- Data source type \u0026 version: Prometheus v2.30.3\r\n- OS Grafana is installed on: Docker\r\n- User OS \u0026 Browser: Microsoft edge\r\n- Grafana plugins: none\r\n- Others: \r\n","labels":["prio/high","area/alerting","effort/none"]},{"id":65510,"title":"Grafana dashboard json migrate to other instance with wrong units","body":"I use grafana 8.2.5 (instance A) and create a new dashboard. I copy this dashboard's json (with option export for sharing externally)  to another grafana 8.2.5 (instance B). Dashboard can't work correctly in instance B.\r\nAs you can see in the screenshots, units of measure are displayed incorrectly.\r\nI checked all the settings inside the dashboard and they are identical.\r\nThanks for any ideas.\r\n![123](https://user-images.githubusercontent.com/129268099/228476927-cb625a6b-775e-4723-8c4c-331b97e63aea.jpg)\r\n","labels":["area/dashboard","bot/no new info"]},{"id":88257,"title":"Dashboards:  Annotations arrows overflow graphs and overlap onto neighboring graphs.","body":"### What happened?\n\nIf you have a few panels aligned horizontally in a dashboard - when you enable annotations, a good number of them are overflowing their panels and overlapping onto the neighboring panels - making for a total readability mess.\r\n\r\nSeems to only happen to single day annotations where the start and end dates are the same, rather than ranges?\r\n\r\n![image](https://github.com/grafana/grafana/assets/1250698/4e27bad0-6058-4549-bb9d-799f33ab1a82)\n\n### What did you expect to happen?\n\nAnnotations be properly contained within a panel for the current time frame.\n\n### Did this work before?\n\nHas been this way since 10.x and 11.x\n\n### How do we reproduce it?\n\n1. Create a few graph panels aligned horizontally\r\n2. Have a number of annotations that go beyond the current timeframe\r\n3. See how the annotations outside of the current timeframe overflow each panel and overlap onto neighbors.\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 11.0\r\nOS: Windows\r\nBrowser: Chrome\r\n\n\n### Grafana platform?\n\nA downloaded binary\n\n### Datasource(s)?\n\n_No response_","labels":["needs more info","area/annotations"]},{"id":46322,"title":"Grafana Alerting Labels not working for kubernetes ${pod}, allthough ${container} label is working","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nWe are trying to create Alert emails for CPU Usage and Memory usage Grafana dashboards.\r\nWe target to print the container name, pod name , node name and the namespace name in our email template.\r\n\r\nWe have used notification template like this:\r\n**Alert Description: CPU Usage of POD - ${pod} having container ${container} in namespace ${namespace} is greater than the threshold 0.1**\r\n\r\nAlso the ${container} works only for 1 query(dashboard panel) and not for others. Please clarify how the ${Label} works.\r\nPlease note: We have thoroughly gone through the relevant official documentation \r\n\r\nhttps://grafana.com/docs/grafana/latest/alerting/old-alerting/add-notification-template/\r\n\r\n\r\n\r\n**What you expected to happen**:\r\n![image](https://user-images.githubusercontent.com/64616330/157239769-5d84605f-7ffe-4247-a50e-2cc40b6db210.png)\r\n\r\nWe want the highlighted values to be populated as well just like the container is getting printed in our alert emails\r\n![Uploading grafana-alert-isse.JPG…]()\r\n\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**: Dev\r\n- Grafana version: 8.4.3 OSS\r\n- Data source type \u0026 version: Prometheus (via helm chart) 0.5.1\r\n- OS Grafana is installed on: Kubernetes cluster with RHEL instances\r\n- User OS \u0026 Browser: Chrome\r\n- Grafana plugins: None\r\n- Others: N/A\r\n","labels":["type/bug","needs more info","area/alerting"]},{"id":83740,"title":"Panel positions change when sharing the dashboard","body":"### What happened?\n\nAfter sharing the dashboard, the positions of individual panels were unexpectedly altered, contrary to the expected behavior where the panel positions should remain unchanged.\r\n\r\n![Screenshot 2024-03-01 11 05 56](https://github.com/grafana/grafana/assets/18591933/e242d35e-b37a-46c3-ac6e-32c22ce691f1)\r\n![2](https://github.com/grafana/grafana/assets/18591933/f15eb541-81b8-4a9b-b7d0-bda1c8492d3f)\r\n![Screenshot 2024-03-01 11 07 26](https://github.com/grafana/grafana/assets/18591933/5c6d0a2f-0728-4f00-ab64-323458746694)\r\n\n\n### What did you expect to happen?\n\nI expect that sharing the dashboard should not impact the positions of individual panels. After performing the sharing operation, the positions of each panel should remain unchanged.\n\n### Did this work before?\n\nI’m not sure.\n\n### How do we reproduce it?\n\n1. Click on the \"Share Dashboard\" button in the top left corner.\r\n2. Select \"Export\" for external sharing.\r\n3. Notice changes in the positions of some panels.\n\n### Is the bug inside a dashboard panel?\n\nyes\n\n### Environment (with versions)?\n\nGrafana:9.3.2\r\nOS:Ubuntu 22.04.1 LTS\r\nBrowser:chrome 122.0.6261.94\r\n\n\n### Grafana platform?\n\nA downloaded binary\n\n### Datasource(s)?\n\nprometheus","labels":["type/bug","area/dashboard","triage/needs-confirmation","team/grafana-dashboards"]},{"id":55348,"title":"Stacking in bar and timeseries plots when negative values are present is incorrect","body":"Tested with Grafana 9.1.2 and 9.1.5\r\n\r\nThe data is (data columns correspond to green, yellow, red colors in the graphs below)\r\n![2022-09-18_22-25-16_3290x603](https://user-images.githubusercontent.com/105664/190929271-baf70613-2ca1-48c7-b471-86353328dfd2.png)\r\nThis is what I get with stacked bar plot (changing to stacked timeseries plot shows the same issue)\r\n![2022-09-18_22-49-49_3018x783](https://user-images.githubusercontent.com/105664/190929340-24ee49a9-8f13-4bd4-a381-b2be08b3e555.png)\r\nAn example of the issue is for 11:00 and 12:00 - both yellow values should have exactly the same height (their values are 1100).\r\n\r\nIf I hide the green (negative values), then the yellow and red values are OK\r\n\r\n![2022-09-18_22-24-29_3465x1702](https://user-images.githubusercontent.com/105664/190929306-061de6a5-41bd-48db-8d14-417c92d781fe.png)\r\n","labels":["type/bug","area/panel/timeseries"]},{"id":68906,"title":"News Visualization: RSS Feed ","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n  - I tried to add two different atom feeds to the source data of the news visualizer and ended up with an exception:\r\n    - https://github.com/junit-team/junit5/releases.atom\r\n    - https://github.com/karatelabs/karate/releases.atom\r\n\r\n**What did you expect to happen**:\r\n\r\n  - The feeds would be visible on the dashboard\r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Open Grafana, create a new dashboard\r\n\r\n**Step 2**:\r\n\r\n- Set the visualization for \"News\" \r\n\r\n**Step 3**:\r\n\r\n- Add `https://github.com/junit-team/junit5/releases.atom` as the URL input \r\n\r\n**Step 4**:\r\n\r\n![image](https://github.com/grafana/grafana/assets/76950991/b01808d3-ea4f-44c8-a733-52ed5117366a)\r\n\n\n### \n# What Grafana version are you using?\n\n\nGrafana v9.5.2 (cfcea75916)\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nKubernetes\n\n### User's OS?\n\nMacOS\n\n### User's Browser?\n\nVersion 113.0.5672.92 (Official Build) (x86_64)\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\n_No response_","labels":["area/panel/news"]},{"id":78535,"title":"Provisioning: Dashboard provider folderUid not working","body":"### What happened?\r\n\r\nI'm using the panel 'Dashboard list', which previously, on version 10.1.1, had the option to select all folders. Now that I updated to the newest version (10.2.2), I need to specify a folder, which would be fine with me but now that I added the uid to my provisioned folder, it doesn't get set for the selected folder. Instead a random uid is assigned and since the dashboard is also privisioned, every time I restart grafana the default 'Dashboard' folder is selected instead of my own.\r\n\r\n### What did you expect to happen?\r\n\r\nFolder get's assigned defined uid and can be used in a provisioned dashboard.\r\n\r\n### Did this work before?\r\n\r\nYes, at least until version 10.1.1. I checked, if the uid specified in the privisioning yaml get's assigned to the folder by selecting the folder instead of all in the 'Dashboard list' panel.\r\n\r\n### How do we reproduce it?\r\n\r\n1. Use the following yaml for the provisioning:\r\n```yaml\r\napiVersion: 1\r\nproviders:\r\n  - name: monitoring\r\n    folder: 'Monitoring'\r\n    folderUid: monitoring\r\n    type: file\r\n    options:\r\n      path: /monitoring-dashboards/\r\n```\r\n2. Add the panel 'Dashboard list'\r\n3. Select the folder 'Monitoring'\r\n4. Look in the panel json and search for '\"folderUID\": '\r\n5. See the random uid\r\n\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\nNo\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: 10.2.2\r\nOS: docker/kubernetes\r\nBrowser: chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nDocker\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["needs more info","area/provisioning","triage/pending"]},{"id":60921,"title":"Cloudwatch data source provisioning not working","body":"**What happened**:\r\nCloudwatch data source provisioning doesn't seem to be working. I followed the steps in the documentation but Cloudwatch doesn't appear as a Data Source. It does appear installed though.\r\n\r\n\u003cimg width=\"481\" alt=\"Screenshot 2023-01-03 at 18 46 06\" src=\"https://user-images.githubusercontent.com/93582811/210412647-16721f6e-c422-4f1d-91da-3626496f33f8.png\"\u003e\r\n\r\n\u003cimg width=\"1413\" alt=\"Screenshot 2023-01-03 at 18 45 35\" src=\"https://user-images.githubusercontent.com/93582811/210412667-148ec1b8-e6b0-45a0-b70b-26458ad9af6c.png\"\u003e\r\n\r\n**What you expected to happen**:\r\nCloudwatch data source to appear in Grafana data sources.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nBlock of code from first screenshot in your production or staging deployment YAML.\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: 9.2.1\r\n- Data source type \u0026 version: CloudWatch\r\n- OS Grafana is installed on: Linux\r\n- User OS \u0026 Browser: MacOS Ventura 13.0.1 | Chrome\r\n- Grafana plugins: Redshift\r\n- Others:\r\n","labels":["datasource/CloudWatch","area/provisioning"]},{"id":48917,"title":"Dashboards | Timestamps: improve handling of ms precision for timestamps","body":"Issue happening with both MySQL 5.6, and latest version of PostgreSQL\r\n\r\nBasic TimeSeries chart.\r\nI have 4 records in the table and millisecond resolution datetime properly shows up (both in Grafana table and chart view)\r\n![image](https://user-images.githubusercontent.com/5315603/167954054-26bbc04a-1671-4b0b-a70f-9d5377c259f1.png)\r\n\r\nAfter inserting one more record, the query starts to return seconds resolution, even though I didn't touch the query.\r\n![image](https://user-images.githubusercontent.com/5315603/167953959-d2145e48-b1b2-439c-99e7-4474a1750859.png)\r\n\r\nAlso note I text DIFF - ed the EXPANDED query and there is no difference just that it queried 5 samples instead of 4.\r\n\r\nI expect to get millisecond resolution queried always, regardless of how many records are in the table.\r\n\r\nIn MySQL timestamp(3) column type used, in PostgreSQL timestamp without timezone (with 3 precision)\r\n\r\nHow to reproduce?\r\nCreate table, insert some {'2022.05.12 23:40:50.398', anyValue} values, and millisecond display eventually changes to seconds by itself without changing the query.\r\n\r\nUse the following query:\r\nSELECT\r\n  DateTime AS \"time\",\r\n  Value\r\nFROM table\r\nORDER by DateTime\r\n\r\n**Environment**:\r\n- Grafana version: v8.5.0 (6134e3cf3)\r\n- Data source type \u0026 version: MySQL 5.6, and latest PostgreSQL both reproducable\r\n- OS Grafana is installed on: Win10\r\n- User OS \u0026 Browser: Win10 + Google Chrome\r\n- Grafana plugins: Built-in TimeSeries\r\n- Others:\r\n","labels":["area/panel/common"]},{"id":70035,"title":"Provisioning: SecureJSONData in datasource does not null empty fields on update","body":"### \n# What went wrong?\n\n\n**What happened**:\r\n\r\n  - As part of rollout of grafana enterprise, we updated the default datasource to use basicAuth instead of TLS Certificate auth. This involved removing the keys tlsClientCert and tlsClientKey from the secureJSONData field of the datasource in our datasources.yaml.\r\n  - When the TLS certificate expired, the datasource broke, requiring us to delete and recreate it to recover service.\r\n\r\n**What did you expect to happen**:\r\n\r\n  - We expected the database representation of the datasource to have the tlsClientCert and tlsClientKey fields deleted when they were deleted from the config file.\r\n\r\n\r\n\n\n### \n# How do we reproduce it?\n\n\n**Step 1**:\r\n\r\n- Create a datasource using datasources.yaml. set a key in the secureJsonData field. \r\n\r\n**Step 2**:\r\n\r\n- Note in the database that the field is now set - eg `SELECT secure_json_data FROM \"data_source\" WHERE name='mimir';` will show the key exists.\r\n\r\n**Step 3**:\r\n\r\n- Delete the key from secureJsonData in datasources.yaml and apply the config file. Note that the secureJsonData continues to contain the affected field.\n\n### \n# What Grafana version are you using?\n\n\nv9.5.3\n\n### \n## Optional Questions:\n\n### Is the bug inside a Dashboard Panel?\n\n\nCopy the panel's [\"get-help\" data](https://grafana.com/docs/grafana/latest/troubleshooting/send-panel-to-grafana-support/) here\n\n### Grafana Platform?\n\nKubernetes\n\n### User's OS?\n\n_No response_\n\n### User's Browser?\n\n_No response_\n\n### Is this a Regression?\n\nNone\n\n### Are Datasources involved?\n\n_No response_\n\n### Anything else to add?\n\n\nWe can work around by deleting the datasource and allowing recreation for now.","labels":["area/provisioning","triage/needs-confirmation"]},{"id":60629,"title":"Numbering of pages for request dashboards starts from 0, not from 1","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI tried to execute request `my-grafana.com?query=\u0026starred=false\u0026skipRecent=true\u0026skipStarred=true\u0026layout=list\u0026type=dash-db\u0026limit=20\u0026page=1 ` and I got not first 20 dashboards, I got 21-40 dashboards\r\n**What you expected to happen**:\r\nI expected to get first 20 dashboards\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nTry to execute request described above\r\n**Anything else we need to know?**:\r\nMaybe just fix doc you need\r\n**Environment**:\r\n- Grafana version: v9.1.5\r\n- Data source type \u0026 version: -\r\n- OS Grafana is installed on: ubuntu\r\n- User OS \u0026 Browser: google chrome\r\n- Grafana plugins: -\r\n- Others: -\r\n","labels":["area/dashboard","bot/no new info"]},{"id":61470,"title":"PSQL Queries and Tranformations","body":"Hi all :), \r\n\r\nI have 2 queries psql, the first one is the number of PC with a application setup, and the 2nd one the total number of PC.\r\nI need to calculate a percentage. So I tried to use the transformation, but it does not work...\r\n\r\nIf a try to do: first query+ 2nd query, there is no answer...\r\nIf I do first query + first query, it works, but it's useless :)\r\n\r\nFirst + second: \r\n![image](https://user-images.githubusercontent.com/24936778/212297354-0632eea0-bffd-4253-90c5-4d89cc91f04b.png)\r\n\r\nFirst + First\r\n![image](https://user-images.githubusercontent.com/24936778/212297480-fbe6f582-233b-4dfb-b144-105e6c1e75d8.png)\r\n\r\nAny idea why ? \r\n\r\nthx !\r\n","labels":["datasource/Postgres","area/transformations","bot/no new info"]},{"id":46440,"title":"Timeseries: Annotations from multiple datasources do not show the full annotation","body":"**What happened**:\r\nWe get annotations from multiple Graphite datasources and display them in the same graph. One of the annotations have both subject/description (_\"Show each tests\"_ in the video)  and if we have two annotations enabled, the description part is not shown, see the video. If we only enable that specific annotation, the annotation is shown correctly.\r\n\r\nhttps://user-images.githubusercontent.com/540757/157834617-b5210725-225f-44e7-87de-731e77a5b128.mp4\r\n\r\n**What you expected to happen**:\r\nI expect the annotation to look the same independently if we have multiple annotation datasources enabled or not.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nNot sure but you can verify the behaviour at our public instance:\r\nhttps://grafana.wikimedia.org/d/IvAfnmLMk/page-drilldown?orgId=1\u0026viewPanel=80\r\n\r\n**Anything else we need to know?**:\r\nWe haven't been able to pinpoint when this happened, but I'm pretty sure it used to work :) I also tested on a 8.4.3 install but there I do not have multiple datasources and I couldn't reproduce it.\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.6\r\n- Data source type \u0026 version: Two different Graphite instances that stores the annotations. I could reproduce also by storing a annotation in Grafana.\r\n- OS Grafana is installed on:\r\n- User OS \u0026 Browser: Reproducible on latest Chrome/Firefox/Safari on Mac OS\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["type/bug","area/annotations"]},{"id":75315,"title":"Dashboards: empty links configs break dashboards after upgrade","body":"### What happened?\r\n\r\nWe're seeing this on v10.1.1:\r\n\r\n```\r\nreact-dom.production.min.js:189 TypeError: Cannot read properties of undefined (reading 'replace')\r\n    at S.getDataLinkUIModel (link_srv.ts:301:45)\r\n    at linkSuppliers.ts:152:29\r\n    at Array.map (\u003canonymous\u003e)\r\n    at Object.getLinks (linkSuppliers.ts:151:20)\r\n    at o (getPanelChromeProps.tsx:56:53)\r\n    at We (PanelLinks.tsx:27:23)\r\n    at Bl (react-dom.production.min.js:167:137)\r\n    at Nc (react-dom.production.min.js:290:337)\r\n    at el (react-dom.production.min.js:280:389)\r\n    at ws (react-dom.production.min.js:280:320)\r\n```\r\n\r\n### What did you expect to happen?\r\n\r\nNo errors.\r\n\r\n### Did this work before?\r\n\r\nEverything was working fine on v9.4.x.\r\n\r\n### How do we reproduce it?\r\n\r\nHave a dashboard with a panel that has the following:\r\n\r\n```json\r\n                \"links\": [\r\n                    {}\r\n                ],\r\n```\r\n\r\n### Is the bug inside a dashboard panel?\r\n\r\n_No response_\r\n\r\n### Environment (with versions)?\r\n\r\nGrafana: v10.1.1\r\nOS: macOS\r\nBrowser: Chrome\r\n\r\n\r\n### Grafana platform?\r\n\r\nNone\r\n\r\n### Datasource(s)?\r\n\r\n_No response_","labels":["area/dashboard","triage/needs-confirmation","team/grafana-dashboards"]},{"id":44711,"title":"Links with same URL but different port than the grafana URL are handled incorrectly","body":"**What happened**:\r\n\r\nWhen using links in dashboard that have the same URL as the grafana instance but a different port the links appear to be treated as internal links. \r\n\r\n![grafana_url](https://user-images.githubusercontent.com/80964995/151977384-5067ca94-4ae0-4fa9-8ef0-d8a9872bc883.png)\r\n\r\n![grafana_result](https://user-images.githubusercontent.com/80964995/151977372-5b147e33-4809-478e-bfaa-141d2c99ad54.png)\r\n\r\n**What you expected to happen**:\r\n\r\nI would expect the link to be handled as any other external link.\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n* Create a textpanel on a grafana instance with url: https://grafana.example.com\r\n* Add a link  https://grafana.example.com:8888/some_target\r\n* Save and click the link\r\n\r\n**Environment**:\r\n- Grafana version: 8.1.1\r\n- Data source type \u0026 version: -\r\n- OS Grafana is installed on: ubuntu\r\n- User OS \u0026 Browser: ubuntu - chrome\r\n- Grafana plugins: -\r\n- Others: -\r\n","labels":["type/bug","area/panel/text","area/dashboard/data-links"]},{"id":77906,"title":"Alerting: Unable to configure Webhook contact point with Basic authentication","body":"### What happened?\n\nWe have a webhook contact point configured with basic authentication which was working fine in old version 8.4 after upgrading to 10.0.3 this configuration is not working anymore.\r\n\r\nWhile testing the webhook we are getting below error. \r\nAlso we noticed that _Bearer_  is automatically coming as authorization Header - Scheme \r\n\r\n![image](https://github.com/grafana/grafana/assets/50142085/cbec9c80-f16a-42f5-a3d8-5421d83727fe)\r\n\r\n![image](https://github.com/grafana/grafana/assets/50142085/10ebe782-4bce-4415-8dfa-2bc72528a083)\r\n\n\n### What did you expect to happen?\n\nThe webhook contact point should work with basic authentication\n\n### Did this work before?\n\nYes, It was working fine with 8.4.4\n\n### How do we reproduce it?\n\n1.Configure webhook contact point with basic auth\r\n2. Test the webhook\r\n\r\n\n\n### Is the bug inside a dashboard panel?\n\n_No response_\n\n### Environment (with versions)?\n\nGrafana: 10.0.3\r\n\r\n\n\n### Grafana platform?\n\nNone\n\n### Datasource(s)?\n\n_No response_","labels":["area/alerting/notifications","bot/no new info"]},{"id":46677,"title":"Random duplicate log entries when using `| json`","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\n\r\nRandomly duplicate log entries when using `| json`\r\n\r\n**What you expected to happen**:\r\n\r\nNo random duplicates.\r\n\r\n**Anything else we need to know?**:\r\n\r\nHere how log looks without `| json`:\r\n\r\nNotice no duplicate lines and notice this strange line with `[[[[[]], [[]], ...` which can be a cause\r\n![image](https://user-images.githubusercontent.com/1997978/158751025-c9e0fe77-cf98-48a2-bc13-2299c14b1e82.png)\r\n\r\nHere I add `| json`, notice duplicates:\r\n![image](https://user-images.githubusercontent.com/1997978/158751277-1fa0e2b3-7eab-4343-8c90-48f278bff04d.png)\r\n\r\nHere I refreshed query (Shift + Enter), notice how duplicates changed:\r\n![image](https://user-images.githubusercontent.com/1997978/158751394-5b2dc344-7d20-4352-a308-a4217b21146c.png)\r\n\r\nHere is a suspicious line for reproduction:\r\n```\r\n{\"level\":\"debug\",\"msg\":\"Received verifyReceipt response (response=[[[[[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[[[[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]]]]]]], [[]], [[[[[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]], [[]]]]], [[]], [[]]])\",\"response\":[[[[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[[[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]]]]]]],[[]],[[[[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]],[[]]]]],[[]],[[]]],\"source\":\"GameServer.Infrastructure.ReceiptVerification.AppleReceiptVerifier\",\"sessionId\":\"6232d286aa02a3b259424b9c\",\"processId\":\"6231f16f11257f7b78e85be3\"}\r\n```\r\n\r\n**Environment**:\r\n- Grafana version: Cloud\r\n- Data source type \u0026 version: .NET C# application with Serilog and Loki sink and JSON log formatter.\r\n","labels":["needs more info","datasource/Loki","bot/no new info","area/logs"]},{"id":53183,"title":"Alerting: Unified Alerting REST API: Field `For` is always set to `0`","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI´m trying to create a Grafana-Managed rule via the unified alerting API. The value for the field `for` seems to be ignored. My JSON i send to `/api/v1/provisioning/alert-rules`:\r\n```\r\n \"annotations\": {\r\n            \"summary\": \"trunc\"\r\n        },\r\n        \"labels\": {\r\n            \"sn\": \"_changeme_\"\r\n        },\r\n        \"condition\": \"B\",\r\n        \"title\": \"SN000092 - Letztes Statusupdate\",\r\n        \"data\": [\r\n            {\r\n                \"refId\": \"A\",\r\n                \"queryType\": \"\",\r\n                \"relativeTimeRange\": {\r\n                    \"from\": 600,\r\n                    \"to\": 0\r\n                },\r\n                \"datasourceUid\": \"_changeme_\",\r\n                \"model\": {\r\n                    \"expr\": \"(time() - (push_time_seconds{job=\\\"caterva_collector_SNxxx\\\"})) / 3600\",\r\n                    \"hide\": false,\r\n                    \"intervalMs\": 1000,\r\n                    \"maxDataPoints\": 43200,\r\n                    \"refId\": \"A\"\r\n                }\r\n            },\r\n            {\r\n                \"refId\": \"B\",\r\n                \"queryType\": \"\",\r\n                \"relativeTimeRange\": {\r\n                    \"from\": 0,\r\n                    \"to\": 0\r\n                },\r\n                \"datasourceUid\": \"-100\",\r\n                \"model\": {\r\n                    \"conditions\": [\r\n                        {\r\n                            \"evaluator\": {\r\n                                \"params\": [\r\n                                    6\r\n                                ],\r\n                                \"type\": \"gt\"\r\n                            },\r\n                            \"operator\": {\r\n                                \"type\": \"and\"\r\n                            },\r\n                            \"query\": {\r\n                                \"params\": [\r\n                                    \"A\"\r\n                                ]\r\n                            },\r\n                            \"reducer\": {\r\n                                \"params\": [],\r\n                                \"type\": \"last\"\r\n                            },\r\n                            \"type\": \"query\"\r\n                        }\r\n                    ],\r\n                    \"datasource\": {\r\n                        \"type\": \"__expr__\",\r\n                        \"uid\": \"-100\"\r\n                    },\r\n                    \"hide\": false,\r\n                    \"intervalMs\": 1000,\r\n                    \"maxDataPoints\": 43200,\r\n                    \"refId\": \"B\",\r\n                    \"type\": \"classic_conditions\"\r\n                }\r\n            }\r\n        ],\r\n        \"ruleGroup\": \"_changeme_\",\r\n        \"noDataState\": \"OK\",\r\n        \"execErrState\": \"OK\",\r\n        \"for\": 1200,\r\n        \"orgId\": 1\r\n```\r\n\r\nLook at the value for the field `for` which is set to 1200. The result should be 20mins. But when I check the result (`/api/ruler/grafana/api/v1/rules?subtype=cortex`) I get the value zero:\r\n```\r\n{\r\n    \"expr\": \"\",\r\n    \"for\": \"0s\",\r\n    \"labels\": {\r\n        \"sn\": \"000092\"\r\n    },\r\n    \"annotations\": {\r\n        \"summary\": \"Deine Caterva-Anlage hat seit über 6 Stunden keine Werte mehr an das Reporting übermittelt.\"\r\n    },\r\n    \"grafana_alert\": {\r\n        \"id\": 12,\r\n        \"orgId\": 1,\r\n        \"title\": \"SN000092 - Letztes Statusupdate\",\r\n        \"condition\": \"B\",\r\n        \"data\": [\r\n            {\r\n                \"refId\": \"A\",\r\n                \"queryType\": \"\",\r\n                \"relativeTimeRange\": {\r\n                    \"from\": 600,\r\n                    \"to\": 0\r\n                },\r\n                \"datasourceUid\": \"vXgO9xzVz\",\r\n                \"model\": {\r\n                    \"expr\": \"(time() - (push_time_seconds{job=\\\"caterva_collector_SN000092\\\"})) / 3600\",\r\n                    \"hide\": false,\r\n                    \"intervalMs\": 1000,\r\n                    \"maxDataPoints\": 43200,\r\n                    \"refId\": \"A\"\r\n                }\r\n            },\r\n            {\r\n                \"refId\": \"B\",\r\n                \"queryType\": \"\",\r\n                \"relativeTimeRange\": {\r\n                    \"from\": 0,\r\n                    \"to\": 0\r\n                },\r\n                \"datasourceUid\": \"-100\",\r\n                \"model\": {\r\n                    \"conditions\": [\r\n                        {\r\n                            \"evaluator\": {\r\n                                \"params\": [\r\n                                    6\r\n                                ],\r\n                                \"type\": \"gt\"\r\n                            },\r\n                            \"operator\": {\r\n                                \"type\": \"and\"\r\n                            },\r\n                            \"query\": {\r\n                                \"params\": [\r\n                                    \"A\"\r\n                                ]\r\n                            },\r\n                            \"reducer\": {\r\n                                \"params\": [],\r\n                                \"type\": \"last\"\r\n                            },\r\n                            \"type\": \"query\"\r\n                        }\r\n                    ],\r\n                    \"datasource\": {\r\n                        \"type\": \"__expr__\",\r\n                        \"uid\": \"-100\"\r\n                    },\r\n                    \"hide\": false,\r\n                    \"intervalMs\": 1000,\r\n                    \"maxDataPoints\": 43200,\r\n                    \"refId\": \"B\",\r\n                    \"type\": \"classic_conditions\"\r\n                }\r\n            }\r\n        ],\r\n        \"updated\": \"2022-08-02T20:31:17Z\",\r\n        \"intervalSeconds\": 600,\r\n        \"version\": 3,\r\n        \"uid\": \"oADDrbk4k\",\r\n        \"namespace_uid\": \"5ODvrxzVz\",\r\n        \"namespace_id\": 5,\r\n        \"rule_group\": \"SN000092\",\r\n        \"no_data_state\": \"OK\",\r\n        \"exec_err_state\": \"OK\",\r\n        \"provenance\": \"api\"\r\n    }\r\n}\r\n```\r\n\r\nnow the value is set to zero seconds. The value I send has no effect.\r\n\r\n**What you expected to happen**:\r\nI can controll the value of the field `for` over the api\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n**Anything else we need to know?**:\r\n\r\nMaybe this is related to https://github.com/grafana/grafana/pull/50992\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.6 and 9.1.0-beta1\r\n- Data source type \u0026 version: prometheus\r\n- OS Grafana is installed on: docker\r\n- User OS \u0026 Browser: Windows 11/ Edge\r\n- Grafana plugins: none\r\n","labels":["area/alerting"]},{"id":53034,"title":"Unable to select all points on Time Series panel","body":"**What happened**:\r\nI was unable to select a point in the Time Series panel (despite it being in the centre of the crosshairs)\r\n![Screen Recording 2022-08-01 at 12 45 01](https://user-images.githubusercontent.com/61825444/182141933-f9e23a1a-26e8-496c-9dde-995b6ffd7c97.gif)\r\n\r\n**What you expected to happen**:\r\nThe point should be selected (yellow halo).\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nThere are approximately 2,160 points plotted on the panel (90-days at one reading per hour). 1,440 points (60 days) doesn't appear to have the same issue but it's likely this is due to the points not being so close together.\r\n\r\nThis SQL (postgres) will generate a series with outliers approx. 20% of the time that are sufficiently apart to test selection using the y-axis rather than just x;\r\n```\r\nSELECT \r\n  a.a AS time,\r\n  CASE WHEN RANDOM()\u003c0.2 THEN 20 ELSE 0 END as value\r\nFROM generate_series($__unixEpochFrom(), $__unixEpochTo()) a\r\n```\r\n\r\nThe point selection algorithm seems to be relying on proximity of the mouse cursor using the horizontal line only rather than using the vertical line. Using both Axis would make the selection of outliers possible near a cluster of data. \r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version: Grafana v9.0.2 (0641b5d0cd)\r\n- Data source type \u0026 version: Postgres\r\n- OS Grafana is installed on: Docker/ Google Hosted\r\n- User OS \u0026 Browser: Edge on MacOS.\r\n- Grafana plugins:\r\n- Others:\r\n","labels":["stale","area/panel/timeseries"]},{"id":52556,"title":"Plugins page without sub path","body":"**What happened**:\r\nWhen i load the list of plugins and i click one i get \"page not found\". \r\nThis is a configuration behind a reverse proxy, so i am using sub path. I see that all the plugins dont have the subpath on the url, so i have to put it manually on browser url.\r\n**What you expected to happen**:\r\nI expect to see the details of plugin\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n1- Behind a reverse proxy with sub path \"t-grafana\"\r\n1.1- Load plugins list\r\n1.2- Click in any plugin\r\n\r\n**Anything else we need to know?**:\r\nNope\r\n\r\n**Environment**:\r\n- Grafana version: 9.0.4\r\n- Data source type \u0026 version: \r\n- OS Grafana is installed on: Red hat 7\r\n- User OS \u0026 Browser: Chrome\r\n- Grafana plugins: Defaults\r\n- Others:\r\n","labels":["type/bug","area/plugins-catalog"]},{"id":63307,"title":"Grafana \"Bar Chart\" charshes with tooltip=Single","body":"****What happened**:**\r\n\"Tooltip Mode =Single\" chrashes Bar Chart\r\nReported error: Cannot read properties of undefined (reading '0')\r\nCrashes when howering the chart\r\n\r\n**What you expected to happen**:\r\nShow the correct tooltip and not crash\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\nSet up a chart of the type \"Bar Chart\"\r\nSet the Tooltip = Single\r\nMove the mouse to the generated bar in the chart\r\n\r\n**Anything else we need to know?**:\r\n\r\n**Environment**:\r\n- Grafana version:c v9.3.6\r\n- OS Grafana is installed on: Cloud\r\n- User OS \u0026 Browser: Windows 10 Pro, Chrome\r\n\r\n![chrome_305pXDXEVQ](https://user-images.githubusercontent.com/122878901/218404738-e64397b1-7cc8-4c93-8fbb-db5e5f81e3ee.gif)\r\n","labels":["needs more info","area/panel/barchart"]},{"id":46821,"title":"Dashboard variables re-order issue","body":"When trying to re-order variables in a dashboard, they instantly go back to their old position.\r\nSee animated GIF.\r\n\r\n**Environment**:\r\n- Grafana version: [v8.4.3-54429 (261722681)] \r\n- OS Grafana is installed on: Grafana Cloud\r\n- User OS \u0026 Browser: Mac OS 12.3 / Safari 15.4\r\n\r\n\r\n![Screen Recording 2022-03-22 at 09 07 57](https://user-images.githubusercontent.com/50638541/159436353-85a7f93c-68df-4a2a-b0c2-d0bb29dc6415.gif)\r\n\r\n","labels":["area/dashboard/templating","needs more info","bot/no new info"]},{"id":46299,"title":"MixedDatasource, one non-defined datasource disables showing available data from others","body":"\u003c!--\r\nPlease use this template to create your bug report. By providing as much info as possible you help us understand the issue, reproduce it and resolve it for you quicker. Therefore take a couple of extra minutes to make sure you have provided all info needed.\r\n\r\nPROTIP: record your screen and attach it as a gif to showcase the issue.\r\n\r\n- Questions should be posted to: https://community.grafana.com\r\n- Use query inspector to troubleshoot issues: https://bit.ly/2XNF6YS\r\n- How to record and attach gif: https://bit.ly/2Mi8T6K\r\n--\u003e\r\n\r\n**What happened**:\r\nI get an error when one of the datasources is not defined, and one of them is not defined.\r\n![image](https://user-images.githubusercontent.com/6523124/157063584-d0c9bf75-9f83-4fc2-89de-ae32e6ad7913.png)\r\nThe red triangle with exclamation mark says: \"Datasource rmHegeman-F1 was not found\". Which is a valid point, but I still want to see the data that is available, since not all sites have 8 fields, some have only one (F0).\r\n\r\n**What you expected to happen**:\r\nI expected that the values for the defined datasources was displayed.\r\n![image](https://user-images.githubusercontent.com/6523124/157063474-a80bf064-1800-4875-b67c-ba7a7070b7ed.png)\r\n\r\n**How to reproduce it (as minimally and precisely as possible)**:\r\n\r\n- create custom template variable $SelectedSite with values site1 and site2\r\n- create datasources site1-F0, site1-F1, site2-F0\r\n- create metrics that select from datasource $SelectedSite-F0, $SelectedSite-F1\r\n- create panel that uses both $SelectedSite-F0 and $SelectedSite-F1\r\n- the problem occurs when switching variable from site1 to site2\r\n\r\n**Anything else we need to know?**:\r\nA similar issue was solved some time ago #26955, but in that case the datasources were defined but non-reachable.\r\nI found a work-around to create dummy influxdb datasources for missing fields that point to an empty database (for F6, F7, F8 in panel below), but this is quite messy and time-consuming.\r\n![image](https://user-images.githubusercontent.com/6523124/157065883-d9f8f1ab-6d62-4c38-bb47-efab1501a1fe.png)\r\n\r\n\r\n**Environment**:\r\n- Grafana version: 8.3.4\r\n- Data source type \u0026 version: influxdb (core)\r\n- OS Grafana is installed on: Ubuntu 20.04.3 LTS\r\n- User OS \u0026 Browser: Ubuntu 20.04.4 LTS with Firefox 97.0.2\r\n- Grafana plugins: flowcharting 1.0.0b\r\n- Others:\r\n","labels":["type/bug","area/datasource","area/panel/data","team/grafana-dashboards","prio/future"]},{"id":47233,"title":"ElasticSearch : Add Nested Query Support","body":"This P.R enables querying nested fields within ElasticSearch documents. Nested querying is becoming more important since Elastic has deprecated multiple types of documents in an index and there is no way to cross-index join. \r\n\r\n[Grafana appears to have this functionality already](https://i.imgur.com/GqMtGIr.png), but when trying to do a query, it fails to show any data. This PR changes minimal code to enable that functionality to work and show awesome graphs based on aggregated subdocuments. :rocket: \r\n\r\nHere is what it looks like with the changes ![Graph With Changes](https://i.imgur.com/tzZOXVr.png)\r\n\r\nFixes https://github.com/grafana/grafana/issues/4693\r\n\r\n\r\nDespite this feature maybe seeming unimportant or niche, it is the only way to graph any kind of one-to-many relationship in ElasticSearch, especially with the deprecation of the type field.","labels":["datasource/Elasticsearch","area/backend","area/frontend","pr/external"]}]